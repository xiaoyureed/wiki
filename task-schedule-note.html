<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>task-schedule-note - Xiaoyu Wiki</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="pre.html">pre page</a></li><li class="chapter-item expanded "><a href="SpringBoot-note.html"><strong aria-hidden="true">1.</strong> Spring boot note</a></li><li class="chapter-item expanded "><a href="springcloud-note.html"><strong aria-hidden="true">2.</strong> springcloud-note</a></li><li class="chapter-item expanded "><a href="java-concurrent.html"><strong aria-hidden="true">3.</strong> java-concurrent</a></li><li class="chapter-item expanded "><a href="java-memory-model-jmm-jvm.html"><strong aria-hidden="true">4.</strong> java-memory-model-jmm-jvm</a></li><li class="chapter-item expanded "><a href="java-note.html"><strong aria-hidden="true">5.</strong> java-note</a></li><li class="chapter-item expanded "><a href="rust-note.html"><strong aria-hidden="true">6.</strong> rust-note</a></li><li class="chapter-item expanded "><a href="git-note.html"><strong aria-hidden="true">7.</strong> git note</a></li><li class="chapter-item expanded "><a href="linux-note.html"><strong aria-hidden="true">8.</strong> linux-note</a></li><li class="chapter-item expanded "><a href="cross-gfw.html"><strong aria-hidden="true">9.</strong> cross gfw</a></li><li class="chapter-item expanded "><a href="react-note.html"><strong aria-hidden="true">10.</strong> react-note</a></li><li class="chapter-item expanded "><a href="cs-note.html"><strong aria-hidden="true">11.</strong> cs note</a></li><li class="chapter-item expanded "><a href="distributed-system.html"><strong aria-hidden="true">12.</strong> distributed system</a></li><li class="chapter-item expanded "><a href="message-queue.html"><strong aria-hidden="true">13.</strong> message-queue</a></li><li class="chapter-item expanded "><a href="data-structure-and-algorithm.html"><strong aria-hidden="true">14.</strong> data structure and algorithm</a></li><li class="chapter-item expanded "><a href="effective-java-reading-note.html"><strong aria-hidden="true">15.</strong> effective java reading note</a></li><li class="chapter-item expanded "><a href="docker-note.html"><strong aria-hidden="true">16.</strong> docker note</a></li><li class="chapter-item expanded "><a href="how-to-test-java-app.html"><strong aria-hidden="true">17.</strong> how-to-test-java-app</a></li><li class="chapter-item expanded "><a href="maven-note.html"><strong aria-hidden="true">18.</strong> maven-note</a></li><li class="chapter-item expanded "><a href="mac.html"><strong aria-hidden="true">19.</strong> mac</a></li><li class="chapter-item expanded "><a href="autohotkey.html"><strong aria-hidden="true">20.</strong> AHK collection</a></li><li class="chapter-item expanded "><a href="class-conflict-check.html"><strong aria-hidden="true">21.</strong> class conflict check</a></li><li class="chapter-item expanded "><a href="cpp.html"><strong aria-hidden="true">22.</strong> cpp</a></li><li class="chapter-item expanded "><a href="create-blog-by-react.html"><strong aria-hidden="true">23.</strong> create blog by react</a></li><li class="chapter-item expanded "><a href="css-note.html"><strong aria-hidden="true">24.</strong> css-note</a></li><li class="chapter-item expanded "><a href="css-pre-processor.html"><strong aria-hidden="true">25.</strong> css pre processor</a></li><li class="chapter-item expanded "><a href="defect-about-java-programmer-from-programming-thinking.html"><strong aria-hidden="true">26.</strong> from programming thinking</a></li><li class="chapter-item expanded "><a href="design-pattern-note.html"><strong aria-hidden="true">27.</strong> design pattern note</a></li><li class="chapter-item expanded "><a href="dev-resources.html"><strong aria-hidden="true">28.</strong> dev resources</a></li><li class="chapter-item expanded "><a href="eclipse.html"><strong aria-hidden="true">29.</strong> eclipse</a></li><li class="chapter-item expanded "><a href="extjs-note.html"><strong aria-hidden="true">30.</strong> extjs-note</a></li><li class="chapter-item expanded "><a href="FreeMarker-note.html"><strong aria-hidden="true">31.</strong> FreeMarker-note</a></li><li class="chapter-item expanded "><a href="go-note.html"><strong aria-hidden="true">32.</strong> golang</a></li><li class="chapter-item expanded "><a href="hello-world.html"><strong aria-hidden="true">33.</strong> hexo</a></li><li class="chapter-item expanded "><a href="html-note.html"><strong aria-hidden="true">34.</strong> html-note</a></li><li class="chapter-item expanded "><a href="idea-note.html"><strong aria-hidden="true">35.</strong> idea-note</a></li><li class="chapter-item expanded "><a href="interview-system-design.html"><strong aria-hidden="true">36.</strong> interview-system-design</a></li><li class="chapter-item expanded "><a href="java-code-clean.html"><strong aria-hidden="true">37.</strong> java-code-clean</a></li><li class="chapter-item expanded "><a href="job-interview-cv.html"><strong aria-hidden="true">38.</strong> job-interview-cv</a></li><li class="chapter-item expanded "><a href="joke-collecting.html"><strong aria-hidden="true">39.</strong> joke-collecting</a></li><li class="chapter-item expanded "><a href="jquery-note.html"><strong aria-hidden="true">40.</strong> jquery-note</a></li><li class="chapter-item expanded "><a href="js-tutorial.html"><strong aria-hidden="true">41.</strong> js-tutorial</a></li><li class="chapter-item expanded "><a href="money.html"><strong aria-hidden="true">42.</strong> money</a></li><li class="chapter-item expanded "><a href="mongodb-note.html"><strong aria-hidden="true">43.</strong> mongodb-note</a></li><li class="chapter-item expanded "><a href="mvc-mvvm.html"><strong aria-hidden="true">44.</strong> mvc-mvvm</a></li><li class="chapter-item expanded "><a href="my-ioc.html"><strong aria-hidden="true">45.</strong> my-ioc</a></li><li class="chapter-item expanded "><a href="mybatis-note.html"><strong aria-hidden="true">46.</strong> mybatis-note</a></li><li class="chapter-item expanded "><a href="mysql-note.html"><strong aria-hidden="true">47.</strong> mysql-note</a></li><li class="chapter-item expanded "><a href="nodejs.html"><strong aria-hidden="true">48.</strong> nodejs</a></li><li class="chapter-item expanded "><a href="outline-about-cache.html"><strong aria-hidden="true">49.</strong> outline-about-cache</a></li><li class="chapter-item expanded "><a href="outline-about-db-design-note.html"><strong aria-hidden="true">50.</strong> outline-about-db-design-note</a></li><li class="chapter-item expanded "><a href="outline-about-http.html"><strong aria-hidden="true">51.</strong> outline-about-http</a></li><li class="chapter-item expanded "><a href="outline-about-rest-api.html"><strong aria-hidden="true">52.</strong> outline-about-rest-api</a></li><li class="chapter-item expanded "><a href="php-note.html"><strong aria-hidden="true">53.</strong> php-note</a></li><li class="chapter-item expanded "><a href="postgres-note.html"><strong aria-hidden="true">54.</strong> postgres-note</a></li><li class="chapter-item expanded "><a href="python-note.html"><strong aria-hidden="true">55.</strong> python-note</a></li><li class="chapter-item expanded "><a href="redis-login-limitation.html"><strong aria-hidden="true">56.</strong> redis-login-limitation</a></li><li class="chapter-item expanded "><a href="redis-note.html"><strong aria-hidden="true">57.</strong> redis-note</a></li><li class="chapter-item expanded "><a href="regex-js.html"><strong aria-hidden="true">58.</strong> regex-js</a></li><li class="chapter-item expanded "><a href="servlet.html"><strong aria-hidden="true">59.</strong> servlet</a></li><li class="chapter-item expanded "><a href="spring-note.html"><strong aria-hidden="true">60.</strong> spring-note</a></li><li class="chapter-item expanded "><a href="springboot-doc.html"><strong aria-hidden="true">61.</strong> springboot-doc</a></li><li class="chapter-item expanded "><a href="springmvc-note.html"><strong aria-hidden="true">62.</strong> springmvc-note</a></li><li class="chapter-item expanded "><a href="task-schedule-note.html" class="active"><strong aria-hidden="true">63.</strong> task-schedule-note</a></li><li class="chapter-item expanded "><a href="tcp-ip-note.html"><strong aria-hidden="true">64.</strong> tcp-ip-note</a></li><li class="chapter-item expanded "><a href="tomcat-jetty-nginx.html"><strong aria-hidden="true">65.</strong> tomcat-jetty-nginx</a></li><li class="chapter-item expanded "><a href="webpack-note.html"><strong aria-hidden="true">66.</strong> webpack-note</a></li><li class="chapter-item expanded "><a href="windows-sub-system-on-linux.html"><strong aria-hidden="true">67.</strong> windows-sub-system-on-linux</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Xiaoyu Wiki</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <hr />
<p>title: Task Schedule
tags:</p>
<ul>
<li>schedule</li>
<li>task
date: 2016-05-01 22:38:07
categories: java web</li>
</ul>
<hr />
<div align="center">
ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ æ€»ç»“
https://www.ibm.com/developerworks/cn/java/j-lo-taskschedule/index.html
</div>
<!--more-->
<!-- TOC -->
<ul>
<li><a href="#%E5%88%86%E7%B1%BB">åˆ†ç±»</a></li>
<li><a href="#cronexpression">cronExpression</a></li>
<li><a href="#%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B">ç”¨æ³•ç¤ºä¾‹</a>
<ul>
<li><a href="#javautiltimer">java.util.Timer</a></li>
<li><a href="#quartz">Quartz</a>
<ul>
<li><a href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C">å‡†å¤‡å·¥ä½œ</a></li>
<li><a href="#task%E7%BB%A7%E6%89%BF%E8%87%AA%E7%89%B9%E5%AE%9A%E5%9F%BA%E7%B1%BB">taskç»§æ‰¿è‡ªç‰¹å®šåŸºç±»</a></li>
<li><a href="#task%E6%97%A0%E9%9C%80%E7%BB%A7%E6%89%BF%E5%9F%BA%E7%B1%BB">taskæ— éœ€ç»§æ‰¿åŸºç±»</a></li>
</ul>
</li>
<li><a href="#spring-task">spring task</a></li>
</ul>
</li>
<li><a href="#quartz-1">Quartz</a>
<ul>
<li><a href="#%E6%98%AF%E4%BB%80%E4%B9%88">æ˜¯ä»€ä¹ˆ</a></li>
<li><a href="#quick-start">quick start</a></li>
<li><a href="#%E6%9C%89%E7%94%A8%E7%9A%84%E6%B3%A8%E8%A7%A3">æœ‰ç”¨çš„æ³¨è§£</a></li>
<li><a href="#trigger">trigger</a>
<ul>
<li><a href="#quartz-calendars">quartz Calendars</a></li>
<li><a href="#simpletrigger">SimpleTrigger</a></li>
<li><a href="#crontrigger">CronTrigger</a></li>
</ul>
</li>
<li><a href="#triggerlisteners-and-joblisteners">TriggerListeners and JobListeners</a></li>
<li><a href="#schedulerlisteners">SchedulerListeners</a></li>
<li><a href="#job-stores">Job Stores</a></li>
</ul>
</li>
<li><a href="#springboot%E5%92%8Cquartz%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E9%85%8D%E7%BD%AE">springbootå’Œquartzå®ç°åŠ¨æ€é…ç½®</a></li>
</ul>
<!-- /TOC -->
<h1><a class="header" href="#åˆ†ç±»" id="åˆ†ç±»">åˆ†ç±»</a></h1>
<p>ä¸ºäº†ç†è§£æ–¹ä¾¿, åšä¸€ä¸‹åˆ†ç±», æ ¹æ®å®ç°æŠ€æœ¯åˆ†ç±»:</p>
<ol>
<li>
<p>Javaè‡ªå¸¦çš„java.util.Timerç±»ï¼Œè¿™ä¸ªç±»å…è®¸ä½ è°ƒåº¦ä¸€ä¸ªjava.util.TimerTaskä»»åŠ¡ã€‚ä¸èƒ½æŒ‡å®šæ—¶é—´ï¼Œåªèƒ½æŒ‡å®šé¢‘ç‡ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨Quartzï¼Œè¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½æ¯”è¾ƒå¼ºå¤§çš„çš„è°ƒåº¦å™¨ï¼Œå¯ä»¥æŒ‡å®šæ—¶é—´ã€é¢‘ç‡ã€‚</p>
</li>
<li>
<p>Spring3.0ä»¥åè‡ªå¸¦çš„taskï¼Œå¯ä»¥å°†å®ƒçœ‹æˆä¸€ä¸ªè½»é‡çº§çš„Quartzï¼Œè€Œä¸”ä½¿ç”¨ç®€å•ã€‚</p>
</li>
</ol>
<p>æ ¹æ®ä»»åŠ¡ç±»ç»§æ‰¿æ–¹å¼åˆ†ç±»:</p>
<ol>
<li>ä»»åŠ¡ç±»éœ€è¦ç»§æ‰¿è‡ªç‰¹å®šçš„åŸºç±»</li>
</ol>
<p>æ¯”å¦‚ï¼š
Quartzä¸­éœ€è¦ç»§æ‰¿è‡ª<code>org.springframework.scheduling.quartz.QuartzJobBean</code>ï¼›java.util.Timerä¸­éœ€è¦ç»§æ‰¿è‡ª<code>java.util.TimerTask</code>ã€‚</p>
<ol start="2">
<li>ä¸éœ€è¦ç»§æ‰¿, ä»»åŠ¡ç±»å°±æ˜¯æ™®é€šç±»</li>
</ol>
<p>æŒ‡å®šæ—¶é—´ or æŒ‡å®šé¢‘ç‡ :</p>
<ol>
<li>
<p>æ¯éš”æŒ‡å®šæ—¶é—´åˆ™è§¦å‘ä¸€æ¬¡ï¼Œåœ¨Quartzä¸­å¯¹åº”çš„è§¦å‘å™¨ä¸ºï¼š<code>org.springframework.scheduling.quartz.SimpleTriggerBean</code></p>
</li>
<li>
<p>æ¯åˆ°æŒ‡å®šæ—¶é—´åˆ™è§¦å‘ä¸€æ¬¡ï¼Œåœ¨Quartzä¸­å¯¹åº”çš„è°ƒåº¦å™¨ä¸ºï¼š<code>org.springframework.scheduling.quartz.CronTriggerBean</code></p>
</li>
</ol>
<blockquote>
<p>æ³¨ï¼š
java.util.TimerTaskä»»åŠ¡å°±åªèƒ½ä½¿ç”¨ç¬¬ä¸€ç§è§¦å‘æ¡ä»¶ã€‚
Quartzå’Œspring taskéƒ½å¯ä»¥æ”¯æŒè¿™ä¸¤ç§è§¦å‘æ¡ä»¶ã€‚</p>
</blockquote>
<h1><a class="header" href="#cronexpression" id="cronexpression">cronExpression</a></h1>
<p>https://cron.qqe2.com/ åœ¨çº¿ç”Ÿæˆ cron</p>
<p>cron è¡¨è¾¾å¼</p>
<p>æ ¼å¼: <code>{ç§’æ•°} {åˆ†é’Ÿ} {å°æ—¶} {æ—¥æœŸ} {æœˆä»½} {æ˜ŸæœŸ} {å¹´ä»½(å¯ä¸ºç©º)}</code></p>
<p>å„ä¸ªå ä½ç¬¦è§£é‡Š:</p>
<p><img src="1.png" alt="alt" /></p>
<ul>
<li>
<p>&quot;<em>&quot; ç”¨æ¥æŒ‡æ‰€æœ‰å€¼, æ¯”å¦‚: &quot;</em>&quot;åœ¨&quot;åˆ†é’Ÿ&quot;çš„å­—æ®µé‡Œè¡¨ç¤º&quot;æ²¡åˆ†é’Ÿ&quot;</p>
</li>
<li>
<p>&quot;-&quot; æŒ‡å®šä¸€ä¸ªèŒƒå›´, å¦‚: &quot;10-12&quot;åœ¨&quot;å°æ—¶&quot;å­—æ®µè¡¨ç¤º&quot;10ç‚¹, 11ç‚¹, 12ç‚¹&quot;</p>
</li>
<li>
<p>&quot;,&quot; åˆ†éš”å¤šä¸ªå€¼, å¦‚: &quot;MON,WED,FRI&quot; åœ¨æ˜ŸæœŸé‡Œè¡¨ç¤º&quot;å‘¨ä¸€,ä¸‰,äº”&quot;</p>
</li>
<li>
<p>&quot;?&quot; åªåœ¨ &quot;æ—¥æœŸ&quot;, &quot;æ˜ŸæœŸ&quot;å­—æ®µä½¿ç”¨, æŒ‡&quot;ä¸æ˜ç¡®çš„å€¼&quot;</p>
</li>
<li>
<p>&quot;L&quot; æŒ‡å®šåœ¨&quot;æœˆ&quot;or&quot;æ˜ŸæœŸ&quot;çš„æœ€åä¸€å¤©(lastç¼©å†™)</p>
</li>
<li>
<p>&quot;W&quot; ç¦»æŒ‡å®šæ—¥æœŸæœ€è¿‘çš„æ˜ŸæœŸæ—¥, åªèƒ½åœ¨&quot;æœˆä»½&quot;ä¸­ä½¿ç”¨</p>
</li>
<li>
<p>&quot;#&quot; åªæ˜¯ç”¨åœ¨æ˜ŸæœŸå­—æ®µ,</p>
</li>
<li>
<p>&quot;/&quot; å¦‚: 1/20: ä»ç¬¬ä¸€å•ä½å¼€å§‹, æ¯éš”20ä¸ªå•ä½, å°±è§¦å‘ä¸€æ¬¡; 10-45/20 : åœ¨ç¬¬10åˆ°45å•ä½å†…ï¼Œæ¯éš”20å•ä½è§¦å‘ä¸€æ¬¡ï¼Œè¶…è¿‡ç¬¬45å•ä½ï¼Œåˆ™æ— æ•ˆäº†</p>
</li>
</ul>
<p>çœ‹çœ‹å‡ ä¸ª cron è¡¨è¾¾å¼ demo:</p>
<pre><code>CRONè¡¨è¾¾å¼                  å«ä¹‰ 
&quot;0 0 12 * * ?&quot;          æ¯å¤©ä¸­åˆåäºŒç‚¹è§¦å‘ 
&quot;0 15 10 ? * *&quot;         æ¯å¤©æ—©ä¸Š10ï¼š15è§¦å‘ 
&quot;0 15 10 * * ?&quot;         æ¯å¤©æ—©ä¸Š10ï¼š15è§¦å‘ 
&quot;0 15 10 * * ? *&quot;       æ¯å¤©æ—©ä¸Š10ï¼š15è§¦å‘ 
&quot;0 15 10 * * ? 2005&quot;    2005å¹´çš„æ¯å¤©æ—©ä¸Š10ï¼š15è§¦å‘ 
&quot;0 * 14 * * ?&quot;          æ¯å¤©ä»ä¸‹åˆ2ç‚¹å¼€å§‹åˆ°2ç‚¹59åˆ†æ¯åˆ†é’Ÿä¸€æ¬¡è§¦å‘
&quot;0 0/5 * * * ?&quot;         æ¯5minè§¦å‘ä¸€æ¬¡
â€œ10 0/5 * * * ?â€        æ¯5minä¸€æ¬¡è§¦å‘, åœ¨æ¯åˆ†é’Ÿçš„ç¬¬ 10s å¼€å§‹è§¦å‘
&quot;0 0/5 14 * * ?&quot;        æ¯å¤©ä»ä¸‹åˆ2ç‚¹å¼€å§‹åˆ°2ï¼š55åˆ†ç»“æŸæ¯5åˆ†é’Ÿä¸€æ¬¡è§¦å‘ 
&quot;0 0/5 14,18 * * ?&quot;     æ¯å¤©çš„ä¸‹åˆ2ç‚¹è‡³2ï¼š55å’Œ6ç‚¹è‡³6ç‚¹55åˆ†ä¸¤ä¸ªæ—¶é—´æ®µå†…æ¯5åˆ†é’Ÿä¸€æ¬¡è§¦å‘ 
&quot;0 0-5 14 * * ?&quot;        æ¯å¤©14:00è‡³14:05æ¯åˆ†é’Ÿä¸€æ¬¡è§¦å‘ 
â€œ0 30 10-13 ? * WED,FRIâ€    fires at 10:30, 11:30, 12:30, and 13:30, on every Wednesday and Friday.
&quot;0 10,44 14 ? 3 WED&quot;    ä¸‰æœˆçš„æ¯å‘¨ä¸‰çš„14ï¼š10å’Œ14ï¼š44è§¦å‘ 
&quot;0 15 10 ? * MON-FRI&quot;   æ¯ä¸ªå‘¨ä¸€ã€å‘¨äºŒã€å‘¨ä¸‰ã€å‘¨å››ã€å‘¨äº”çš„10ï¼š15è§¦å‘
â€œ0 0/30 8-9 5,20 * ?â€   æ¯ä¸ªæœˆçš„ 5å·, 20å· çš„ 8ç‚¹-10ç‚¹æ²¡30minè§¦å‘ä¸€æ¬¡

</code></pre>
<h1><a class="header" href="#ç”¨æ³•ç¤ºä¾‹" id="ç”¨æ³•ç¤ºä¾‹">ç”¨æ³•ç¤ºä¾‹</a></h1>
<h2><a class="header" href="#javautiltimer" id="javautiltimer">java.util.Timer</a></h2>
<p><code>java.util.Timer</code>
<code>java.util.TimerTask</code></p>
<ul>
<li>
<p>Timeræ˜¯ä¸€ä¸ªå®šæ—¶å™¨ç±»ï¼Œé€šè¿‡è¯¥ç±»å¯ä»¥ä¸ºæŒ‡å®šçš„å®šæ—¶ä»»åŠ¡è¿›è¡Œé…ç½®ã€‚</p>
</li>
<li>
<p>TimerTaskç±»æ˜¯ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ç±»ï¼Œè¯¥ç±»å®ç°äº†Runnableæ¥å£ï¼Œè€Œä¸”æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>public abstract class TimerTask implements Runnable 
å¯ä»¥é€šè¿‡ç»§æ‰¿è¯¥ç±»ï¼Œæ¥å®ç°è‡ªå·±çš„å®šæ—¶ä»»åŠ¡ã€‚</p>
</li>
</ul>
<p>Timerå®šæ—¶å™¨å®ä¾‹æœ‰å¤šç§æ„é€ æ–¹æ³•ï¼š</p>
<ul>
<li>
<p>Timer() åˆ›å»ºä¸€ä¸ªæ–°è®¡æ—¶å™¨ã€‚</p>
</li>
<li>
<p>Timer(boolean isDaemon) åˆ›å»ºä¸€ä¸ªæ–°è®¡æ—¶å™¨ï¼Œå¯ä»¥æŒ‡å®šå…¶ç›¸å…³çš„çº¿ç¨‹ä½œä¸ºå®ˆæŠ¤ç¨‹åºè¿è¡Œã€‚</p>
</li>
<li>
<p>Timer(String name) åˆ›å»ºä¸€ä¸ªæ–°è®¡æ—¶å™¨ï¼Œå…¶ç›¸å…³çš„çº¿ç¨‹å…·æœ‰æŒ‡å®šçš„åç§°ã€‚</p>
</li>
<li>
<p>Timer(String name, boolean isDaemon) åˆ›å»ºä¸€ä¸ªæ–°è®¡æ—¶å™¨ï¼Œå…¶ç›¸å…³çš„çº¿ç¨‹å…·æœ‰æŒ‡å®šçš„åç§°ï¼Œå¹¶ä¸”å¯ä»¥æŒ‡å®šä½œä¸ºå®ˆæŠ¤ç¨‹åºè¿è¡Œã€‚</p>
</li>
</ul>
<p>Timer æ–¹æ³•:</p>
<ol>
<li>åœ¨ç‰¹å®šæ—¶é—´æ‰§è¡Œä»»åŠ¡ï¼Œåªæ‰§è¡Œä¸€æ¬¡</li>
</ol>
<p>public void schedule(TimerTask task,Date time)</p>
<ol>
<li>åœ¨ç‰¹å®šæ—¶é—´ä¹‹åæ‰§è¡Œä»»åŠ¡ï¼Œåªæ‰§è¡Œä¸€æ¬¡</li>
</ol>
<p>public void schedule(TimerTask task,long delay)</p>
<ol>
<li>æŒ‡å®šç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶é—´ï¼Œç„¶åæŒ‰ç…§é—´éš”æ—¶é—´ï¼Œé‡å¤æ‰§è¡Œ</li>
</ol>
<p>public void schedule(TimerTask task,Date firstTime,long period)</p>
<ol>
<li>åœ¨ç‰¹å®šå»¶è¿Ÿä¹‹åç¬¬ä¸€æ¬¡æ‰§è¡Œï¼Œç„¶åæŒ‰ç…§é—´éš”æ—¶é—´ï¼Œé‡å¤æ‰§è¡Œ</li>
</ol>
<p>public void schedule(TimerTask task,long delay,long period)</p>
<ol>
<li>ç¬¬ä¸€æ¬¡æ‰§è¡Œä¹‹åï¼Œç‰¹å®šé¢‘ç‡æ‰§è¡Œï¼Œä¸3åŒ</li>
</ol>
<p>public void scheduleAtFixedRate(TimerTask task,Date firstTime,long period)</p>
<ol>
<li>åœ¨delayæ¯«ç§’ä¹‹åç¬¬ä¸€æ¬¡æ‰§è¡Œï¼ŒåæŒ‰ç…§ç‰¹å®šé¢‘ç‡æ‰§è¡Œ</li>
</ol>
<p>public void scheduleAtFixedRate(TimerTask task,long delay,long period)</p>
<ol>
<li>Timeræ³¨é”€ï¼štimer.cancle();</li>
</ol>
<blockquote>
<p>æ³¨:
schedule() &amp; scheduleAtFixedRate()ä¸¤è€…çš„åŒºåˆ«ï¼š
&lt;1&gt;schedule()æ–¹æ³•æ›´æ³¨é‡ä¿æŒé—´éš”æ—¶é—´çš„ç¨³å®šï¼šä¿éšœæ¯éš”periodæ—¶é—´å¯è°ƒç”¨ä¸€æ¬¡
&lt;2&gt;scheduleAtFixedRate()æ–¹æ³•æ›´æ³¨é‡ä¿æŒæ‰§è¡Œé¢‘ç‡çš„ç¨³å®šï¼šä¿éšœå¤šæ¬¡è°ƒç”¨çš„é¢‘ç‡è¶‹è¿‘äºperiodæ—¶é—´
å¦‚æœä»»åŠ¡æ‰§è¡Œæ—¶é—´å¤§äºperiodï¼Œä¼šåœ¨ä»»åŠ¡æ‰§è¡Œä¹‹åé©¬ä¸Šæ‰§è¡Œä¸‹ä¸€æ¬¡ä»»åŠ¡</p>
</blockquote>
<p>demo:</p>
<pre><code class="language-java">/**
 * task1
 *
 * @version 0.1
 * @author xy
 * @date 2018å¹´7æœˆ27æ—¥ ä¸‹åˆ4:33:36
 */
public class DemoTask extends TimerTask {
    
    @Override
    public void run() {
        SimpleDateFormat df = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);
        System.out.println(&quot;ä»»åŠ¡ è§¦å‘...mmmm, æ—¶é—´ï¼š&quot; + df.format(System.currentTimeMillis()));
    }

}

/**
 * task2 æ£€æµ‹æ˜¯å¦åˆ°é¥­ç‚¹äº†
 *
 * @version 0.1
 * @author xy
 * @date 2018å¹´7æœˆ27æ—¥ ä¸‹åˆ5:40:23
 */
public class DemoTask2 extends TimerTask{
    
    private static List&lt;Integer&gt; eatTimes;
    /**
     * é™æ€åˆå§‹åŒ–
     */
    static {
        initEatTimes();
    }
    
    /**
     * åˆå§‹åŒ–åƒé¥­æ—¶é—´
     */
    private static void initEatTimes(){
        eatTimes = new ArrayList&lt;Integer&gt;();
        eatTimes.add(8);
        eatTimes.add(12);
        eatTimes.add(18);
    }


    @Override
    public void run() {
        Calendar calendar = Calendar.getInstance();
        int hour = calendar.get(Calendar.HOUR_OF_DAY);
        if(eatTimes.contains(hour)) {
            System.out.println(&quot;é¥¿äº†ï¼Œåƒé¥­...&quot;);
        }

    }

}


/**
 * scheduler
 *
 * @version 0.1
 * @author xy
 * @date 2018å¹´7æœˆ27æ—¥ ä¸‹åˆ4:37:15
 */
public class DemoScheduler {
    
    Timer timer = new Timer();
    
    /**
     * æŒ‡å®šæ—¶é—´ç‚¹æ‰§è¡Œ
     * @param task
     * @param ms
     */
    public void schedule(TimerTask task, long ms) {
        timer.schedule(task, ms);
    }
    
    /**
     * é—´éš”ä¸€æ®µæ—¶é—´æ‰§è¡Œ
     * @param task
     * @param firstTime
     * @param period
     */
    public void schedule (TimerTask task, Date firstTime, long period) {
        timer.schedule(task, firstTime, period);
    }
    
    public static void main(String[] args) {
        
//        SimpleDateFormat df = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);
//        
//        new DemoScheduler().schedule(new DemoTask(), 1000);
//        System.out.println(&quot;main thread: scheduleæˆåŠŸè°ƒç”¨ï¼Œ timeï¼š&quot; + df.format(System.currentTimeMillis()));
        
        new DemoScheduler().schedule(new DemoTask2(), Calendar.getInstance().getTime(), 1000*60*60);
    }
}

</code></pre>
<h2><a class="header" href="#quartz" id="quartz">Quartz</a></h2>
<p>å…·ä½“å‚è§ï¼šhttps://blog.csdn.net/defonds/article/details/49496895</p>
<h3><a class="header" href="#å‡†å¤‡å·¥ä½œ" id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ</a></h3>
<p>å¯¼å…¥ç›¸åº”çš„springçš„åŒ…(å››ä¸ªæ ¸å¿ƒåŒ…ï¼Œä¸€ä¸ªä¾èµ–åŒ…)ä¸Quartzçš„åŒ…</p>
<ul>
<li>
<p>å¯¼å…¥Quartzçš„åŒ…</p>
</li>
<li>
<p>å¯¼å…¥Springçš„</p>
<p>Spring-context-supportåŒ…----ä»»åŠ¡ç±»åŸºç±»
Spring-webåŒ…--------spring web å¼€å‘ï¼ˆå‘ç°web.xmlï¼ŒListenerç­‰ï¼‰
Spring-txåŒ…</p>
</li>
</ul>
<blockquote>
<p>æ³¨ï¼š
springç‰ˆæœ¬ä¸º3.2  quartzç‰ˆæœ¬ä¸º2.2.1  ä¹Ÿå°±æ˜¯è¯´å¦‚æœä½¿ç”¨äº†quartz2.2.1 åˆ™springç‰ˆæœ¬éœ€3.1ä»¥ä¸Š</p>
</blockquote>
<h3><a class="header" href="#taskç»§æ‰¿è‡ªç‰¹å®šåŸºç±»" id="taskç»§æ‰¿è‡ªç‰¹å®šåŸºç±»">taskç»§æ‰¿è‡ªç‰¹å®šåŸºç±»</a></h3>
<p>taskåŸºç±»: <code>org.springframework.scheduling.quartz.QuartzJobBean</code>-----æ¥è‡ª context-support åŒ…</p>
<h3><a class="header" href="#taskæ— éœ€ç»§æ‰¿åŸºç±»" id="taskæ— éœ€ç»§æ‰¿åŸºç±»">taskæ— éœ€ç»§æ‰¿åŸºç±»</a></h3>
<p>èƒ½å¤Ÿæ”¯æŒè¿™ä¸€ç‰¹æ€§, å½’åŠŸäº <code>org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean</code></p>
<h2><a class="header" href="#spring-task" id="spring-task">spring task</a></h2>
<p>Spring task ï¼šè½»é‡çº§çš„Quartzï¼Œè€Œä¸”ä½¿ç”¨èµ·æ¥å¾ˆç®€å•ï¼Œé™¤springç›¸å…³çš„åŒ…å¤–ä¸éœ€è¦é¢å¤–çš„åŒ…ï¼Œè€Œä¸”æ”¯æŒæ³¨è§£å’Œé…ç½®æ–‡ä»¶ä¸¤ç§ï¼Œä»»åŠ¡ç±»å‡ä¸ºPOJO</p>
<h1><a class="header" href="#quartz-1" id="quartz-1">Quartz</a></h1>
<h2><a class="header" href="#æ˜¯ä»€ä¹ˆ" id="æ˜¯ä»€ä¹ˆ">æ˜¯ä»€ä¹ˆ</a></h2>
<p>http://www.quartz-scheduler.org/</p>
<p>åŸºäºjavaå¹³å°çš„ä»»åŠ¡è°ƒåº¦åº“, æ”¯æŒäº‹åŠ¡, é›†ç¾¤</p>
<p>æ ¸å¿ƒæ¦‚å¿µ/æ¥å£å°±è¿™å‡ ä¸ª:</p>
<ul>
<li>
<p>Scheduler - è°ƒåº¦ç¨‹åº (the main API for interacting with the scheduler.)</p>
<ul>
<li>
<p>Schedulerâ€™s life-cycle: ä»åˆ›å»ºå¼€å§‹, åˆ° shutdown() method ç»“æŸ</p>
</li>
<li>
<p>æä¾› add, remove, list Jobs and Triggers, pause trigger ç­‰ç­‰</p>
</li>
<li>
<p>scheduler åœ¨ä½¿ç”¨ start() å¯åŠ¨å‰, ä¸ä¼šèµ·ä½œç”¨</p>
</li>
</ul>
</li>
<li>
<p>Job - ä»»åŠ¡ç±»éœ€è¦å®ç°å®ƒ</p>
<ul>
<li>
<p>æ¥å£åªä¸€ä¸ªæ–¹æ³• public void execute(JobExecutionContext context), å½“ trigger è¢«è§¦å‘, schedulerâ€™s worker threads ä¼šæ‰§è¡Œ execute æ–¹æ³•</p>
</li>
<li>
<p>JobExecutionContext å¯ä»¥è·å– scheduler, trigger, JobDetail ...</p>
</li>
<li>
<p>scheduler æ¯æ¬¡è°ƒç”¨ Job çš„ execute(), éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ Job å®ä¾‹, è°ƒç”¨ç»“æŸ, æŒ‡å‘è¿™ä¸ªå®ä¾‹çš„ references å°±è¢«æ‹¿æ‰äº†, å¯¹è±¡éšä¹‹è¢«å›æ”¶, å› æ­¤æ— æ³•åœ¨ Job ä¸­è®¾ç½®å±æ€§ä¿¡æ¯, åªæœ‰é€šè¿‡ JobDetail è®¾ç½® JobDataMap</p>
</li>
</ul>
</li>
<li>
<p>JobDetail - å®šä¹‰ä¸€ä¸ª Job çš„å±æ€§, æ¯”å¦‚ name, group...</p>
<ul>
<li>
<p>ä»»åŠ¡ç±»æ·»åŠ å®Œä¸€äº›å±æ€§åæˆä¸º JobDetail, ç„¶åå’Œ trigger ä¸€èµ·äº¤ç»™ scheduler</p>
</li>
<li>
<p>JobDataMap - å¯ä»¥åœ¨ JobDetail ä¸­ä¸º Job è®¾ç½®ä¸€äº› props ç„¶åå†åœ¨ execute() ä¸­ä½¿ç”¨ (å¦å¤–, è§¦å‘å™¨è¿˜å¯ä»¥å…·æœ‰ä¸ä¹‹å…³è”çš„JobDataMaps)</p>
</li>
</ul>
<pre><code class="language-java">// define the job and tie it to our DumbJob class
JobDetail job = newJob(DumbJob.class)
    .withIdentity(&quot;myJob&quot;, &quot;group1&quot;) // name &quot;myJob&quot;, group &quot;group1&quot;
    .usingJobData(&quot;jobSays&quot;, &quot;Hello World!&quot;)
    .usingJobData(&quot;myFloatValue&quot;, 3.141f)
    .build();

// use JobDataMap inside task class
public void execute(JobExecutionContext context)
    throws JobExecutionException
{
    JobKey key = context.getJobDetail().getKey();

    JobDataMap dataMap = context.getJobDetail().getJobDataMap();

    String jobSays = dataMap.getString(&quot;jobSays&quot;);
    float myFloatValue = dataMap.getFloat(&quot;myFloatValue&quot;);

    System.err.println(&quot;Instance &quot; + key + &quot; of DumbJob says: &quot; + jobSays + &quot;, and val is: &quot; + myFloatValue);
}
</code></pre>
<p>æˆ–è€…ï¼Œ å¯ä»¥é€šè¿‡ setter() å®ç° è‡ªåŠ¨æ³¨å…¥ (è§¦å‘å™¨è§¦å‘æ—¶ï¼Œå°†åŠ è½½ä¸å…¶å…³è”çš„JobDetailï¼ˆå®ä¾‹å®šä¹‰ï¼‰ï¼Œå¹¶é€šè¿‡Schedulerä¸Šé…ç½®çš„JobFactoryå®ä¾‹åŒ–å…¶å¼•ç”¨çš„ä½œä¸šç±»ã€‚é»˜è®¤çš„JobFactoryåªæ˜¯åœ¨ä½œä¸šç±»ä¸Šè°ƒç”¨newInstanceï¼ˆï¼‰ï¼Œç„¶åå°è¯•åœ¨ç±»ä¸Šè°ƒç”¨ä¸JobDataMapä¸­çš„é”®ååŒ¹é…çš„setteræ–¹æ³•)</p>
<pre><code class="language-java">public class DumbJob implements Job {

    String jobSays;
    float myFloatValue;
    ArrayList state;

    public DumbJob() {
    }

    public void execute(JobExecutionContext context)
    throws JobExecutionException
    {
    JobKey key = context.getJobDetail().getKey();

    JobDataMap dataMap = context.getMergedJobDataMap();  // Note the difference from the previous example

    state.add(new Date());

    System.err.println(&quot;Instance &quot; + key + &quot; of DumbJob says: &quot; + jobSays + &quot;, and val is: &quot; + myFloatValue);
    }

    public void setJobSays(String jobSays) {
    this.jobSays = jobSays;
    }

    public void setMyFloatValue(float myFloatValue) {
    myFloatValue = myFloatValue;
    }

    public void setState(ArrayList state) {
    state = state;
    }

}

</code></pre>
</li>
<li>
<p>Trigger - å®šä¹‰è°ƒåº¦è§„åˆ™ ( a component that defines the schedule upon which a given Job will be executed)</p>
<p>quartz é¢„å…ˆå®šä¹‰å¥½äº†å¾ˆå¤šç±»å‹çš„ trigger, å¸¸ç”¨çš„æ˜¯ SimpleTrigger (ç‰¹å®šæ—¶é—´æ‰§è¡Œä¸€æ¬¡ [ç„¶åé‡å¤ N æ¬¡, æ¯æ¬¡é—´éš” T]) and CronTrigger (å¯ä»¥ä½¿ç”¨æ›´çµæ´»çš„ cron expression)</p>
</li>
<li>
<p>å¯ä»¥ä½¿ç”¨ Domain Specific Language (or DSL, also sometimes referred to as a â€œfluent interfaceâ€), è§åé¢çš„ä»£ç (éœ€è¦ static import)</p>
<ul>
<li>
<p>JobBuilder - used to define/build JobDetail instances, which define instances of Jobs.</p>
</li>
<li>
<p>TriggerBuilder - used to define/build Trigger instances.</p>
</li>
</ul>
</li>
</ul>
<h2><a class="header" href="#quick-start" id="quick-start">quick start</a></h2>
<p>ğŸ”—: xx</p>
<p>æœ‰å¿…è¦æä¸€ä¸‹, fluent api çš„ä½¿ç”¨éœ€è¦é¦–å…ˆ static import ä¸€äº›åŒ…:</p>
<pre><code class="language-java">import static org.quartz.JobBuilder.*;
import static org.quartz.SimpleScheduleBuilder.*;
import static org.quartz.CronScheduleBuilder.*;
import static org.quartz.CalendarIntervalScheduleBuilder.*;
import static org.quartz.TriggerBuilder.*;
import static org.quartz.DateBuilder.*;
</code></pre>
<pre><code class="language-java">package com.xiaoyu.learn.etc.schedule.quartz.simple.demo;

import org.quartz.JobDetail;
import org.quartz.Scheduler;
import org.quartz.Trigger;
import org.quartz.impl.StdSchedulerFactory;
import static org.quartz.JobBuilder.*;
import static org.quartz.TriggerBuilder.*;
import static org.quartz.SimpleScheduleBuilder.*;

import com.xiaoyu.learn.etc.schedule.quartz.simple.demo.job.HelloJob;

/**
 * quartz simple demo
 *
 * @version 0.1
 * @author xy
 * @date 2018å¹´7æœˆ29æ—¥ ä¸‹åˆ10:08:08
 */
public class QuartzTest {

    public static void main(String[] args) throws Exception {
        // // Grab the Scheduler instance from the Factory
        Scheduler defaultScheduler = StdSchedulerFactory.getDefaultScheduler();
        
        // setup quartz properties
        String qzPropsPath = Thread.currentThread().getContextClassLoader()
                .getResource(&quot;quartz.properties&quot;).getPath().toString();
        System.setProperty(
                &quot;org.quartz.properties&quot;, qzPropsPath);
        System.out.println(&quot;&gt;&gt;&gt;&gt;&gt; quartz config file path: &quot; + qzPropsPath);
        
        // and start it off
        defaultScheduler.start();
        // -----------------------------do sth.------------------------------
        // attention: static import needed
     // define the job and tie it to our HelloJob class
        JobDetail job = newJob(HelloJob.class)
            .withIdentity(&quot;job1&quot;, &quot;group1&quot;)// setup jobName and jobGroup
            .build();

        // Trigger the job to run now, and then repeat every 2 seconds
        Trigger trigger = newTrigger()
            .withIdentity(&quot;trigger1&quot;, &quot;group1&quot;)
            .startNow()
                  .withSchedule(simpleSchedule()
                    .withIntervalInSeconds(2)
                    .repeatForever())            
            .build();

        // Tell quartz to schedule the job using our trigger
        defaultScheduler.scheduleJob(job, trigger);
        // ---------------------------------------------------------------
        
        Thread.sleep(60000);
        
        /**
         * Once you obtain a scheduler using `StdSchedulerFactory.getDefaultScheduler()`,
         * your application will not terminate until you call `scheduler.shutdown()`,
         * because there will be active threads.
         */
        defaultScheduler.shutdown();
    }
}

</code></pre>
<h2><a class="header" href="#æœ‰ç”¨çš„æ³¨è§£" id="æœ‰ç”¨çš„æ³¨è§£">æœ‰ç”¨çš„æ³¨è§£</a></h2>
<p>å¯ä»¥æ·»åŠ åˆ° job class ä¸Šç”¨äºæ§åˆ¶ state å’Œå¹¶å‘</p>
<ul>
<li>
<p>@DisallowConcurrentExecution - è§„å®šåŒä¸€ä¸ªæ—¶é—´æ®µå†…, åªèƒ½æœ‰ä¸€ä¸ª job classåœ¨æ‰§è¡Œ, ä½†æ˜¯å¯ä»¥æœ‰å¤šä¸ª jobDetail åœ¨æ‰§è¡Œ;</p>
<p>ä¸¾ä¸ªğŸŒ°:
æœ‰ä¸ª job class å« &quot;SalesReportJob&quot;, ç„¶ååœ¨æ­¤åŸºç¡€ä¸Šå®šä¹‰ä¸¤ä¸ª jobDetail &quot;SalesReportForJoe&quot; å’Œ &quot;SalesReportForMike&quot; (é€šè¿‡ä¼ é€’ä¸åŒçš„jobDateMap). å¦‚æœ SalesReportJob è¢«æ ‡æ³¨, åˆ™åªèƒ½åœ¨ç»™å®šæ—¶é—´æ‰§è¡Œâ€œSalesReportForJoeâ€çš„ä¸€ä¸ªå®ä¾‹ï¼Œä½†å®ƒå¯ä»¥ä¸â€œSalesReportForMikeâ€å®ä¾‹åŒæ—¶æ‰§è¡Œ</p>
</li>
<li>
<p>@PersistJobDataAfterExecution - å®ƒå‘Šè¯‰Quartzåœ¨executeï¼ˆï¼‰æ–¹æ³•æˆåŠŸå®Œæˆåï¼ˆä¸æŠ›å‡ºå¼‚å¸¸ï¼‰æ›´æ–°JobDetailçš„JobDataMapçš„å­˜å‚¨å‰¯æœ¬ï¼Œä»¥ä¾¿ä¸‹ä¸€æ¬¡æ‰§è¡Œç›¸åŒçš„å·¥ä½œï¼ˆ JobDetailï¼‰æ¥æ”¶æ›´æ–°çš„å€¼è€Œä¸æ˜¯æœ€åˆå­˜å‚¨çš„å€¼</p>
<p>ä¸€èˆ¬å’Œ @DisallowConcurrentExecution ä¸€èµ·ä½¿ç”¨</p>
</li>
</ul>
<h2><a class="header" href="#trigger" id="trigger">trigger</a></h2>
<p>è§¦å‘å™¨å…¬å…±çš„å±æ€§ï¼š</p>
<ul>
<li>
<p>TriggerKey </p>
</li>
<li>
<p>jobKey</p>
</li>
<li>
<p>startTime -  java.util.Date, æŒ‡å®š triggerâ€™s schedule ä½•æ—¶é¦–æ¬¡ç”Ÿæ•ˆ</p>
</li>
<li>
<p>endTime - triggerâ€™s schedule ä½•æ—¶å¤±æ•ˆ</p>
</li>
<li>
<p>Priority - ä¸º trigger è®¾ç½®ä¼˜å…ˆçº§ï¼Œ å½“ worker thread ä¸å¤Ÿç”¨çš„æ—¶å€™ç”Ÿæ•ˆ</p>
</li>
</ul>
<h3><a class="header" href="#quartz-calendars" id="quartz-calendars">quartz Calendars</a></h3>
<p>åœ¨ä¸€ä»½è®¡åˆ’ä¸­ï¼Œ æ’é™¤æŸäº›æ—¥æœŸ</p>
<pre><code class="language-java">HolidayCalendar cal = new HolidayCalendar();
cal.addExcludedDate( someDate );
cal.addExcludedDate( someOtherDate );

sched.addCalendar(&quot;myHolidays&quot;, cal, false);


Trigger t = newTrigger()
    .withIdentity(&quot;myTrigger&quot;)
    .forJob(&quot;myJob&quot;)
    .withSchedule(dailyAtHourAndMinute(9, 30)) // execute job daily at 9:30
    .modifiedByCalendar(&quot;myHolidays&quot;) // but not on holidays
    .build();

// .. schedule job with trigger

Trigger t2 = newTrigger()
    .withIdentity(&quot;myTrigger2&quot;)
    .forJob(&quot;myJob2&quot;)
    .withSchedule(dailyAtHourAndMinute(11, 30)) // execute job daily at 11:30
    .modifiedByCalendar(&quot;myHolidays&quot;) // but not on holidays
    .build();

// .. schedule job with trigger2
</code></pre>
<h3><a class="header" href="#simpletrigger" id="simpletrigger">SimpleTrigger</a></h3>
<ul>
<li>
<p>æ»¡è¶³è¿™æ ·çš„éœ€æ±‚: åœ¨ç‰¹å®šçš„æ—¶åˆ»æ‰§è¡Œä¸€æ¬¡ä»»åŠ¡[é—´éš”ä¸€å®šæ—¶é—´é‡å¤æ‰§è¡Œè¯¥ä»»åŠ¡]</p>
</li>
<li>
<p>åŒ…å«è¿™äº›å±æ€§: a start-time, and end-time, a repeat count, and a repeat interval.</p>
</li>
<li>
<p>ä½¿ç”¨éœ€è¦ static import:</p>
<pre><code class="language-java">import static org.quartz.TriggerBuilder.*;
import static org.quartz.SimpleScheduleBuilder.*;
import static org.quartz.DateBuilder.*:

</code></pre>
<ul>
<li>
<p>ç‰¹å®šæ—¶åˆ»è§¦å‘, ä¸é‡å¤</p>
<pre><code class="language-java">SimpleTrigger trigger = (SimpleTrigger) newTrigger()
    .withIdentity(&quot;trigger1&quot;, &quot;group1&quot;)
    .startAt(myStartTime) // some Date æˆ–è€… .startNow() é»˜è®¤å°±æ˜¯now
    .forJob(&quot;job1&quot;, &quot;group1&quot;) // identify job with name, group strings
    .build();
</code></pre>
</li>
<li>
<p>ç‰¹å®šæ—¶åˆ»è§¦å‘, é—´éš”10s, é‡å¤ 10+1 æ¬¡</p>
<pre><code class="language-java">trigger = newTrigger()
    .withIdentity(&quot;trigger3&quot;, &quot;group1&quot;)
    .startAt(myTimeToStartFiring)  // if a start time is not given (if this line were omitted), &quot;now&quot; is implied
    .withSchedule(simpleSchedule()
        .withIntervalInSeconds(10)
        .withRepeatCount(10)) // note that 10 repeats will give a total of 11 firings
    .forJob(myJob) // identify job with handle to its JobDetail itself
    .build();
</code></pre>
</li>
<li>
<p>5min åè§¦å‘, ä¸é‡å¤</p>
<pre><code class="language-java"> trigger = (SimpleTrigger) newTrigger()
    .withIdentity(&quot;trigger5&quot;, &quot;group1&quot;)
    .startAt(futureDate(5, IntervalUnit.MINUTE)) // use DateBuilder to create a date in the future
    .forJob(myJobKey) // identify job with its JobKey
    .build();
</code></pre>
</li>
<li>
<p>ç«‹å³è§¦å‘, æ¯ 5min é‡å¤ä¸€æ¬¡, ç›´åˆ° 22:00 ç‚¹</p>
<pre><code class="language-java">trigger = newTrigger()
    .withIdentity(&quot;trigger7&quot;, &quot;group1&quot;)
    .withSchedule(simpleSchedule()
        .withIntervalInMinutes(5)
        .repeatForever())
    .endAt(dateOf(22, 0, 0))
    .build();
</code></pre>
</li>
<li>
<p>åœ¨ä¸‹ä¸€ä¸ªæ•´ç‚¹è§¦å‘, ç„¶åé—´éš” 2h, æ°¸è¿œé‡å¤</p>
<pre><code class="language-java"> trigger = newTrigger()
    .withIdentity(&quot;trigger8&quot;) // because group is not specified, &quot;trigger8&quot; will be in the default group
    .startAt(evenHourDate(null)) // get the next even-hour (minutes and seconds zero (&quot;00:00&quot;))
    .withSchedule(simpleSchedule()
        .withIntervalInHours(2)
        .repeatForever())
    // note that in this example, 'forJob(..)' is not called
    //  - which is valid if the trigger is passed to the scheduler along with the job  
    .build();

    scheduler.scheduleJob(trigger, job);
</code></pre>
</li>
</ul>
</li>
<li>
<p>æ‰§è¡Œä»»åŠ¡å¤±è´¥, å¯ä»¥ç»™ trigger è®¾å®š&quot;å¤±è´¥æŒ‡ä»¤&quot; (<a href="http://www.quartz-scheduler.org/documentation/quartz-2.2.x/tutorials/tutorial-lesson-05.html">ref</a>)</p>
</li>
</ul>
<h3><a class="header" href="#crontrigger" id="crontrigger">CronTrigger</a></h3>
<ul>
<li>
<p>startTime , endTime</p>
</li>
<li>
<p>cronExpression ğŸ‘‰ <a href="#cronExpression">#coronè¡¨è¾¾å¼</a></p>
</li>
<li>
<p>éœ€è¦é™æ€å¼•å…¥</p>
<pre><code class="language-java">import static org.quartz.TriggerBuilder.*;
import static org.quartz.CronScheduleBuilder.*;
import static org.quartz.DateBuilder.*:
</code></pre>
<ul>
<li>
<p>æ¯åˆ†é’Ÿè§¦å‘ä¸€æ¬¡, ä¸Šåˆ5ç‚¹åˆ°ä¸‹åˆ8ç‚¹, æ¯å¤©</p>
<pre><code class="language-java">trigger = newTrigger()
    .withIdentity(&quot;trigger3&quot;, &quot;group1&quot;)
    .withSchedule(cronSchedule(&quot;0 0/2 8-17 * * ?&quot;))
    .forJob(&quot;myJob&quot;, &quot;group1&quot;)
    .build();
</code></pre>
</li>
<li>
<p>è®¾ç½®æ—¶åŒº</p>
<pre><code class="language-java">trigger = newTrigger()
    .withIdentity(&quot;trigger3&quot;, &quot;group1&quot;)
    .withSchedule(cronSchedule(&quot;0 42 10 ? * WED&quot;))
    .inTimeZone(TimeZone.getTimeZone(&quot;America/Los_Angeles&quot;))
    .forJob(myJobKey)
    .build();
</code></pre>
</li>
</ul>
</li>
</ul>
<h2><a class="header" href="#triggerlisteners-and-joblisteners" id="triggerlisteners-and-joblisteners">TriggerListeners and JobListeners</a></h2>
<p>http://www.quartz-scheduler.org/documentation/quartz-2.2.x/tutorials/tutorial-lesson-07.html</p>
<h2><a class="header" href="#schedulerlisteners" id="schedulerlisteners">SchedulerListeners</a></h2>
<p>http://www.quartz-scheduler.org/documentation/quartz-2.2.x/tutorials/tutorial-lesson-08.html</p>
<h2><a class="header" href="#job-stores" id="job-stores">Job Stores</a></h2>
<ul>
<li>
<p>RAMJobStore - å­˜å‚¨åœ¨å†…å­˜ä¸­</p>
<p>ä½¿ç”¨éœ€è¦è¿™æ ·è®¾ç½®: <code>org.quartz.jobStore.class = org.quartz.simpl.RAMJobStore</code></p>
</li>
<li>
<p>JDBCJobStore - å­˜å‚¨åœ¨æ•°æ®åº“ä¸­</p>
</li>
</ul>
<h1><a class="header" href="#springbootå’Œquartzå®ç°åŠ¨æ€é…ç½®" id="springbootå’Œquartzå®ç°åŠ¨æ€é…ç½®">springbootå’Œquartzå®ç°åŠ¨æ€é…ç½®</a></h1>
<p>ref: https://blog.csdn.net/liuchuanhong1/article/details/60873295</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="springmvc-note.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="tcp-ip-note.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="springmvc-note.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="tcp-ip-note.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
