<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>java-note - Xiaoyu Wiki</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="pre.html">pre page</a></li><li class="chapter-item expanded "><a href="SpringBoot-note.html"><strong aria-hidden="true">1.</strong> Spring boot note</a></li><li class="chapter-item expanded "><a href="springcloud-note.html"><strong aria-hidden="true">2.</strong> springcloud-note</a></li><li class="chapter-item expanded "><a href="java-concurrent.html"><strong aria-hidden="true">3.</strong> java-concurrent</a></li><li class="chapter-item expanded "><a href="java-memory-model-jmm-jvm.html"><strong aria-hidden="true">4.</strong> java-memory-model-jmm-jvm</a></li><li class="chapter-item expanded "><a href="java-note.html" class="active"><strong aria-hidden="true">5.</strong> java-note</a></li><li class="chapter-item expanded "><a href="rust-note.html"><strong aria-hidden="true">6.</strong> rust-note</a></li><li class="chapter-item expanded "><a href="git-note.html"><strong aria-hidden="true">7.</strong> git note</a></li><li class="chapter-item expanded "><a href="linux-note.html"><strong aria-hidden="true">8.</strong> linux-note</a></li><li class="chapter-item expanded "><a href="cross-gfw.html"><strong aria-hidden="true">9.</strong> cross gfw</a></li><li class="chapter-item expanded "><a href="react-note.html"><strong aria-hidden="true">10.</strong> react-note</a></li><li class="chapter-item expanded "><a href="cs-note.html"><strong aria-hidden="true">11.</strong> cs note</a></li><li class="chapter-item expanded "><a href="distributed-system.html"><strong aria-hidden="true">12.</strong> distributed system</a></li><li class="chapter-item expanded "><a href="message-queue.html"><strong aria-hidden="true">13.</strong> message-queue</a></li><li class="chapter-item expanded "><a href="data-structure-and-algorithm.html"><strong aria-hidden="true">14.</strong> data structure and algorithm</a></li><li class="chapter-item expanded "><a href="effective-java-reading-note.html"><strong aria-hidden="true">15.</strong> effective java reading note</a></li><li class="chapter-item expanded "><a href="docker-note.html"><strong aria-hidden="true">16.</strong> docker note</a></li><li class="chapter-item expanded "><a href="how-to-test-java-app.html"><strong aria-hidden="true">17.</strong> how-to-test-java-app</a></li><li class="chapter-item expanded "><a href="maven-note.html"><strong aria-hidden="true">18.</strong> maven-note</a></li><li class="chapter-item expanded "><a href="mac.html"><strong aria-hidden="true">19.</strong> mac</a></li><li class="chapter-item expanded "><a href="autohotkey.html"><strong aria-hidden="true">20.</strong> AHK collection</a></li><li class="chapter-item expanded "><a href="class-conflict-check.html"><strong aria-hidden="true">21.</strong> class conflict check</a></li><li class="chapter-item expanded "><a href="cpp.html"><strong aria-hidden="true">22.</strong> cpp</a></li><li class="chapter-item expanded "><a href="create-blog-by-react.html"><strong aria-hidden="true">23.</strong> create blog by react</a></li><li class="chapter-item expanded "><a href="css-note.html"><strong aria-hidden="true">24.</strong> css-note</a></li><li class="chapter-item expanded "><a href="css-pre-processor.html"><strong aria-hidden="true">25.</strong> css pre processor</a></li><li class="chapter-item expanded "><a href="defect-about-java-programmer-from-programming-thinking.html"><strong aria-hidden="true">26.</strong> from programming thinking</a></li><li class="chapter-item expanded "><a href="design-pattern-note.html"><strong aria-hidden="true">27.</strong> design pattern note</a></li><li class="chapter-item expanded "><a href="dev-resources.html"><strong aria-hidden="true">28.</strong> dev resources</a></li><li class="chapter-item expanded "><a href="eclipse.html"><strong aria-hidden="true">29.</strong> eclipse</a></li><li class="chapter-item expanded "><a href="extjs-note.html"><strong aria-hidden="true">30.</strong> extjs-note</a></li><li class="chapter-item expanded "><a href="FreeMarker-note.html"><strong aria-hidden="true">31.</strong> FreeMarker-note</a></li><li class="chapter-item expanded "><a href="go-note.html"><strong aria-hidden="true">32.</strong> golang</a></li><li class="chapter-item expanded "><a href="hello-world.html"><strong aria-hidden="true">33.</strong> hexo</a></li><li class="chapter-item expanded "><a href="html-note.html"><strong aria-hidden="true">34.</strong> html-note</a></li><li class="chapter-item expanded "><a href="idea-note.html"><strong aria-hidden="true">35.</strong> idea-note</a></li><li class="chapter-item expanded "><a href="interview-system-design.html"><strong aria-hidden="true">36.</strong> interview-system-design</a></li><li class="chapter-item expanded "><a href="java-code-clean.html"><strong aria-hidden="true">37.</strong> java-code-clean</a></li><li class="chapter-item expanded "><a href="job-interview-cv.html"><strong aria-hidden="true">38.</strong> job-interview-cv</a></li><li class="chapter-item expanded "><a href="joke-collecting.html"><strong aria-hidden="true">39.</strong> joke-collecting</a></li><li class="chapter-item expanded "><a href="jquery-note.html"><strong aria-hidden="true">40.</strong> jquery-note</a></li><li class="chapter-item expanded "><a href="js-tutorial.html"><strong aria-hidden="true">41.</strong> js-tutorial</a></li><li class="chapter-item expanded "><a href="money.html"><strong aria-hidden="true">42.</strong> money</a></li><li class="chapter-item expanded "><a href="mongodb-note.html"><strong aria-hidden="true">43.</strong> mongodb-note</a></li><li class="chapter-item expanded "><a href="mvc-mvvm.html"><strong aria-hidden="true">44.</strong> mvc-mvvm</a></li><li class="chapter-item expanded "><a href="my-ioc.html"><strong aria-hidden="true">45.</strong> my-ioc</a></li><li class="chapter-item expanded "><a href="mybatis-note.html"><strong aria-hidden="true">46.</strong> mybatis-note</a></li><li class="chapter-item expanded "><a href="mysql-note.html"><strong aria-hidden="true">47.</strong> mysql-note</a></li><li class="chapter-item expanded "><a href="nodejs.html"><strong aria-hidden="true">48.</strong> nodejs</a></li><li class="chapter-item expanded "><a href="outline-about-cache.html"><strong aria-hidden="true">49.</strong> outline-about-cache</a></li><li class="chapter-item expanded "><a href="outline-about-db-design-note.html"><strong aria-hidden="true">50.</strong> outline-about-db-design-note</a></li><li class="chapter-item expanded "><a href="outline-about-http.html"><strong aria-hidden="true">51.</strong> outline-about-http</a></li><li class="chapter-item expanded "><a href="outline-about-rest-api.html"><strong aria-hidden="true">52.</strong> outline-about-rest-api</a></li><li class="chapter-item expanded "><a href="php-note.html"><strong aria-hidden="true">53.</strong> php-note</a></li><li class="chapter-item expanded "><a href="postgres-note.html"><strong aria-hidden="true">54.</strong> postgres-note</a></li><li class="chapter-item expanded "><a href="python-note.html"><strong aria-hidden="true">55.</strong> python-note</a></li><li class="chapter-item expanded "><a href="redis-login-limitation.html"><strong aria-hidden="true">56.</strong> redis-login-limitation</a></li><li class="chapter-item expanded "><a href="redis-note.html"><strong aria-hidden="true">57.</strong> redis-note</a></li><li class="chapter-item expanded "><a href="regex-js.html"><strong aria-hidden="true">58.</strong> regex-js</a></li><li class="chapter-item expanded "><a href="servlet.html"><strong aria-hidden="true">59.</strong> servlet</a></li><li class="chapter-item expanded "><a href="spring-note.html"><strong aria-hidden="true">60.</strong> spring-note</a></li><li class="chapter-item expanded "><a href="springboot-doc.html"><strong aria-hidden="true">61.</strong> springboot-doc</a></li><li class="chapter-item expanded "><a href="springmvc-note.html"><strong aria-hidden="true">62.</strong> springmvc-note</a></li><li class="chapter-item expanded "><a href="task-schedule-note.html"><strong aria-hidden="true">63.</strong> task-schedule-note</a></li><li class="chapter-item expanded "><a href="tcp-ip-note.html"><strong aria-hidden="true">64.</strong> tcp-ip-note</a></li><li class="chapter-item expanded "><a href="tomcat-jetty-nginx.html"><strong aria-hidden="true">65.</strong> tomcat-jetty-nginx</a></li><li class="chapter-item expanded "><a href="webpack-note.html"><strong aria-hidden="true">66.</strong> webpack-note</a></li><li class="chapter-item expanded "><a href="windows-sub-system-on-linux.html"><strong aria-hidden="true">67.</strong> windows-sub-system-on-linux</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Xiaoyu Wiki</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <hr />
<h2>title: Java Core
tags:
- java
date: 2014-04-02 21:08:53
categories: java core</h2>
<p>sentry grafana prometheus youtrack</p>
<p>https://github.com/akullpp/awesome-java</p>
<p>Java core note.
https://docs.oracle.com/javase/tutorial/
jdk 8u192 æ˜¯æœ€åçš„å…è´¹ç‰ˆæœ¬, ä¹‹åçš„éƒ½è¦æ”¶è´¹äº†</p>
<p>https://www.jianshu.com/p/a06aa86c6b27 (Jodconvert , æ˜¯ä¸€ä¸ª java çš„æ–‡æ¡£è½¬æ¢å™¨, åˆ©ç”¨ openoffice æˆ– libreOffice æ¥è¿›è¡Œæ–‡æ¡£æ ¼å¼è½¬æ¢.)</p>
<p>https://godbolt.org/ - åœ¨çº¿æœºå™¨ç è½¬æ¢</p>
<p>https://github.com/qiurunze123 - é«˜å¹¶å‘</p>
<p>https://github.com/Snailclimb/awesome-java#%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F awesome java</p>
<!--more-->
<!-- TOC -->
<ul>
<li><a href="#%E5%90%84%E4%B8%AA%E7%89%88%E6%9C%AC">å„ä¸ªç‰ˆæœ¬</a></li>
<li><a href="#%E6%B3%A8%E9%87%8A">æ³¨é‡Š</a></li>
<li><a href="#%E5%8F%8D%E5%B0%84reflect">åå°„(reflect)</a>
<ul>
<li><a href="#%E5%8F%8D%E5%B0%84%E7%9A%84-api">åå°„çš„ api</a></li>
<li><a href="#%E5%AE%9E%E7%8E%B0%E4%BA%8B%E4%BB%B6%E9%A9%B1%E5%8A%A8%E6%9C%BA%E5%88%B6">å®ç°äº‹ä»¶é©±åŠ¨æœºåˆ¶</a></li>
</ul>
</li>
<li><a href="#java-%E5%B9%B6%E5%8F%91-%E5%A4%9A%E7%BA%BF%E7%A8%8B">java å¹¶å‘-å¤šçº¿ç¨‹</a></li>
<li><a href="#%E9%9B%86%E5%90%88">é›†åˆ</a>
<ul>
<li><a href="#%E9%9B%86%E5%90%88%E7%9A%84%E4%BD%93%E7%B3%BB">é›†åˆçš„ä½“ç³»</a></li>
<li><a href="#%E8%AF%BB%E6%BA%90%E7%A0%81">è¯»æºç </a>
<ul>
<li><a href="#%E6%95%B0%E7%BB%84%E5%92%8C%E9%93%BE%E8%A1%A8%E5%8C%BA%E5%88%AB">æ•°ç»„å’Œé“¾è¡¨åŒºåˆ«</a></li>
<li><a href="#%E5%8D%95%E9%93%BE%E8%A1%A8%E5%92%8C%E5%8F%8C%E9%93%BE%E8%A1%A8%E5%8C%BA%E5%88%AB">å•é“¾è¡¨å’ŒåŒé“¾è¡¨åŒºåˆ«</a></li>
<li><a href="#hashmap">HashMap</a></li>
<li><a href="#hashset">HashSet</a></li>
<li><a href="#hashtable">HashTable</a></li>
<li><a href="#linkedhashmap">LinkedHashMap</a></li>
<li><a href="#lindedhashset">LindedHashSet</a></li>
<li><a href="#arraylist-%E5%92%8C-vector">ArrayList å’Œ Vector</a></li>
<li><a href="#linkedlist">LinkedList</a></li>
<li><a href="#concurrenthashmap">ConcurrentHashMap</a></li>
</ul>
</li>
<li><a href="#collections-%E5%92%8C-arrays-%E5%B7%A5%E5%85%B7%E7%B1%BB">Collections å’Œ Arrays å·¥å…·ç±»</a></li>
</ul>
</li>
<li><a href="#%E6%B3%9B%E5%9E%8B">æ³›å‹</a>
<ul>
<li><a href="#%E6%B3%9B%E5%9E%8B%E6%96%B9%E6%B3%95-%E6%B3%9B%E5%9E%8B%E7%B1%BB-%E6%B3%9B%E5%9E%8B%E6%8E%A5%E5%8F%A3">æ³›å‹æ–¹æ³•-æ³›å‹ç±»-æ³›å‹æ¥å£</a></li>
<li><a href="#%E6%B3%9B%E5%9E%8B%E5%8F%8D%E5%B0%84">æ³›å‹åå°„</a>
<ul>
<li><a href="#%E6%B3%9B%E5%9E%8B%E5%8F%8D%E5%B0%84-api">æ³›å‹åå°„ api</a></li>
<li><a href="#%E6%A1%88%E4%BE%8B-%E4%BC%98%E5%8C%96-basedao">æ¡ˆä¾‹-ä¼˜åŒ– BaseDao</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E6%B3%A8%E8%A7%A3">æ³¨è§£</a>
<ul>
<li><a href="#%E8%AF%AD%E6%B3%95">è¯­æ³•</a></li>
<li><a href="#%E5%85%83%E6%B3%A8%E8%A7%A3">å…ƒæ³¨è§£</a></li>
<li><a href="#%E6%B3%A8%E8%A7%A3%E5%8F%8D%E5%B0%84">æ³¨è§£åå°„</a></li>
<li><a href="#%E7%9C%8B%E4%B8%80%E4%B8%AA%E4%BE%8B%E5%AD%90%E4%BC%98%E5%8C%96-dao-%E8%A7%A3%E5%86%B3%E5%AD%97%E6%AE%B5%E5%92%8C%E5%B1%9E%E6%80%A7%E4%B8%8D%E4%B8%80%E8%87%B4">çœ‹ä¸€ä¸ªä¾‹å­(ä¼˜åŒ– dao-è§£å†³å­—æ®µå’Œå±æ€§ä¸ä¸€è‡´)</a>
<ul>
<li><a href="#%E9%80%9A%E8%BF%87%E6%B3%A8%E8%A7%A3%E4%BC%98%E5%8C%96-javabean">é€šè¿‡æ³¨è§£ä¼˜åŒ– JavaBean</a></li>
<li><a href="#%E6%B3%9B%E5%9E%8B%E5%8F%8D%E5%B0%84%E4%BC%98%E5%8C%96-basedao">æ³›å‹åå°„ä¼˜åŒ– BaseDao</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%93%E6%9E%9C%E9%9B%86-handler">è‡ªå®šä¹‰ç»“æœé›† handler</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#io">io</a>
<ul>
<li><a href="#io%E6%80%BB%E7%BB%93">ioæ€»ç»“</a></li>
<li><a href="#socket-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B">socket ç½‘ç»œç¼–ç¨‹</a></li>
<li><a href="#%E9%98%BB%E5%A1%9E-io">é˜»å¡ io</a>
<ul>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E9%98%BB%E5%A1%9E-io">ä»€ä¹ˆæ˜¯é˜»å¡ io</a></li>
<li><a href="#io-%E4%BD%93%E7%B3%BB%E7%9A%84%E6%95%B4%E4%B8%AA%E6%A6%82%E8%A7%88">io ä½“ç³»çš„æ•´ä¸ªæ¦‚è§ˆ</a></li>
<li><a href="#paths-%E5%92%8C-files-%E7%9B%B8%E5%85%B3-api">Paths å’Œ Files ç›¸å…³ api</a>
<ul>
<li><a href="#paths-%E7%9A%84%E8%8E%B7%E5%8F%96%E8%BD%AC%E5%8C%96">Paths çš„è·å–è½¬åŒ–</a></li>
<li><a href="#%E9%80%9A%E8%BF%87-files-paths-%E8%AF%BB%E5%8F%96%E5%86%99%E5%85%A5">é€šè¿‡ Files Paths è¯»å–å†™å…¥</a></li>
<li><a href="#%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E5%A4%B9">éå†æ–‡ä»¶å¤¹</a></li>
<li><a href="#%E9%80%9A%E8%BF%87-files-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7">é€šè¿‡ files è·å–æ–‡ä»¶å±æ€§</a></li>
</ul>
</li>
<li><a href="#bio-tcp-%E5%AE%9E%E7%8E%B0%E9%80%9A%E4%BF%A1">bio tcp å®ç°é€šä¿¡</a></li>
</ul>
</li>
<li><a href="#%E9%9D%9E%E9%98%BB%E5%A1%9E-io">éé˜»å¡ io</a>
<ul>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%9E%E9%98%BB%E5%A1%9E-io">ä»€ä¹ˆæ˜¯éé˜»å¡ io</a></li>
<li><a href="#%E5%90%8C%E6%AD%A5%E5%BC%82%E6%AD%A5%E5%92%8C%E9%98%BB%E5%A1%9E%E9%9D%9E%E9%98%BB%E5%A1%9E">åŒæ­¥å¼‚æ­¥å’Œé˜»å¡éé˜»å¡</a>
<ul>
<li><a href="#%E5%90%8C%E6%AD%A5%E4%B8%8E%E5%BC%82%E6%AD%A5">åŒæ­¥ä¸å¼‚æ­¥</a></li>
<li><a href="#%E9%98%BB%E5%A1%9E%E4%B8%8E%E9%9D%9E%E9%98%BB%E5%A1%9E">é˜»å¡ä¸éé˜»å¡</a></li>
<li><a href="#%E5%9B%9B%E7%A7%8D%E7%BB%84%E5%90%88">å››ç§ç»„åˆ</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8-io-%E5%8D%B3-java-nio">å¤šè·¯å¤ç”¨ IO å³ java nio</a>
<ul>
<li><a href="#%E8%A7%A3%E9%87%8A%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8">è§£é‡Šå¤šè·¯å¤ç”¨</a></li>
<li><a href="#nio-%E5%92%8C-io-%E5%8C%BA%E5%88%AB">nio å’Œ io åŒºåˆ«</a></li>
<li><a href="#linux-%E4%B8%AD%E7%9A%84%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E6%94%AF%E6%8C%81">Linux ä¸­çš„å¤šè·¯å¤ç”¨æ”¯æŒ</a></li>
<li><a href="#%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6">æ ¸å¿ƒç»„ä»¶</a>
<ul>
<li><a href="#%E7%90%86%E8%A7%A3">ç†è§£</a></li>
<li><a href="#channels">Channels</a></li>
<li><a href="#buffers">Buffers</a></li>
<li><a href="#selectors">Selectors</a></li>
</ul>
</li>
<li><a href="#nio-%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1">nio å®ç°ç½‘ç»œé€šä¿¡</a></li>
</ul>
</li>
<li><a href="#java-aio">java aio</a></li>
<li><a href="#%E6%96%AD%E7%82%B9%E7%BB%AD%E4%BC%A0">æ–­ç‚¹ç»­ä¼ </a></li>
</ul>
</li>
<li><a href="#%E4%BB%A3%E7%90%86">ä»£ç†</a></li>
<li><a href="#java-%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B">Java å†…å­˜æ¨¡å‹</a></li>
<li><a href="#java8">java8</a>
<ul>
<li><a href="#%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E7%9A%84%E6%A6%82%E5%BF%B5fp">å‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µ(FP)</a></li>
<li><a href="#java8-%E6%B7%BB%E5%8A%A0%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7">Java8 æ·»åŠ çš„æ–°ç‰¹æ€§</a>
<ul>
<li><a href="#%E6%8E%A5%E5%8F%A3%E9%BB%98%E8%AE%A4%E6%96%B9%E6%B3%95">æ¥å£é»˜è®¤æ–¹æ³•</a></li>
<li><a href="#functionalinterface-%E5%87%BD%E6%95%B0%E6%8E%A5%E5%8F%A3">@FunctionalInterface-å‡½æ•°æ¥å£</a></li>
<li><a href="#%E6%96%B9%E6%B3%95%E7%9A%84%E5%BC%95%E7%94%A8">æ–¹æ³•çš„å¼•ç”¨</a></li>
<li><a href="#lambda-%E8%A1%A8%E8%BE%BE%E5%BC%8F">Lambda è¡¨è¾¾å¼</a>
<ul>
<li><a href="#lambda-%E4%BB%8B%E7%BB%8D">lambda ä»‹ç»</a></li>
<li><a href="#lambda-%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%97%AE%E9%A2%98">Lambda ä½œç”¨åŸŸé—®é¢˜</a>
<ul>
<li><a href="#%E8%AE%BF%E9%97%AE%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F">è®¿é—®å±€éƒ¨å˜é‡</a></li>
<li><a href="#%E8%AE%BF%E9%97%AE%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F">è®¿é—®æˆå‘˜å˜é‡</a></li>
<li><a href="#%E8%AE%BF%E9%97%AE%E9%BB%98%E8%AE%A4%E6%8E%A5%E5%8F%A3%E6%96%B9%E6%B3%95">è®¿é—®é»˜è®¤æ¥å£æ–¹æ³•</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#java8-%E4%B8%AD%E7%9A%84%E5%B9%B6%E8%A1%8C%E6%B5%81">java8 ä¸­çš„å¹¶è¡Œæµ</a>
<ul>
<li><a href="#%E4%BD%BF%E7%94%A8%E5%B9%B6%E8%A1%8C%E8%BF%87%E6%BB%A4%E6%95%B0%E6%8D%AE">ä½¿ç”¨å¹¶è¡Œè¿‡æ»¤æ•°æ®</a></li>
<li><a href="#%E4%BB%8E%E9%9B%86%E5%90%88%E5%BE%97%E5%88%B0%E5%B9%B6%E8%A1%8C%E6%B5%81">ä»é›†åˆå¾—åˆ°å¹¶è¡Œæµ</a></li>
<li><a href="#%E5%B9%B6%E8%A1%8C%E6%8E%92%E5%BA%8F-%E7%BB%99%E6%95%B0%E7%BB%84%E8%B5%8B%E5%80%BC">å¹¶è¡Œæ’åº-ç»™æ•°ç»„èµ‹å€¼</a></li>
</ul>
</li>
<li><a href="#completablefuture-%E6%8E%A5%E5%8F%A3-%E5%A2%9E%E5%BC%BA%E7%9A%84-future">CompletableFuture æ¥å£-å¢å¼ºçš„ Future</a>
<ul>
<li><a href="#%E5%85%88%E7%9C%8B%E7%9C%8B-future-%E7%BC%BA%E7%82%B9">å…ˆçœ‹çœ‹ Future ç¼ºç‚¹</a></li>
<li><a href="#%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D">åŸç†ä»‹ç»</a></li>
<li><a href="#%E5%AE%8C%E6%88%90%E4%BA%86%E5%B0%B1%E9%80%9A%E7%9F%A5%E6%88%91-%E6%89%8B%E5%8A%A8%E5%A1%AB%E5%85%85-completablefuture">å®Œæˆäº†å°±é€šçŸ¥æˆ‘-æ‰‹åŠ¨å¡«å…… CompletableFuture</a></li>
<li><a href="#%E5%BC%82%E6%AD%A5%E6%89%A7%E8%A1%8C%E4%BB%BB%E5%8A%A1">å¼‚æ­¥æ‰§è¡Œä»»åŠ¡</a></li>
<li><a href="#%E6%B5%81%E5%BC%8F%E8%B0%83%E7%94%A8%E7%BB%84%E5%90%88%E5%A4%9A%E4%B8%AA-function-%E5%92%8C-%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86">æµå¼è°ƒç”¨ç»„åˆå¤šä¸ª function å’Œ å¼‚å¸¸å¤„ç†</a></li>
<li><a href="#%E7%BB%84%E5%90%88%E5%A4%9A%E4%B8%AA-completablefuture">ç»„åˆå¤šä¸ª CompletableFuture</a></li>
</ul>
</li>
<li><a href="#stampedlock-%E8%AF%BB%E5%86%99%E9%94%81%E7%9A%84%E6%94%B9%E8%BF%9B">StampedLock-è¯»å†™é”çš„æ”¹è¿›</a></li>
<li><a href="#longadder-%E5%8E%9F%E5%AD%90%E7%B1%BB%E7%9A%84%E5%A2%9E%E5%BC%BA">LongAdder-åŸå­ç±»çš„å¢å¼º</a></li>
<li><a href="#java8-%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3">java8 å†…ç½®å‡½æ•°å¼æ¥å£</a>
<ul>
<li><a href="#predicates%E8%B0%93%E8%AF%8D-%E6%96%AD%E5%AE%9A">Predicates(è°“è¯, æ–­å®š)</a></li>
<li><a href="#functions%E5%87%BD%E6%95%B0">Functions(å‡½æ•°)</a></li>
<li><a href="#suppliers%E7%94%9F%E4%BA%A7%E8%80%85">Suppliers(ç”Ÿäº§è€…)</a></li>
<li><a href="#consumers%E6%B6%88%E8%B4%B9%E8%80%85">Consumers(æ¶ˆè´¹è€…)</a></li>
<li><a href="#comparators%E6%AF%94%E8%BE%83%E5%99%A8">Comparators(æ¯”è¾ƒå™¨)</a></li>
<li><a href="#optionals">Optionals</a></li>
</ul>
</li>
<li><a href="#streams%E7%AE%A1%E9%81%93">Streams(ç®¡é“)</a>
<ul>
<li><a href="#stream-%E4%BB%8B%E7%BB%8D">stream ä»‹ç»</a></li>
<li><a href="#%E9%87%8D%E5%A4%8D%E4%BD%BF%E7%94%A8-stream">é‡å¤ä½¿ç”¨ stream</a></li>
<li><a href="#map-%E5%92%8C-flatmap">map å’Œ flatMap</a></li>
<li><a href="#%E5%8E%BB%E9%87%8D">å»é‡</a></li>
<li><a href="#collect%E6%96%B9%E6%B3%95-%E5%A6%82%E4%BD%95%E6%94%B6%E9%9B%86%E5%A4%84%E7%90%86%E5%90%8E%E7%9A%84%E5%85%83%E7%B4%A0-%E5%88%86%E7%BB%84-%E5%8E%BB%E9%87%8D">collectæ–¹æ³• å¦‚ä½•æ”¶é›†å¤„ç†åçš„å…ƒç´  åˆ†ç»„ å»é‡</a></li>
<li><a href="#stream-%E4%B8%AD%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86">stream ä¸­å¼‚å¸¸å¤„ç†</a></li>
</ul>
</li>
<li><a href="#date-%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E6%96%B0%E7%9A%84-api">date æ—¶é—´æ—¥æœŸæ–°çš„ api</a>
<ul>
<li><a href="#%E4%BB%8B%E7%BB%8D-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8">ä»‹ç»-ä¸ºä»€ä¹ˆä½¿ç”¨</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8%E6%96%B0%E7%9A%84%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F-api">ä½¿ç”¨æ–°çš„æ—¶é—´æ—¥æœŸ api</a></li>
</ul>
</li>
<li><a href="#%E5%8F%AF%E9%87%8D%E5%A4%8D%E7%9A%84-annotations">å¯é‡å¤çš„ Annotations</a></li>
<li><a href="#base64-%E7%BC%96%E7%A0%81">base64 ç¼–ç </a></li>
<li><a href="#map-%E6%98%A0%E5%B0%84%E7%9A%84%E6%96%B0%E6%96%B9%E6%B3%95">map æ˜ å°„çš„æ–°æ–¹æ³•</a></li>
</ul>
</li>
<li><a href="#java11">java11</a>
<ul>
<li><a href="#java-module">java module</a></li>
<li><a href="#jshell">jshell</a></li>
<li><a href="#var">var</a></li>
<li><a href="#jdk-api-enhencement">jdk api enhencement</a></li>
<li><a href="#%E6%94%B9%E8%BF%9B-java-%E7%A8%8B%E5%BA%8F%E5%9C%A8-docker-%E4%B8%AD%E7%9A%84%E8%A1%A8%E7%8E%B0">æ”¹è¿› java ç¨‹åºåœ¨ docker ä¸­çš„è¡¨ç°</a></li>
</ul>
</li>
<li><a href="#classloader-%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8">classloader ç±»åŠ è½½å™¨</a>
<ul>
<li><a href="#classloader-%E7%9A%84%E6%A6%82%E5%BF%B5">classloader çš„æ¦‚å¿µ</a></li>
<li><a href="#%E5%B1%82%E7%BA%A7%E7%BB%93%E6%9E%84">å±‚çº§ç»“æ„</a></li>
<li><a href="#%E5%B7%A5%E4%BD%9C%E8%BF%87%E7%A8%8B-and-%E5%8F%8C%E4%BA%B2%E5%A7%94%E6%B4%BE%E6%A8%A1%E5%BC%8F">å·¥ä½œè¿‡ç¨‹ and åŒäº²å§”æ´¾æ¨¡å¼</a></li>
<li><a href="#%E7%BA%BF%E7%A8%8B%E4%B8%8A%E4%B8%8B%E6%96%87%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8-%E6%89%93%E4%B9%B1%E5%B1%82%E7%BA%A7%E7%BB%93%E6%9E%84">çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨-æ‰“ä¹±å±‚çº§ç»“æ„</a></li>
<li><a href="#%E5%80%9F%E5%8A%A9-classloader-%E5%AE%9E%E7%8E%B0%E7%B1%BB%E9%9A%94%E7%A6%BB">å€ŸåŠ© classloader å®ç°ç±»éš”ç¦»</a></li>
<li><a href="#%E7%B1%BB%E5%8A%A0%E8%BD%BD%E7%9B%B8%E5%85%B3%E7%9A%84%E5%BC%82%E5%B8%B8">ç±»åŠ è½½ç›¸å…³çš„å¼‚å¸¸</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89-classloader%E5%8A%A0%E8%BD%BD%E7%BD%91%E7%BB%9C%E4%B8%8A%E7%9A%84-class">è‡ªå®šä¹‰ classloader(åŠ è½½ç½‘ç»œä¸Šçš„ class)</a></li>
</ul>
</li>
<li><a href="#%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98">è·¯å¾„é—®é¢˜</a>
<ul>
<li><a href="#%E8%8E%B7%E5%8F%96-classpath-%E5%92%8C-%E7%B3%BB%E7%BB%9F%E5%B1%9E%E6%80%A7-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">è·å– classpath å’Œ ç³»ç»Ÿå±æ€§ ç¯å¢ƒå˜é‡</a></li>
</ul>
</li>
<li><a href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">æ•°æ®ç±»å‹</a>
<ul>
<li><a href="#%E5%90%84%E4%B8%AA%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%8C%83%E5%9B%B4">å„ä¸ªæ•°æ®ç±»å‹çš„èŒƒå›´</a></li>
<li><a href="#double-%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%8A%A0%E5%87%8F%E4%B9%98%E9%99%A4">double ç±»å‹çš„åŠ å‡ä¹˜é™¤</a></li>
</ul>
</li>
<li><a href="#%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%91%BD%E4%BB%A4">æ§åˆ¶å°å‘½ä»¤</a>
<ul>
<li><a href="#%E6%89%93-jar-%E5%8C%85">æ‰“ jar åŒ…</a></li>
<li><a href="#%E7%94%9F%E6%88%90%E6%B3%A8%E9%87%8A%E6%96%87%E6%A1%A3-javadoc">ç”Ÿæˆæ³¨é‡Šæ–‡æ¡£ javadoc</a></li>
<li><a href="#%E7%BC%96%E8%AF%91%E5%92%8C%E5%8F%8D%E7%BC%96%E8%AF%91">ç¼–è¯‘å’Œåç¼–è¯‘</a></li>
</ul>
</li>
<li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%AF%B9%E8%B1%A1">é‡è¦çš„å¯¹è±¡</a>
<ul>
<li><a href="#object">Object</a></li>
<li><a href="#string">String</a></li>
</ul>
</li>
<li><a href="#%E5%AD%97%E8%8A%82%E7%A0%81%E7%BC%96%E8%BE%91%E6%8A%80%E6%9C%AF">å­—èŠ‚ç ç¼–è¾‘æŠ€æœ¯</a>
<ul>
<li><a href="#javassist">javassist</a></li>
</ul>
</li>
<li><a href="#%E5%89%8D%E6%B2%BF">å‰æ²¿</a>
<ul>
<li><a href="#graalvm">graalvm</a></li>
<li><a href="#vertx">vertx</a></li>
<li><a href="#micronaut">Micronaut</a></li>
<li><a href="#quarkus">Quarkus</a></li>
</ul>
</li>
<li><a href="#%E6%8B%BE%E9%81%97">æ‹¾é—</a>
<ul>
<li><a href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F-regex">æ­£åˆ™è¡¨è¾¾å¼ regex</a></li>
<li><a href="#%E9%9D%99%E6%80%81%E7%BB%91%E5%AE%9A%E5%92%8C%E5%8A%A8%E6%80%81%E7%BB%91%E5%AE%9A">é™æ€ç»‘å®šå’ŒåŠ¨æ€ç»‘å®š</a></li>
<li><a href="#%E9%87%8D%E8%BD%BD-and-%E9%87%8D%E5%86%99">é‡è½½ and é‡å†™</a></li>
<li><a href="#java-%E5%80%BC%E4%BC%A0%E9%80%92-or-%E5%BC%95%E7%94%A8%E4%BC%A0%E9%80%92">java å€¼ä¼ é€’ or å¼•ç”¨ä¼ é€’</a></li>
<li><a href="#%E8%AE%BF%E9%97%AE%E4%BF%AE%E9%A5%B0%E7%AC%A6-public-protect-default-private">è®¿é—®ä¿®é¥°ç¬¦ public-protect-default-private</a></li>
<li><a href="#getcontextclassloadergetclassloader-%E5%8C%BA%E5%88%AB">getcontextclassloader&amp;getclassloader åŒºåˆ«</a></li>
<li><a href="#getter-%E5%92%8C-setter-%E5%AD%98%E5%9C%A8%E7%9A%84%E6%84%8F%E4%B9%89">getter å’Œ setter å­˜åœ¨çš„æ„ä¹‰</a></li>
<li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88-service-%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AA%E5%AE%9E%E7%8E%B0%E4%B9%9F%E9%9C%80%E8%A6%81%E4%B8%80%E4%B8%AA%E6%8E%A5%E5%8F%A3">ä¸ºä»€ä¹ˆ service åªæœ‰ä¸€ä¸ªå®ç°ä¹Ÿéœ€è¦ä¸€ä¸ªæ¥å£</a></li>
<li><a href="#static-%E5%85%B3%E9%94%AE%E5%AD%97">static å…³é”®å­—</a></li>
<li><a href="#%E5%86%85%E9%83%A8%E7%B1%BB-or-%E9%9D%99%E6%80%81%E5%86%85%E9%83%A8%E7%B1%BB">å†…éƒ¨ç±» or é™æ€å†…éƒ¨ç±»</a>
<ul>
<li><a href="#%E5%86%85%E9%83%A8%E7%B1%BB">å†…éƒ¨ç±»</a></li>
<li><a href="#%E9%9D%99%E6%80%81%E5%86%85%E9%83%A8%E7%B1%BB">é™æ€å†…éƒ¨ç±»</a></li>
</ul>
</li>
<li><a href="#java-%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%BA%E5%BA%8F">Java ç±»åˆå§‹åŒ–é¡ºåº</a></li>
<li><a href="#random-%E9%9A%8F%E6%9C%BA%E6%95%B0">Random-éšæœºæ•°</a></li>
<li><a href="#%E4%BD%8D%E8%BF%90%E7%AE%97">ä½è¿ç®—</a></li>
<li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%8C%85%E5%90%8D%E9%83%BD%E5%B0%8F%E5%86%99">ä¸ºä»€ä¹ˆåŒ…åéƒ½å°å†™</a></li>
<li><a href="#%E5%A4%84%E7%90%86-unicode-%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98">å¤„ç† unicode ç¼–ç é—®é¢˜</a></li>
<li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%E5%86%8D%E6%AC%A1%E8%B5%8B%E5%80%BC%E7%BB%99%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F">ä¸ºä»€ä¹ˆæˆå‘˜å˜é‡å†æ¬¡èµ‹å€¼ç»™å±€éƒ¨å˜é‡</a></li>
<li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%AE%9A%E4%B9%89%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%E4%B8%8D%E7%94%A8%E8%B5%8B%E5%80%BC%E8%80%8C%E5%AE%9A%E4%B9%89%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E5%BF%85%E9%A1%BB%E8%B5%8B%E5%80%BC">ä¸ºä»€ä¹ˆå®šä¹‰æˆå‘˜å˜é‡ä¸ç”¨èµ‹å€¼è€Œå®šä¹‰å±€éƒ¨å˜é‡å¿…é¡»èµ‹å€¼</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h1><a class="header" href="#å„ä¸ªç‰ˆæœ¬" id="å„ä¸ªç‰ˆæœ¬">å„ä¸ªç‰ˆæœ¬</a></h1>
<ul>
<li>
<p>jdk5: è‡ªåŠ¨è£…ç®±/æ‹†ç®±, æšä¸¾, é™æ€å¯¼å…¥(ä¸å®ç”¨), å¯å˜é•¿å‚æ•°(&quot;String... params&quot;), æ³›å‹, for-each å¾ªç¯, å¹¶å‘åº“(Concurrent)</p>
</li>
<li>
<p>jdk6: compiler api(åŠ¨æ€ç¼–è¯‘è¿è¡Œæ–‡æœ¬å½¢å¼çš„ Java ä»£ç ), console å¢å¼º(ç¼–å†™å‘½ä»¤è¡Œç¨‹åº, ä¸å®ç”¨), Desktop ç±»(æ‰“å¼€æµè§ˆå™¨, æ–‡ä»¶ç­‰ç­‰æ–¹æ³•)å’Œ SystemTray ç±», Http server api, script engine</p>
</li>
<li>
<p>jdk7: switch å¯¹ String æ”¯æŒ(æšä¸¾ä¹Ÿæ”¯æŒ), åˆ›å»ºæ³›å‹æ—¶çš„ç±»å‹æ¨æ–­(ä»å®šä¹‰çš„å˜é‡æ¨æ–­æ„é€ å‡½æ•°ä¸­çš„æ³›å‹), æ•è·å¤šç§å¼‚å¸¸(... catch (IOException | SQLException e) ...), æ•°å€¼ç±»å‹æ”¯æŒ&quot;_&quot;(å¦‚å®šä¹‰ 10s, ä½†æ˜¯å•ä½æ˜¯æ¯«ç§’: int mills = 10_000), try_auto_close_resource</p>
</li>
<li>
<p>jdk8: lambda express/å‡½æ•°å¼æ¥å£(@FunctionalInterface), æ¥å£é»˜è®¤æ–¹æ³•, æ¥å£é™æ€æ–¹æ³•, base64 å¢å¼º, Datetime å¢å¼º, Optional(é˜² null), Stream,</p>
</li>
</ul>
<h1><a class="header" href="#æ³¨é‡Š" id="æ³¨é‡Š">æ³¨é‡Š</a></h1>
<pre><code class="language-java">main() {
    // ä¸‹é¢è¿™è¡Œä¼šè¢«æ‰§è¡Œ
    // \u000d sysout(&quot;hehe&quot;)
}


</code></pre>
<h1><a class="header" href="#åå°„reflect" id="åå°„reflect">åå°„(reflect)</a></h1>
<h2><a class="header" href="#åå°„çš„-api" id="åå°„çš„-api">åå°„çš„ api</a></h2>
<pre><code class="language-java">Class clazz1 = Class.forName(&quot;cn.itcast.reflect.Person&quot;);
Class clazz2 = Person.class;
Class clazz3 = new Person(110,&quot;ç‹—å¨ƒ&quot;).getClass();

Constructor[] constructors = clazz.getConstructors();// è·å–å…¬å¼€çš„
Constructor[] constructors =  clazz.getDeclaredConstructors(); // è·å–æ‰€æœ‰
Constructor constructor = clazz.getConstructor(int.class,String.class);// æŒ‡å®š
constructor.setAccessible(true);
Person p = (Person) constructor.newInstance(999,&quot;xiaoyu&quot;);

Method[] methods = clazz.getMethods();//å…¬å¼€çš„æ–¹æ³•ï¼Œä½†æ˜¯ä¸åŒ…å«çˆ¶ç±»çš„æ–¹æ³•, æ²¡æ–¹æ³•, åˆ™è¿”å›ä¸€ä¸ªé•¿åº¦ä¸º 0 çš„æ•°ç»„
Method m =clazz.getDeclaredMethod(&quot;sleep&quot;,int.class);// æ‰€æœ‰
Method m = clazz.getMethod(&quot;eat&quot;, int.class);//è·å–æŒ‡å®š
m.setAccessible(true);
m.invoke(null, 6);
Method m = clazz.getMethod(&quot;sum&quot;, int[].class);
m.invoke(p,new int[]{12,5,9});

Field[] fields = clazz.getDeclaredFields();// æ‰€æœ‰
Field field = clazz.getDeclaredField(&quot;id&quot;);// æŒ‡å®š
field.setAccessible(true);
field.set(p, 110);

getDeclaredAnnotation //getDeclaredAnnotationï¼ˆsï¼‰ï¼šè¿”å›ç›´æ¥å­˜åœ¨äºæ­¤å…ƒç´ ä¸Šçš„æ‰€æœ‰æ³¨é‡Š, å¿½ç•¥ç»§æ‰¿çš„æ³¨é‡Š
getAnnotationï¼ˆsï¼‰ï¼šè¿”å›æ­¤å…ƒç´ ä¸Šå­˜åœ¨çš„æ‰€æœ‰æ³¨é‡Š

</code></pre>
<h2><a class="header" href="#å®ç°äº‹ä»¶é©±åŠ¨æœºåˆ¶" id="å®ç°äº‹ä»¶é©±åŠ¨æœºåˆ¶">å®ç°äº‹ä»¶é©±åŠ¨æœºåˆ¶</a></h2>
<pre><code class="language-java">
/*äº‹ä»¶å¤„ç†ç±»*/
public class EventHandler {
    //äº‹ä»¶æº
    private Object sender;
    //äº‹ä»¶å¤„ç†å‡½æ•°åç§°ï¼ˆç”¨äºåå°„ï¼‰
    private String callback;
    
    public EventHandler(Object sender, String callback){
        this.sender = sender;
        this.callback = callback;
    }
    
    //äº‹ä»¶è§¦å‘
    public void emit(){
    Class senderType = this.sender.getClass();
    try {
        //è·å–å¹¶è°ƒç”¨äº‹ä»¶æºsenderçš„äº‹ä»¶å¤„ç†å‡½æ•°
        Method method = senderType.getMethod(this.callback);
        method.invoke(this.sender);
        } catch (Exception e2) {
            e2.printStackTrace();
        }
    }
}


/*äº‹ä»¶æº*/
public class Button(){
    /*å¯ä»¥åœ¨æ­¤è®¾ç½®Buttonç±»çš„ç›¸å…³å±æ€§ï¼Œæ¯”å¦‚åå­—ç­‰*/
    private String name;
    ...
    
    
    //äº‹ä»¶å¤„ç†å‡½æ•°
    public void onClick(){
        System.out.println(&quot;you just clicked me!&quot;);
    }
}
    
    
/*å®ç°äº‹ä»¶é©±åŠ¨æœºåˆ¶*/
Button b = new Button();
if(/*æ”¶åˆ°æŒ‰é’®ç‚¹å‡»ä¿¡å·*/){
    EventHandler e = new EventHandler(b, &quot;onClick&quot;);
    e.emit();
}
</code></pre>
<p>è¿˜æœ‰ä¸€ç§æ–¹å¼: è§‚å¯Ÿè€…æ¨¡å¼</p>
<pre><code class="language-java">/*äº‹ä»¶ç±»*/
public Event {
    //ä¸äº‹ä»¶ç›¸å…³çš„äº‹ä»¶å¤„ç†å‡½æ•°
    public ArrayList&lt;Callback&gt; callbackList;
    
    //äº‹ä»¶è§¦å‘å‡½æ•°
    public void emit(){
        for(Callback cb : callbackList){
            cb.run();
        }
    }
    
    //æ³¨å†Œäº‹ä»¶å¤„ç†å‡½æ•°
    public registerCallback(Callback cb){
        callbackList.add(cb);
    }
}

/*äº‹ä»¶å¤„ç†å‡½æ•°ç±»*/
public interface Callback {
    void run();
}

public OnClick implements Callback {
    //å‡½æ•°
    public void run(){
        System.out.println(&quot;you just clicked me!&quot;);
    }
    
    
/*å®ç°äº‹ä»¶é©±åŠ¨*/
Event e = new Event();  
//å°†OnClickäº‹ä»¶å¤„ç†å‡½æ•°æ³¨å†Œåˆ°äº‹ä»¶ä¸­
e.registerCallback(new OnClick()); 
//è§¦å‘äº‹ä»¶
e.emit();
</code></pre>
<h1><a class="header" href="#java-å¹¶å‘-å¤šçº¿ç¨‹" id="java-å¹¶å‘-å¤šçº¿ç¨‹">java å¹¶å‘-å¤šçº¿ç¨‹</a></h1>
<p>{% post_link java-concurrent ğŸ“š java-concurrent-reading-note %}</p>
<p>(è§ java-concurrent)</p>
<h1><a class="header" href="#é›†åˆ" id="é›†åˆ">é›†åˆ</a></h1>
<h2><a class="header" href="#é›†åˆçš„ä½“ç³»" id="é›†åˆçš„ä½“ç³»">é›†åˆçš„ä½“ç³»</a></h2>
<p>(æ³¨: é›†åˆå’Œæ•°ç»„ä¸­å­˜æ”¾çš„éƒ½æ˜¯å¯¹è±¡çš„å¼•ç”¨è€Œéå¯¹è±¡æœ¬èº«;; ä»é›†åˆä¸­å–å‡ºå…ƒç´ æ˜¯ä½œä¸º Object å–å‡º, é™¤éæ³›å‹æŒ‡å®šäº†ç±»å‹)</p>
<p><img src="Snipaste_2018-11-23_15-52-56.png" alt="alt" /></p>
<ul>
<li>
<p>Collection å•åˆ—é›†åˆçš„æ ¹æ¥å£</p>
<ul>
<li>
<p>List å¦‚æœæ˜¯å®ç°äº† List æ¥å£çš„é›†åˆç±»ï¼Œ å…·å¤‡çš„ç‰¹ç‚¹ï¼šæœ‰åºï¼Œé‡å¤ã€‚</p>
<ul>
<li>
<p>ArraryList åº•å±‚ æ˜¯ä½¿ç”¨äº† Object æ•°ç»„å®ç°çš„ï¼Œç‰¹ç‚¹ï¼š æŸ¥è¯¢é€Ÿåº¦å¿«ï¼Œå¢åˆ æ…¢ã€‚(å› ä¸ºå¢åˆ æ—¶å€™ä¼šæ¶‰åŠåˆ°æ•°ç»„æ‰©å®¹, æ‹·è´å…ƒç´ æ‰€ä»¥å¢åˆ æ…¢; æ•°ç»„å¯ä»¥æŒ‰ç…§ index æŸ¥æ‰¾å…ƒç´ , æ‰€ä»¥æŸ¥æ‰¾å¿«)</p>
</li>
<li>
<p>LinkedList åº•å±‚æ˜¯ä½¿ç”¨äº†åŒå‘é“¾è¡¨æ•°æ®ç»“æ„å®ç°çš„ï¼Œ ç‰¹ç‚¹ï¼š æŸ¥è¯¢é€Ÿåº¦æ…¢ï¼Œå¢åˆ å¿«ã€‚(å¢åˆ åªéœ€è¦æ”¹å˜æŸä¸€ä¸ªå…ƒç´ çš„ next å¼•ç”¨ä½¿å…¶æŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ , æ‰€ä»¥å¢åˆ å¿«; æŸ¥è¯¢æ—¶å€™éœ€è¦ä¸€ä¸ªä¸ªéå†, æ‰€ä»¥æŸ¥è¯¢æ…¢)</p>
</li>
<li>
<p>Vector å®ç°ä¸ ArrayList æ˜¯ä¸€è‡´ï¼Œä½†æ˜¯æ˜¯çº¿ç¨‹å®‰å…¨ çš„ï¼Œæ“ä½œæ•ˆç‡ä½ã€‚</p>
</li>
</ul>
</li>
<li>
<p>Set å¦‚æœæ˜¯å®ç°äº† Set æ¥å£çš„é›†åˆç±»ï¼Œå…·å¤‡çš„ç‰¹ç‚¹ï¼šæ— åºï¼Œä¸å¯é‡å¤ã€‚</p>
<ul>
<li>
<p>HashSet åº•å±‚æ˜¯åŸºäº HashMap å®ç° (å“ˆå¸Œè¡¨)ï¼Œ ç‰¹ç‚¹ï¼šå­˜å–é€Ÿåº¦å¿«ã€‚ã€*ã€‘æ·»åŠ å…ƒç´ åŸç†: è°ƒç”¨å…ƒç´ çš„ hashcode() å¾—åˆ°å“ˆå¸Œç , è¿›è€Œè¿ç®—å¾—åˆ°å“ˆå¸Œè¡¨ä¸­çš„ä½ç½®. [ä¸¤ç§æƒ…å†µ] å¦‚æœè¯¥ä½ç½®è¿˜æ²¡æœ‰å­˜ä»»ä½•å…ƒç´ , é‚£ä¹ˆç›´æ¥å­˜å‚¨; å¦‚æœè¯¥ä½ç½®æœ‰å…ƒç´ äº†åˆ™è°ƒç”¨å…ƒç´ çš„ equals() å’Œç›®æ ‡å…ƒç´ æ¯”å¯¹, [åˆåˆ†ä¸ºä¸¤ç§æƒ…å†µ]: å¦‚æœç›¸åŒ, ä¸å…è®¸å­˜å‚¨; å¦‚æœä¸åŒ, å°±å¯ä»¥å­˜å‚¨</p>
<ul>
<li>LinkedHashSet å†…éƒ¨ä½¿ç”¨ LindedHashMap, æœ‰åº, ä¸å’Œé‡å¤</li>
</ul>
</li>
<li>
<p>TreeSet åº•å±‚æ˜¯ä½¿ç”¨äº†çº¢é»‘æ ‘ï¼ˆäºŒå‰æ ‘ï¼‰æ•°æ®ç»“æ„å®ç°çš„ã€‚ ç‰¹ç‚¹ï¼š å¯¹é›†åˆä¸­çš„å…ƒç´ è¿›è¡Œæ’åºå­˜å‚¨. å…ƒç´ å¿…é¡»æ˜¯å¯æ¯”è¾ƒçš„, å¦‚æœä¸å¯æ¯”è¾ƒ, éœ€è¦å®ç° Comparable æ¥å£(å¦ä¸€ç§æ–¹æ³•æ˜¯åœ¨åˆ›å»º Treeset å¯¹è±¡çš„æ—¶å€™ä¼ å…¥æ¯”è¾ƒå™¨(è‡ªå®šä¹‰ä¸€ä¸ªç±»å®ç° COmparator æ¥å£), æ¨è, å› ä¸ºè¿™ç§æ–¹å¼å¯ä»¥å¤ç”¨)</p>
</li>
</ul>
</li>
<li>
<p>Queue FIFO-å…ˆè¿›å…ˆå‡º</p>
<p>å¸¸ç”¨æ–¹æ³•:</p>
<p>ğŸ“Œ add å¢åŠ ä¸€ä¸ªå…ƒç´¢ å¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™æŠ›å‡ºä¸€ä¸ª IIIegaISlabEepeplian å¼‚å¸¸
ğŸ“Œ remove ç§»é™¤å¹¶è¿”å›é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´  å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™æŠ›å‡ºä¸€ä¸ª NoSuchElementException å¼‚å¸¸
ğŸ“Œ element è¿”å›é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´  å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™æŠ›å‡ºä¸€ä¸ª NoSuchElementException å¼‚</p>
<p>ğŸ“Œ offer å°†å…ƒç´ è¿½åŠ åˆ°é˜Ÿåˆ—æœ«å°¾å¹¶è¿”å› true å¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™è¿”å› false
ğŸ“Œ poll åˆ é™¤å¹¶è¿”é—®é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´  å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å› null
ğŸ“Œ peek è¿”å›é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´ ä¸åˆ é™¤ å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å› nul</p>
<p>ğŸ“Œ put æ·»åŠ ä¸€ä¸ªå…ƒç´  å¦‚æœé˜Ÿåˆ—æ»¡ï¼Œåˆ™é˜»å¡
ğŸ“Œ take ç§»é™¤å¹¶è¿”å›é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´  å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™é˜»å¡</p>
<pre><code>  - Deque åŒå‘é˜Ÿåˆ—, å­æ¥å£, å¤´å°¾éƒ½å¯ä»¥poll, offer; å¦‚æœå°†Dequeé™åˆ¶ä¸ºåªèƒ½ä»ä¸€ç«¯å…¥é˜Ÿå’Œå‡ºé˜Ÿï¼Œåˆ™å¯å®ç°æ ˆçš„æ•°æ®ç»“æ„

  - BlockingQueue é˜»å¡é˜Ÿåˆ—; è¿›å‡ºä¸¤ç«¯çš„threadä¼šé€šè¿‡é˜»å¡æ¥å®ç°å¹³è¡¡, å‡å°‘ä¸¤è¾¹çš„å¤„ç†é€Ÿåº¦å·®è·
</code></pre>
</li>
</ul>
</li>
<li>
<p>Map key å”¯ä¸€ä¸å¯é‡å¤, value å¯é‡å¤</p>
<ul>
<li>
<p>HashMap ğŸ“Œ åº•å±‚æ˜¯ä¸€ä¸ª Entry æ•°ç»„, æ¯ä¸ª entry æ˜¯ä¸€ä¸ªé“¾è¡¨, å­˜å‚¨æ—¶, ä¼šæ ¹æ® hashCode() æ¥å†³å®šåœ¨æ•°ç»„ä¸­çš„ index, æ ¹æ® equals() å†³å®š åœ¨è¯¥ä½ç½®ä¸Šé“¾è¡¨ä¸­çš„ä½ç½®; ğŸ“Œ çº¿ç¨‹ä¸åŒæ­¥, è§£å†³æ–¹æ¡ˆæœ‰ Hashtable æˆ–è€… Collections.synchronizedMap(hashMap)ï¼Œè¿™ä¸¤ç§æ–¹å¼åŸºæœ¬éƒ½æ˜¯å¯¹æ•´ä¸ª hash è¡¨ç»“æ„åšé”å®šæ“ä½œçš„ï¼Œè¿™æ ·åœ¨é”è¡¨çš„æœŸé—´ï¼Œåˆ«çš„çº¿ç¨‹å°±éœ€è¦ç­‰å¾…äº†ï¼Œæ— ç–‘æ€§èƒ½ä¸é«˜ã€‚; ğŸ“Œ Key å’Œ value å¯ä»¥ä¸º null;</p>
<ul>
<li>LinkedHashMap åŸºäºå“ˆå¸Œè¡¨ä½†æ˜¯å†…éƒ¨ä¹Ÿç»´æŒäº†ä¸€ä¸ªåŒå‘é“¾è¡¨,å¯ä»¥ä¿æŒé¡ºåº(ä¿ç•™äº†æ’å…¥é¡ºåº, æ‰€ä»¥è¾“å‡ºé¡ºåºå’Œè¾“å…¥é¡ºåºç›¸åŒ)</li>
</ul>
</li>
<li>
<p>TreeMap åº•å±‚ä½¿ç”¨äºŒå‰æ ‘å®ç° å¯ä»¥æ ¹æ®é”®æ’åº(é»˜è®¤å‡åº) ã€*ã€‘</p>
</li>
<li>
<p>HashTable å­˜å‚¨çš„å†…å®¹æ˜¯é”®å€¼å¯¹(key-value)æ˜ å°„ã€‚å®ƒæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å®ƒçš„ keyã€value éƒ½ä¸å¯ä»¥ä¸º null</p>
<ul>
<li>Properties é”®å€¼å¯¹ String--String å¦‚æœä½¿ç”¨äº†ä¸­æ–‡, åªèƒ½ä½¿ç”¨å­—ç¬¦æµ, ä¸èƒ½ä½¿ç”¨å­—èŠ‚æµ(å› ä¸ºå­—èŠ‚æµä½¿ç”¨ iso8859-1 ç¼–ç )</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2><a class="header" href="#è¯»æºç " id="è¯»æºç ">è¯»æºç </a></h2>
<p>references: http://wiki.jikexueyuan.com/project/java-collection/hashmap.html</p>
<h3><a class="header" href="#æ•°ç»„å’Œé“¾è¡¨åŒºåˆ«" id="æ•°ç»„å’Œé“¾è¡¨åŒºåˆ«">æ•°ç»„å’Œé“¾è¡¨åŒºåˆ«</a></h3>
<p>æ•°ç»„é™æ€åˆ†é…å†…å­˜(å³, æ•°ç»„ä¸€æ—¦å®šä¹‰å°±å†…å­˜ä¸å¯å˜åŠ¨, è¦ä¿®æ”¹å°±å¿…é¡»æ¶‰åŠåˆ°æ•°ç»„çš„å¤åˆ¶)ï¼Œé“¾è¡¨åŠ¨æ€åˆ†é…å†…å­˜ï¼›</p>
<p>æ•°ç»„åœ¨å†…å­˜ä¸­è¿ç»­ï¼Œé“¾è¡¨ä¸è¿ç»­ï¼›</p>
<p>æ•°ç»„åˆ©ç”¨ä¸‹æ ‡å®šä½ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼Œé“¾è¡¨é€šè¿‡éå†å®šä½, å®šä½å…ƒç´ æ—¶é—´å¤æ‚åº¦ O(n)ï¼›</p>
<p>æ•°ç»„æ’å…¥æˆ–åˆ é™¤å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ O(n)ï¼Œé“¾è¡¨çš„æ—¶é—´å¤æ‚åº¦ O(1)ã€‚</p>
<h3><a class="header" href="#å•é“¾è¡¨å’ŒåŒé“¾è¡¨åŒºåˆ«" id="å•é“¾è¡¨å’ŒåŒé“¾è¡¨åŒºåˆ«">å•é“¾è¡¨å’ŒåŒé“¾è¡¨åŒºåˆ«</a></h3>
<ul>
<li>
<p>ä¸ºä»€ä¹ˆç›®å‰å¸‚åœºåº”ç”¨ä¸Šå•é“¾è¡¨çš„åº”ç”¨è¦æ¯”åŒé“¾è¡¨çš„åº”ç”¨è¦å¹¿æ³›çš„å¤šå‘¢ï¼Ÿ åŒé“¾è¡¨èŠ‚ç‚¹éœ€è¦å¤šç»´æŠ¤ä¸€ä¸ªæŒ‡é’ˆ</p>
</li>
<li>
<p>å­˜å‚¨æ•ˆç‡: å•é“¾è¡¨æ˜¯ &quot;æ—¶é—´æ¢ç©ºé—´&quot;, åŒé“¾è¡¨&quot;ç©ºé—´æ¢æ—¶é—´&quot;, æ¯”å¦‚: è€ƒè™‘é“¾è¡¨çš„ delete æ“ä½œ:</p>
<ul>
<li>
<p>å¯¹äºå•é“¾è¡¨, å…ˆå®šä½å¾…åˆ é™¤ node, å¾—åˆ°å¾…åˆ é™¤ node çš„ pre_node, ä¿®æ”¹ pre_node çš„ next æŒ‡é’ˆ;</p>
</li>
<li>
<p>è€Œå¾—åˆ° pre_node y æœ‰ä¸¤ç§æ–¹æ³•: ğŸ“Œ å®šä½ node_to_delete æ—¶å€™ä¸€è·¯ä¿å­˜å®ƒçš„å‰ä¸€ä¸ª node; ğŸ“Œ å®šä½åˆ° node_to_delete åé‡æ–°éå†é“¾è¡¨æ‰¾åˆ° è¿™ä¸ª pre_node; å®é™…ä¸Š è¿™ä¸¤ç§æ–¹æ³•çš„æ•ˆç‡æ˜¯ä¸€æ ·çš„ï¼ŒæŒ‡é’ˆçš„æ€»çš„ç§»åŠ¨æ“ä½œéƒ½ä¼šæœ‰ 2*i æ¬¡ã€‚è€Œå¦‚æœç”¨åŒå‘é“¾è¡¨ï¼Œåˆ™ä¸éœ€è¦å®šä½ pre_nodeã€‚å› æ­¤æŒ‡é’ˆæ€»çš„ç§»åŠ¨æ“ä½œä¸º i æ¬¡</p>
</li>
</ul>
</li>
<li>
<p>å†è€ƒè™‘ find æ“ä½œ: å¯ä»¥å€Ÿç”¨äºŒåˆ†æ³•çš„æ€è·¯ï¼Œä» headï¼ˆé¦–èŠ‚ç‚¹ï¼‰å‘åæŸ¥æ‰¾æ“ä½œå’Œ lastï¼ˆå°¾èŠ‚ç‚¹ï¼‰å‘å‰æŸ¥æ‰¾æ“ä½œåŒæ­¥è¿›è¡Œï¼Œè¿™æ ·åŒé“¾è¡¨çš„æ•ˆç‡å¯ä»¥æé«˜ä¸€å€</p>
</li>
</ul>
<h3><a class="header" href="#hashmap" id="hashmap">HashMap</a></h3>
<p>çº¿ç¨‹ä¸å®‰å…¨ä½“ç°åœ¨å“ªé‡Œ? https://www.zhihu.com/question/28516433</p>
<p>TODO</p>
<p>jdk1.7 ç¤ºæ„å›¾: (<a href="https://www.draw.io/?lightbox=1&amp;highlight=0000ff&amp;edit=_blank&amp;layers=1&amp;nav=1&amp;title=Untitled%20Diagram.xml#R3Vrfb9s2EP5rCGwPDURRkqlHyVbWhxUo0AHbngbFYm2tsmjIdOL0r98df1hSJMdOaztZgCAmT8fj3XffHUUnhE1Xu9%2BafL38JAtREd8rdoTNiO%2FTwI%2FgAyWPRsKpZwSLpiysUiv4Un4XVujUtmUhNj1FJWWlynVfOJd1LeaqJ8ubRj701b7Kqr%2FrOl%2BIgeDLPK%2BG0j%2FLQi1tFP6klX8U5WLpdqZRbJ6scqdsI9ks80I%2BdEQsI2zaSKnMaLWbigrBc7iYdbcHnu4da0StTlngMnGfV1sbnHVMPbpoH5alEl%2FW%2BRznD5BRwtKlWlUwozCEENb4ZLVbYLZv7vJNOb%2BZV3Jb%2FAOQwaeye4hGid1BR%2Bk%2BfOCNkCuhmkdQsQtCLzRLLGUYswg%2BtAmIrWjZwT6ystymfLG33KICAwvMAZDCq4DE0pW8z%2B%2B0RVzTiE35vTuXKledOVSV6M5FUXanlvwdyRnSALDf9BNBPTZIBPXjYSYmwRkycTwRjdzWhUB9D0I%2BkpYzIEIdER0x%2BZCY1L8QM2kwiF8U0KrsVDZqKReyzquslaZ9hDpoiF2p%2FkIxpNjM%2FrZK%2FwqlHm0fzrdKgqi1%2FbuU6x6e6MLzaILHctvMrZYlkMqbhXBabBz0RlS5Ku%2F75n8GQfb2GAW97vUYFbw9PNjkNSvMOw7IT5TcZQuLDwsrvlJd8ZfwiF6nU%2Ft9HvmTIY%2F4CI3Cc9DohJPrzdIoHunPB6A%2BO4%2Fi%2FwGPvCvyiL59PGhwRTxOuL%2B82bqiYy8%2B4ZUKi77ozec6TPInP9ahWXgGPE645L06Hid2mrPgMey8WY02wpSEswE0EKTqx9%2B9vmJZrWVZK%2B2QscBSrKiNKS5ckFflooZxJb6iKUSuhLtxYsUKqy3dAN5lvfhDl96H4Dw4h4z1cGZBNMA5HMHZP0MHm5zQwOoiwW%2BtYDav8s2mnD%2B5t2FezMUtYtwJ8O5GbzzfzT%2BLpgTvRGPzcXrP6vYnPg7kEaCc7OQuZnf4jJzpnDSHbgLOhOmudpXf%2BdrrmCH2xJAJeWBIJ3Mf9mlfWQxP7Bpr5V0VEA1oH89w2KiCCxWQK5h3DbDPj3eoiwE8fFO4286%2FiXcG8b6ZuNdYf8jhSx0Co6dAVCECRXkPw4XSQRoRhF872cd8s%2FwErx7gRRaSNCFxqAeUcJ9kMeET%2FMkmJA5IwkkWkJQTiNQMkgQW9o51eBKhjdTDRWlKeKAlM5KEetEtjmGHZEZijo94rO2BzhTHuFWCq3zvm3j8YCIy3iW3JAUF%2BA2aU%2B0mGGHoJq4FHfAIDNKO%2FRDjeNbxnm2OkSdUuwPuR%2B1uFjvIRBe%2BjngE6CPYa1%2BmGC46nul9JziArTG4jPBwGIrYe91D6olkCXl12TDYw%2FKIpEwbzPSmIdrHGEPEL%2BFjqTNozVrT%2BAio4GsPp6jvTx2GkSYNGMnQIAZ169I%2BI1wbgQHsbsymSb0FGqMfnMQm9SlaR1Zk1umneexk%2F8l%2Bl8oQ1653Pd5HDFABX7BMqFYK0W%2BA%2BbnQ90DGyF1IMioD6fgvpiv%2B2poHS7g0QmNQf8hOMM%2BeIQe%2BkWl%2BjJADsuxrJnvDvUcSfcjSgWxfBH1DCK7LYobdoYXGMMYUfGQ148gpDDOil6SjoevWk6QuofoR9ineSb9zoN0aiklXCUoSknidLQYGXwbOezoVqdc%2FFYNo5FRkI8fiD3z5DtP2L9%2FmVbv9%2FwGW%2FQc%3D">online</a>)</p>
<p><img src="Snipaste_2018-11-16_22-01-06.png" alt="alt" /></p>
<p>å½“ Hash ç¢°æ’ä¸¥é‡æ—¶ï¼Œåœ¨ bucket ä¸Šå½¢æˆçš„é“¾è¡¨ä¼šå˜çš„è¶Šæ¥è¶Šé•¿ï¼Œè¿™æ ·åœ¨æŸ¥è¯¢æ—¶çš„æ•ˆç‡å°±ä¼šè¶Šæ¥è¶Šä½ï¼›æ—¶é—´å¤æ‚åº¦ä¸º O(N), 1.8 å°† bucket ç”±åŸæ¥çš„å•çº¯ LinkedList åŠ å…¥äº† çº¢é»‘æ ‘ çš„å®ç°</p>
<p>jdk1.8 ç¤ºæ„å›¾:</p>
<p>åˆå§‹å®¹é‡</p>
<p>åŠ è½½å› å­(Float loadFactor): ç»™å®šçš„é»˜è®¤å®¹é‡ä¸º 16ï¼Œè´Ÿè½½å› å­ä¸º 0.75ã€‚Map åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¸æ–­çš„å¾€é‡Œé¢å­˜æ”¾æ•°æ®ï¼Œå½“æ•°é‡è¾¾åˆ°äº† 16 * 0.75 = 12 å°±éœ€è¦å°†å½“å‰ 16 çš„å®¹é‡è¿›è¡Œæ‰©å®¹ï¼Œè€Œæ‰©å®¹è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ° rehashã€å¤åˆ¶æ•°æ®ç­‰æ“ä½œï¼Œæ‰€ä»¥éå¸¸æ¶ˆè€—æ€§èƒ½</p>
<p>Fail-Fast æœºåˆ¶</p>
<pre><code class="language-java">/**
- HashMapå®é™…ä¸Šæ˜¯ä¸€ä¸ªâ€œé“¾è¡¨æ•£åˆ—â€çš„æ•°æ®ç»“æ„ï¼Œå³æ•°ç»„å’Œé“¾è¡¨çš„ç»“åˆä½“; HashMap åº•å±‚å°±æ˜¯ä¸€ä¸ªæ•°ç»„ç»“æ„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸€é¡¹åˆæ˜¯ä¸€ä¸ªé“¾è¡¨

- HashMap åº•å±‚é‡‡ç”¨ä¸€ä¸ª Entry[] æ•°ç»„æ¥ä¿å­˜æ‰€æœ‰çš„ key-value å¯¹ï¼Œå½“éœ€è¦å­˜å‚¨ä¸€ä¸ª Entry å¯¹è±¡æ—¶ï¼Œä¼šè®¡ç®—å¾…å­˜å‚¨entry çš„ key çš„ hash æ¥å†³å®šå…¶åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•, å¦‚æœè¯¥ä½ç½®ä¸ºnullåˆ™ç›´æ¥å­˜å‚¨ï¼Œå¦‚æœä¸ä¸ºnull, å°±éå†è¯¥ä½ç½®çš„é“¾è¡¨(bucket), å†æ¯”è¾ƒå¾…å­˜å‚¨ entryçš„ key å’Œ é“¾è¡¨ä¸­çš„ entryçš„ key, å¦‚æœç›¸ç­‰, åˆ™è¦†ç›–, éå†åˆ°é“¾è¡¨æœ«å°¾è¿˜ä¸ç­‰åˆ™æ·»åŠ åˆ°æœ«å°¾

- æ‰©å®¹: å½“ HashMap ä¸­çš„å…ƒç´ ä¸ªæ•°è¶…è¿‡æ•°ç»„å¤§å° *loadFactor(é»˜è®¤0.75)æ—¶ï¼Œå°±ä¼šè¿›è¡Œæ•°ç»„æ‰©å®¹; int threshold = (int)(capacity * loadFactor);

    - é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°ç»„å¤§å°ä¸º 16ï¼Œé‚£ä¹ˆå½“ HashMap ä¸­å…ƒç´ ä¸ªæ•°è¶…è¿‡ 16*0.75=12 çš„æ—¶å€™ï¼Œå°±æŠŠæ•°ç»„çš„å¤§å°æ‰©å±•ä¸º 2*16=32ï¼Œå³æ‰©å¤§ä¸€å€; æ‰€ä»¥åˆ›å»º HashMap æœ€å¥½æŒ‡å®šå®¹é‡

    - è´Ÿè½½å› å­ loadFactor è¡¡é‡çš„æ˜¯ä¸€ä¸ªæ•£åˆ—è¡¨çš„ç©ºé—´çš„ä½¿ç”¨ç¨‹åº¦ï¼Œè´Ÿè½½å› å­è¶Šå¤§è¡¨ç¤ºæ•£åˆ—è¡¨(å³æ•°ç»„)çš„è£…å¡«ç¨‹åº¦è¶Šé«˜

- fail-fast æœºåˆ¶æ˜¯ java é›†åˆ(Collection)ä¸­çš„ä¸€ç§é”™è¯¯æœºåˆ¶ã€‚ å½“å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªé›†åˆçš„å†…å®¹è¿›è¡Œæ“ä½œæ—¶ï¼Œå°±å¯èƒ½ä¼šäº§ç”Ÿ fail-fast äº‹ä»¶

    - ä¾‹å¦‚ï¼šå½“æŸä¸€ä¸ªçº¿ç¨‹ A é€šè¿‡ iteratorå»éå†æŸé›†åˆçš„è¿‡ç¨‹ä¸­ï¼Œè‹¥è¯¥é›†åˆçš„å†…å®¹è¢«å…¶ä»–çº¿ç¨‹æ‰€æ”¹å˜äº†ï¼›é‚£ä¹ˆçº¿ç¨‹ A è®¿é—®é›†åˆæ—¶ï¼Œå°±ä¼šæŠ›å‡º ConcurrentModificationException å¼‚å¸¸ï¼Œäº§ç”Ÿ fail-fast äº‹ä»¶

    - åŸç†: è¿™ä¸€ç­–ç•¥åœ¨æºç ä¸­çš„å®ç°æ˜¯é€šè¿‡ modCount åŸŸ(`transient int modCount;`) åœ¨è¿­ä»£å™¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ä¼šå°†è¿™ä¸ªå€¼èµ‹ç»™è¿­ä»£å™¨çš„ expectedModCount; åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œåˆ¤æ–­ modCount è·Ÿ expectedModCount æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœä¸ç›¸ç­‰å°±è¡¨ç¤ºå·²ç»æœ‰å…¶ä»–çº¿ç¨‹ä¿®æ”¹äº† Map
*/

// æ„é€ å‡½æ•°

public HashMap(int initialCapacity, float loadFactor) {
    if (initialCapacity &lt; 0)
        throw new IllegalArgumentException(&quot;Illegal initial capacity: &quot; +
                                            initialCapacity);
    if (initialCapacity &gt; MAXIMUM_CAPACITY)
        initialCapacity = MAXIMUM_CAPACITY;
    if (loadFactor &lt;= 0 || Float.isNaN(loadFactor))
        throw new IllegalArgumentException(&quot;Illegal load factor: &quot; +
                                            loadFactor);

    // Find a power of 2 &gt;= initialCapacity
    int capacity = 1;
    while (capacity &lt; initialCapacity)
        capacity &lt;&lt;= 1;

    this.loadFactor = loadFactor;
    threshold = (int)Math.min(capacity * loadFactor, MAXIMUM_CAPACITY + 1);
    table = new Entry[capacity]; // åˆ›å»ºä¸€ä¸ª Entry æ•°ç»„; æ¯ä¸ª Entry å…¶å®å°±æ˜¯ä¸€ä¸ª key-value å¯¹ï¼Œå®ƒæŒæœ‰ä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œè¿™å°±æ„æˆäº†é“¾è¡¨
    useAltHashing = sun.misc.VM.isBooted() &amp;&amp;
            (capacity &gt;= Holder.ALTERNATIVE_HASHING_THRESHOLD);
    init();
}

// å­˜å‚¨

public V put(K key, V value) {
    //å…¶å…è®¸å­˜æ”¾ null çš„ key å’Œ null çš„ valueï¼Œå½“å…¶ key ä¸º null æ—¶ï¼Œè°ƒç”¨putForNullKeyæ–¹æ³•ï¼Œæ”¾å…¥åˆ°table[0]çš„è¿™ä¸ªä½ç½®
    if (key == null)
        return putForNullKey(value);
    //å¾—åˆ°keyçš„ hashcode ï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†å°½å¯èƒ½çš„è®©é”®å€¼å¯¹å¯ä»¥åˆ†å¸ƒåˆ°ä¸åŒçš„æ¡¶ä¸­
    int hash = hash(key);
    //æ ¹æ®ä¸Šä¸€æ­¥éª¤ä¸­æ±‚å‡ºçš„hashå¾—åˆ°åœ¨æ•°ç»„ä¸­æ˜¯ç´¢å¼•i
    int i = indexFor(hash, table.length);
    //å¦‚æœiå¤„çš„Entryä¸ä¸ºnullï¼Œåˆ™é€šè¿‡å…¶nextæŒ‡é’ˆä¸æ–­éå†eå…ƒç´ çš„ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚, å¦‚æœæ‰¾åˆ°ä¸€ä¸ª entry, ä»–çš„ hash åŒ¹é…, key ä¹Ÿç›¸åŒ(equals), æ›¿æ¢ oldValue
    for (Entry&lt;K,V&gt; e = table[i]; e != null; e = e.next) {
        Object k;
        if (e.hash == hash &amp;&amp; ((k = e.key) == key || key.equals(k))) { // å¦‚æœ key å­˜åœ¨äº†
            V oldValue = e.value;
            e.value = value; // æ–°çš„valueæ›¿ä»£ oldValue
            e.recordAccess(this);
            return oldValue;
        }
    }

    // å¦‚æœ i å¤„çš„ entry==null, æˆ–è€… bucketéå†å®Œäº†ä¹Ÿæ²¡æœ‰æ‰¾åˆ°ç›¸åŒ key çš„ entry, ç›´æ¥æ·»åŠ 
    modCount++; // è¿™ä¸ªå˜é‡è®°å½• map ä¿®æ”¹æ¬¡æ•°, å®ç° fail-fast æœºåˆ¶
    addEntry(hash, key, value, i);
    return null;
}

void addEntry(int hash, K key, V value, int bucketIndex) {
    // è¿™é‡Œå®Œå…¨æ²¡æœ‰è€ƒè™‘ Entry ä¸­çš„ valueï¼Œä»…ä»…åªæ˜¯æ ¹æ® key æ¥è®¡ç®—å¹¶å†³å®šæ¯ä¸ª Entry çš„å­˜å‚¨ä½ç½®
    // å½“ç³»ç»Ÿå†³å®šäº† key çš„å­˜å‚¨ä½ç½®ä¹‹åï¼Œvalue éšä¹‹ä¿å­˜åœ¨é‚£é‡Œå³å¯ã€‚
    if ((size &gt;= threshold) &amp;&amp; (null != table[bucketIndex])) {
        resize(2 * table.length);  // æ‰©å®¹
        hash = (null != key) ? hash(key) : 0;
        bucketIndex = indexFor(hash, table.length);
    }

    createEntry(hash, key, value, bucketIndex);
}
void createEntry(int hash, K key, V value, int bucketIndex) {
        // è·å–æŒ‡å®š bucketIndex ç´¢å¼•å¤„çš„ Entry
        Entry&lt;K,V&gt; e = table[bucketIndex];
        // å°†æ–°åˆ›å»ºçš„ Entry æ”¾å…¥ bucketIndex ç´¢å¼•å¤„ï¼Œå¹¶è®©æ–°çš„ Entry æŒ‡å‘åŸæ¥çš„ Entry
        table[bucketIndex] = new Entry&lt;&gt;(hash, key, value, e);
        size++;
}

// è·å–

public V get(Object key) {
    if (key == null)
        return getForNullKey();
    Entry&lt;K,V&gt; entry = getEntry(key);

    return null == entry ? null : entry.getValue();
}
final Entry&lt;K,V&gt; getEntry(Object key) {
    int hash = (key == null) ? 0 : hash(key); // calculate hashCode according to key.
    for (Entry&lt;K,V&gt; e = table[indexFor(hash, table.length)]; // find element, traverse the bucket.
            e != null;
            e = e.next) {
        Object k;
        if (e.hash == hash &amp;&amp;
            ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))
            return e;
    }
    return null;
}

</code></pre>
<h3><a class="header" href="#hashset" id="hashset">HashSet</a></h3>
<p>å‡ ä¹å…¨éƒ¨å€ŸåŠ©äº HashMap æ¥å®ç°</p>
<p>æ‰€ä»¥ä¹Ÿè¦é‡å†™ hashCode(), equals() ä»¥ç¡®ä¿å…ƒç´ å”¯ä¸€æ€§</p>
<pre><code class="language-java">
/**
- HashSetå†…éƒ¨çš„æ•°æ®ç»“æ„å°±æ˜¯ä¸€ä¸ª HashMapï¼Œå…¶æ–¹æ³•çš„å†…éƒ¨å‡ ä¹å°±æ˜¯åœ¨è°ƒç”¨ HashMap çš„æ–¹æ³•
*/
///////////////////// field

private transient HashMap&lt;E,Object&gt; map;
// æ‰€æœ‰å†™å…¥ map çš„ value å€¼, key åˆ™æ˜¯ Hashset ä¸­å­˜å‚¨çš„å€¼
private static final Object PRESENT = new Object();

////////////////////////////////////////// æ„é€ å‡½æ•°
 /**
 * é»˜è®¤çš„æ— å‚æ„é€ å™¨ï¼Œæ„é€ ä¸€ä¸ªç©ºçš„HashSetã€‚
 * å®é™…åº•å±‚ä¼šåˆå§‹åŒ–ä¸€ä¸ªç©ºçš„HashMapï¼Œå¹¶ä½¿ç”¨é»˜è®¤åˆå§‹å®¹é‡ä¸º16å’ŒåŠ è½½å› å­0.75ã€‚
 */
public HashSet() {
    map = new HashMap&lt;E,Object&gt;();
}
public HashSet(int initialCapacity, float loadFactor) {
    map = new HashMap&lt;&gt;(initialCapacity, loadFactor);
}
/**
 * æ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®š collection ä¸­çš„å…ƒç´ çš„æ–°setã€‚
 * å®é™…åº•å±‚ä½¿ç”¨é»˜è®¤çš„åŠ è½½å› å­0.75å’Œè¶³ä»¥åŒ…å«æŒ‡å®š collection ä¸­æ‰€æœ‰å…ƒç´ çš„åˆå§‹å®¹é‡æ¥åˆ›å»ºä¸€ä¸ªH ashMapã€‚
 * @param c å…¶ä¸­çš„å…ƒç´ å°†å­˜æ”¾åœ¨æ­¤ set ä¸­çš„collectionã€‚
 */
public HashSet(Collection&lt;? extends E&gt; c) {
    map = new HashMap&lt;E,Object&gt;(Math.max((int) (c.size()/.75f) + 1, 16));
    addAll(c);
}
/**
 * ä»¥æŒ‡å®šçš„initialCapacity å’Œ loadFactor æ„é€ ä¸€ä¸ªç©ºçš„ HashSetã€‚
 *
 * å®é™…åº•å±‚ä»¥ç›¸åº”çš„å‚æ•°æ„é€ ä¸€ä¸ªç©ºçš„HashMapã€‚
 * @param initialCapacity åˆå§‹å®¹é‡ã€‚
 * @param loadFactor åŠ è½½å› å­ã€‚
 */
public HashSet(int initialCapacity, float loadFactor) {
    map = new HashMap&lt;E,Object&gt;(initialCapacity, loadFactor);
}
/**
 * ä»¥æŒ‡å®šçš„ initialCapacity æ„é€ ä¸€ä¸ªç©ºçš„ HashSetã€‚
 *
 * å®é™…åº•å±‚ä»¥ç›¸åº”çš„å‚æ•°åŠåŠ è½½å› å­loadFactorä¸º0.75æ„é€ ä¸€ä¸ªç©ºçš„HashMapã€‚
 * @param initialCapacity åˆå§‹å®¹é‡ã€‚
 */
public HashSet(int initialCapacity) {
    map = new HashMap&lt;E,Object&gt;(initialCapacity);
}
/**
 * ä»¥æŒ‡å®šçš„initialCapacityå’ŒloadFactoræ„é€ ä¸€ä¸ªæ–°çš„ç©ºé“¾æ¥å“ˆå¸Œé›†åˆã€‚æ­¤æ„é€ å‡½æ•°ä¸ºåŒ…è®¿é—®æƒé™ï¼Œä¸å¯¹å¤–å…¬å¼€ï¼Œ
 * å®é™…åªæ˜¯æ˜¯å¯¹LinkedHashSetçš„æ”¯æŒã€‚
 *
 * å®é™…åº•å±‚ä¼šä»¥æŒ‡å®šçš„å‚æ•°æ„é€ ä¸€ä¸ªç©ºLinkedHashMapå®ä¾‹æ¥å®ç°ã€‚
 * @param initialCapacity åˆå§‹å®¹é‡ã€‚
 * @param loadFactor åŠ è½½å› å­ã€‚
 * @param dummy æ ‡è®°ã€‚
 */
HashSet(int initialCapacity, float loadFactor, boolean dummy) {
    map = new LinkedHashMap&lt;E,Object&gt;(initialCapacity, loadFactor);
}

////////////////////////////////// æ·»åŠ æ–¹æ³•

/**
ç”±äº HashMap çš„ put() æ–¹æ³•æ·»åŠ  key-value å¯¹æ—¶ï¼Œå½“æ–°æ”¾å…¥ HashMap çš„ key ä¸åŸæœ‰ key ç›¸åŒï¼ˆhashCode()è¿”å›å€¼ç›¸ç­‰ï¼Œé€šè¿‡ equals æ¯”è¾ƒä¹Ÿè¿”å› trueï¼‰ï¼Œæ–°æ·»åŠ çš„ Entry çš„ value å°†è¦†ç›–åŸæ¥ Entry çš„ valueï¼ˆä¹Ÿå°±æ˜¯ HashSet ä¸­çš„ value , éƒ½æ˜¯PRESENTï¼‰ï¼Œä½† key ä¸ä¼šæœ‰ä»»ä½•æ”¹å˜ï¼Œ

å› æ­¤å¦‚æœå‘ HashSet ä¸­æ·»åŠ ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å…ƒç´ æ—¶ï¼Œæ–°æ·»åŠ çš„é›†åˆå…ƒç´ å°†ä¸ä¼šè¢«æ”¾å…¥ HashMapä¸­ï¼ŒåŸæ¥çš„å…ƒç´ ä¹Ÿä¸ä¼šæœ‰ä»»ä½•æ”¹å˜ï¼Œè¿™ä¹Ÿå°±æ»¡è¶³äº† Set ä¸­å…ƒç´ ä¸é‡å¤çš„ç‰¹æ€§ã€‚

 * @param e å°†æ·»åŠ åˆ°æ­¤setä¸­çš„å…ƒç´ ã€‚
 * @return å¦‚æœæ­¤setå°šæœªåŒ…å«æŒ‡å®šå…ƒç´ ï¼Œåˆ™è¿”å›trueã€‚
 */
public boolean add(E e) {
    //å°†å­˜æ”¾çš„å¯¹è±¡å½“åšäº† HashMap çš„å¥ï¼Œvalue éƒ½æ˜¯ç›¸åŒçš„ PRESENT ã€‚
    //ç”±äº HashMap çš„ key æ˜¯ä¸èƒ½é‡å¤çš„ï¼Œæ‰€ä»¥æ¯å½“æœ‰é‡å¤çš„å€¼å†™å…¥åˆ° HashSet æ—¶, ä¹Ÿå°±æ˜¯ hashmap ä¸­çš„ key é‡å¤äº†ï¼Œé‚£ä¹ˆ value ä¼šè¢«è¦†ç›–ï¼Œä½† key ä¸ä¼šå—åˆ°å½±å“ï¼Œè¿™æ ·å°±ä¿è¯äº† HashSet ä¸­åªèƒ½å­˜æ”¾ä¸é‡å¤çš„å…ƒç´ 
    return map.put(e, PRESENT)==null;
}

</code></pre>
<h3><a class="header" href="#hashtable" id="hashtable">HashTable</a></h3>
<p>åŒæ­¥çš„ hashmap, key, value ä¸å…è®¸ä¸º null</p>
<pre><code class="language-java">/**
- å’Œ HashMap ä¸€æ ·ï¼ŒHashtable ä¹Ÿæ˜¯ä¸€ä¸ªæ•£åˆ—è¡¨ï¼Œå®ƒå­˜å‚¨çš„å†…å®¹æ˜¯é”®å€¼å¯¹

- Hashtable ä¸ HashMap çš„ç®€å•æ¯”è¾ƒ

    - HashTable åŸºäº Dictionary ç±»ï¼Œè€Œ HashMap æ˜¯åŸºäº AbstractMap

        -(Dictionary æ˜¯ä»»ä½•å¯å°†é”®æ˜ å°„åˆ°ç›¸åº”å€¼çš„ç±»çš„æŠ½è±¡çˆ¶ç±», è¿‡æ—¶äº†)

    - HashMap çš„ key å’Œ value éƒ½å…è®¸ä¸º nullï¼Œè€Œ Hashtable çš„ key å’Œ value éƒ½ä¸å…è®¸ä¸º null

    - Hashtable æ–¹æ³•æ˜¯åŒæ­¥ï¼Œè€ŒHashMapåˆ™ä¸æ˜¯
*/

// æˆå‘˜å˜é‡ å’Œ HashMap ç±»ä¼¼ table, count, threshold, loadFactor, modCountã€‚

// æ„é€ æ–¹æ³•å¤§åŒå°å¼‚, é»˜è®¤æ„é€ å‡½æ•°ï¼Œå®¹é‡ä¸º 11ï¼ŒåŠ è½½å› å­ä¸º 0.75

// æ·»åŠ  çº¿ç¨‹å®‰å…¨

/**
æ•´ä¸ªè¿‡ç¨‹:

- åˆ¤æ–­ value æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºåˆ™æŠ›å‡ºå¼‚å¸¸ï¼›

- è®¡ç®— key çš„ hash å€¼ï¼Œå¹¶æ ¹æ® hash å€¼è·å¾— key åœ¨ table æ•°ç»„ä¸­çš„ä½ç½® indexï¼Œå¦‚æœ table[index] å…ƒç´ ä¸ä¸ºç©ºï¼Œåˆ™è¿›è¡Œè¿­ä»£ï¼Œå¦‚æœé‡åˆ°ç›¸åŒçš„ keyï¼Œåˆ™ç›´æ¥æ›¿æ¢ï¼Œå¹¶è¿”å›æ—§ valueï¼›

- table[index] ä¸ºç©ºï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶æ’å…¥åˆ° table[index] ä½ç½®ã€‚
*/
public synchronized V put(K key, V value) {
    // Make sure the value is not nullç¡®ä¿valueä¸ä¸ºnull
    if (value == null) {
        throw new NullPointerException();
    }

    // Makes sure the key is not already in the hashtable.
    //ç¡®ä¿keyä¸åœ¨hashtableä¸­
    //é¦–å…ˆï¼Œé€šè¿‡hashæ–¹æ³•è®¡ç®—keyçš„å“ˆå¸Œå€¼ï¼Œå¹¶è®¡ç®—å¾—å‡ºindexå€¼ï¼Œç¡®å®šå…¶åœ¨table[]ä¸­çš„ä½ç½®
    //å…¶æ¬¡ï¼Œè¿­ä»£indexç´¢å¼•ä½ç½®çš„é“¾è¡¨ï¼Œå¦‚æœè¯¥ä½ç½®å¤„çš„é“¾è¡¨å­˜åœ¨ç›¸åŒçš„keyï¼Œåˆ™æ›¿æ¢valueï¼Œè¿”å›æ—§çš„value
    Entry tab[] = table;
    int hash = hash(key);
    int index = (hash &amp; 0x7FFFFFFF) % tab.length;
    for (Entry&lt;K,V&gt; e = tab[index] ; e != null ; e = e.next) {
        if ((e.hash == hash) &amp;&amp; e.key.equals(key)) {
            V old = e.value;
            e.value = value;
            return old;
        }
    }

    modCount++;
    if (count &gt;= threshold) {
        // Rehash the table if the threshold is exceeded
        //å¦‚æœè¶…è¿‡é˜€å€¼ï¼Œå°±è¿›è¡Œrehashæ“ä½œ
        rehash();

        tab = table;
        hash = hash(key);
        index = (hash &amp; 0x7FFFFFFF) % tab.length;
    }

    // Creates the new entry.
    //å°†å€¼æ’å…¥ï¼Œè¿”å›çš„ä¸ºnull
    Entry&lt;K,V&gt; e = tab[index];
    // åˆ›å»ºæ–°çš„EntryèŠ‚ç‚¹ï¼Œå¹¶å°†æ–°çš„Entryæ’å…¥Hashtableçš„indexä½ç½®ï¼Œå¹¶è®¾ç½®eä¸ºæ–°çš„Entryçš„ä¸‹ä¸€ä¸ªå…ƒç´ 
    tab[index] = new Entry&lt;&gt;(hash, key, value, e);
    count++;
    return null;
}

// get æ–¹æ³•

public synchronized V get(Object key) {
    Entry tab[] = table;
    int hash = hash(key); // calculate hashCode
    int index = (hash &amp; 0x7FFFFFFF) % tab.length; //calculate index
    for (Entry&lt;K,V&gt; e = tab[index] ; e != null ; e = e.next) { //éå†é“¾è¡¨
        if ((e.hash == hash) &amp;&amp; e.key.equals(key)) {
            return e.value;
        }
    }
    return null;
}

</code></pre>
<h3><a class="header" href="#linkedhashmap" id="linkedhashmap">LinkedHashMap</a></h3>
<p>å¯ä»¥æ’åºçš„ hashmap</p>
<p>ç”±ä¸€ä¸ªåŒå‘é“¾è¡¨æ‰€æ„æˆ, ä¿è¯äº†æœ‰åº (åœ¨ hashmap å†…éƒ¨çš„ entry åŸºç¡€ä¸Šæ·»åŠ äº† &quot;Entry&lt;K,V&gt; before, after;&quot; æ„æˆäº†åŒå‘é“¾è¡¨, )</p>
<p>æ’åºæ¨¡å¼: é€šè¿‡ <code>accessOrder</code> æ§åˆ¶</p>
<ul>
<li>
<p>æ ¹æ®å†™å…¥é¡ºåºæ’åº(é»˜è®¤)</p>
</li>
<li>
<p>æ ¹æ®è®¿é—®é¡ºåºæ’åº - æ¯æ¬¡ get éƒ½ä¼šå°†è®¿é—®çš„å€¼ç§»åŠ¨åˆ°é“¾è¡¨æœ«å°¾ï¼Œè¿™æ ·é‡å¤æ“ä½œå°±èƒ½å¾—åˆ°ä¸€ä¸ªæŒ‰ç…§è®¿é—®é¡ºåºæ’åºçš„é“¾è¡¨ã€‚å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§, ç”¨ LinkedHashMap æ„å»º LRU ç¼“å­˜</p>
</li>
</ul>
<pre><code class="language-java">/**
- LinkedHashMap æ˜¯ HashMap çš„ä¸€ä¸ªå­ç±»ï¼Œå®ƒä¿ç•™æ’å…¥çš„é¡ºåº

- å…è®¸ä½¿ç”¨ null å€¼å’Œ null é”®

- LinkedHashMap å®ç°ä¸ HashMap çš„ä¸åŒä¹‹å¤„åœ¨äºï¼ŒLinkedHashMap ç»´æŠ¤ç€ä¸€ä¸ªåŒé‡é“¾æ¥åˆ—è¡¨ã€‚æ­¤é“¾æ¥åˆ—è¡¨å®šä¹‰äº†è¿­ä»£é¡ºåºï¼Œè¯¥è¿­ä»£é¡ºåºå¯ä»¥æ˜¯æ’å…¥é¡ºåºæˆ–è€…æ˜¯è®¿é—®é¡ºåº(å³è°ƒç”¨ get() åï¼Œä¼šå°†è¿™æ¬¡è®¿é—®çš„å…ƒç´ ç§»è‡³é“¾è¡¨ å°¾éƒ¨ï¼Œä¸æ–­è®¿é—®å¯ä»¥å½¢æˆæŒ‰è®¿é—®é¡ºåºæ’åºçš„é“¾è¡¨ã€‚)ã€‚
**/

// æˆå‘˜å˜é‡

private final boolean accessOrder; //å¦‚æœä¸ºtrueï¼Œåˆ™æŒ‰ç…§è®¿é—®é¡ºåºï¼›å¦‚æœä¸ºfalseï¼Œåˆ™æŒ‰ç…§æ’å…¥é¡ºåºã€‚
private transient Entry&lt;K,V&gt; header;// the head(eldest) of the doubly linked list
private transient Entry&lt;K,V&gt; tail;// the tail(youngest) of the doubly linked list
/**
* LinkedHashMapçš„Entryå…ƒç´ ã€‚
* ç»§æ‰¿HashMapçš„Entryå…ƒç´ ï¼Œåˆä¿å­˜äº†å…¶ä¸Šä¸€ä¸ªå…ƒç´ beforeå’Œä¸‹ä¸€ä¸ªå…ƒç´ afterçš„å¼•ç”¨ã€‚æ–°ç‰ˆæœ¬æœ‰å˜åŒ–äº†, ç»§æ‰¿ Node
 */
private static class Entry&lt;K,V&gt; extends HashMap.Entry&lt;K,V&gt; {
    Entry&lt;K,V&gt; before, after;
    â€¦â€¦
}

// åˆå§‹åŒ–/æ„é€ å‡½æ•°

public LinkedHashMap(int initialCapacity, float loadFactor,boolean accessOrder) {
    super(initialCapacity, loadFactor);
    this.accessOrder = accessOrder;//é»˜è®¤ä¸º falseï¼Œä»£è¡¨æŒ‰ç…§æ’å…¥é¡ºåºè¿›è¡Œè¿­ä»£ï¼›å½“ç„¶å¯ä»¥æ˜¾å¼è®¾ç½®ä¸º trueï¼Œä»£è¡¨ä»¥è®¿é—®é¡ºåºè¿›è¡Œè¿­ä»£
}

// å­˜å‚¨æ–¹æ³•

/**
LinkedHashMap å¹¶æœªé‡å†™çˆ¶ç±» HashMap çš„ put æ–¹æ³•ï¼Œè€Œæ˜¯é‡å†™äº†çˆ¶ç±» HashMap çš„ put æ–¹æ³•è°ƒç”¨çš„å­æ–¹æ³•void recordAccess(HashMap m) ï¼Œvoid addEntry(int hash, K key, V value, int bucketIndex) å’Œvoid createEntry(int hash, K key, V value, int bucketIndex)ï¼Œæä¾›äº†è‡ªå·±ç‰¹æœ‰çš„åŒå‘é“¾æ¥åˆ—è¡¨çš„å®ç°
*/

// get æ–¹æ³•

/**
LinkedHashMap é‡å†™äº†çˆ¶ç±» HashMap çš„ get æ–¹æ³•ï¼Œå®é™…åœ¨è°ƒç”¨çˆ¶ç±» getEntry() æ–¹æ³•å–å¾—æŸ¥æ‰¾çš„å…ƒç´ åï¼Œå†åˆ¤æ–­å½“æ’åºæ¨¡å¼ accessOrder ä¸º true æ—¶ï¼Œè®°å½•è®¿é—®é¡ºåºï¼Œå°†æœ€æ–°è®¿é—®çš„å…ƒç´ æ·»åŠ åˆ°åŒå‘é“¾è¡¨çš„è¡¨å¤´ï¼Œå¹¶ä»åŸæ¥çš„ä½ç½®åˆ é™¤ã€‚
*/

// LRU æ˜¯ Least Recently Used çš„ç¼©å†™, æœ€è¿‘æœ€å°‘ä½¿ç”¨
// LinkedHashMap æœ¬èº«å·²ç»å®ç°äº†æŒ‰ç…§è®¿é—®é¡ºåºçš„å­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæœ€è¿‘è¯»å–çš„ä¼šæ”¾åœ¨æœ€å‰é¢ï¼Œæœ€æœ€ä¸å¸¸è¯»å–çš„ä¼šæ”¾åœ¨æœ€å;LinkedHashMap æœ¬èº«æœ‰ä¸€ä¸ªæ–¹æ³•ç”¨äºåˆ¤æ–­æ˜¯å¦éœ€è¦ç§»é™¤æœ€ä¸å¸¸è¯»å–çš„æ•°ï¼Œä½†æ˜¯ï¼ŒåŸå§‹æ–¹æ³•é»˜è®¤ä¸éœ€è¦ç§»é™¤ï¼ˆè¿™æ˜¯ï¼ŒLinkedHashMap ç›¸å½“äºä¸€ä¸ªlinkedlistï¼‰ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ override è¿™æ ·ä¸€ä¸ªæ–¹æ³•ï¼Œä½¿å¾—å½“ç¼“å­˜é‡Œå­˜æ”¾çš„æ•°æ®ä¸ªæ•°è¶…è¿‡è§„å®šä¸ªæ•°åï¼Œå°±æŠŠæœ€ä¸å¸¸ç”¨çš„ç§»é™¤æ‰

/**
 * An LRU cache, based on &lt;code&gt;LinkedHashMap&lt;/code&gt;.
 *
 * &lt;p&gt;
 * This cache has a fixed maximum number of elements (&lt;code&gt;cacheSize&lt;/code&gt;).
 * If the cache is full and another entry is added, the LRU (least recently
 * used) entry is dropped.
 *
 * &lt;p&gt;
 * This class is thread-safe. All methods of this class are synchronized.
 *
 * &lt;p&gt;
 * Author: Christian d'Heureuse, Inventec Informatik AG, Zurich, Switzerland&lt;br&gt;
 * Multi-licensed: EPL / LGPL / GPL / AL / BSD.
 */
public class LRUCache&lt;K, V&gt; {
    private static final float hashTableLoadFactor = 0.75f;
    private LinkedHashMap&lt;K, V&gt; map;
    private int cacheSize;

    /**
     * Creates a new LRU cache. åœ¨è¯¥æ–¹æ³•ä¸­ï¼Œnew LinkedHashMap&lt;K,V&gt;(hashTableCapacity,
     * hashTableLoadFactor, true)ä¸­ï¼Œtrueä»£è¡¨ä½¿ç”¨è®¿é—®é¡ºåº
     *
     * @param cacheSize
     *            the maximum number of entries that will be kept in this cache.
     */
    public LRUCache(int cacheSize) {
        this.cacheSize = cacheSize;
        int hashTableCapacity = (int) Math
                .ceil(cacheSize / hashTableLoadFactor) + 1;
        map = new LinkedHashMap&lt;K, V&gt;(hashTableCapacity, hashTableLoadFactor,
                true) {
            // (an anonymous inner class)
            private static final long serialVersionUID = 1;

            @Override
            protected boolean removeEldestEntry(Map.Entry&lt;K, V&gt; eldest) {
                return size() &gt; LRUCache.this.cacheSize;
            }
        };
    }

    /**
     * Retrieves an entry from the cache.&lt;br&gt;
     * The retrieved entry becomes the MRU (most recently used) entry.
     *
     * @param key
     *            the key whose associated value is to be returned.
     * @return the value associated to this key, or null if no value with this
     *         key exists in the cache.
     */
    public synchronized V get(K key) {
        return map.get(key);
    }

    /**
     * Adds an entry to this cache. The new entry becomes the MRU (most recently
     * used) entry. If an entry with the specified key already exists in the
     * cache, it is replaced by the new entry. If the cache is full, the LRU
     * (least recently used) entry is removed from the cache.
     *
     * @param key
     *            the key with which the specified value is to be associated.
     * @param value
     *            a value to be associated with the specified key.
     */
    public synchronized void put(K key, V value) {
        map.put(key, value);
    }

    /**
     * Clears the cache.
     */
    public synchronized void clear() {
        map.clear();
    }

    /**
     * Returns the number of used entries in the cache.
     *
     * @return the number of entries currently in the cache.
     */
    public synchronized int usedEntries() {
        return map.size();
    }

    /**
     * Returns a &lt;code&gt;Collection&lt;/code&gt; that contains a copy of all cache
     * entries.
     *
     * @return a &lt;code&gt;Collection&lt;/code&gt; with a copy of the cache content.
     */
    public synchronized Collection&lt;Map.Entry&lt;K, V&gt;&gt; getAll() {
        return new ArrayList&lt;Map.Entry&lt;K, V&gt;&gt;(map.entrySet());
    }

    // Test routine for the LRUCache class.
    public static void main(String[] args) {
        LRUCache&lt;String, String&gt; c = new LRUCache&lt;String, String&gt;(3);
        c.put(&quot;1&quot;, &quot;one&quot;); // 1
        c.put(&quot;2&quot;, &quot;two&quot;); // 2 1
        c.put(&quot;3&quot;, &quot;three&quot;); // 3 2 1
        c.put(&quot;4&quot;, &quot;four&quot;); // 4 3 2
        if (c.get(&quot;2&quot;) == null)
            throw new Error(); // 2 4 3
        c.put(&quot;5&quot;, &quot;five&quot;); // 5 2 4
        c.put(&quot;4&quot;, &quot;second four&quot;); // 4 5 2
        // Verify cache content.
        if (c.usedEntries() != 3)
            throw new Error();
        if (!c.get(&quot;4&quot;).equals(&quot;second four&quot;))
            throw new Error();
        if (!c.get(&quot;5&quot;).equals(&quot;five&quot;))
            throw new Error();
        if (!c.get(&quot;2&quot;).equals(&quot;two&quot;))
            throw new Error();
        // List cache content.
        for (Map.Entry&lt;String, String&gt; e : c.getAll())
            System.out.println(e.getKey() + &quot; : &quot; + e.getValue());
    }
}

</code></pre>
<h3><a class="header" href="#lindedhashset" id="lindedhashset">LindedHashSet</a></h3>
<p>æœ‰åºçš„ hashset</p>
<p>ç»§æ‰¿ HashSetã€åˆåŸºäº LinkedHashMap æ¥å®ç°çš„</p>
<pre><code class="language-java">/**
- ä¸HashSet çš„ä¸åŒä¹‹å¤„åœ¨äºï¼ŒLinkedHashSet ç»´æŠ¤ç€ä¸€ä¸ªåŒé‡é“¾æ¥åˆ—è¡¨ã€‚æ­¤é“¾æ¥åˆ—è¡¨å®šä¹‰äº†è¿­ä»£é¡ºåºï¼Œè¯¥è¿­ä»£é¡ºåºå¯ä¸ºæ’å…¥é¡ºåºæˆ–æ˜¯è®¿é—®é¡ºåº

*/

</code></pre>
<h3><a class="header" href="#arraylist-å’Œ-vector" id="arraylist-å’Œ-vector">ArrayList å’Œ Vector</a></h3>
<p>æœ€é‡è¦çš„ä¸¤ä¸ªå±æ€§åˆ†åˆ«æ˜¯: <code>elementData</code> æ•°ç»„ï¼Œä»¥åŠ <code>size</code> å¤§å°, æ·»åŠ å…ƒç´ æ—¶å€™ é¦–å…ˆè¿›è¡Œ <code>æ‰©å®¹æ ¡éªŒ</code>, å¦‚æœå®¹é‡ä¸å¤Ÿäº†, ä¼šè¿›è¡Œæ•°ç»„çš„å¤åˆ¶. å¦å¤–åœ¨æ·»åŠ å…ƒç´ åˆ°æŒ‡å®šä½ç½®æ—¶ä¹Ÿæœ‰æ•°ç»„çš„å¤åˆ¶. æ‰€ä»¥<code>ä½¿ç”¨æ—¶æœ€å¥½æ˜¯æŒ‡å®šå¤§å°</code>, <code>å‡å°‘åœ¨æŒ‡å®šä½ç½®æ’å…¥æ•°æ®çš„æ“ä½œ</code></p>
<p>å®ç°äºä¸‹é¢ 2 ä¸ªæ¥å£</p>
<ul>
<li>
<p>List æ¥å£</p>
</li>
<li>
<p>RandomAccess æ¥å£: æ ‡è®°æ¥å£, è¡¨ç¤ºå¯ä»¥å¿«é€Ÿéšæœºè®¿é—®(é€šè¿‡å…ƒç´ çš„åºå·å¿«é€Ÿè·å–å…ƒç´ å¯¹è±¡)</p>
</li>
</ul>
<p>Fail-Fast æœºåˆ¶: å¤šä¸ªçº¿ç¨‹ç«äº‰è®¿é—®ä¼šæŠ¥é”™</p>
<p>ç”±äº ArrayList æ˜¯åŸºäºæ•°ç»„å®ç°çš„ï¼Œæ‰€ä»¥<code>å¹¶ä¸æ˜¯æ‰€æœ‰çš„ç©ºé—´éƒ½è¢«ä½¿ç”¨</code>ã€‚å› æ­¤ä½¿ç”¨äº† transient ä¿®é¥°ï¼Œå¯ä»¥é˜²æ­¢è¢«è‡ªåŠ¨åºåˆ—åŒ–, å› æ­¤ <code>ArrayList è‡ªå®šä¹‰äº†åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</code></p>
<p>Vector åº•å±‚æ•°æ®ç»“æ„å’Œ ArrayList ç±»ä¼¼,ä¹Ÿæ˜¯ä¸€ä¸ªåŠ¨æ€æ•°ç»„å­˜æ”¾æ•°æ®ã€‚ä¸è¿‡æ˜¯åœ¨ add() æ–¹æ³•çš„æ—¶å€™ä½¿ç”¨ synchronized è¿›è¡ŒåŒæ­¥å†™æ•°æ®ï¼Œä½†æ˜¯å¼€é”€è¾ƒå¤§ï¼Œæ‰€ä»¥ Vector æ˜¯ä¸€ä¸ªåŒæ­¥å®¹å™¨å¹¶ä¸æ˜¯ä¸€ä¸ªå¹¶å‘å®¹å™¨ã€‚</p>
<pre><code class="language-java">/**
- å®ƒå®ç° List æ¥å£ã€åº•å±‚ä½¿ç”¨æ•°ç»„ä¿å­˜æ‰€æœ‰å…ƒç´ ã€‚å…¶æ“ä½œåŸºæœ¬ä¸Šæ˜¯å¯¹æ•°ç»„çš„æ“ä½œ
*/

// æˆå‘˜å˜é‡
private transient Object[] elementData;

// æ·»åŠ  æœ‰å¤šç§æ–¹æ³•

public E set(int index, E element) {
    rangeCheck(index);//æ£€æŸ¥æ˜¯å¦è¶…å‡ºæ•°ç»„èŒƒå›´, å¦‚æœè¶…å‡º, æŠ›å¼‚å¸¸

    E oldValue = elementData(index);
    elementData[index] = element;// replace
    return oldValue;
}
private void rangeCheck(int index) {
    if (index &gt;= size)
    throw new IndexOutOfBoundsException(outOfBoundsMsg(index));
}

 /**
    * Appends the specified element to the end of the list.
    *
    * @param e element to be appended to this list
    * @return &lt;tt&gt;true&lt;/tt&gt; (as specified by {@link Collection#add})
    */
public boolean add(E e) {
    //æ‰©å®¹æ ¡éªŒã€‚
    ensureCapacityInternal(size + 1);  // Increments modCount!!
    elementData[size++] = e;
    return true;
}
private void ensureCapacityInternal(int minCapacity) {
    modCount++;
    // overflow-conscious code
    if (minCapacity - elementData.length &gt; 0)
        grow(minCapacity); //å½“å®¹é‡ä¸è¶³æ—¶ï¼Œä¼šè°ƒç”¨ grow æ–¹æ³•å¢é•¿å®¹é‡
}
private void grow(int minCapacity) {
    // overflow-conscious code
    int oldCapacity = elementData.length;
    int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1);
    if (newCapacity - minCapacity &lt; 0)
        newCapacity = minCapacity;
    if (newCapacity - MAX_ARRAY_SIZE &gt; 0)
        newCapacity = hugeCapacity(minCapacity);
    // minCapacity is usually close to size, so this is a win:
    // æ•°ç»„å¤åˆ¶,
    elementData = Arrays.copyOf(elementData, newCapacity);
}

 public void add(int index, E element) {
    rangeCheckForAdd(index);

    ensureCapacityInternal(size + 1);  // Increments modCount!!
    //å¤åˆ¶ï¼Œå‘åç§»åŠ¨
    System.arraycopy(elementData, index, elementData, index + 1,
                        size - index);
    elementData[index] = element;
    size++;
}


// è¯»å–

public E get(int index) {
    rangeCheck(index);
    return (E) elementData[index];// returns the element at the specified position of the list
}
private void rangeCheck(int index) {
    if (index &gt;= size)
    throw new IndexOutOfBoundsException(outOfBoundsMsg(index));
}

// è°ƒæ•´æ•°ç»„å®¹é‡

/**
å¼€å‘è€…å¯ä»¥é€šè¿‡ä¸€ä¸ª public çš„æ–¹æ³•ensureCapacity(int minCapacity)æ¥å¢åŠ  ArrayList çš„å®¹é‡ï¼Œè€Œåœ¨å­˜å‚¨å…ƒç´ ç­‰æ“ä½œè¿‡ç¨‹ä¸­ï¼Œå¦‚æœé‡åˆ°å®¹é‡ä¸è¶³ï¼Œä¼šè°ƒç”¨priavteæ–¹æ³•private void ensureCapacityInternal(int minCapacity)å®ç°ã€‚
*/

 public void ensureCapacity(int minCapacity) {
    if (minCapacity &gt; 0)
        ensureCapacityInternal(minCapacity);
}

private void ensureCapacityInternal(int minCapacity) {
    modCount++;
    // overflow-conscious code
    if (minCapacity - elementData.length &gt; 0)
        grow(minCapacity);
}
/**
    * Increases the capacity to ensure that it can hold at least the
    * number of elements specified by the minimum capacity argument.
    *
    * @param minCapacity the desired minimum capacity
    */
private void grow(int minCapacity) {
    // overflow-conscious code
    int oldCapacity = elementData.length;
    int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1); //æ¯æ¬¡æ•°ç»„å®¹é‡çš„å¢é•¿å¤§çº¦æ˜¯å…¶åŸå®¹é‡çš„ 1.5 å€
    if (newCapacity - minCapacity &lt; 0)
        newCapacity = minCapacity;
    if (newCapacity - MAX_ARRAY_SIZE &gt; 0)
        newCapacity = hugeCapacity(minCapacity);
    // minCapacity is usually close to size, so this is a win:
    elementData = Arrays.copyOf(elementData, newCapacity);
}
</code></pre>
<h3><a class="header" href="#linkedlist" id="linkedlist">LinkedList</a></h3>
<p>å•å‘é“¾è¡¨</p>
<p>LinkedList æ’å…¥ï¼Œåˆ é™¤éƒ½æ˜¯ç§»åŠ¨æŒ‡é’ˆæ•ˆç‡å¾ˆé«˜ã€‚</p>
<p>æŸ¥æ‰¾éœ€è¦è¿›è¡Œéå†æŸ¥è¯¢ï¼Œæ•ˆç‡è¾ƒä½, ç‰¹åˆ«æ˜¯å½“ index è¶Šæ¥è¿‘ size çš„ä¸­é—´å€¼æ—¶å°¤å…¶ä½</p>
<pre><code class="language-java">/**
- LinkedList æ˜¯åŸºäºé“¾è¡¨å®ç°
*/

// æˆå‘˜å˜é‡
transient int size = 0;
transient Node&lt;E&gt; first; //é“¾è¡¨çš„å¤´æŒ‡é’ˆ
transient Node&lt;E&gt; last; //å°¾æŒ‡é’ˆ

//å­˜å‚¨å¯¹è±¡çš„ç»“æ„ Node, LinkedListçš„å†…éƒ¨ç±»
private static class Node&lt;E&gt; {
    E item;
    Node&lt;E&gt; next; // æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
    Node&lt;E&gt; prev; //æŒ‡å‘ä¸Šä¸€ä¸ªèŠ‚ç‚¹

    Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) {
        this.item = element;
        this.next = next;
        this.prev = prev;
    }
}

// æ ¸å¿ƒæ–¹æ³• linkBeforeã€linkLast

// æ·»åŠ 
public boolean add(E e) {
    linkLast(e);
    return true;
}
/**
* Links e as last element.
*/
void linkLast(E e) {
    final Node&lt;E&gt; l = last;
    final Node&lt;E&gt; newNode = new Node&lt;&gt;(l, e, null);
    last = newNode;
    if (l == null)
        first = newNode;
    else
        l.next = newNode; // ä»…ä»…æ˜¯æŒ‡é’ˆçš„ç§»åŠ¨, æ·»åŠ æ•ˆç‡é«˜
    size++;
    modCount++;
}

// æŸ¥è¯¢
public E get(int index) {
    checkElementIndex(index);
    return node(index).item;
}
Node&lt;E&gt; node(int index) {
    // assert isElementIndex(index);

    // å¦‚æœå°äº sizeçš„ä¸€åŠ, å°±ä»èŠ‚ç‚¹å¤´éƒ¨éå†, å¦åˆ™å°±ä»èŠ‚ç‚¹å°¾éƒ¨å¼€å§‹éå†ã€‚
    if (index &lt; (size &gt;&gt; 1)) {
        Node&lt;E&gt; x = first;
        for (int i = 0; i &lt; index; i++)
            x = x.next;
        return x;
    } else {
        Node&lt;E&gt; x = last;
        for (int i = size - 1; i &gt; index; i--)
            x = x.prev;
        return x;
    }
}

</code></pre>
<h3><a class="header" href="#concurrenthashmap" id="concurrenthashmap">ConcurrentHashMap</a></h3>
<p>ref: https://crossoverjie.top/2018/07/23/java-senior/ConcurrentHashMap/</p>
<p><a href="https://github.com/ben-manes/concurrentlinkedhashmap">ä¸€ä¸ª concurrentlinkedhashmap å®ç°</a></p>
<p>é¢è¯•å¥—è·¯:</p>
<ul>
<li>è°ˆè°ˆä½ ç†è§£çš„ HashMapï¼Œè®²è®²å…¶ä¸­çš„ get put è¿‡ç¨‹ã€‚</li>
<li>1.8 åšäº†ä»€ä¹ˆä¼˜åŒ–ï¼Ÿ</li>
<li>æ˜¯çº¿ç¨‹å®‰å…¨çš„å˜›ï¼Ÿ</li>
<li>ä¸å®‰å…¨ä¼šå¯¼è‡´å“ªäº›é—®é¢˜ï¼Ÿ</li>
<li>å¦‚ä½•è§£å†³ï¼Ÿæœ‰æ²¡æœ‰çº¿ç¨‹å®‰å…¨çš„å¹¶å‘å®¹å™¨ï¼Ÿ</li>
<li>ConcurrentHashMap æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ 1.7ã€1.8 å®ç°æœ‰ä½•ä¸åŒï¼Ÿä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Ÿ</li>
</ul>
<p>é’ˆå¯¹å¹¶å‘åœºæ™¯çš„ hashmap, æ¯” hashtable å¹¶å‘æ•ˆç‡æ›´é«˜</p>
<p>ä¿®æ”¹æ“ä½œ: é”å®šçš„ Segment è€Œä¸æ˜¯æ•´ä¸ª ConcurrentHashMap, æ›´æ–°æ“ä½œåªæ˜¯åœ¨è¿™ä¸ª Segment ä¸­å®Œæˆï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦å¯¹æ•´ä¸ª ConcurrentHashMap åŠ é”, æ­¤æ—¶ï¼Œå…¶ä»–çš„çº¿ç¨‹ä¹Ÿå¯ä»¥å¯¹å¦å¤–çš„ Segment è¿›è¡Œ put æ“ä½œ
è¯»æ“ä½œå°±æ›´æ²¡ä»€ä¹ˆå½±å“äº†</p>
<p>Segment æ•°æ®ç»“æ„
<img src="Snipaste_2018-09-30_11-23-18.png" alt="alt" />
æ•´ä¸ª ConcurrentHashMap æ•°æ®ç»“æ„
<img src="Snipaste_2018-09-30_11-24-10.png" alt="alt" /></p>
<pre><code class="language-java">/**
- æ•°æ®ç»“æ„

    - æˆå‘˜å˜é‡ä¸­ï¼ŒåŒ…å«äº†ä¸€ä¸ª Segment çš„æ•°ç»„ï¼ˆfinal Segment&lt;K,V&gt;[] segments;ï¼‰ï¼Œè€Œ Segment æ˜¯ ConcurrentHashMap çš„å†…éƒ¨ç±»

    - åœ¨ Segment è¿™ä¸ªç±»ä¸­ï¼ŒåŒ…å«äº†ä¸€ä¸ª HashEntry çš„æ•°ç»„ï¼ˆtransient volatile HashEntry&lt;K,V&gt;[] table;ï¼‰ã€‚è€Œ HashEntry ä¹Ÿæ˜¯ ConcurrentHashMap çš„å†…éƒ¨ç±»ã€‚

    - HashEntry ä¸­ï¼ŒåŒ…å«äº† key å’Œ value ä»¥åŠ next æŒ‡é’ˆï¼ˆç±»ä¼¼äº HashMap ä¸­ Entryï¼‰ï¼Œæ‰€ä»¥ HashEntry å¯ä»¥æ„æˆä¸€ä¸ªé“¾è¡¨ã€‚

- ConcurrentHashMap å’Œ HashTable

    - ç›¸æ¯”äº HashTable å’Œç”¨åŒæ­¥åŒ…è£…å™¨åŒ…è£…çš„ HashMapï¼ˆCollections.synchronizedMap(new HashMap())ï¼‰ï¼ŒConcurrentHashMap æ‹¥æœ‰æ›´é«˜çš„å¹¶å‘æ€§ã€‚åœ¨å‰ä¸¤è€…ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªå…¨å±€çš„é”æ¥åŒæ­¥ä¸åŒçº¿ç¨‹é—´çš„å¹¶å‘è®¿é—®ã€‚åŒä¸€æ—¶é—´ç‚¹ï¼Œåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æŒæœ‰é”ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨åŒä¸€æ—¶é—´ç‚¹ï¼Œåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è®¿é—®å®¹å™¨ã€‚è¿™è™½ç„¶ä¿è¯å¤šçº¿ç¨‹é—´çš„å®‰å…¨å¹¶å‘è®¿é—®ï¼Œä½†åŒæ—¶ä¹Ÿå¯¼è‡´å¯¹å®¹å™¨çš„è®¿é—®å˜æˆä¸²è¡ŒåŒ–çš„äº†ã€‚

- ConcurrentHashMap çš„é«˜å¹¶å‘æ€§ä¸»è¦æ¥è‡ªäºä¸‰ä¸ªæ–¹é¢: (ç”±äºæ•£åˆ—æ˜ å°„è¡¨åœ¨å®é™…åº”ç”¨ä¸­å¤§å¤šæ•°æ“ä½œéƒ½æ˜¯æˆåŠŸçš„ è¯»æ“ä½œï¼Œæ‰€ä»¥ 2 å’Œ 3 æ—¢å¯ä»¥å‡å°‘è¯·æ±‚åŒä¸€ä¸ªé”çš„é¢‘ç‡ï¼Œä¹Ÿå¯ä»¥æœ‰æ•ˆå‡å°‘æŒæœ‰é”çš„æ—¶é—´)

    - ç”¨åˆ†ç¦»é”å®ç°å¤šä¸ªçº¿ç¨‹é—´çš„æ›´æ·±å±‚æ¬¡çš„å…±äº«è®¿é—®ã€‚
    - ç”¨ HashEntery å¯¹è±¡çš„ä¸å˜æ€§(finalä¿®é¥°)æ¥é™ä½æ‰§è¡Œè¯»æ“ä½œçš„çº¿ç¨‹åœ¨éå†é“¾è¡¨æœŸé—´å¯¹åŠ é”çš„éœ€æ±‚ã€‚
    - é€šè¿‡å¯¹åŒä¸€ä¸ª Volatile å˜é‡çš„å†™ / è¯»è®¿é—®ï¼Œåè°ƒä¸åŒçº¿ç¨‹é—´è¯» / å†™æ“ä½œçš„å†…å­˜å¯è§æ€§ã€‚
*/

// HashEntry å­˜å‚¨é”®å€¼å¯¹çš„è¿‡ç¨‹ä¸­ï¼Œæ•£åˆ—çš„æ—¶å€™å¦‚æœå‘ç”Ÿâ€œç¢°æ’â€ï¼Œå°†æŠŠç¢°æ’çš„ HashEntry å¯¹è±¡é“¾æ¥æˆä¸€ä¸ªé“¾è¡¨ã€‚

static final class HashEntry&lt;K,V&gt; {//ç±»æ¯”ç€ HashMap ä¸­çš„ Entry
    final int hash;
    final K key;
    volatile V value;
    volatile HashEntry&lt;K,V&gt; next;

    HashEntry(int hash, K key, V value, HashEntry&lt;K,V&gt; next) {
        this.hash = hash;
        this.key = key;
        this.value = value;
        this.next = next;
    }
    ...
    ...
}

// Segment

// ç»§æ‰¿äº ReentrantLock ç±»ï¼Œä»è€Œä½¿å¾— Segment å¯¹è±¡å¯ä»¥å……å½“é”çš„è§’è‰²
//Segment æ•°æ®ç»“æ„ç±»ä¼¼äº HashMapäº†ï¼Œéƒ½æ˜¯åŒ…å«äº†ä¸€ä¸ªæ•°ç»„ï¼Œè€Œæ•°ç»„ä¸­çš„å…ƒç´ å¯ä»¥æ˜¯ä¸€ä¸ªé“¾è¡¨ã€‚
/**
    * Segments are specialized versions of hash tables.  This
    * subclasses from ReentrantLock opportunistically, just to
    * simplify some locking and avoid separate construction.
    */
static final class Segment&lt;K,V&gt; extends ReentrantLock implements Serializable {
    /**
        * The per-segment table. Elements are accessed via
        * entryAt/setEntryAt providing volatile semantics.
        */
        // å¦‚æœæ•£åˆ—æ—¶å‘ç”Ÿç¢°æ’ï¼Œç¢°æ’çš„ HashEntry å¯¹è±¡å°±ä»¥é“¾è¡¨çš„å½¢å¼é“¾æ¥æˆä¸€ä¸ªé“¾è¡¨
    transient volatile HashEntry&lt;K,V&gt;[] table;//Segment ä¸­åŒ…å«HashEntry çš„æ•°ç»„; ä½¿å¾— segment å¯ä»¥å¯ä»¥å®ˆæŠ¤å…¶åŒ…å«çš„è‹¥å¹²ä¸ªæ¡¶ï¼ˆHashEntryæ•°ç»„ä¸­çš„æ¯ä¸ªHashentryå…ƒç´ å³ä¸ºä¸€ä¸ª æ¡¶ï¼‰

    /**
        * The number of elements. Accessed only either within locks
        * or among other volatile reads that maintain visibility.
        */
    transient int count;//count å˜é‡æ˜¯è®¡ç®—å™¨ï¼Œè¡¨ç¤ºæ¯ä¸ª Segment å¯¹è±¡ç®¡ç†çš„ table æ•°ç»„ï¼ˆè‹¥å¹²ä¸ª HashEntry çš„é“¾è¡¨); ä¹‹æ‰€ä»¥åœ¨æ¯ä¸ªSegmentå¯¹è±¡ä¸­åŒ…å«ä¸€ä¸ª count è®¡æ•°å™¨ï¼Œè€Œä¸åœ¨ ConcurrentHashMap ä¸­ä½¿ç”¨å…¨å±€çš„è®¡æ•°å™¨ï¼Œæ˜¯ä¸ºäº†é¿å…å‡ºç°â€œçƒ­ç‚¹åŸŸâ€è€Œå½±å“å¹¶å‘æ€§ã€‚
    transient int modCount;
    /**
        * è£…è½½å› å­
        */
    final float loadFactor;
}

// å¹¶å‘å†™æ“ä½œ

/**
    * Maps the specified key to the specified value in this table.
    * Neither the key nor the value can be null.
    *
    * &lt;p&gt; The value can be retrieved by calling the &lt;tt&gt;get&lt;/tt&gt; method
    * with a key that is equal to the original key.
    *
    * @param key key with which the specified value is to be associated
    * @param value value to be associated with the specified key
    * @return the previous value associated with &lt;tt&gt;key&lt;/tt&gt;, or
    *         &lt;tt&gt;null&lt;/tt&gt; if there was no mapping for &lt;tt&gt;key&lt;/tt&gt;
    * @throws NullPointerException if the specified key or value is null
    */
@SuppressWarnings(&quot;unchecked&quot;)
public V put(K key, V value) {
    Segment&lt;K,V&gt; s;//é¦–å…ˆæœ‰ä¸€ä¸ª Segment çš„å¼•ç”¨ s
    if (value == null)
        throw new NullPointerException();
    int hash = hash(key);//hash() æ–¹æ³•å¯¹ key è¿›è¡Œè®¡ç®—
    int j = (hash &gt;&gt;&gt; segmentShift) &amp; segmentMask;
    if ((s = (Segment&lt;K,V&gt;)UNSAFE.getObject          // nonvolatile; recheck
            (segments, (j &lt;&lt; SSHIFT) + SBASE)) == null) //  in ensureSegment
        s = ensureSegment(j);
    return s.put(key, hash, value, false);//è°ƒç”¨ Segment çš„ put(K key, int hash, V value, boolean onlyIfAbsent)æ–¹æ³•è¿›è¡Œå­˜å‚¨æ“ä½œ
}
// Segment çš„ put æ–¹æ³•
final V put(K key, int hash, V value, boolean onlyIfAbsent) {
    //åŠ é”ï¼Œè¿™é‡Œæ˜¯é”å®šçš„Segmentè€Œä¸æ˜¯æ•´ä¸ªConcurrentHashMap
    //å› ä¸º put æ“ä½œåªæ˜¯åœ¨è¿™ä¸ª Segment ä¸­å®Œæˆï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦å¯¹æ•´ä¸ª ConcurrentHashMap åŠ é”
    //æ‰€ä»¥ï¼Œæ­¤æ—¶ï¼Œå…¶ä»–çš„çº¿ç¨‹ä¹Ÿå¯ä»¥å¯¹å¦å¤–çš„ Segment è¿›è¡Œ put æ“ä½œï¼Œå› ä¸ºè™½ç„¶è¯¥ Segment è¢«é”ä½äº†ï¼Œä½†å…¶ä»–çš„ Segment å¹¶æ²¡æœ‰åŠ é”ã€‚åŒæ—¶ï¼Œè¯»çº¿ç¨‹å¹¶ä¸ä¼šå› ä¸ºæœ¬çº¿ç¨‹çš„åŠ é”è€Œé˜»å¡ã€‚
    HashEntry&lt;K,V&gt; node = tryLock() ? null :scanAndLockForPut(key, hash, value);
    V oldValue;
    try {
        HashEntry&lt;K,V&gt;[] tab = table;
        //å¾—åˆ°hashå¯¹åº”çš„tableä¸­çš„ç´¢å¼•index
        int index = (tab.length - 1) &amp; hash;
        //æ‰¾åˆ°hashå¯¹åº”çš„æ˜¯å…·ä½“çš„å“ªä¸ªæ¡¶ï¼Œä¹Ÿå°±æ˜¯å“ªä¸ªHashEntryé“¾è¡¨
        HashEntry&lt;K,V&gt; first = entryAt(tab, index);
        for (HashEntry&lt;K,V&gt; e = first;;) {
            if (e != null) {
                K k;
                if ((k = e.key) == key ||
                    (e.hash == hash &amp;&amp; key.equals(k))) {
                    oldValue = e.value;
                    if (!onlyIfAbsent) {
                        e.value = value;
                        ++modCount;
                    }
                    break;
                }
                e = e.next;
            }
            else {
                if (node != null)
                    node.setNext(first);
                else
                    node = new HashEntry&lt;K,V&gt;(hash, key, value, first);
                int c = count + 1;
                if (c &gt; threshold &amp;&amp; tab.length &lt; MAXIMUM_CAPACITY)
                    rehash(node);
                else
                    setEntryAt(tab, index, node);
                ++modCount;
                count = c;
                oldValue = null;
                break;
            }
        }
    } finally {
        //è§£é”
        unlock();
    }
    return oldValue;
}

</code></pre>
<h2><a class="header" href="#collections-å’Œ-arrays-å·¥å…·ç±»" id="collections-å’Œ-arrays-å·¥å…·ç±»">Collections å’Œ Arrays å·¥å…·ç±»</a></h2>
<p>Collections æ–¹æ³•:</p>
<pre><code class="language-java">1ï¼Œå¯¹listè¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼š
å‰æè¯¥é›†åˆä¸€å®šè¦æœ‰åºã€‚
int binarySearch(list,key);
int binarySearch(list,key,Comparator);

2ï¼Œå¯¹listé›†åˆè¿›è¡Œæ’åºã€‚
sort(list);
sort(list,comaprator);
//æŒ‰ç…§æŒ‡å®šæ¯”è¾ƒå™¨è¿›è¡Œæ’åº

3ï¼Œå¯¹é›†åˆå–æœ€å¤§å€¼æˆ–è€…æœ€å°å€¼ã€‚
max(Collection)
max(Collection,comparator)
min(Collection)
min(Collection,comparator)

4ï¼Œå¯¹listé›†åˆè¿›è¡Œåè½¬ã€‚
reverse(list);


8ï¼Œå¯ä»¥å°†ä¸åŒæ­¥çš„é›†åˆå˜æˆåŒæ­¥çš„é›†åˆã€‚
Set synchronizedSet(Set&lt;T&gt; s)
Map synchronizedMap(Map&lt;K,V&gt; m)
List synchronizedList(List&lt;T&gt; list)

9.å¦‚æœæƒ³è¦å°†é›†åˆå˜æ•°ç»„ï¼š
å¯ä»¥ä½¿ç”¨Collection ä¸­çš„toArray æ–¹æ³•ã€‚æ³¨æ„ï¼šæ˜¯Collectionä¸æ˜¯Collectionså·¥å…·ç±»
ä¼ å…¥æŒ‡å®šçš„ç±»å‹æ•°ç»„å³å¯ï¼Œè¯¥æ•°ç»„çš„é•¿åº¦æœ€å¥½ä¸ºé›†åˆçš„sizeã€‚

10. è¿”å› ç©ºé›†åˆ èŠ‚çœå†…å­˜

é€šè¿‡java.util.Collections.emptyList()æ–¹æ³•çš„ç›¸å…³æºç å¯ä»¥å¾—çŸ¥å®ƒå®é™…ä¸Šå°±æ˜¯è¿”å›äº†ä¸€ä¸ªç©ºçš„Listï¼Œä½†æ˜¯è¿™ä¸ªListå’Œæˆ‘ä»¬å¹³æ—¶å¸¸ç”¨çš„é‚£ä¸ªListæ˜¯ä¸ä¸€æ ·çš„ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›çš„Listæ˜¯Collectionsç±»çš„ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œå®ƒç»§æ‰¿AbstractListåå¹¶æ²¡æœ‰å®ç°add()ã€remove()ç­‰æ–¹æ³•ï¼Œå› æ­¤è¿™ä¸ªè¿”å›å€¼Listå¹¶ä¸èƒ½å¢åŠ åˆ é™¤å…ƒç´ ã€‚
æ—¢ç„¶è¿™ä¸ªListä¸èƒ½è¿›è¡Œå¢åˆ æ“ä½œï¼Œé‚£ä¹ˆå®ƒæœ‰ä½•æ„ä¹‰å‘¢ï¼Ÿ
è¿™ä¸ªæ–¹æ³•ä¸»è¦ç›®çš„å°±æ˜¯è¿”å›ä¸€ä¸ªä¸å¯å˜çš„åˆ—è¡¨ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•ä½œä¸ºè¿”å›å€¼å°±ä¸éœ€è¦å†åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¯ä»¥å‡å°‘å†…å­˜å¼€é”€ã€‚å¹¶ä¸”è¿”å›ä¸€ä¸ªsizeä¸º0çš„Listï¼Œè°ƒç”¨è€…ä¸éœ€è¦æ ¡éªŒè¿”å›å€¼æ˜¯å¦ä¸ºnullï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨è¿™ä¸ªæ–¹æ³•è¿”å›å¯èƒ½ä¸ºç©ºçš„Listã€‚
emptySet()ã€emptyMap()æ–¹æ³•åŒç†ã€‚

</code></pre>
<p>Arrays æ–¹æ³•:</p>
<pre><code class="language-java">1ï¼ŒäºŒåˆ†æŸ¥æ‰¾,æ•°ç»„éœ€è¦æœ‰åº
binarySearch(int[])
binarySearch(double[])

2ï¼Œæ•°ç»„æ’åº
sort(int[])
sort(char[])


3. å¤åˆ¶æ•°ç»„ã€‚
copyOf(oldArrayï¼ŒnewLength);
// å¤åˆ¶éƒ¨åˆ†æ•°ç»„ã€‚
copyOfRange(oldArrayï¼ŒstartIndexï¼ŒendIndex)    è¿™é‡Œä¸åŒ…æ‹¬endIndexå¯¹åº”å€¼ï¼›

4ï¼Œæ¯”è¾ƒä¸¤ä¸ªæ•°ç»„å¯¹åº”ä½ç½®çš„å…ƒç´ æ˜¯å¦ä¸€è‡´ã€‚
equals(int[],int[]);

5ï¼Œå°†æ•°ç»„å˜æˆé›†åˆã€‚
List asList(T[]);
è¿™æ ·å¯ä»¥é€šè¿‡é›†åˆçš„æ“ä½œæ¥æ“ä½œæ•°ç»„ä¸­å…ƒç´ ï¼Œ
ä½†æ˜¯ä¸å¯ä»¥ä½¿ç”¨å¢åˆ æ–¹æ³•ï¼Œaddï¼Œremoveã€‚å› ä¸ºæ•°ç»„é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œä¼šå‡ºç°
UnsupportOperationExcetionã€‚
å¯ä»¥ä½¿ç”¨çš„æ–¹æ³•ï¼šcontainsï¼ŒindexOfã€‚ã€‚ã€‚
å¦‚æœæ•°ç»„ä¸­å­˜å…¥çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆasListä¼šå°†æ•°ç»„å®ä½“ä½œä¸ºé›†åˆä¸­çš„å…ƒç´ ã€‚
å¦‚æœæ•°ç»„ä¸­çš„å­˜å…¥çš„å¼•ç”¨æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆasListä¼šå°†æ•°ç»„ä¸­çš„å…ƒç´ ä½œä¸ºé›†åˆä¸­
çš„å…ƒç´ ã€‚

6. å°†æ•°ç»„å˜æˆå­—ç¬¦ä¸²ã€‚
toString(int[])


</code></pre>
<h1><a class="header" href="#æ³›å‹" id="æ³›å‹">æ³›å‹</a></h1>
<h2><a class="header" href="#æ³›å‹æ–¹æ³•-æ³›å‹ç±»-æ³›å‹æ¥å£" id="æ³›å‹æ–¹æ³•-æ³›å‹ç±»-æ³›å‹æ¥å£">æ³›å‹æ–¹æ³•-æ³›å‹ç±»-æ³›å‹æ¥å£</a></h2>
<ul>
<li>
<p>æ³›å‹æ–¹æ³•ä¸­ çš„è‡ªå®šä¹‰æ³›å‹çš„å…·ä½“æ•°æ®ç±»å‹æ˜¯åœ¨<code>è°ƒç”¨è¯¥å‡½æ•°çš„æ—¶å€™ä¼ å…¥å®å‚æ—¶</code>ç¡®å®šçš„</p>
</li>
<li>
<p>æ³›å‹ç±»ä¸Šçš„è‡ªå®šä¹‰æ³›å‹æ˜¯åœ¨<code>ä½¿ç”¨è¯¥ç±»åˆ›å»ºå¯¹è±¡çš„æ—¶å€™</code> ç¡®å®šå…·ä½“çš„æ•°æ®ç±»å‹çš„</p>
</li>
<li>
<p>æ³›å‹æ¥å£ä¸Šçš„è‡ªå®šä¹‰æ³›å‹æ˜¯åœ¨<code>å®ç°è¯¥æ¥å£çš„æ—¶å€™</code>æŒ‡å®šå…·ä½“æ•°æ®ç±»å‹çš„ - å¦‚æœéœ€è¦<code>å»¶è¿Ÿç¡®å®šæ¥å£æ³›å‹</code>çš„å…·ä½“ç±»å‹, åœ¨åˆ›å»ºæ¥å£å®ç°ç±»å¯¹è±¡çš„æ—¶å€™æ‰æŒ‡å®šæ¥å£ä¸Šè‡ªå®šä¹‰æ³›å‹ï¼Œé‚£ä¹ˆéœ€è¦ä»¥ä¸‹æ ¼å¼ï¼š<code>class&lt;T&gt; ç±»å implements æ¥å£&lt;T&gt;</code></p>
</li>
</ul>
<h2><a class="header" href="#æ³›å‹åå°„" id="æ³›å‹åå°„">æ³›å‹åå°„</a></h2>
<h3><a class="header" href="#æ³›å‹åå°„-api" id="æ³›å‹åå°„-api">æ³›å‹åå°„ api</a></h3>
<p>ParameterizedType å‚æ•°åŒ–ç±»å‹, æ¯”å¦‚: ArrayList<String>;</p>
<pre><code class="language-java">// baseDaoç±»
public class BaseDao&lt;T&gt; {
    // å½“å‰è¿è¡Œç±»çš„ç±»å‹
    private Class&lt;T&gt; clazz;
    // è¡¨å
    private String tableName;
    // ä¸»é”®
    private String id_primary;
    // æ‹¿åˆ°å½“å‰è¿è¡Œç±»çš„å‚æ•°åŒ–ç±»å‹ä¸­å®é™…çš„ç±»å‹  ( BaseDao&lt;Admin&gt; ,  Admin.class)
    public BaseDao(){
	    //**è·å–parentçš„å‚æ•°åŒ–ç±»å‹
        Type type = this.getClass().getGenericSuperclass();
        ParameterizedType pt = (ParameterizedType) type;
        Type[] types = pt.getActualTypeArguments();

        clazz = (Class&lt;T&gt;) types[0];//åˆ°æ­¤, å·²ç»æ‹¿åˆ°ï¼š  Admin.class

        /*******1. è·å–è¡¨å*******/
        Table table = clazz.getAnnotation(Table.class);
        tableName = table.tableName();

        /*******2. è·å–ä¸»é”®å­—æ®µ*******/
        //è·å–å½“å‰è¿è¡Œç±»çš„æ‰€æœ‰å­—æ®µã€éå†ã€è·å–æ¯ä¸€ä¸ªå­—æ®µä¸Šçš„idæ³¨è§£
        Field[] fs = clazz.getDeclaredFields();
        for (Field f : fs) {
            // è®¾ç½®å¼ºåˆ¶è®¿é—®
            f.setAccessible(true);

            // è·å–æ¯ä¸€ä¸ªå­—æ®µä¸Šçš„idæ³¨è§£
            Id anno_id = f.getAnnotation(Id.class);
            if (anno_id != null) {// ä¸ä¸ºnull, è¯æ˜æ—¶ä¸»é”®å­—æ®µ

                Column column = f.getAnnotation(Column.class);
                id_primary = column.columnName();
                // è·³å‡ºå¾ªç¯
                break;
            }
        }
        System.out.println(&quot;è¡¨ï¼š&quot; + tableName);
        System.out.println(&quot;ä¸»é”®ï¼š&quot; + id_primary);
    }

    public T findById(int id){
        try {
            String sql = &quot;select * from &quot; + tableName + &quot; where &quot; + id_primary +&quot;=?&quot;;
            /*
             * DbUtilsçš„å·²ç»å°è£…å¥½çš„å·¥å…·ç±»ï¼šBeanHandler?   å±æ€§=å­—æ®µ
             */
            return JdbcUtils.getQueryRunner().query(sql, new BeanHandler&lt;T&gt;(clazz), id);
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }


    public List&lt;T&gt; getAll(){
        try {
            String sql = &quot;select * from &quot; + tableName;
            return JdbcUtils.getQuerrRunner().query(sql, new BeanListHandler&lt;T&gt;(clazz));
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
}

</code></pre>
<h3><a class="header" href="#æ¡ˆä¾‹-ä¼˜åŒ–-basedao" id="æ¡ˆä¾‹-ä¼˜åŒ–-basedao">æ¡ˆä¾‹-ä¼˜åŒ– BaseDao</a></h3>
<p>è§ <a href="#%E7%9C%8B%E4%B8%80%E4%B8%AA%E4%BE%8B%E5%AD%90%E4%BC%98%E5%8C%96dao-%E8%A7%A3%E5%86%B3%E5%AD%97%E6%AE%B5%E5%92%8C%E5%B1%9E%E6%80%A7%E4%B8%8D%E4%B8%80%E8%87%B4">æ³¨è§£åå°„</a></p>
<h1><a class="header" href="#æ³¨è§£" id="æ³¨è§£">æ³¨è§£</a></h1>
<p>https://blog.csdn.net/briblue/article/details/73824058</p>
<h2><a class="header" href="#è¯­æ³•" id="è¯­æ³•">è¯­æ³•</a></h2>
<p>æ³¨è§£æˆå‘˜å±æ€§ç±»å‹:</p>
<ul>
<li>
<p>æ‰€æœ‰åŸºæœ¬ç±»å‹</p>
</li>
<li>
<p>String</p>
</li>
<li>
<p>Class</p>
</li>
<li>
<p>Enum</p>
</li>
<li>
<p>Annotation</p>
</li>
<li>
<p>ä»¥ä¸Šç±»å‹çš„æ•°ç»„</p>
</li>
</ul>
<p>æ³¨è§£æœ¬èº«ä¸æ”¯æŒç»§æ‰¿, ä½†æ˜¯æ³¨è§£çš„å±æ€§å¯ä»¥æ˜¯å¦å¤–ä¸€ä¸ªæ³¨è§£(æ³¨è§£æ•°ç»„), è€Œä¸”æ³¨è§£æœ‰ä¸€ä¸ª ä¸€ä¸ªå…ƒæ³¨è§£ @Inherited</p>
<pre><code class="language-java">/**
 * å®šä¹‰ä¸€ä¸ªæœ€æ™®é€šçš„æ³¨è§£
 *
 */
public @interface Author {
    /**
    * æ³¨è§£å±æ€§
    *       1. ä¿®é¥°ä¸ºé»˜è®¤æˆ–publicæ•ˆæœä¸€æ ·
    */
    String name();
    int age();
}
// ä½¿ç”¨:
@Author(name = &quot;Jet&quot;, age = 30)
public void save() {

}

///////////////////////////////////////////////////////
//
//          å¸¦é»˜è®¤å€¼çš„æ³¨è§£
//
//////////////////////////////////

public @interface Author {

    String name();
    int age() default 30;   // å¸¦é»˜è®¤å€¼çš„æ³¨è§£;  ä½¿ç”¨çš„æ—¶å€™å°±å¯ä»¥ä¸å†™æ­¤å±æ€§å€¼

    // æ³¨è§£çš„æ‰€æœ‰å…ƒç´ å¿…é¡»æœ‰ç¡®å®šçš„å€¼ï¼Œè¦æƒ³è¡¨ç¤ºå…ƒç´ nullçš„çŠ¶æ€ï¼Œå¯ä»¥è¿™ä¹ˆåšï¼š
    int age() default -1;
}


/////////////////////
//
//      é»˜è®¤åç§°çš„æ³¨è§£
//
/////////////////////

public @interface Author {
    // å¦‚æœæ³¨è§£åç§°ä¸ºvalue,ä½¿ç”¨æ—¶å€™å¯ä»¥çœç•¥åç§°ï¼Œç›´æ¥ç»™å€¼
    // (ä¸”æ³¨è§£åªæœ‰ä¸€ä¸ªå±æ€§æ—¶å€™æ‰å¯ä»¥çœç•¥åç§°)
    String value();
}
// ä½¿ç”¨
@Author(&quot;Jet&quot;)
// ç­‰ä»·äº
@Author(value = &quot;Jet&quot;)


///////////////////////////
//
//      æ•°ç»„
//
///////////////////////////////

public @interface Author {
    String[] value() default {&quot;test1&quot;,&quot;test2&quot;};
}
// ä½¿ç”¨ï¼š
@Authorï¼ˆ{â€œâ€ï¼Œâ€œâ€}ï¼‰
public void save() {

}



</code></pre>
<h2><a class="header" href="#å…ƒæ³¨è§£" id="å…ƒæ³¨è§£">å…ƒæ³¨è§£</a></h2>
<p>è¡¨ç¤ºæ³¨è§£ä¸Šçš„æ³¨è§£ï¼Œ</p>
<p>ä¸€èˆ¬å¯ä»¥è¿™æ ·ä½¿ç”¨ å¯¼å…¥è‡ªåŠ¨é…ç½®</p>
<pre><code class="language-java">@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Import(RabbitBootstrapConfiguration.class)
public @interface EnableRabbit {
}
</code></pre>
<p>é™¤äº†æ™®é€šæ³¨è§£ï¼Œ è¿˜æ”¯æŒä¸‹é¢å‡ ä¸ªç‰¹æ®Šçš„</p>
<pre><code class="language-java">////////////////////////////////////
//
//      æŒ‡å®šæ³¨è§£çš„å¯ç”¨èŒƒå›´ @Target
//
//////////////////////////////////

æŒ‡å®šæ³¨è§£åœ¨ä»€ä¹ˆåœ°æ–¹ç”¨ï¼Œä¾‹å¦‚ç”¨äºä¸€ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªåŸŸ
@Target({
TYPE,     ç±»
FIELD,     å­—æ®µ
METHOD,  æ–¹æ³•
PARAMETER,   å‚æ•°
CONSTRUCTOR, æ„é€ å™¨
 LOCAL_VARIABLE  å±€éƒ¨å˜é‡
})

//////////////////////////////
//
//     æŒ‡å®šæ³¨è§£çš„å¯ç”¨å£°æ˜å‘¨æœŸ @Retention
//
/////////////////////////////////////

// æŒ‡å®šæ³¨è§£åœ¨å“ªä¸€ä¸ªçº§åˆ«å¯ç”¨

@Retention(RetentionPolicy.SOURCE)    //æ³¨è§£åªåœ¨æºç çº§åˆ«æœ‰æ•ˆ
@Retention(RetentionPolicy.CLASS)      //æ³¨è§£åœ¨å­—èŠ‚ç çº§åˆ«æœ‰æ•ˆ(ç¼–è¯‘æˆå­—èŠ‚ç åè¿˜ä¿ç•™æ³¨è§£ä¿¡æ¯)
                                    // é»˜è®¤å€¼
@Retention(RetentionPolicy.RUNTIME)   æ³¨è§£åœ¨è¿è¡Œæ—¶æœŸæœ‰æ•ˆ(æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡åå°„å»è·å–æ³¨è§£ä¿¡æ¯, å¸¸ç”¨)

/////////////////////
//
//      æ³¨è§£åŒ…å«è¿›javadocä¸­ @Documented
//
/////////////////////////////

@Documented

///////////////////////
//
//      å…è®¸å­ç±»ç»§æ‰¿çˆ¶ç±»ä¸­çš„æ³¨è§£ @Inherited
//
///////////////////////

// å¯¹äºè¢«æ ‡æ³¨çš„æ³¨è§£ï¼Œå…è®¸å­ç±»ç»§æ‰¿çˆ¶ç±»ä¸­çš„è¯¥æ³¨è§£
@Inherited


/////////////////////////
//
//      æ‹“å±•: @Constraint(validatedBy = {XXXXValidator.class})
//
/////////////////////////

// å¯¹æ³¨è§£æ ‡æ³¨çš„å­—æ®µè¿›è¡Œæ ¡éªŒ

</code></pre>
<h2><a class="header" href="#æ³¨è§£åå°„" id="æ³¨è§£åå°„">æ³¨è§£åå°„</a></h2>
<pre><code class="language-java">// æ³¨è§£åå°„è¦è®¾ç½®æ³¨è§£åœ¨è¿è¡Œæ—¶æœ‰æ•ˆï¼Œå³ï¼šåœ¨åˆ›å»ºæ³¨è§£æ—¶åŠ ä¸Šï¼š @Retention(RetentionPolicy.RUNTIME)   æ³¨è§£åœ¨è¿è¡Œæ—¶æœŸæœ‰æ•ˆ
@Id
@Author(remark = &quot;ä¿å­˜ä¿¡æ¯ï¼ï¼ï¼&quot;, age = 19)
public void save() throws Exception {
    // è·å–æ³¨è§£ä¿¡æ¯ï¼š name/age/remark
    // 1. å…ˆè·å–ä»£è¡¨æ–¹æ³•çš„Methodç±»å‹;
    Class clazz = App_2.class;
    Method m = clazz.getMethod(&quot;save&quot;);
    // 2. å†è·å–æ–¹æ³•ä¸Šçš„æ³¨è§£
    Author author = m.getAnnotation(Author.class);
    // è·å–è¾“å‡ºæ³¨è§£ä¿¡æ¯
    System.out.println(author.authorName());
    System.out.println(author.age());
    System.out.println(author.remark());
}


</code></pre>
<h2><a class="header" href="#çœ‹ä¸€ä¸ªä¾‹å­ä¼˜åŒ–-dao-è§£å†³å­—æ®µå’Œå±æ€§ä¸ä¸€è‡´" id="çœ‹ä¸€ä¸ªä¾‹å­ä¼˜åŒ–-dao-è§£å†³å­—æ®µå’Œå±æ€§ä¸ä¸€è‡´">çœ‹ä¸€ä¸ªä¾‹å­(ä¼˜åŒ– dao-è§£å†³å­—æ®µå’Œå±æ€§ä¸ä¸€è‡´)</a></h2>
<p>è§£å†³ä¼˜åŒ–çš„é—®é¢˜ï¼š</p>
<ul>
<li>
<ol>
<li>å½“æ•°æ®åº“è¡¨åä¸ç±»åä¸ä¸€è‡´ã€</li>
</ol>
</li>
<li>
<ol start="2">
<li>å­—æ®µä¸å±æ€§ä¸ä¸€æ ·ã€</li>
</ol>
</li>
<li>
<ol start="3">
<li>ä¸»é”®ä¸å« id</li>
</ol>
</li>
</ul>
<h3><a class="header" href="#é€šè¿‡æ³¨è§£ä¼˜åŒ–-javabean" id="é€šè¿‡æ³¨è§£ä¼˜åŒ–-javabean">é€šè¿‡æ³¨è§£ä¼˜åŒ– JavaBean</a></h3>
<pre><code class="language-java">//adminç±»ï¼Œç»è¿‡æ³¨è§£ä¼˜åŒ–
// Admin=a_adminè¡¨å
@Table(tableName=&quot;a_admin&quot;)
public class Admin {
    @Id//ä¸»é”®
    @Column(columnName = &quot;a_id&quot;)
    private int id;

    @Column(columnName = &quot;a_userName&quot;)
    private String userName;

    @Column(columnName = &quot;a_pwd&quot;)
    private String pwd;

   getter&amp;setter

    @Override
    public String toString() {
        return &quot;Admin [id=&quot; + id + &quot;, pwd=&quot; + pwd + &quot;, userName=&quot; + userName
                + &quot;]&quot;;
    }
}

</code></pre>
<h3><a class="header" href="#æ³›å‹åå°„ä¼˜åŒ–-basedao" id="æ³›å‹åå°„ä¼˜åŒ–-basedao">æ³›å‹åå°„ä¼˜åŒ– BaseDao</a></h3>
<pre><code class="language-java">
// baseDaoç±»
public class BaseDao&lt;T&gt; {
    // å½“å‰è¿è¡Œç±»çš„ç±»å‹
    private Class&lt;T&gt; clazz;
    // è¡¨å
    private String tableName;
    // ä¸»é”®
    private String id_primary;
    // æ‹¿åˆ°å½“å‰è¿è¡Œç±»çš„å‚æ•°åŒ–ç±»å‹ä¸­å®é™…çš„ç±»å‹  ( BaseDao&lt;Admin&gt; ,  Admin.class)
    public BaseDao(){
	    //**è·å–parentçš„å‚æ•°åŒ–ç±»å‹
        Type type = this.getClass().getGenericSuperclass();
        ParameterizedType pt = (ParameterizedType) type;
        Type[] types = pt.getActualTypeArguments();

        clazz = (Class&lt;T&gt;) types[0];//åˆ°æ­¤, å·²ç»æ‹¿åˆ°ï¼š  Admin.class

        /*******1. è·å–è¡¨å*******/
        Table table = clazz.getAnnotation(Table.class);
        tableName = table.tableName();

        /*******2. è·å–ä¸»é”®å­—æ®µ*******/
        //è·å–å½“å‰è¿è¡Œç±»çš„æ‰€æœ‰å­—æ®µã€éå†ã€è·å–æ¯ä¸€ä¸ªå­—æ®µä¸Šçš„idæ³¨è§£
        Field[] fs = clazz.getDeclaredFields();
        for (Field f : fs) {
            // è®¾ç½®å¼ºåˆ¶è®¿é—®
            f.setAccessible(true);

            // è·å–æ¯ä¸€ä¸ªå­—æ®µä¸Šçš„idæ³¨è§£
            Id anno_id = f.getAnnotation(Id.class);
            if (anno_id != null) {// ä¸ä¸ºnull, è¯æ˜æ—¶ä¸»é”®å­—æ®µ

                Column column = f.getAnnotation(Column.class);
                id_primary = column.columnName();
                // è·³å‡ºå¾ªç¯
                break;
            }
        }
        System.out.println(&quot;è¡¨ï¼š&quot; + tableName);
        System.out.println(&quot;ä¸»é”®ï¼š&quot; + id_primary);
    }

    public T findById(int id){
        try {
            String sql = &quot;select * from &quot; + tableName + &quot; where &quot; + id_primary +&quot;=?&quot;;
            /*
             * DbUtilsçš„å·²ç»å°è£…å¥½çš„å·¥å…·ç±»ï¼šBeanHandler?   å±æ€§=å­—æ®µ
             */
            return JdbcUtils.getQueryRunner().query(sql, new BeanHandler&lt;T&gt;(clazz), id);
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }


    public List&lt;T&gt; getAll(){
        try {
            String sql = &quot;select * from &quot; + tableName;
            return JdbcUtils.getQuerrRunner().query(sql, new BeanListHandler&lt;T&gt;(clazz));
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
}

</code></pre>
<h3><a class="header" href="#è‡ªå®šä¹‰ç»“æœé›†-handler" id="è‡ªå®šä¹‰ç»“æœé›†-handler">è‡ªå®šä¹‰ç»“æœé›† handler</a></h3>
<pre><code class="language-java">/**
 * è‡ªå®šä¹‰ç»“æœé›†ï¼šå°è£…å•ä¸ªBeanå¯¹è±¡
 */
class BeanHandler&lt;T&gt; implements ResultSetHandler&lt;T&gt;{
    // ä¿å­˜ä¼ å…¥çš„è¦å°è£…çš„ç±»çš„å­—èŠ‚ç 
    private Class&lt;T&gt; clazz;
    public BeanHandler(Class&lt;T&gt; clazz) {
        this.clazz = clazz;
    }

    // å°è£…ç»“æœé›†çš„æ–¹æ³•
    @Override
    public T handle(ResultSet rs) throws SQLException {
        try {
            // åˆ›å»ºè¦å°è£…çš„å¯¹è±¡  â€˜1â€™
            T t = clazz.newInstance();
            // å‘ä¸‹è¯»ä¸€è¡Œ
            if (rs.next()) {
                // a. è·å–ç±»çš„æ‰€æœ‰çš„Fieldå­—æ®µæ•°ç»„
                Field[] fs = clazz.getDeclaredFields();
                // b. éå†ï¼Œ å¾—åˆ°æ¯ä¸€ä¸ªå­—æ®µç±»å‹ï¼šField
                for (Field f : fs) {
                    // c. è·å–â€å±æ€§åç§°â€œï¼Œattention: ä¸æ˜¯æ³¨è§£é‡Œçš„å­—æ®µå
                    String fieldName = f.getName();
                    // e. è·å–Fieldå­—æ®µä¸Šæ³¨è§£
                    Column column =  f.getAnnotation(Column.class);
                 // æ•°æ®åº“ä¸­å­—æ®µ a_userName
                    String columnName = column.columnName();
                    // g. å­—æ®µå€¼
                    Object columnValue = rs.getObject(columnName);

                    // è®¾ç½®ï¼ˆBeanUtilsç»„ä»¶ï¼‰
                    BeanUtils.copyProperty(t, fieldName, columnValue);
                }
            }
            return t;
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
}
/**
 * è‡ªå®šä¹‰ç»“æœé›†ï¼šå°è£…å¤šä¸ªBeanå¯¹è±¡åˆ°Listé›†åˆ
 */
class BeanListHandler&lt;T&gt; implements ResultSetHandler&lt;List&lt;T&gt;&gt;{
    // è¦å°è£…çš„å•ä¸ªå¯¹è±¡
    private Class&lt;T&gt; clazz;
    public BeanListHandler(Class&lt;T&gt; clazz){
        this.clazz = clazz;
    }
    // æŠŠä»æ•°æ®åº“æŸ¥è¯¢åˆ°çš„æ²¡ä¸€è¡Œè®°å½•ï¼Œå°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå†æäº¤åˆ°listé›†åˆï¼Œ è¿”å›List&lt;T&gt;
    @Override
    public List&lt;T&gt; handle(ResultSet rs) throws SQLException {
        List&lt;T&gt; list = new ArrayList&lt;T&gt;();
        try {
            // å‘ä¸‹è¯»ä¸€è¡Œ
            while (rs.next()) {
                // åˆ›å»ºè¦å°è£…çš„å¯¹è±¡  â€˜1â€™
                T t = clazz.newInstance();
                // a. è·å–ç±»çš„æ‰€æœ‰çš„Fieldå­—æ®µæ•°ç»„
                Field[] fs = clazz.getDeclaredFields();
                // b. éå†ï¼Œ å¾—åˆ°æ¯ä¸€ä¸ªå­—æ®µç±»å‹ï¼šField
                for (Field f : fs) {
                    // c. è·å–â€å±æ€§åç§°â€œ
                    String fieldName = f.getName();
                    // e. è·å–Fieldå­—æ®µä¸Šæ³¨è§£
                    Column column =  f.getAnnotation(Column.class);
                    // f. â€å­—æ®µåâ€œ
                    String columnName = column.columnName();
                    // g. å­—æ®µå€¼
                    Object columnValue = rs.getObject(columnName);
                    // è®¾ç½®ï¼ˆBeanUtilsç»„ä»¶ï¼‰
                    BeanUtils.copyProperty(t, fieldName, columnValue);
                }
                // å¯¹è±¡æ·»åŠ åˆ°é›†åˆ
                list.add(t);
            }
            return list;
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
}


</code></pre>
<h1><a class="header" href="#io" id="io">io</a></h1>
<h2><a class="header" href="#ioæ€»ç»“" id="ioæ€»ç»“">ioæ€»ç»“</a></h2>
<p>io æœ‰è¿™å‡ ç§ç”¨æ³•:</p>
<ul>
<li>
<p>åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œæ¥å—ä¸€ä¸ªè¿æ¥ï¼Œè¯»å–æ•°æ®ï¼Œå¤„ç†ä¸šåŠ¡ï¼Œå†™å›ç»“æœï¼Œå†æ¥å—ä¸‹ä¸€ä¸ªè¿æ¥ï¼Œè¿™æ˜¯åŒæ­¥é˜»å¡ã€‚è¿™ç§ç”¨æ³•å‡ ä¹æ²¡æœ‰ã€‚</p>
</li>
<li>
<p>ä¸€ä¸ªçº¿ç¨‹å’Œä¸€ä¸ªçº¿ç¨‹æ± ï¼Œçº¿ç¨‹è¿è¡Œselectorï¼Œå°†æ‰€æœ‰ channel æ³¨å†Œåˆ°å¤šè·¯å¤ç”¨é€‰æ‹©å™¨ä¸Šï¼Œå¦‚æœchannel ä¸­æœ‰æ•°æ®äº†, å°±ä»çº¿ç¨‹æ± ä¸­æ‹¿åˆ°ä¸€ä¸ªçº¿ç¨‹å¤„ç†, ä¹Ÿå°±æ˜¯å¤šè·¯å¤ç”¨ï¼Œè¿™æ˜¯åŒæ­¥éé˜»å¡ã€‚ä¹Ÿå°±æ˜¯ java nio çš„åŸç†</p>
</li>
<li>
<p>ä¸€ä¸ªçº¿ç¨‹å’Œä¸€ä¸ªçº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ³¨å†Œä¸€ä¸ªacceptå›è°ƒï¼Œç³»ç»Ÿå¸®æˆ‘ä»¬æ¥å—å¥½è¿æ¥åï¼Œæ‰è§¦å‘å›è°ƒåœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œï¼Œæ‰§è¡Œæ—¶å†æ³¨å†Œreadå›è°ƒï¼Œç³»ç»Ÿå¸®æˆ‘ä»¬æ¥å—å¥½æ•°æ®åï¼Œæ‰è§¦å‘å›è°ƒåœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œï¼Œå°±æ˜¯AIOï¼Œè¿™æ˜¯å¼‚æ­¥éé˜»å¡</p>
</li>
</ul>
<p>redisä¹Ÿæ˜¯å¤šè·¯å¤ç”¨ï¼Œä½†å®ƒåªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œselectæ“ä½œï¼Œå¤„ç†å°±ç»ªçš„è¿æ¥ï¼Œæ•´ä¸ªæ˜¯ä¸²è¡ŒåŒ–çš„ï¼Œæ‰€ä»¥å¤©ç„¶ä¸å­˜åœ¨å¹¶å‘é—®é¢˜ã€‚åªèƒ½æŠŠå®ƒå½’ä¸ºåŒæ­¥é˜»å¡äº†ã€‚</p>
<h2><a class="header" href="#socket-ç½‘ç»œç¼–ç¨‹" id="socket-ç½‘ç»œç¼–ç¨‹">socket ç½‘ç»œç¼–ç¨‹</a></h2>
<pre><code class="language-java">/**
 * ç³»ç»Ÿé—´è¿›è¡Œé€šä¿¡ï¼Œ éœ€è¦ä¸¤ä¸ªæ­¥éª¤ï¼š
 *
 * - æ•°æ®ä¼ è¾“.  - å€ŸåŠ© tcp/ip ï¼ˆå¯é ï¼Œ æ€§èƒ½è¾ƒå·®ï¼‰, æˆ– udp/ip åè®® ï¼ˆæ•°æ®ä¸¢å¤±ï¼Œ ä¹±åºï¼Œ ä½†æ˜¯æ€§èƒ½æ›´å¥½ï¼‰
 *
 * - æ•°æ®å¤„ç†ï¼ˆè¯»å–or å†™å…¥ï¼‰ - åŒæ­¥io æˆ–è€… å¼‚æ­¥io
 *
 *      - åŒæ­¥ioåˆ†ä¸º bio, nio
 *
 *          bio - æŸä¸ª thread å½“å‘èµ·ioæ“ä½œ, ä¸ºé˜»å¡æ–¹å¼ ï¼ˆcpu ä¸€ç›´ç©ºé—²ç­‰å¾…ï¼‰ï¼Œç›´åˆ°è¯»å–åˆ° æµ or å°† æµå†™å…¥åˆ°æ“ä½œç³»ç»Ÿæ‰ä¼šé‡Šæ”¾èµ„æºï¼Œ æœŸé—´ç‹¬å èµ„æºï¼Œ å…¶ä»–éœ€è¦ä½¿ç”¨å…±äº«èµ„æºçš„threadå‡ç­‰å¾…
 *
 *          nio - åŸºäº&quot;äº‹ä»¶é©±åŠ¨&quot; æ€æƒ³ï¼Œ é€šè¿‡ Reactoræ¨¡å¼ å®ç° ã€‚ æŸä¸ª thread è¿›è¡Œ è¯» or å†™æ“ä½œ å‡ä¸º éé˜»å¡çš„ ï¼ˆcpu å»å¤„ç†å…¶ä»–ä»»åŠ¡ï¼‰ã€‚ å½“ socket æœ‰ stream å¯è¯» æˆ– æœ‰ stream å¾…è¢« å†™å…¥ socket
 *          æ—¶, å‘å‡ºäº‹ä»¶(å¦‚ è¿æ¥å»ºç«‹äº‹ä»¶, æµè¯»å–äº‹ä»¶, æµå†™å…¥äº‹ä»¶), ç”±æ“ä½œç³»ç»Ÿé€šçŸ¥ appæ¥å¤„ç†
 *
 *      - å¼‚æ­¥io åˆ†ä¸º aio
 *
 *          aio - åŒæ ·åŸºäºäº‹ä»¶é©±åŠ¨, é€šè¿‡ Proactoræ¨¡å¼å®ç°;
 *          å’Œnioå¯¹æ¯”, 1. ç®€åŒ–ç¼–ç¨‹, ioæ“ä½œç”±æ“ä½œç³»ç»Ÿå®Œæˆ, appåªè¦è°ƒç”¨apiå³å¯; 2. çœç•¥äº† nioä¸­éœ€è¦éå† äº‹ä»¶é€šçŸ¥é˜Ÿåˆ—(Selector)
 *          çš„æ—¶é—´
 *
 * è¿™æ ·ç»„åˆçš„è¯, æœ‰å››ç§é€šä¿¡æ–¹å¼: tcp/ip + bio, tcp/ip  + nio, udp/ip + bio, udp/ip + nio
 *
 * *************************************************************************************************
 *
 * ä¸‹é¢æ˜¯ bio + tcp æ–¹å¼
 *
 * @author xiaoyu
 * @since 1.0
 */
public class Client {

    //private String url = &quot;127.0.0.1&quot;;
    //private int port = 9527;
    private Socket socket;
    private BufferedReader readerOnServer;
    private PrintWriter printerOnServer;
    private BufferedReader readerOnCli;

    public void init(String url, int port) throws IOException {
        socket = new Socket(url, port);
        readerOnServer = new BufferedReader(new InputStreamReader(socket.getInputStream()));
        printerOnServer = new PrintWriter(socket.getOutputStream(), true);
        readerOnCli   = new BufferedReader(new InputStreamReader(System.in));
    }

    public void start() throws IOException {
        while (true) {
            String line = readerOnCli.readLine();
            // exit
            if (testExit(line)) {
                break;
            }

            System.out.println(&quot;&gt;&gt;&gt; send to server: &quot; + line);
            // send to server
            printerOnServer.println(line);

            // receive from server
            String respLine = readerOnServer.readLine();
            System.out.println(&quot;&gt;&gt;&gt; receive from server: &quot; + respLine);
        }
    }

    private boolean testExit(String test) throws IOException {
        if (StringUtils.isBlank(test) || &quot;exit&quot;.equalsIgnoreCase(test)) {
            printerOnServer.write(&quot;exit&quot;);
            close();
            System.out.println(&quot;&gt;&gt;&gt; client exit.&quot;);
            return true;
        }
        return false;
    }

    private void close() throws IOException {
        printerOnServer.close();
        readerOnCli.close();
        readerOnServer.close();
        socket.close();
    }

    public static void main(String[] args) throws IOException {
        Client client = new Client();
        client.init(&quot;127.0.0.1&quot;, 9527);
        client.start();
    }
}

/**
 * è¿™ä¸ª server åªæ”¯æŒ å•ä¸ª client è¿æ¥
 *
 * å¤šä¸ª client è¿æ¥ serveræ€ä¹ˆåŠ? é¦–å…ˆè¦ pass æ‰ &quot;åœ¨ server ä¸­ åˆ›å»ºå¤šä¸ª socket&quot;çš„æƒ³æ³•, å› ä¸º ç”Ÿæˆ socket æ˜¯éå¸¸é‡çš„æ“ä½œ, å 
 * ç”¨serverèµ„æºéå¸¸å¤š
 *
 * é€šå¸¸ç”¨é‡‡ç”¨ &quot;è¿æ¥æ± &quot;, å¥½å¤„æ˜¯ ğŸ¶ èƒ½å¤Ÿé™åˆ¶åˆ›å»ºçš„ socketä¸ªæ•°; ğŸ¶ é¿å…é‡å¤åˆ›å»º socket
 * ä½†æ˜¯è¿™ç§æ–¹å¼è¿˜æ˜¯æœ‰é—®é¢˜: è¿æ¥æ± ä¸­ socket æ€»æ˜¯æœ‰é™çš„æ€»æœ‰ä¸å¤Ÿç”¨çš„æ—¶å€™; server éœ€è¦è®¾ç½®è¶…æ—¶æ—¶é—´, é˜²
 * æ­¢ server è¿å¸¦ clientæŒ‚æ‰
 *
 * å¦‚æœè¦æ”¯æŒå¤šä¸ª client è¿æ¥ï¼Œ å¯é‡‡ç”¨ çº¿ç¨‹æ± ï¼Œ æ¯ä¸ª socket æ–°å¼€ä¸€ä¸ª threadã€‚ è¿™ä¹ˆåšæœ‰ç¼ºç‚¹ï¼š æ— è®ºæ˜¯å¦æ˜¯æœ‰æ•ˆè¯·æ±‚ï¼Œ server
 * éƒ½è¦è€—è´¹ä¸€ä¸ª thread
 * å‘³äº†é¿å… è¿‡å¤šçš„ thread è€—å°½ serverçš„èµ„æºï¼Œ çº¿ç¨‹æ± å¿…é¡»æ˜¯é™å®šå¤§å°çš„ã€‚ &lt;=&gt; é‡‡ç”¨ bio æ–¹å¼çš„ server æ”¯æ’‘çš„è¿æ¥æ•°æ˜¯æœ‰é™çš„
 *
 * @author xiaoyu
 * @since 1.0
 */
public class Server {

    //private ServerSocket serverSocket;
    //private BufferedReader readerFromClient;
    //private PrintWriter writerToClient;
    //
    //public void initBlock(int port) throws IOException {
    //    this.serverSocket = new ServerSocket(port);
    //    this.readerFromClient = new BufferedReader(new InputStreamReader(serverSocket.accept().getInputStream()));
    //}

    public static void main(String[] args) throws IOException, InterruptedException {
        int port = 9527;
        ServerSocket socketServer = new ServerSocket(port);
        socketServer.setSoTimeout(60 * 1000); // unit : milliseconds
        System.out.println(&quot;&gt;&gt;&gt; server listen on port: &quot; + port);
        Socket socketClient = socketServer.accept(); // start

        BufferedReader readerFromClient = new BufferedReader(new InputStreamReader(socketClient.getInputStream()));
        //BufferedWriter writerToClient   = new BufferedWriter(new OutputStreamWriter(socketClient.getOutputStream()));
        PrintWriter writerToClient = new PrintWriter(socketClient.getOutputStream(), true);

        while (true) {
            String line = readerFromClient.readLine(); // start

            if (StringUtils.isBlank(line)) {// read nothing
                Thread.sleep(100);
                continue;
            }
            if (&quot;exit&quot;.equalsIgnoreCase(line)) {
                // close
                readerFromClient.close();
                writerToClient.close();
                socketServer.close();

                System.out.println(&quot;&gt;&gt;&gt; server exit&quot;);
                break;
            }

            System.out.println(&quot;&gt;&gt;&gt; msg from client: &quot; + line);

            writerToClient.println(line);
            System.out.println(&quot;&gt;&gt;&gt; msg to client: &quot; + line);
            Thread.sleep(100);
        }
        System.exit(0);

    }
}

/////////////////////////////////////////////

/**
 * åŸºäºæ¶ˆæ¯çš„æ–¹å¼å®ç°é€šä¿¡;
 * æ•°æ®ä¼ è¾“: tcp/ip
 * æ•°æ®å¤„ç†: nio
 *
 * @author xiaoyu
 * @since 1.0
 */
public class Client {

    //private Selector selector;
    //
    //public void init(String ip, int port) throws IOException {
    //    SocketChannel socketChannel = SocketChannel.open();
    //    socketChannel.configureBlocking(false); // configure channel as non blocking
    //    socketChannel.connect(new InetSocketAddress(ip, port));// å¯¹äº non blocking io, ç«‹å³è¿”å› false, è¡¨ç¤ºè¿æ¥å»ºç«‹ä¸­
    //                                            // ç”¨channel.finishConnect();æ‰èƒ½å®Œæˆè¿æ¥
    //    Selector selector = Selector.open();
    //    socketChannel.register(selector, SelectionKey.OP_CONNECT);
    //}
    //
    //public void listen() {
    //
    //}

    public static void main(String[] args) throws IOException {
        String ip = &quot;127.0.0.1&quot;;
        int port = 9527;

        SocketChannel socketChannel = SocketChannel.open();
        socketChannel.configureBlocking(false); // configure channel as non blocking
        // ä¼šç«‹å³è¿”å› false, è¡¨ç¤ºè¿æ¥å»ºç«‹ä¸­; è°ƒç”¨channel.finishConnect()æ‰èƒ½å®Œæˆè¿æ¥
        socketChannel.connect(new InetSocketAddress(ip, port));

        // register socket channel with selector, å¹¶æŒ‡å®šåªå¯¹ è¿æ¥ æ„Ÿå…´è¶£
        Selector selector = Selector.open();
        socketChannel.register(selector, SelectionKey.OP_CONNECT);

        BufferedReader readerOnCli = new BufferedReader(new InputStreamReader(System.in));
        while (true) {
            if (socketChannel.isConnected()) {// connection is established; send msg to server
                String line = readerOnCli.readLine();
                socketChannel.write(StandardCharsets.UTF_8.encode(line));

                if (&quot;exit&quot;.equalsIgnoreCase(line)) {
                    // exit
                    readerOnCli.close();
                    socketChannel.close();
                    selector.close();
                    System.out.println(&quot;&gt;&gt;&gt; client exit.&quot;);
                    break;
                }
            }

            // receive from server
            selector.select(60 * 1000);// timeout = 60 s
            Iterator&lt;SelectionKey&gt; it = selector.selectedKeys().iterator();
            while (it.hasNext()) {
                SelectionKey key = it.next();
                it.remove();// remove current key from key set to avoid repetition

                if (key.isConnectable()) {// event: è¿æ¥äº‹ä»¶
                    SocketChannel sc = (SocketChannel) key.channel();
                    sc.configureBlocking(false);
                    // - è¿™æ—¶, sc å¯¹ read äº‹ä»¶ä¹Ÿæ„Ÿå…´è¶£äº†;
                    // - ä¸€èˆ¬ä¸ä¼šç›´æ¥æ³¨å†Œ write äº‹ä»¶ å› ä¸ºåœ¨ buffer æœªæ»¡æ—¶ä¸€ç›´æ˜¯å¯å†™çš„, å› æ­¤å¦‚æœåœ¨æ³¨å†Œäº† write äº‹ä»¶è€Œåˆä¸ä½¿ç”¨
                    //   å®ƒæ—¶ cpu æ¶ˆè€—å¯èƒ½ä¼š100%
                    sc.register(selector, SelectionKey.OP_READ);

                    if (sc.isConnectionPending()) {// å¦‚æœè¿æ¥è¿˜æ²¡å®Œæˆï¼Œåˆ™å®Œæˆè¿æ¥çš„å»ºç«‹
                        sc.finishConnect();
                    }
                } else if (key.isReadable()) {// reading event
                    SocketChannel sc = (SocketChannel) key.channel();
                    ByteBuffer    buffer = ByteBuffer.allocate(1024);

                    int numRead = 0;
                    try {
                        int tmp = 0;
                        try {
                            // read æ“ä½œæ˜¯ block çš„ï¼Œ è¯»å–åˆ°æœ«å°¾ï¼Œ è¿”å› -1
                            while ((tmp = sc.read(buffer)) &gt; 0) {
                                numRead += tmp;
                            }
                        } finally {
                            buffer.flip();
                        }

                        if (numRead &gt; 0) {
                            System.out.println(&quot;&gt;&gt;&gt; msg from server: &quot; + StandardCharsets.UTF_8.decode(buffer).toString());
                            buffer = null;
                        }
                    } finally {
                        if (buffer != null) {
                            buffer.clear();
                        }
                    }

                }
            }

        }
    }
}

/**
 * tcp + nio
 * 
 * @author xiaoyu
 * @since 1.0
 */
public class Server {
    public static void main(String[] args) throws IOException {
        int                 port              = 9527;
        InetSocketAddress   inetSocketAddress = new InetSocketAddress(port);
        ServerSocketChannel ssc               = ServerSocketChannel.open();
        ssc.configureBlocking(false);
        ssc.socket().bind(inetSocketAddress);// retrieve server socket and bind to port

        // - register server socket channel with selector;
        //      - `selector.select()` will return directly instead of blocking if `OP_ACCEPT` occurred;
        //      - OP_ACCEPT means the type of the registration; in this case, selector merely reports that a client
        //          attempts a connection to the server; (Other possible options are: OP_CONNECT, which will be used by the client; OP_READ; and OP_WRITE.)
        Selector selector = Selector.open();
        ssc.register(selector, SelectionKey.OP_ACCEPT);
        System.out.println(&quot;&gt;&gt;&gt; server listen on port: &quot; + port);

        outLoop:
        while (true) {
            selector.select(60 * 1000); // block, wait for events recorded on the selector; timeout: 60s

            // work on selected keys
            Iterator&lt;SelectionKey&gt; it = selector.selectedKeys().iterator();
            while (it.hasNext()) {
                SelectionKey key = it.next();
                it.remove();// prevent the same key coming up again

                if (!key.isValid()) {
                    continue;
                }
                if (key.isAcceptable()) {// event: the associated client request a connection
                    // retrieve server socket channel from selector
                    ServerSocketChannel serverSocketChannel = (ServerSocketChannel) key.channel();
                    // create a socket channel which accepts the connection, creates a standard java socket
                    SocketChannel socketChannel = serverSocketChannel.accept();
                    socketChannel.configureBlocking(false);
                    System.out.println(&quot;&gt;&gt;&gt; connected to: &quot; + socketChannel.socket().getRemoteSocketAddress());

                    // register socket channel with selector, è¿™ä¸ª channelåªå¯¹ read æ„Ÿå…´è¶£
                    socketChannel.register(selector, SelectionKey.OP_READ);
                } else if (key.isReadable()) {// event: the server can read
                    SocketChannel sc     = (SocketChannel) key.channel();
                    ByteBuffer    buffer = ByteBuffer.allocate(1024);

                    int readBytes = 0;
                    try {
                        int tmp =  0;
                        try {
                            while ((tmp = sc.read(buffer)) &gt; 0) {
                                readBytes += tmp;
                            }
                        } finally {
                            buffer.flip();
                        }

                        if (readBytes &gt; 0) {
                            String data = StandardCharsets.UTF_8.decode(buffer).toString();
                            System.out.println(&quot;&gt;&gt;&gt; receive from client: &quot; + data);

                            if (&quot;exit&quot;.equalsIgnoreCase(data)) {
                                sc.close();
                                selector.close();
                                System.out.println(&quot;&gt;&gt;&gt; server closed&quot;);
                                break outLoop;  // æ¬åˆ°è¿™é‡Œå°±okäº†
                            }

                            sc.write(StandardCharsets.UTF_8.encode(data));
                            System.out.println(&quot;&gt;&gt;&gt; send to client: &quot; + data );
                        }
                    } finally {
                        if (buffer != null) {
                            buffer.clear();
                        }
                    }

                    //byte[] data = new byte[numRead];
                    //System.arraycopy(buffer, 0, data, 0, numRead);
                    //java.lang.String data = new java.lang.String(buffer.array());
                    //System.out.println(&quot;&gt;&gt;&gt; receive from client: &quot; + data);

                    //if (&quot;exit&quot;.equalsIgnoreCase(data)) {
                    //    sc.close();
                    //    selector.close();
                    //    System.out.println(&quot;&gt;&gt;&gt; server closed&quot;);
                    //    break outLoop;  // å­˜ç–‘ ä½¿ç”¨è¿™ç§æ–¹å¼ client å‘é€ exitï¼Œ è¿™é‡Œåé¢çš„ä»£ç ä»æ—§ä¼šæ‰§è¡Œ
                    //}

                    // send msg to client
                    //sc.write(StandardCharsets.UTF_8.encode(data));
                    //System.out.println(&quot;&gt;&gt;&gt; send to client: &quot; + data );
                }
            }
        }
    }
}

///////////////////////////////////////////

/**
 * udp é€šä¿¡æ— éœ€å»ºç«‹è¿æ¥ï¼Œ æ‰€ä»¥æ— æ³•åŒå‘é€šä¿¡ï¼Œ å¦‚éœ€åŒå‘é€šä¿¡ï¼Œ ä¸¤ç«¯éƒ½å¿…é¡»æ˜¯ server, ä¹Ÿå°±æ˜¯ client ä¹Ÿè¦æœ‰ç›‘å¬ç«¯å£
 *
 * @author xiaoyu
 * @since 1.0
 */
public class Client {
    public static void main(String[] args) throws Exception {
        int            remotePort          = 9527;// è¿œç¨‹ server ç«¯å£
        int            listenPort         = 9528;// æœ¬åœ°ç›‘å¬ç«¯å£

        DatagramSocket listenSocket  = new DatagramSocket(listenPort);
        byte[]         buffer        = new byte[65507];
        DatagramPacket receivePacket = new DatagramPacket(buffer, buffer.length);// æ¥æ”¶æ•°æ®æµå¯¹è±¡

        DatagramSocket socket   = new DatagramSocket();
        InetAddress    remoteAddr   = InetAddress.getByName(&quot;localhost&quot;);
        BufferedReader systemIn = new BufferedReader(new InputStreamReader(System.in));
        System.out.println(&quot;&gt;&gt;&gt; client listen on port : &quot; + listenPort);
        while (true) {
            String         line      = systemIn.readLine();
            byte[]         lineBytes = line.getBytes(StandardCharsets.UTF_8);
            DatagramPacket packetToRemote    = new DatagramPacket(lineBytes, lineBytes.length, remoteAddr, remotePort);// ä¼ é€æ•°æ®æµå¯¹è±¡
            socket.send(packetToRemote);
            System.out.println(&quot;&gt;&gt;&gt; send to server: &quot; + line);

            if (&quot;exit&quot;.equalsIgnoreCase(line.trim())) {
                System.out.println(&quot;&gt;&gt;&gt; Client quit!&quot;);
                socket.close();
                listenSocket.close();
                break;
            }

            listenSocket.receive(receivePacket);
            String receiveResponse = new String(receivePacket.getData(),
                    0, receivePacket.getLength(), StandardCharsets.UTF_8);
            System.out.println(&quot;&gt;&gt;&gt; receive from server: &quot; + receiveResponse);
        }
    }
}


/**
 * @author xiaoyu
 * @since 1.0
 */
public class Server {
    public static void main(String[] args) throws Exception{
        int            listenPort          =9527;
        int            remotePort         =9528;
        DatagramSocket server        =new DatagramSocket(listenPort);
        DatagramSocket client        =new DatagramSocket();
        InetAddress    serverAddress =InetAddress.getByName(&quot;localhost&quot;);
        byte[]         buffer        =new byte[65507];
        DatagramPacket packet        =new DatagramPacket(buffer,buffer.length);
        System.out.println(&quot;&gt;&gt;&gt; server listen on port : &quot; + listenPort);
        while(true){
            server.receive(packet);
            String line=new String(packet.getData(),0,packet.getLength(), StandardCharsets.UTF_8);
            if(&quot;exit&quot;.equalsIgnoreCase(line.trim())){
                server.close();
                client.close();
                System.exit(0);
            }
            else{
                System.out.println(&quot;&gt;&gt;&gt; Message from client: &quot;+ line);
                packet.setLength(buffer.length);
                byte[] lineBytes=line.getBytes(StandardCharsets.UTF_8);
                DatagramPacket responsePacket=new DatagramPacket(lineBytes,lineBytes.length,serverAddress,remotePort);
                client.send(responsePacket);
                System.out.println(&quot;&gt;&gt;&gt; send to client: &quot; + line);
                Thread.sleep(100);
            }
        }
    }
}

////////////////////////////////////////////

/**
 * DatagramChannel è´Ÿè´£ç›‘å¬ç«¯å£andè¯»å†™; ByteBuffer æ•°æ®ä¼ è¾“
 *
 * @author xiaoyu
 * @since 1.0
 */
public class Client {
    public static void main(String[] args) throws Exception{
        int listenPort=9528;
        int remotePort=9527;

        DatagramChannel receiveChannel=DatagramChannel.open();
        receiveChannel.configureBlocking(false);
        receiveChannel.socket().bind(new InetSocketAddress(listenPort));
        Selector selector= Selector.open();
        receiveChannel.register(selector, SelectionKey.OP_READ);

        DatagramChannel sendChannel =DatagramChannel.open();
        sendChannel.configureBlocking(false);
        sendChannel.connect(new InetSocketAddress(&quot;127.0.0.1&quot;,remotePort));

        BufferedReader systemIn =new BufferedReader(new InputStreamReader(System.in));

        while(true){
            String command=systemIn.readLine();
            sendChannel.write(Charset.forName(&quot;UTF-8&quot;).encode(command));
            if(&quot;quit&quot;.equalsIgnoreCase(command.trim())){
                systemIn.close();
                sendChannel.close();
                selector.close();
                System.out.println(&quot;Client quit!&quot;);
                System.exit(0);
            }
            int nKeys=selector.select(1000);
            if(nKeys&gt;0){
                for (SelectionKey key : selector.selectedKeys()) {
                    if(key.isReadable()){
                        ByteBuffer buffer= ByteBuffer.allocate(1024);
                        DatagramChannel dc=(DatagramChannel) key.channel();
                        dc.receive(buffer);
                        buffer.flip();
                        System.out.println(Charset.forName(&quot;UTF-8&quot;).decode(buffer).toString());
                    }
                }
                selector.selectedKeys().clear();
            }
        }
    }
}

/**
 * @author xiaoyu
 * @since 1.0
 */
public class Server {
    public static void main(String[] args) throws Exception{
        int rport=9527;
        int sport=9528;

        DatagramChannel sendChannel=DatagramChannel.open();
        sendChannel.configureBlocking(false);
        SocketAddress target =new InetSocketAddress(&quot;127.0.0.1&quot;,sport);
        sendChannel.connect(target);

        DatagramChannel receiveChannel =DatagramChannel.open();
        DatagramSocket  serverSocket   =receiveChannel.socket();
        serverSocket.bind(new InetSocketAddress(rport));
        System.out.println(&quot;Data receive listen on port: &quot;+rport);
        receiveChannel.configureBlocking(false);
        Selector selector= Selector.open();
        receiveChannel.register(selector, SelectionKey.OP_READ);
        while(true){
            int nKeys=selector.select(1000);
            if(nKeys&gt;0){
                for (SelectionKey key : selector.selectedKeys()) {
                    if(key.isReadable()){
                        ByteBuffer buffer= ByteBuffer.allocate(1024);
                        DatagramChannel dc=(DatagramChannel) key.channel();
                        dc.receive(buffer);
                        buffer.flip();
                        String message= Charset.forName(&quot;UTF-8&quot;).decode(buffer).toString();
                        System.out.println(&quot;Message from client: &quot;+ message);
                        if(&quot;quit&quot;.equalsIgnoreCase(message.trim())){
                            dc.close();
                            selector.close();
                            sendChannel.close();
                            System.out.println(&quot;Server has been shutdown!&quot;);
                            System.exit(0);
                        }
                        String outMessage=&quot;Server responseï¼š&quot;+message;
                        sendChannel.write(Charset.forName(&quot;UTF-8&quot;).encode(outMessage));
                    }
                }
                selector.selectedKeys().clear();
            }
        }
    }
}


</code></pre>
<h2><a class="header" href="#é˜»å¡-io" id="é˜»å¡-io">é˜»å¡ io</a></h2>
<h3><a class="header" href="#ä»€ä¹ˆæ˜¯é˜»å¡-io" id="ä»€ä¹ˆæ˜¯é˜»å¡-io">ä»€ä¹ˆæ˜¯é˜»å¡ io</a></h3>
<p>IO : æŒ‡çš„å°±æ˜¯åº”ç”¨ç¨‹åºè¯»å…¥/å†™å‡ºæ•°æ®çš„è¿‡ç¨‹ï¼Œå’Œç¨‹åºç­‰å¾…è¯»å…¥/å†™å‡ºæ•°æ®çš„è¿‡ç¨‹ã€‚ä¸€æ—¦æ‹¿åˆ°æ•°æ®åå°±å˜æˆäº†æ•°æ®æ“ä½œäº†ï¼Œå°±ä¸æ˜¯ IO äº†</p>
<p>é˜»å¡io: æ‹¿ç½‘ç»œ IO æ¥è¯´ï¼Œç­‰å¾…çš„è¿‡ç¨‹å°±æ˜¯æ•°æ®ä»ç½‘ç»œåˆ°ç½‘å¡å†åˆ°å†…æ ¸ç©ºé—´ã€‚è¯»å†™çš„è¿‡ç¨‹å°±æ˜¯å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´çš„ç›¸äº’æ‹·è´. åº”ç”¨ç¨‹åºéƒ½æ˜¯è¿è¡Œåœ¨ç”¨æˆ·ç©ºé—´çš„ï¼Œæ‰€ä»¥å®ƒä»¬èƒ½æ“ä½œçš„æ•°æ®ä¹Ÿéƒ½åœ¨ç”¨æˆ·ç©ºé—´ã€‚åªè¦æ•°æ®æ²¡æœ‰åˆ°è¾¾ç”¨æˆ·ç©ºé—´ï¼Œç”¨æˆ·çº¿ç¨‹å°±æ“ä½œä¸äº†. å¦‚æœæ­¤æ—¶ç”¨æˆ·çº¿ç¨‹å·²ç»å‚ä¸ï¼Œé‚£å®ƒä¸€å®šä¼šè¢«é˜»å¡åœ¨ IO ä¸Šã€‚è¿™å°±æ˜¯å¸¸è¯´çš„é˜»å¡ IOã€‚ç”¨æˆ·çº¿ç¨‹è¢«é˜»å¡åœ¨ç­‰å¾…æ•°æ®ä¸Šæˆ–æ‹·è´æ•°æ®ä¸Š.</p>
<p>éé˜»å¡ IO : å°±æ˜¯ç”¨æˆ·çº¿ç¨‹ä¸å‚ä¸ä»¥ä¸Šä¸¤ä¸ªè¿‡ç¨‹(æ•°æ®ä¼ è¾“, æ•°æ®æ‹·è´)ï¼Œå³æ•°æ®å·²ç»æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´åï¼Œæ‰å»é€šçŸ¥ç”¨æˆ·çº¿ç¨‹ï¼Œä¸€ä¸Šæ¥å°±å¯ä»¥ç›´æ¥æ“ä½œæ•°æ®äº†</p>
<p>é˜»å¡io å’Œéé˜»å¡ioåŒºåˆ«å°±æ˜¯ç”¨æˆ·çº¿ç¨‹ä¼šä¸ä¼šé˜»å¡åœ¨ç­‰å¾…æ•°æ®æˆ–è€…æ•°æ®æ‹·è´ä¸Š</p>
<h3><a class="header" href="#io-ä½“ç³»çš„æ•´ä¸ªæ¦‚è§ˆ" id="io-ä½“ç³»çš„æ•´ä¸ªæ¦‚è§ˆ">io ä½“ç³»çš„æ•´ä¸ªæ¦‚è§ˆ</a></h3>
<p>åŸºäºå­—èŠ‚æ“ä½œçš„ I/O æ¥å£ï¼šInputStream å’Œ OutputStream</p>
<p>åŸºäºå­—ç¬¦æ“ä½œçš„ I/O æ¥å£ï¼šWriter å’Œ Reader</p>
<p>å­—èŠ‚å­—ç¬¦è½¬æ¢æµ</p>
<p>åŸºäºç£ç›˜æ“ä½œçš„ I/O æ¥å£ï¼šFile</p>
<p>åŸºäºç½‘ç»œæ“ä½œçš„ I/O æ¥å£ï¼šSocket</p>
<pre><code class="language-java">
1. å­—èŠ‚æµ

1.1 å­—èŠ‚è¯»å–ï¼š

InputStream æ‰€æœ‰è¾“å…¥å­—èŠ‚æµçš„åŸºç±»  æŠ½è±¡ç±»
    FileInputStream è¯»å–æ–‡ä»¶æ•°æ®çš„è¾“å…¥å­—èŠ‚æµ
    BufferedInputStream  ç¼“å†²è¾“å…¥å­—ç¬¦æµ       è¯¥ç±»å‡ºç°çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜è¯»å–æ–‡ä»¶ æ•°æ®çš„æ•ˆç‡ã€‚ è¿™ä¸ªç±»å…¶å®åªä¸è¿‡æ˜¯åœ¨å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª8kbçš„å­—èŠ‚æ•°ç»„è€Œå·²ã€‚

1.2 å­—èŠ‚è¾“å‡ºï¼š

OutputStream æ‰€æœ‰è¾“å‡ºå­—èŠ‚æµçš„åŸºç±»ã€‚  æŠ½è±¡ç±»ã€‚
    FileOutputStream å‘æ–‡ä»¶è¾“å‡ºæ•°æ®çš„è¾“å‡ºå­—èŠ‚æµ
    BufferedOutputStream ç¼“å†²è¾“å‡ºå­—èŠ‚æµ   è¯¥ç±»å‡ºç°çš„ç›®çš„ä¹Ÿæ˜¯ä¸ºäº†æé«˜å‘æ–‡ä»¶å†™æ•°æ®çš„æ•ˆç‡ã€‚ è¿™ä¸ªç±»çš„ä¹Ÿåªä¸è¿‡æ˜¯åœ¨å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª8kbçš„å­—èŠ‚æ•°ç»„è€Œå·²ã€‚

2. å­—ç¬¦æµ : å­—ç¬¦æµ = å­—èŠ‚æµ + ç¼–ç ï¼ˆè§£ç ï¼‰

2.1 å­—ç¬¦è¯»å–:

Reader æ‰€æœ‰è¾“å…¥å­—ç¬¦æµçš„åŸºç±»ã€‚ æŠ½è±¡ç±»ã€‚
    FileReader è¯»å–æ–‡ä»¶æ•°æ®çš„è¾“å…¥å­—ç¬¦æµã€‚    å†…éƒ¨ç»´æŠ¤ä¸€ä¸ª1024å­—ç¬¦çš„å­—ç¬¦æ•°ç»„, è°ƒç”¨flushæˆ–è€…æ˜¯closeæ–¹æ³•æˆ–è€…æ˜¯å¡«æ»¡äº†å†…éƒ¨çš„å­—ç¬¦æ•°ç»„æ‰ä¼šçœŸæ­£å†™æ•°æ®åˆ°ç¡¬ç›˜
    BufferedReader ç¼“å†²è¾“å…¥å­—ç¬¦æµ           è¯¥ç±»å‡ºç°çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜è¯»å–æ–‡ä»¶æ•°æ®çš„æ•ˆç‡ä¸æ‹“å±•FileReaderçš„(readLine)åŠŸèƒ½ã€‚ è¿™ä¸ªç±»çš„ä¹Ÿåªä¸è¿‡æ˜¯åœ¨å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª8kbçš„å­—ç¬¦æ•°ç»„è€Œå·²ã€‚

2.2 å­—ç¬¦è¾“å‡º:

Writer æ‰€æœ‰è¾“å‡ºå­—ç¬¦æµçš„åŸºç±»ã€‚  æŠ½è±¡ç±»
    FileWriter å‘æ–‡ä»¶è¾“å‡ºæ•°æ®çš„è¾“å‡ºå­—ç¬¦æµ
    BufferedWriter ç¼“å†²è¾“å‡ºå­—ç¬¦æµ , æ‰‹åŠ¨ flush, æ‰‹åŠ¨ newLine()       è¯¥ç±»å‡ºç°çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜å†™æ–‡ä»¶æ•°æ®çš„æ•ˆç‡ä¸æ‹“å±•FileWriterçš„(newLine)åŠŸèƒ½.
    PrintWriter æ‰“å°è¾“å‡ºæµ, å­—ç¬¦å­—èŠ‚å‡å¯, å¯è®¾ç½®è‡ªåŠ¨flush, è‡ªåŠ¨æ¢è¡Œ , å¯ä»£æ›¿ bufferwriter; (https://blog.csdn.net/lyhkmm/article/details/78260207)

3. è½¬æ¢æµ

InputStreamReader   è¾“å…¥å­—èŠ‚æµçš„è½¬æ¢æµ ; ä½œç”¨ï¼šInputStream--------------------&gt; Reader
OutputStreamWriter  è¾“å‡ºå­—èŠ‚æµçš„è½¬æ¢æµ ; ä½œç”¨ï¼šOutputStream --------------------&gt; Writer

è½¬æ¢æµçš„ä½œç”¨ï¼š
    - å¯ä»¥æŠŠå­—èŠ‚æµè½¬æ¢æˆå­—ç¬¦æµä½¿ç”¨ã€‚
    - FileReaderä¸FileWriteréƒ½æ˜¯å›ºå®šæ˜¯gbkç è¡¨è¿›è¡Œè¯»å†™æ•°æ®çš„ï¼Œè€Œè½¬æ¢æµå¯ä»¥æŒ‡å®šç è¡¨è¿›è¡Œè¯»å†™æ–‡ä»¶çš„æ•°æ®ã€‚

4. File

File å¹¶ä¸ä»£è¡¨ä¸€ä¸ªçœŸå®å­˜åœ¨çš„æ–‡ä»¶å¯¹è±¡, è€Œä¸”å°±ç®—å­˜åœ¨è¿˜å¯èƒ½å¼æ–‡ä»¶orç›®å½•;

ä¸ºä½•è¦è¿™æ ·è®¾è®¡ï¼Ÿå› ä¸ºå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸å…³å¿ƒè¿™ä¸ªæ–‡ä»¶æ˜¯å¦çœŸçš„å­˜åœ¨ï¼Œè€Œæ˜¯å…³å¿ƒè¿™ä¸ªæ–‡ä»¶åˆ°åº•å¦‚ä½•æ“ä½œã€‚ä¾‹å¦‚æˆ‘ä»¬æ‰‹æœºé‡Œé€šå¸¸å­˜äº†å‡ ç™¾ä¸ªæœ‹å‹çš„ç”µè¯å·ç ï¼Œä½†æ˜¯æˆ‘ä»¬é€šå¸¸å…³å¿ƒçš„æ˜¯æˆ‘æœ‰æ²¡æœ‰è¿™ä¸ªæœ‹å‹çš„ç”µè¯å·ç ï¼Œæˆ–è€…è¿™ä¸ªç”µè¯å·ç æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯è¿™ä¸ªç”µè¯å·ç åˆ°åº•èƒ½ä¸èƒ½æ‰“é€šï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯æ—¶æ—¶åˆ»åˆ»éƒ½å»æ£€æŸ¥ï¼Œè€Œåªæœ‰åœ¨çœŸæ­£è¦ç»™ä»–æ‰“ç”µè¯æ—¶æ‰ä¼šçœ‹è¿™ä¸ªç”µè¯èƒ½ä¸èƒ½ç”¨ã€‚ä¹Ÿå°±æ˜¯ä½¿ç”¨è¿™ä¸ªç”µè¯è®°å½•è¦æ¯”æ‰“è¿™ä¸ªç”µè¯çš„æ¬¡æ•°å¤šå¾ˆå¤š


Properties(é…ç½®æ–‡ä»¶ç±»)

ä½“ç³»ï¼š
 -------| Map
 ------------| HashTable
 ----------------| Properties é…ç½®æ–‡ä»¶ç±»ã€

 store() ç”¨äºç”Ÿæˆä¸€ä¸ªé…ç½®æ–‡ä»¶
 load() åŠ è½½ä¸€ä¸ªé…ç½®æ–‡ä»¶

attention ï¼š
    - å¦‚æœé…ç½®æ–‡ä»¶å­˜åœ¨ç€ä¸­æ–‡ï¼Œé‚£ä¹ˆç”Ÿæˆé…ç½®æ–‡ä»¶çš„æ—¶å€™è¦ä½¿ç”¨å­—ç¬¦æµï¼Œå¦åˆ™ä¼šå‡ºç°ä¹±ç ã€‚
    - å¦‚æœéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶çš„å†…å®¹ï¼Œåº”è¯¥å…ˆåŠ è½½åŸæœ¬é…ç½®æ–‡ä»¶ï¼Œç„¶åå†ç”Ÿæˆä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚


</code></pre>
<h3><a class="header" href="#paths-å’Œ-files-ç›¸å…³-api" id="paths-å’Œ-files-ç›¸å…³-api">Paths å’Œ Files ç›¸å…³ api</a></h3>
<h4><a class="header" href="#paths-çš„è·å–è½¬åŒ–" id="paths-çš„è·å–è½¬åŒ–">Paths çš„è·å–è½¬åŒ–</a></h4>
<p>jdk 1.7 æä¾›</p>
<pre><code class="language-java">// Paths.get(&quot;C:/&quot;, &quot;Xmp&quot;); å’Œ Paths.get(&quot;C:/Xmp&quot;); ç­‰åŒ


Path pathRoot = Paths.get(&quot;/&quot;);// è¡¨ç¤ºç£ç›˜æ ¹è·¯å¾„
System.out.println(pathRoot.toAbsolutePath());// D:\

FileSystems.getDefault().getPath(&quot;C:/&quot;, &quot;aa.log&quot;) // ä»æ“ä½œç³»ç»Ÿè·å–

Paths.get(URI.create(&quot;file:///C:/Xmp/dd&quot;))

new File(&quot;C:/aa.log&quot;).toPath()

// è¡¨ç¤ºå½“å‰é¡¹ç›®æ ¹è·¯å¾„, ç­‰åŒ System.getProperty(&quot;user.dir&quot;), ç­‰åŒ new File(&quot;&quot;).getAbsoblutePath
// æ³¨æ„: system.getProperty(&quot;user.home&quot;)  è¡¨ç¤ºæ“ä½œç³»ç»Ÿ ç”¨æˆ·å®¶ç›®å½•, è€Œä¸æ˜¯å½“å‰é¡¹ç›®ç›®å½•
Path pathA  = Paths.get(&quot;.&quot;);
Path pathB = pathA.toAbsolutePath();
System.out.println(pathB);// D:\repo\repo_github\shared_already\xiaoyu-recipes\samples\java8-demo\.


Path path1 = Paths.get(this.getClass().getResource(&quot;.&quot;).toURI());
System.out.println(path1);
//D:\repo\repo_github\shared_already\starter-demo\target\classes\io\github\xiaoyureed\starterdemo\util

Path path2 = Paths.get(this.getClass().getClassLoader().getResource(&quot;.&quot;).toURI());
System.out.println(path2);
//D:\repo\repo_github\shared_already\starter-demo\target\classes

// è·å– class path æ¨èè¿™ç§æ–¹å¼
Path path3 = Paths.get(Thread.currentThread().getContextClassLoader().getResource(&quot;.&quot;).toURI());
System.out.println(path3);
//D:\repo\repo_github\shared_already\starter-demo\target\classes

</code></pre>
<h4><a class="header" href="#é€šè¿‡-files-paths-è¯»å–å†™å…¥" id="é€šè¿‡-files-paths-è¯»å–å†™å…¥">é€šè¿‡ Files Paths è¯»å–å†™å…¥</a></h4>
<pre><code class="language-java">private Path createFile(String dir, String file) throws IOException {
    Path dirPath = Paths.get(dir);
    if (Files.notExists(dirPath)) {
        Files.createDirectories(dirPath);
    }
    Path filePath = Paths.get(dir, file);
    if (Files.notExists(filePath)) {
        Files.createFile(filePath);// cannot create directory, only for file
    }

    return filePath;
}

/**
    * create a file
    *
    * write sth to the file
    *
    * read from the file
    */
@Test
public void testPaths_2() throws IOException {

    //Set&lt;PosixFilePermission&gt; perms = PosixFilePermissions.fromString(&quot;rw-rw-rw-&quot;);
    //FileAttribute&lt;Set&lt;PosixFilePermission&gt;&gt; attrs = PosixFilePermissions.asFileAttribute(perms);

    Path file = this.createFile(&quot;d:/_test&quot;, &quot;aa.log&quot;);

        // ä¹Ÿèƒ½ç›´æ¥ files.newbufferreader/writer(Paths.get(&quot;xxx.json&quot;))
        // reader.lines().collect(toList)
    try (BufferedWriter bufferedWriter = Files.newBufferedWriter(file, StandardCharsets.UTF_8)) {
        bufferedWriter.write(&quot;test writing file&quot;);
        bufferedWriter.flush();
    }

    try (BufferedReader bufferedReader = Files.newBufferedReader(file, StandardCharsets.UTF_8);) {
        for (;;) {
            String s = bufferedReader.readLine();
            if (s == null) {
                break;
            }
            System.out.println(s);
        }
    }
}
</code></pre>
<h4><a class="header" href="#éå†æ–‡ä»¶å¤¹" id="éå†æ–‡ä»¶å¤¹">éå†æ–‡ä»¶å¤¹</a></h4>
<pre><code class="language-java">/**
     * æ²¡æœ‰é€’å½’çš„éå†
     *
     * åªä¼šéå†ç¬¬ä¸€å±‚ç›®å½•
     */
    @Test
    public void testTraverse() throws IOException {
        Path path = Paths.get(&quot;d:/_learn/&quot;);
        DirectoryStream&lt;Path&gt; dirStream = Files.newDirectoryStream(path);

        if (!Files.isDirectory(path)) {
            System.out.println(&quot;path is not a dir, path = &quot; + path.toAbsolutePath().toString());
        }
        dirStream.forEach(p -&gt; System.out.println(p.getFileName()));
    }

    /**
     * ç­‰ä»·
     */
    @Test
    public void testTraverse_1() throws IOException {
        Path path = Paths.get(&quot;d:/_learn&quot;);
        Stream&lt;Path&gt; dirStream = Files.list(path);
        Iterator&lt;Path&gt; it = dirStream.iterator();
        while (it.hasNext()) {
            Path next = it.next();
            System.out.println(next.getFileName());
        }
    }

    /**
     * é€’å½’éå†
     */
    @Test
    public void testTraverse_2() throws IOException {
        Path path = Paths.get(&quot;d:/_learn&quot;);
        ArrayList&lt;Path&gt; result = new ArrayList&lt;&gt;();
        Files.walkFileTree(path, new SimpleFileVisitor&lt;Path&gt;() {
            @Override
            public FileVisitResult visitFile(Path file, BasicFileAttributes attrs) throws IOException {
                if (file.toString().endsWith(&quot;.php&quot;)) {
                    result.add(file);
                }

                return super.visitFile(file, attrs);
            }
        });

        result.forEach(System.out::println);
    }

    /**
     * é€’å½’éå†, ç­‰ä»·ä¸Šé¢
     */
    @Test
    public void testTraverse_3() throws IOException {
        Path path = Paths.get(&quot;d:/_learn&quot;);
        Stream&lt;Path&gt; stream = Files.walk(path);
        List&lt;Path&gt; result = stream.map(p -&gt; p.toString().endsWith(&quot;.php&quot;) ? p : null)
                .distinct()
                .collect(Collectors.toList());
        result.forEach(System.out::println);
    }
</code></pre>
<h4><a class="header" href="#é€šè¿‡-files-è·å–æ–‡ä»¶å±æ€§" id="é€šè¿‡-files-è·å–æ–‡ä»¶å±æ€§">é€šè¿‡ files è·å–æ–‡ä»¶å±æ€§</a></h4>
<pre><code class="language-java"> /**
     * æ–‡ä»¶å±æ€§
     */
    @Test
    public void testFileProperty() throws IOException {
        Path zip = Paths.get(&quot;d:/_test/aa.log&quot;);
        System.out.println(Files.getLastModifiedTime(zip));
        System.out.println(Files.size(zip));
        System.out.println(Files.isSymbolicLink(zip));
        System.out.println(Files.isDirectory(zip));
        System.out.println(Files.readAttributes(zip, &quot;*&quot;));// map, æ‰€æœ‰å±æ€§

        // 2019-05-22T14:34:24.320402Z
        // 17
        // false
        // false
        // {lastAccessTime=2019-05-22T14:21:24.821534Z, lastModifiedTime=2019-05-22T14:34:24.320402Z, size=17, creationTime=2019-05-22T14:21:24.821534Z, isSymbolicLink=false, isRegularFile=true, fileKey=null, isOther=false, isDirectory=false}

    }
</code></pre>
<h3><a class="header" href="#bio-tcp-å®ç°é€šä¿¡" id="bio-tcp-å®ç°é€šä¿¡">bio tcp å®ç°é€šä¿¡</a></h3>
<p><img src="Snipaste_2018-12-24_18-19-15.png" alt="alt" /></p>
<p>(æ›´å¤šè§è¿™é‡Œ distributed-System#æ€ä¹ˆå®ç°å­ç³»ç»Ÿé—´çš„é€šä¿¡)</p>
<pre><code class="language-java">/**
 * ç³»ç»Ÿé—´è¿›è¡Œé€šä¿¡ï¼Œ éœ€è¦ä¸¤ä¸ªæ­¥éª¤ï¼š
 *
 * - æ•°æ®ä¼ è¾“.  - å€ŸåŠ© tcp/ip, æˆ– udp/ip åè®®
 *
 * - æ•°æ®å¤„ç†ï¼ˆè¯»å–or å†™å…¥ï¼‰ - åŒæ­¥io æˆ–è€… å¼‚æ­¥io
 *
 *      - åŒæ­¥ioåˆ†ä¸º bio, nio
 *
 *          bio - å½“å‘èµ·ioæ“ä½œ, çº¿ç¨‹é—´ä¸ºé˜»å¡å…³ç³», å½“å‰ thread åªæœ‰å°†æµè¯»å–/å†™å…¥å®Œæ¯•æ‰ä¼šé‡Šæ”¾èµ„æºç»™å…¶ä»–ç­‰å¾…çš„ thread
 *
 *          nio - åŸºäº&quot;äº‹ä»¶é©±åŠ¨&quot; é€šè¿‡ Reactoræ¨¡å¼ å®ç°   thread é—´éé˜»å¡, å½“ socket æœ‰ stream å¯è¯» æˆ– æœ‰ stream å¾…è¢« socket
 *          å†™å…¥æ—¶, å‘å‡ºäº‹ä»¶(å¦‚ è¿æ¥å»ºç«‹äº‹ä»¶, æµè¯»å–äº‹ä»¶, æµå†™å…¥äº‹ä»¶), ç”±æ“ä½œç³»ç»Ÿé€šçŸ¥ appæ¥å¤„ç†
 *
 *      - å¼‚æ­¥io åˆ†ä¸º aio
 *
 *          aio - åŒæ ·åŸºäºäº‹ä»¶é©±åŠ¨, é€šè¿‡ Proactoræ¨¡å¼å®ç°;
 *          å’Œnioå¯¹æ¯”, 1. ç®€åŒ–ç¼–ç¨‹, ioæ“ä½œç”±æ“ä½œç³»ç»Ÿå®Œæˆ, appåªè¦è°ƒç”¨apiå³å¯; 2. çœç•¥äº† nioä¸­éœ€è¦éå† äº‹ä»¶é€šçŸ¥é˜Ÿåˆ—(Selector)
 *          çš„æ—¶é—´
 *
 * è¿™æ ·ç»„åˆçš„è¯, æœ‰å››ç§é€šä¿¡æ–¹å¼: tcp/ip + bio, tcp/ip  + nio, udp/ip + bio, udp/ip + nio
 *
 * *************************************************************************************************
 *
 * ä¸‹é¢æ˜¯ bio + tcp æ–¹å¼
 *
 * @author xiaoyu
 * @since 1.0
 */
public class Client {

    //private String url = &quot;127.0.0.1&quot;;
    //private int port = 9527;
    private Socket socket;
    private BufferedReader readerOnServer;
    private PrintWriter printerOnServer;
    private BufferedReader readerOnCli;

    public void init(String url, int port) throws IOException {
        socket = new Socket(url, port);
        readerOnServer = new BufferedReader(new InputStreamReader(socket.getInputStream()));
        printerOnServer = new PrintWriter(socket.getOutputStream(), true);
        readerOnCli   = new BufferedReader(new InputStreamReader(System.in));
    }

    public void start() throws IOException {
        while (true) {
            String line = readerOnCli.readLine();
            // exit
            if (testExit(line)) {
                break;
            }

            System.out.println(&quot;&gt;&gt;&gt; send to server: &quot; + line);
            // send to server
            printerOnServer.println(line);

            // receive from server
            String respLine = readerOnServer.readLine();
            System.out.println(&quot;&gt;&gt;&gt; receive from server: &quot; + respLine);
        }
    }

    private boolean testExit(String test) throws IOException {
        if (StringUtils.isBlank(test) || &quot;exit&quot;.equalsIgnoreCase(test)) {
            printerOnServer.write(&quot;exit&quot;);
            close();
            System.out.println(&quot;&gt;&gt;&gt; client exit.&quot;);
            return true;
        }
        return false;
    }

    private void close() throws IOException {
        printerOnServer.close();
        readerOnCli.close();
        readerOnServer.close();
        socket.close();
    }

    public static void main(String[] args) throws IOException {
        Client client = new Client();
        client.init(&quot;127.0.0.1&quot;, 9527);
        client.start();
    }
}

/**
 * è¿™ä¸ª server åªæ”¯æŒ å•ä¸ª client è¿æ¥
 *
 * å¤šä¸ª client è¿æ¥ serveræ€ä¹ˆåŠ? é¦–å…ˆè¦ pass æ‰ &quot;åœ¨ server ä¸­ åˆ›å»ºå¤šä¸ª socket&quot;çš„æƒ³æ³•, å› ä¸º ç”Ÿæˆ socket æ˜¯éå¸¸é‡çš„æ“ä½œ, å 
 * ç”¨serverèµ„æºéå¸¸å¤š
 *
 * é€šå¸¸ç”¨é‡‡ç”¨ &quot;è¿æ¥æ± &quot;, å¥½å¤„æ˜¯ ğŸ¶ èƒ½å¤Ÿé™åˆ¶åˆ›å»ºçš„ socketä¸ªæ•°; ğŸ¶ é¿å…é‡å¤åˆ›å»º socket
 * ä½†æ˜¯è¿™ç§æ–¹å¼è¿˜æ˜¯æœ‰é—®é¢˜: è¿æ¥æ± ä¸­ socket æ€»æ˜¯æœ‰é™çš„æ€»æœ‰ä¸å¤Ÿç”¨çš„æ—¶å€™; server éœ€è¦è®¾ç½®è¶…æ—¶æ—¶é—´, é˜²
 * æ­¢ server è¿å¸¦ clientæŒ‚æ‰
 *
 * å¦‚æœè¦æ”¯æŒå¤šä¸ª client è¿æ¥ï¼Œ å¯é‡‡ç”¨ çº¿ç¨‹æ± ï¼Œ æ¯ä¸ª socket æ–°å¼€ä¸€ä¸ª threadã€‚ è¿™ä¹ˆåšæœ‰ç¼ºç‚¹ï¼š æ— è®ºæ˜¯å¦æ˜¯æœ‰æ•ˆè¯·æ±‚ï¼Œ server
 * éƒ½è¦è€—è´¹ä¸€ä¸ª thread
 * å‘³äº†é¿å… è¿‡å¤šçš„ thread è€—å°½ serverçš„èµ„æºï¼Œ çº¿ç¨‹æ± å¿…é¡»æ˜¯é™å®šå¤§å°çš„ã€‚ &lt;=&gt; é‡‡ç”¨ bio æ–¹å¼çš„ server æ”¯æ’‘çš„è¿æ¥æ•°æ˜¯æœ‰é™çš„
 *
 * @author xiaoyu
 * @since 1.0
 */
public class Server {

    //private ServerSocket serverSocket;
    //private BufferedReader readerFromClient;
    //private PrintWriter writerToClient;
    //
    //public void initBlock(int port) throws IOException {
    //    this.serverSocket = new ServerSocket(port);
    //    this.readerFromClient = new BufferedReader(new InputStreamReader(serverSocket.accept().getInputStream()));
    //}

    public static void main(String[] args) throws IOException, InterruptedException {
        int port = 9527;
        ServerSocket socketServer = new ServerSocket(port);
        socketServer.setSoTimeout(60 * 1000); // unit : milliseconds
        System.out.println(&quot;&gt;&gt;&gt; server listen on port: &quot; + port);
        Socket socketClient = socketServer.accept(); // start

        BufferedReader readerFromClient = new BufferedReader(new InputStreamReader(socketClient.getInputStream()));
        //BufferedWriter writerToClient   = new BufferedWriter(new OutputStreamWriter(socketClient.getOutputStream()));
        PrintWriter writerToClient = new PrintWriter(socketClient.getOutputStream(), true);

        while (true) {
            String line = readerFromClient.readLine(); // start

            if (StringUtils.isBlank(line)) {// read nothing
                Thread.sleep(100);
                continue;
            }
            if (&quot;exit&quot;.equalsIgnoreCase(line)) {
                // close
                readerFromClient.close();
                writerToClient.close();
                socketServer.close();

                System.out.println(&quot;&gt;&gt;&gt; server exit&quot;);
                break;
            }

            System.out.println(&quot;&gt;&gt;&gt; msg from client: &quot; + line);

            writerToClient.println(line);
            System.out.println(&quot;&gt;&gt;&gt; msg to client: &quot; + line);
            Thread.sleep(100);
        }
        System.exit(0);

    }
}


</code></pre>
<h2><a class="header" href="#éé˜»å¡-io" id="éé˜»å¡-io">éé˜»å¡ io</a></h2>
<h3><a class="header" href="#ä»€ä¹ˆæ˜¯éé˜»å¡-io" id="ä»€ä¹ˆæ˜¯éé˜»å¡-io">ä»€ä¹ˆæ˜¯éé˜»å¡ io</a></h3>
<p>ç”¨æˆ·çº¿ç¨‹æ²¡æœ‰å› ä¸º IO çš„äº‹æƒ…å‡ºç°é˜»å¡ï¼Œè¿™å°±æ˜¯å¸¸è¯´çš„éé˜»å¡ IO, å³æ•°æ®å·²ç»æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´åï¼Œæ‰å»é€šçŸ¥ç”¨æˆ·çº¿ç¨‹ï¼Œä¸€ä¸Šæ¥å°±å¯ä»¥ç›´æ¥æ“ä½œæ•°æ®äº†ã€‚</p>
<p>ä¼ ç»Ÿ io(block io) ä¸ç®¡æ˜¯ç£ç›˜ I/O è¿˜æ˜¯ç½‘ç»œ I/Oï¼Œæ•°æ®åœ¨å†™å…¥ OutputStream æˆ–è€…ä» InputStream è¯»å–æ—¶ç”¨æˆ·çº¿ç¨‹éƒ½æœ‰å¯èƒ½ä¼šé˜»å¡, ä¸€æ—¦æœ‰çº¿ç¨‹é˜»å¡å°†ä¼šå¤±å» CPU çš„ä½¿ç”¨æƒ</p>
<p>nio ä½¿å¾— server ä½¿ç”¨ ä¸€ä¸ª thread å¯ä»¥å¤„ç†å¤šä¸ª client çš„è¯·æ±‚</p>
<h3><a class="header" href="#åŒæ­¥å¼‚æ­¥å’Œé˜»å¡éé˜»å¡" id="åŒæ­¥å¼‚æ­¥å’Œé˜»å¡éé˜»å¡">åŒæ­¥å¼‚æ­¥å’Œé˜»å¡éé˜»å¡</a></h3>
<h4><a class="header" href="#åŒæ­¥ä¸å¼‚æ­¥" id="åŒæ­¥ä¸å¼‚æ­¥">åŒæ­¥ä¸å¼‚æ­¥</a></h4>
<p>å½¢å®¹å¤šä¸ªäº‹ç‰©ä¹‹é—´çš„è¿è¡Œå…³ç³», å¯ä»¥å½¢å®¹ æ–¹æ³•, çº¿ç¨‹, cpu æŒ‡ä»¤...</p>
<p>åŒæ­¥å°±æ˜¯å¤šä¸ªäº‹ç‰©ä¸èƒ½åŒæ—¶å¼€å·¥ï¼Œå¼‚æ­¥å°±æ˜¯å¤šä¸ªäº‹ç‰©å¯ä»¥åŒæ—¶å¼€å·¥</p>
<h4><a class="header" href="#é˜»å¡ä¸éé˜»å¡" id="é˜»å¡ä¸éé˜»å¡">é˜»å¡ä¸éé˜»å¡</a></h4>
<p>å½¢å®¹ä¸€ç§äº‹ç‰©çŠ¶æ€</p>
<p>çº¿ç¨‹é˜»å¡äº†, è¡¨æ˜çº¿ç¨‹è¢«æŒ‚èµ·, ä¸èƒ½åŠ¨äº†, è®©å‡ºäº† CPU</p>
<h4><a class="header" href="#å››ç§ç»„åˆ" id="å››ç§ç»„åˆ">å››ç§ç»„åˆ</a></h4>
<ul>
<li>
<p>åŒæ­¥é˜»å¡, ç›¸å½“äºä¸€ä¸ªçº¿ç¨‹åœ¨ç­‰å¾…</p>
<p>ä¾‹å¦‚ java bio, I/O æ€§èƒ½ä¸€èˆ¬å¾ˆå·®ï¼ŒCPU å¤§éƒ¨åˆ†åœ¨ç©ºé—²çŠ¶æ€ã€‚</p>
</li>
<li>
<p>åŒæ­¥éé˜»å¡, ç›¸å½“äºä¸€ä¸ªçº¿ç¨‹åœ¨æ­£å¸¸è¿è¡Œ</p>
<p>java nio</p>
</li>
<li>
<p>å¼‚æ­¥éé˜»å¡ - ç”¨æˆ·çº¿ç¨‹çš„ç»§ç»­æ‰§è¡Œï¼Œå’Œæ“ä½œç³»ç»Ÿå‡†å¤‡ IO æ•°æ®çš„è¿‡ç¨‹æ˜¯åŒæ—¶è¿›è¡Œçš„ï¼Œå› æ­¤æ‰å«åšå¼‚æ­¥ IO</p>
<p>java aio</p>
</li>
</ul>
<h2><a class="header" href="#å¤šè·¯å¤ç”¨-io-å³-java-nio" id="å¤šè·¯å¤ç”¨-io-å³-java-nio">å¤šè·¯å¤ç”¨ IO å³ java nio</a></h2>
<h3><a class="header" href="#è§£é‡Šå¤šè·¯å¤ç”¨" id="è§£é‡Šå¤šè·¯å¤ç”¨">è§£é‡Šå¤šè·¯å¤ç”¨</a></h3>
<p>å¤šç§æ•°æ®ä¿¡å·æ··åˆåœ¨ä¸€èµ·, é€šè¿‡ä¸€æ¡é€šè·¯ä¼ è¾“, æœ€ç»ˆé€šè¿‡å„è‡ªç‰¹å®šçš„å¤„ç†å™¨å¤„ç†</p>
<p>æ¯”å¦‚ ç½‘ç»œ io, æœåŠ¡å™¨ç«¯çš„å·¥ä½œçº¿ç¨‹ä¸ä¼šæŠŠæ—¶é—´èŠ±åœ¨â€œç­‰å¾…æ•°æ®â€ä¸Š, ä½†æ˜¯ä¼šèŠ±åœ¨ç­‰å¾…â€œè¯»å–æ•°æ®â€è¿™ä¸ªè¿‡ç¨‹ä¸Š</p>
<h3><a class="header" href="#nio-å’Œ-io-åŒºåˆ«" id="nio-å’Œ-io-åŒºåˆ«">nio å’Œ io åŒºåˆ«</a></h3>
<p>1)IO æ˜¯é¢å‘æµçš„ï¼ŒNIO æ˜¯é¢å‘ç¼“å†²åŒºçš„ï¼›</p>
<p>2)IO æµæ˜¯é˜»å¡çš„ï¼ŒNIO æµæ˜¯ä¸é˜»å¡çš„;</p>
<p>3)NIO æœ‰é€‰æ‹©å™¨ï¼Œè€Œ IO æ²¡æœ‰ã€‚</p>
<p>é˜»å¡io: æ‹¿ç½‘ç»œ IO æ¥è¯´ï¼Œç­‰å¾…çš„è¿‡ç¨‹å°±æ˜¯æ•°æ®ä»ç½‘ç»œåˆ°ç½‘å¡å†åˆ°å†…æ ¸ç©ºé—´ã€‚è¯»å†™çš„è¿‡ç¨‹å°±æ˜¯å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´çš„ç›¸äº’æ‹·è´. åº”ç”¨ç¨‹åºéƒ½æ˜¯è¿è¡Œåœ¨ç”¨æˆ·ç©ºé—´çš„ï¼Œæ‰€ä»¥å®ƒä»¬èƒ½æ“ä½œçš„æ•°æ®ä¹Ÿéƒ½åœ¨ç”¨æˆ·ç©ºé—´ã€‚åªè¦æ•°æ®æ²¡æœ‰åˆ°è¾¾ç”¨æˆ·ç©ºé—´ï¼Œç”¨æˆ·çº¿ç¨‹å°±æ“ä½œä¸äº†. å¦‚æœæ­¤æ—¶ç”¨æˆ·çº¿ç¨‹å·²ç»å‚ä¸ï¼Œé‚£å®ƒä¸€å®šä¼šè¢«é˜»å¡åœ¨ IO ä¸Šã€‚è¿™å°±æ˜¯å¸¸è¯´çš„é˜»å¡ IOã€‚ç”¨æˆ·çº¿ç¨‹è¢«é˜»å¡åœ¨ç­‰å¾…æ•°æ®ä¸Šæˆ–æ‹·è´æ•°æ®ä¸Š.</p>
<p>éé˜»å¡ IO : å°±æ˜¯ç”¨æˆ·çº¿ç¨‹ä¸å‚ä¸ä»¥ä¸Šä¸¤ä¸ªè¿‡ç¨‹(æ•°æ®ä¼ è¾“, æ•°æ®æ‹·è´)ï¼Œå³æ•°æ®å·²ç»æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´åï¼Œæ‰å»é€šçŸ¥ç”¨æˆ·çº¿ç¨‹ï¼Œä¸€ä¸Šæ¥å°±å¯ä»¥ç›´æ¥æ“ä½œæ•°æ®äº†</p>
<p>é˜»å¡io å’Œéé˜»å¡ioåŒºåˆ«å°±æ˜¯ç”¨æˆ·çº¿ç¨‹ä¼šä¸ä¼šé˜»å¡åœ¨ç­‰å¾…æ•°æ®æˆ–è€…æ•°æ®æ‹·è´ä¸Š</p>
<h3><a class="header" href="#linux-ä¸­çš„å¤šè·¯å¤ç”¨æ”¯æŒ" id="linux-ä¸­çš„å¤šè·¯å¤ç”¨æ”¯æŒ">Linux ä¸­çš„å¤šè·¯å¤ç”¨æ”¯æŒ</a></h3>
<p>Linuxä¸‹çš„selectã€pollå’Œepollå°±æ˜¯å¹²è¿™ä¸ªçš„ã€‚å°†ç”¨æˆ·socketå¯¹åº”çš„fdæ³¨å†Œè¿›epollï¼Œç„¶åepollå¸®ä½ ç›‘å¬å“ªäº›socketä¸Šæœ‰æ¶ˆæ¯åˆ°è¾¾</p>
<p>è¿™æ ·ï¼Œæ•´ä¸ªè¿‡ç¨‹åªåœ¨è°ƒç”¨selectã€pollã€epollè¿™äº›è°ƒç”¨çš„æ—¶å€™æ‰ä¼šé˜»å¡ï¼Œæ”¶å‘å®¢æˆ·æ¶ˆæ¯æ˜¯ä¸ä¼šé˜»å¡çš„ï¼Œæ•´ä¸ªè¿›ç¨‹æˆ–è€…çº¿ç¨‹å°±è¢«å……åˆ†åˆ©ç”¨èµ·æ¥ï¼Œè¿™å°±æ˜¯äº‹ä»¶é©±åŠ¨ï¼Œæ‰€è°“çš„reactoræ¨¡å¼</p>
<h3><a class="header" href="#æ ¸å¿ƒç»„ä»¶" id="æ ¸å¿ƒç»„ä»¶">æ ¸å¿ƒç»„ä»¶</a></h3>
<p>java nio å°±æ˜¯ å¤šè·¯å¤ç”¨æ€æƒ³çš„å®ç°</p>
<h4><a class="header" href="#ç†è§£" id="ç†è§£">ç†è§£</a></h4>
<p>Selector å¯ä»¥åŒæ—¶ç›‘å¬ä¸€ç»„é€šä¿¡ä¿¡é“ï¼ˆChannelï¼‰ä¸Šçš„ I/O çŠ¶æ€</p>
<p>selectionKeys è¡¨ç¤º å„ä¸ª client çš„è¯·æ±‚</p>
<p>å¦å¤– , å‚è€ƒè¿™é‡Œ: https://tech.meituan.com/nio.html</p>
<h4><a class="header" href="#channels" id="channels">Channels</a></h4>
<p>NIO Channel é€šé“å’Œæµçš„åŒºåˆ«:</p>
<h4><a class="header" href="#buffers" id="buffers">Buffers</a></h4>
<p>å’Œ channel äº¤äº’</p>
<ul>
<li>
<p>ä» Channel ä¸­è¯»å–æ•°æ®åˆ° buffers é‡Œï¼Œä» Buffer æŠŠæ•°æ®å†™å…¥åˆ° Channelsï¼›</p>
</li>
<li>
<p>Buffer æœ¬è´¨ä¸Šå°±æ˜¯ä¸€å—å†…å­˜åŒº</p>
</li>
<li>
<p>capacity å®¹é‡ã€position ä½ç½®ã€limit é™åˆ¶ã€‚</p>
</li>
</ul>
<p>api:</p>
<pre><code class="language-java">ByteBuffer buf = ByteBuffer.allocate(28);//ä»¥ByteBufferä¸ºä¾‹å­
int bytesRead = inChannel.read(buf); //read into buffer.
buf.put(127);// put data into buf

</code></pre>
<h4><a class="header" href="#selectors" id="selectors">Selectors</a></h4>
<p>å…¶å®å¯¹äºé€‰æ‹©å™¨çš„ä¸ªæ•°ã€é€‰æ‹©å™¨è¿è¡Œåœ¨å“ªä¸ªçº¿ç¨‹é‡Œã€æ˜¯å¦ä½¿ç”¨æ–°çš„çº¿ç¨‹æ¥å¤„ç†è¯·æ±‚éƒ½æ²¡æœ‰è¦æ±‚ï¼Œè¦æ ¹æ®å®é™…æƒ…å†µæ¥å®šã€‚</p>
<p>æ¯”å¦‚è¯´ redisï¼Œå’Œå¤„ç†è¯·æ±‚ç›¸å…³çš„å°±ä¸€ä¸ªçº¿ç¨‹ï¼Œé€‰æ‹©å™¨è¿è¡Œåœ¨é‡Œé¢ï¼Œå¤„ç†è¯·æ±‚çš„ç¨‹åºä¹Ÿè¿è¡Œåœ¨é‡Œé¢ï¼Œæ‰€ä»¥è¿™ä¸ªçº¿ç¨‹æ—¢æ˜¯ I/O çº¿ç¨‹ï¼Œä¹Ÿæ˜¯ Worker çº¿ç¨‹ã€‚</p>
<p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸¤ä¸ªé€‰æ‹©å™¨ï¼Œä¸€ä¸ªå¤„ç† OP_ACCEPTï¼Œä¸€ä¸ªå¤„ç† OP_READï¼Œè®©å®ƒä»¬åˆ†åˆ«è¿è¡Œåœ¨ä¸¤ä¸ªå•ç‹¬çš„ I/O çº¿ç¨‹é‡Œã€‚å¯¹äºèƒ½å¿«é€Ÿå®Œæˆçš„æ“ä½œå¯ä»¥ç›´æ¥åœ¨ I/O çº¿ç¨‹é‡Œåšäº†ï¼Œå¯¹äºéå¸¸è€—æ—¶çš„æ“ä½œä¸€å®šè¦ä½¿ç”¨ Worker çº¿ç¨‹æ± æ¥å¤„ç†ã€‚</p>
<p>è¿™ç§å¤„ç†æ¨¡å¼å°±æ˜¯è¢«ç§°ä¸ºçš„å¤šè·¯å¤ç”¨ I/Oï¼Œå¤šè·¯æŒ‡çš„æ˜¯å¤šä¸ª Socket é€šé“ï¼Œå¤ç”¨æŒ‡çš„æ˜¯åªç”¨ä¸€ä¸ªçº¿ç¨‹æ¥ç®¡ç†å®ƒä»¬ã€‚</p>
<h3><a class="header" href="#nio-å®ç°ç½‘ç»œé€šä¿¡" id="nio-å®ç°ç½‘ç»œé€šä¿¡">nio å®ç°ç½‘ç»œé€šä¿¡</a></h3>
<p>ä»é€šé“è¿›è¡Œæ•°æ®è¯»å– ï¼šåˆ›å»ºä¸€ä¸ªç¼“å†²åŒºï¼Œç„¶åè¯·æ±‚é€šé“è¯»å–æ•°æ®ã€‚</p>
<p>ä»é€šé“è¿›è¡Œæ•°æ®å†™å…¥ ï¼šåˆ›å»ºä¸€ä¸ªç¼“å†²åŒºï¼Œå¡«å……æ•°æ®ï¼Œå¹¶è¦æ±‚é€šé“å†™å…¥æ•°æ®ã€‚</p>
<p>çœ‹ä¸ªä¾‹å­ - nio + tcp å®ç°é€šä¿¡ (https://examples.javacodegeeks.com/core-java/nio/java-nio-socket-example/)</p>
<p><img src="Snipaste_2018-12-24_18-21-12.png" alt="alt" /></p>
<p>è§ distributed-System#æ€ä¹ˆå®ç°å­ç³»ç»Ÿé—´çš„é€šä¿¡</p>
<pre><code class="language-java">/**
nio å®ç°ç½‘ç»œé€šä¿¡
*/
public class NioServer {

  static int clientCount = 0;
  static AtomicInteger counter = new AtomicInteger(0);
  static SimpleDateFormat sdf = new SimpleDateFormat(&quot;HH:mm:ss&quot;);

  public static void main(String[] args) {
    try {
      Selector selector = Selector.open(); // å®šä¹‰ä¸€ä¸ªé€‰æ‹©å™¨

      // å®šä¹‰ä¸€ä¸ªæœåŠ¡å™¨ç«¯å¥—æ¥å­—é€šé“
      // é…ç½®ä¸ºéé˜»å¡
      ServerSocketChannel ssc = ServerSocketChannel.open();
      ssc.configureBlocking(false);

        // æ³¨å†Œ ssc åˆ° é€‰æ‹©å™¨, æŒ‡å®š ssc å…³æ³¨çš„äº‹ä»¶
      ssc.register(selector, SelectionKey.OP_ACCEPT);
      ssc.bind(new InetSocketAddress(&quot;localhost&quot;, 8080));

      //è¿›å…¥æ­»å¾ªç¯, // è½®è¯¢, é€‰æ‹©å™¨ä¸æ—¶çš„è¿›è¡Œé€‰æ‹©
      while (true) {
        selector.select();
        Set&lt;SelectionKey&gt; keys = selector.selectedKeys();
        Iterator&lt;SelectionKey&gt; iterator = keys.iterator();
        while (iterator.hasNext()) {
          SelectionKey key = iterator.next();
          iterator.remove();
          if (key.isAcceptable()) {
              //é€‰æ‹©å™¨ç»ˆäºé€‰æ‹©å‡ºäº†é€šé“
            ServerSocketChannel ssc1 = (ServerSocketChannel)key.channel();
            SocketChannel sc = null;
            while ((sc = ssc1.accept()) != null) {
                //æŠŠæ–°æ¥å—çš„é€šé“é…ç½®ä¸ºéé˜»å¡çš„ï¼Œå¹¶æŠŠå®ƒä¹Ÿæ³¨å†Œåˆ°äº†é€‰æ‹©å™¨ä¸Šï¼Œè¯¥é€šé“æ„Ÿå…´è¶£çš„æ“ä½œä¸ºOP_READã€‚
              sc.configureBlocking(false);
              sc.register(selector, SelectionKey.OP_READ);
              InetSocketAddress rsa = (InetSocketAddress)sc.socket().getRemoteSocketAddress();
              System.out.println(time() + &quot;-&gt;&quot; + rsa.getHostName() + &quot;:&quot; + rsa.getPort() + &quot;-&gt;&quot; + Thread.currentThread().getId() + &quot;:&quot; + (++clientCount));
            }
          }
          //é€‰æ‹©å™¨ç»ˆäºåˆé€‰æ‹©å‡ºäº†é€šé“ï¼Œè¿™æ¬¡å‘ç°é€šé“æ˜¯éœ€è¦Readableçš„
          else if (key.isReadable()) {
            //å…ˆå°†â€œè¯»â€ä»æ„Ÿå…´è¶£æ“ä½œç§»å‡ºï¼Œå¾…æŠŠæ•°æ®ä»é€šé“ä¸­è¯»å®Œåï¼Œå†æŠŠâ€œè¯»â€æ·»åŠ åˆ°æ„Ÿå…´è¶£æ“ä½œä¸­
            //å¦åˆ™ï¼Œè¯¥é€šé“ä¼šä¸€ç›´è¢«é€‰å‡ºæ¥
            key.interestOps(key.interestOps() &amp; (~ SelectionKey.OP_READ));
            // æŠŠè¿™ä¸ªé€šé“äº¤ç»™äº†ä¸€ä¸ªæ–°çš„å·¥ä½œçº¿ç¨‹å»å¤„ç†
            processWithNewThread((SocketChannel)key.channel(), key);
          }
        }
      }
    } catch (Exception e) {
      e.printStackTrace();
    }
  }

  static void processWithNewThread(SocketChannel sc, SelectionKey key) {
    Runnable run = () -&gt; {
      counter.incrementAndGet();
      try {
        String result = readBytes(sc);
        //æŠŠâ€œè¯»â€åŠ è¿›å»
        key.interestOps(key.interestOps() | SelectionKey.OP_READ);
        System.out.println(time() + &quot;-&gt;&quot; + result + &quot;-&gt;&quot; + Thread.currentThread().getId() + &quot;:&quot; + counter.get());
        sc.close();
      } catch (Exception e) {
        e.printStackTrace();
      }
      counter.decrementAndGet();
    };
    new Thread(run).start();
  }

  static String readBytes(SocketChannel sc) throws Exception {
    long start = 0;
    int total = 0;
    int count = 0;
    ByteBuffer bb = ByteBuffer.allocate(1024);
    //å¼€å§‹è¯»æ•°æ®çš„æ—¶é—´
    long begin = System.currentTimeMillis();
    while ((count = sc.read(bb)) &gt; -1) {
      if (start &lt; 1) {
        //ç¬¬ä¸€æ¬¡è¯»åˆ°æ•°æ®çš„æ—¶é—´
        start = System.currentTimeMillis();
      }
      total += count;
      bb.clear();
    }
    //è¯»å®Œæ•°æ®çš„æ—¶é—´
    long end = System.currentTimeMillis();
    return &quot;wait=&quot; + (start - begin) + &quot;ms,read=&quot; + (end - start) + &quot;ms,total=&quot; + total + &quot;bs&quot;;
  }

  static String time() {
    return sdf.format(new Date());
  }
}

</code></pre>
<h2><a class="header" href="#java-aio" id="java-aio">java aio</a></h2>
<p>æ²¡æœ‰é˜»å¡ç‚¹ï¼Œå½“å·¥ä½œçº¿ç¨‹å¯åŠ¨æ—¶ï¼Œæ•°æ®å·²ç»ï¼ˆè¢«ç³»ç»Ÿï¼‰å‡†å¤‡å¥½å¯ä»¥ç›´æ¥ç”¨äº†ã€‚</p>
<pre><code class="language-java">
public class AioServer {

  static int clientCount = 0;
  static AtomicInteger counter = new AtomicInteger(0);
  static SimpleDateFormat sdf = new SimpleDateFormat(&quot;HH:mm:ss&quot;);

  public static void main(String[] args) {
    try {
      AsynchronousServerSocketChannel assc = AsynchronousServerSocketChannel.open();
      assc.bind(new InetSocketAddress(&quot;localhost&quot;, 8080));
      //éé˜»å¡æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯æ³¨å†Œäº†ä¸ªå›è°ƒï¼Œè€Œä¸”åªèƒ½æ¥å—ä¸€ä¸ªè¿æ¥
      assc.accept(null, new CompletionHandler&lt;AsynchronousSocketChannel, Object&gt;() {

        @Override
        public void completed(AsynchronousSocketChannel asc, Object attachment) {
          //å†æ¬¡æ³¨å†Œï¼Œæ¥å—ä¸‹ä¸€ä¸ªè¿æ¥
          assc.accept(null, this);
          try {
            InetSocketAddress rsa = (InetSocketAddress)asc.getRemoteAddress();
            System.out.println(time() + &quot;-&gt;&quot; + rsa.getHostName() + &quot;:&quot; + rsa.getPort() + &quot;-&gt;&quot; + Thread.currentThread().getId() + &quot;:&quot; + (++clientCount));
          } catch (Exception e) {
          }
          readFromChannelAsync(asc);
        }

        @Override
        public void failed(Throwable exc, Object attachment) {

        }
      });
      //ä¸è®©ä¸»çº¿ç¨‹é€€å‡º
      synchronized (AioServer.class) {
        AioServer.class.wait();
      }
    } catch (Exception e) {
      e.printStackTrace();
    }
  }

  static void readFromChannelAsync(AsynchronousSocketChannel asc) {
    //ä¼šæŠŠæ•°æ®è¯»å…¥åˆ°è¯¥bufferä¹‹åï¼Œå†è§¦å‘å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œå›è°ƒ
    ByteBuffer bb = ByteBuffer.allocate(1024*1024*1 + 1);
    long begin = System.currentTimeMillis();
    //éé˜»å¡æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯æ³¨å†Œäº†ä¸ªå›è°ƒï¼Œè€Œä¸”åªèƒ½æ¥å—ä¸€æ¬¡è¯»å–
    asc.read(bb, null, new CompletionHandler&lt;Integer, Object&gt;() {
      //ä»è¯¥è¿æ¥ä¸Šä¸€å…±è¯»åˆ°çš„å­—èŠ‚æ•°
      int total = 0;
      /**
       * @param count è¡¨ç¤ºæœ¬æ¬¡è¯»å–åˆ°çš„å­—èŠ‚æ•°ï¼Œ-1è¡¨ç¤ºæ•°æ®å·²è¯»å®Œ
       */
      @Override
      public void completed(Integer count, Object attachment) {
        counter.incrementAndGet();
        if (count &gt; -1) {
          total += count;
        }
        int size = bb.position();
        System.out.println(time() + &quot;-&gt;count=&quot; + count + &quot;,total=&quot; + total + &quot;bs,buffer=&quot; + size + &quot;bs-&gt;&quot; + Thread.currentThread().getId() + &quot;:&quot; + counter.get());
        if (count &gt; -1) {//æ•°æ®è¿˜æ²¡æœ‰è¯»å®Œ
          //å†æ¬¡æ³¨å†Œå›è°ƒï¼Œæ¥å—ä¸‹ä¸€æ¬¡è¯»å–
          asc.read(bb, null, this);
        } else {//æ•°æ®å·²è¯»å®Œ
          try {
            asc.close();
          } catch (Exception e) {
            e.printStackTrace();
          }
        }
        counter.decrementAndGet();
      }

      @Override
      public void failed(Throwable exc, Object attachment) {

      }
    });
    long end = System.currentTimeMillis();
    System.out.println(time() + &quot;-&gt;exe read req,use=&quot; + (end -begin) + &quot;ms&quot; + &quot;-&gt;&quot; + Thread.currentThread().getId());
  }

  static String time() {
    return sdf.format(new Date());
  }
}

</code></pre>
<h2><a class="header" href="#æ–­ç‚¹ç»­ä¼ " id="æ–­ç‚¹ç»­ä¼ ">æ–­ç‚¹ç»­ä¼ </a></h2>
<p>https://github.com/ryanlijianchang/ResumeBrokenDownloads</p>
<h1><a class="header" href="#ä»£ç†" id="ä»£ç†">ä»£ç†</a></h1>
<ul>
<li>
<p>é™æ€ä»£ç†</p>
<ul>
<li>
<p>ä»£ç†ç±»å®ç°ç›®æ ‡æ¥å£, å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªæ¥å£ç±»å‹çš„å¼•ç”¨), jdk åŸç”Ÿå®ç°</p>
</li>
<li>
<p>aspectj æ¡†æ¶, åœ¨ç¼–è¯‘æœŸå¢å¼º</p>
</li>
</ul>
</li>
<li>
<p>åŠ¨æ€ä»£ç†:</p>
<ul>
<li>
<p>jdk åŠ¨æ€ä»£ç†(åªèƒ½é’ˆå¯¹æ¥å£è¿›è¡Œä»£ç†), jdk åŸç”Ÿå®ç°</p>
</li>
<li>
<p>cglib åŠ¨æ€ä»£ç†(ç›´æ¥é’ˆå¯¹ç±»ä»£ç†, ç”Ÿæˆå­ç±», æ‰€ä»¥ç›®æ ‡ç±»ä¸èƒ½æ˜¯ final çš„ ), ä¾èµ– asm; </p>
<p>Spring aop åœ¨ç»™æŸä¸ªç±»æä¾›åŠ¨æ€ä»£ç†æ—¶ä¼šè‡ªåŠ¨åœ¨ jdk åŠ¨æ€ä»£ç†å’Œ cglib åŠ¨æ€ä»£ç†ä¸­åŠ¨æ€çš„é€‰æ‹©ã€‚</p>
</li>
<li>
<p>javaassist - javaassist æ˜¯ä½¿ç”¨æœ€å¹¿æ³›çš„åŠ¨æ€ä»£ç†å¼€æºåº“, æ— éœ€ç±»æ¥å£; javaassist çš„ ProxyFactory è¿˜æä¾›äº†æ–¹æ³•è¿‡æ»¤å™¨ï¼Œå®ƒå¯ä»¥é€‰æ‹©æ€§åœ°å¯¹ç‰¹å®šæ–¹æ³•è¿›è¡Œå¢å¼ºã€‚</p>
</li>
</ul>
</li>
</ul>
<h1><a class="header" href="#java-å†…å­˜æ¨¡å‹" id="java-å†…å­˜æ¨¡å‹">Java å†…å­˜æ¨¡å‹</a></h1>
<p>java-memory-model.md</p>
<h1><a class="header" href="#java8" id="java8">java8</a></h1>
<h2><a class="header" href="#å‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µfp" id="å‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µfp">å‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µ(FP)</a></h2>
<ul>
<li>
<p>å‡½æ•°å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™å¦å¤–çš„å‡½æ•°, åœ¨ Java ä¸­æœ¬è´¨è¿˜æ˜¯åˆ›å»ºäº†ä¸€ä¸ªåŒ¿åç±»</p>
</li>
<li>
<p>å‡½æ•°å¯ä»¥ä½œä¸ºå¦å¤–å‡½æ•°çš„è¿”å›å€¼</p>
</li>
<li>
<p>å‡½æ•°æ²¡æœ‰å‰¯ä½œç”¨ - å‡½æ•°å’Œå¤–ç•Œäº¤äº’å”¯ä¸€é€”å¾„å°±æ˜¯ å‚æ•° å’Œ è¿”å›å€¼</p>
<p>å‰¯ä½œç”¨: å‡½æ•°åœ¨ call çš„è¿‡ç¨‹ä¸­, å½±å“äº†å‡½æ•°çš„å¤–éƒ¨çŠ¶æ€</p>
</li>
<li>
<p>Declaractive(ç”³æ˜å¼) ä»£æ›¿ Imperative(å‘½ä»¤å¼)</p>
</li>
<li>
<p>ä¸å˜çš„å¯¹è±¡ -- ç±»ä¼¼äº ä¸å˜æ¨¡å¼</p>
<p>å£°æ˜å¼çš„æ“ä½œä¸ä¼šæ”¹å˜åŸå§‹å¯¹è±¡</p>
</li>
<li>
<p>å®¹æ˜“ å¹¶è¡ŒåŒ– -- è¿™ä¹Ÿæ˜¯ &quot;ä¸å˜å¯¹è±¡&quot;çš„å¥½å¤„</p>
</li>
</ul>
<pre><code class="language-java">// Declaractive vs. Imperative:
private static void imperative(int[] arr) {
    for (int i : arr) {
        System.out.print(i+&quot;, &quot;);
    }
}

private static void declaractive(int[] arr) {
    // jdk1.8
    Arrays.stream(arr).forEach(System.out::println);
}

//////////////////////////////////////

</code></pre>
<h2><a class="header" href="#java8-æ·»åŠ çš„æ–°ç‰¹æ€§" id="java8-æ·»åŠ çš„æ–°ç‰¹æ€§">Java8 æ·»åŠ çš„æ–°ç‰¹æ€§</a></h2>
<ul>
<li>default methods for interface æ¥å£å†…å…è®¸é»˜è®¤å®ç°, å®ç° fluent api</li>
<li>Lambda expression
<ul>
<li>lambda scope
<ul>
<li>accessing local variables - final å¯ä»¥ä¸åŠ , æœ€å¥½åŠ ä¸Š, å¿…é¡»ä¿è¯å˜é‡åªè¯»</li>
<li>accessing fields and static variables - å¯è¯»å¯å†™</li>
<li>accessing default interface methods - lambda ä¸­æ— æ³•ä½¿ç”¨æ¥å£é»˜è®¤æ–¹æ³•</li>
</ul>
</li>
</ul>
</li>
<li>method/constructor reference
<ul>
<li>é™æ€æ–¹æ³•å¼•ç”¨ -- ClassName:methodName</li>
<li>å®ä¾‹æ–¹æ³•å¼•ç”¨
<ul>
<li>é€šè¿‡ç±»å‹å¯¹å®ä¾‹æ–¹æ³•å¼•ç”¨ -- ClassName::methodName</li>
<li>é€šè¿‡å®ä¾‹å¯¹å®ä¾‹æ–¹æ³•å¼•ç”¨ -- instance::methodName</li>
</ul>
</li>
<li>è¶…ç±»ä¸Šçš„æ–¹æ³•å¼•ç”¨ -- super::methodName</li>
<li>æ„é€ æ–¹æ³•å¼•ç”¨ -- ClassName::new</li>
<li>æ•°ç»„æ„é€ æ–¹æ³•å¼•ç”¨ -- TypeName[]::new</li>
</ul>
</li>
<li>functional interface
<ul>
<li>built-in functional interface
<ul>
<li>Predicates - accept one arg and produce a predicate (and, or, negtive, isquals), ä»£è¡¨ä¸€æ®µé€»è¾‘åˆ¤æ–­</li>
<li>Functions - accept one arg and produce a result (andThen ä¸€ä¸ªä¸€ä¸ªæ¥ç€æ‰§è¡Œ, compose ä»æœ€å†…å±‚å¼€å§‹æ‰§è¡Œ), ä»£è¡¨ä¸€ä¸ªåŠŸèƒ½
<ul>
<li>BiFunction - æ¥æ”¶ ä¸¤ä¸ªå‚æ•°</li>
</ul>
</li>
<li>Suppliers - do not accept any arg, produce a object of a given type, è¡¨ç¤ºä¸€ä¸ªå¯¹è±¡å·¥å‚</li>
<li>Consumers - accept one arg and perform some operations on it, æ¶ˆè´¹è€…</li>
<li>Comparators - æ¯”è¾ƒå™¨</li>
</ul>
</li>
</ul>
</li>
<li>optional - a container for a value, å¹¶é functional interface, ç”¨äºé˜²æ­¢ç©ºæŒ‡é’ˆå¼‚å¸¸</li>
<li>stream - represents a sequence of elements, on which some operations can be performed; stream opts are either ä¸­é—´æ“ä½œ and ç»ˆæ­¢æ“ä½œ; æµéƒ½æ˜¯ä¸€æ¬¡æ€§çš„, ä¸€æ—¦ terminal opts è°ƒç”¨, æµå°±å…³é—­äº†, å†ç”¨å°±ä¼šå¼‚å¸¸, å¯é€šè¿‡æ„é€ ä¸€ä¸ª Suplier æ¥é‡ç”¨ stream;
<ul>
<li>ä¸­é—´æ“ä½œ(intermediate opts) - åªæœ‰å­˜åœ¨ terminal opts æ—¶æ‰ä¼šå®é™…æ‰§è¡Œ; å¹¶ä¸”æ˜¯æ¯ä¸ª element èµ°å®Œæ•´ä¸ªé“¾æ¡, æ‰ä¼šè¿›å…¥ä¸‹ä¸€ä¸ª element(åˆ©äºå‡å°‘æ“ä½œæ•°, æ¯”å¦‚å¯¹äº anyMatch æ“ä½œ, åªè¦ä¸€ä¸ªå…ƒç´ ç¬¦åˆå°±è¿”å›æœ€æ€»ç»“æœ true)
<ul>
<li>Filter - accept a predicate and return a filtered stream - ä¸€èˆ¬æ”¾åœ¨é“¾æ¡é¦–ä½, å‡å°‘æ“ä½œæ•°</li>
<li>Sorted - accept a comparator or nothing and return a sorted view of stream; åªæ˜¯ç”Ÿæˆè§†å›¾, å¹¶ä¸æ”¹å˜åŸå§‹ collection</li>
<li>Map - accept a function and perform on each element of the stream</li>
</ul>
</li>
<li>ç»ˆç‚¹æ“ä½œ(terminal opts)
<ul>
<li>forEach - accept a consumer to be executed for each element in the stream</li>
<li>Match - accept a predicate and return a boolean result; æ£€æŸ¥è¿™ä¸ª stream ä¸­çš„æ¯ä¸ªå…ƒç´ æ˜¯å¦ç¬¦åˆ predicate
<ul>
<li>anyMatch ä»»ä½•ä¸€ä¸ªç¬¦åˆ return true</li>
<li>allMatch å…¨éƒ½ç¬¦åˆ return true</li>
<li>noneMatch æ²¡æœ‰ç¬¦åˆçš„å…ƒç´  return true</li>
</ul>
</li>
<li>Count - return the number of element as a long value</li>
<li>Reduce - accept a function and return a optional representing the reducing value;</li>
<li>Collect - accept a collector, transfer a stream to collection
<ul>
<li>æœ‰è®¸å¤š builtin çš„ collector, å¦‚ Collectors.toList()...</li>
</ul>
</li>
</ul>
</li>
<li>sequential stream(ä¸²è¡Œæµ)
<ul>
<li>å®ä¾‹æ–¹æ³• someList.stream()</li>
<li>é™æ€æ–¹æ³• Arrays.stream(arr)</li>
<li>é™æ€æ–¹æ³• Stream.of(...)</li>
</ul>
</li>
<li>Parallel Streams(å¹¶è¡Œæµ)
<ul>
<li>someList.parallelStream()</li>
<li>Stream.parallel()</li>
</ul>
</li>
</ul>
</li>
<li>maps
<ul>
<li><code>map.keySet().stream()</code>, <code>map.values().stream()</code> and <code>map.entrySet().stream()</code>.</li>
<li>putIfAbsent(key, value) - è‹¥ç¡®å®, åˆ™å­˜å…¥; ---&gt;  å¦‚æœ key æ²¡æœ‰åœ¨ map ä¸­, å­˜å…¥, å¦‚æœ key å­˜åœ¨ map äº†, è¿”å› oldValue; ä¸»è¦æ˜¯å…é™¤äº† null check</li>
<li>merge(key,  newValue, biFunction) - æ ¹æ® key æŸ¥ value, å¦‚æœæ²¡æŸ¥åˆ°, ä¿å­˜, å¦‚æœæŸ¥åˆ°äº†, æ ¹æ® biFunction æ„é€  newValue ä¿å­˜; biFunction(oldValue, newValue) è¿”å›è®¡ç®—åçš„å€¼</li>
<li>forEach - accept a consumer</li>
<li>computeIfPresent(key, biFunction) - æ¥æ”¶ä¸€ä¸ª key, ä¸€ä¸ª biFunction, æ£€æŸ¥ key æ˜¯å¦ null, æ‰¾åˆ°è¿™ä¸ª entry, æ ¹æ® biFunction è®¡ç®—å‡ºæ–°çš„ value é‡æ–° put è¿› map; biFunction(key, value) è¿”å›è®¡ç®—çš„å€¼</li>
<li>computeIfAbsent - å¦‚æœæ ¹æ® key è·å–ä¸åˆ° value, åˆ™è®¡ç®—æ–°çš„ value å¹¶ put è¿›å»</li>
<li>remove(key, value) - value ç¬¦åˆæ‰ç§»é™¤ key å¯¹åº”çš„å…ƒç´ </li>
<li>getOrDefault(key, def_value) - æ²¡æœ‰å°±è¿”å›é»˜è®¤å€¼</li>
</ul>
</li>
<li>Date api - java.time åŒ…ä¸‹, çº¿ç¨‹å®‰å…¨
<ul>
<li>Clock - æ—¶é’Ÿ, æ—¶é—´ç»Ÿè®¡</li>
<li>Timezones - æ—¶åŒº</li>
<li>LocalTime - æ²¡æœ‰ time zone çš„æ—¶é—´</li>
<li>LocalDate - æ—¥æœŸ</li>
<li>LocalDateTime - æ—¥æœŸæ—¶é—´</li>
</ul>
</li>
<li>Annotations
<ul>
<li>æ³¨è§£é‡Œé¢å…è®¸æ³¨è§£, å…è®¸é‡å¤</li>
<li>æ³¨è§£å…è®¸æ”¾åœ¨æ–°çš„åœ°æ–¹: ElementType.TYPE_PARAMETER, ElementType.TYPE_USE</li>
</ul>
</li>
<li>CompletableFuture - å¢å¼ºç‰ˆæœ¬çš„ Future
<ul>
<li>future.get() è·å–æœ€ç»ˆç»“æœ, ä¼šé˜»å¡, ç­‰å¾…å®Œæˆ</li>
<li>future.complet(xxx) ä»»åŠ¡å®Œæˆ</li>
<li>CompletableFuture.supplyAsync(xxx) æ„é€  future, æœ‰è¿”å›å€¼</li>
<li>CompletableFuture.runAsync(xxx) æ„é€  future, æ— è¿”å›å€¼</li>
<li>æµå¼è°ƒç”¨</li>
<li>å¼‚å¸¸å¤„ç†</li>
</ul>
</li>
</ul>
<h3><a class="header" href="#æ¥å£é»˜è®¤æ–¹æ³•" id="æ¥å£é»˜è®¤æ–¹æ³•">æ¥å£é»˜è®¤æ–¹æ³•</a></h3>
<p>java8 å†…ç½®çš„è®¸å¤šå‡½æ•°å¼æ¥å£ç”¨åˆ°äº†&quot;æ¥å£é»˜è®¤å®ç°&quot;, è¿™ä½¿å¾— Java8 æ‹¥æœ‰äº†ç±»ä¼¼ å¤šç»§æ‰¿çš„èƒ½åŠ›: ä¸€ä¸ªå¯¹è±¡å®ä¾‹, æ‹¥æœ‰å¤šä¸ªæ¥å£æä¾›çš„å®ä¾‹æ–¹æ³•</p>
<p>è€Œè¿™ä¹Ÿä½¿å¾—æ¥å£é»˜è®¤æ–¹æ³•ä¼šç¢°åˆ° å¤šç»§æ‰¿ä¸€æ ·çš„é—®é¢˜ -- å¦‚æœä¸¤ä¸ªçˆ¶ç±»æ‹¥æœ‰ç›¸åŒåç§°çš„æ–¹æ³•, å­ç±»ä¸çŸ¥é“ä»¥å“ªä¸ªçš„ä¸ºå‡†, ä¼šæŠ›å¼‚å¸¸</p>
<p>åˆ©ç”¨ æ¥å£é»˜è®¤æ–¹æ³•, å¯ä»¥å®ç°é¡ºç•…çš„ fluent api</p>
<pre><code class="language-java">// å…¸å‹ Demo
interface Formula {
    double calculate(int a);

    default double sqrt(int a) {
        return Math.sqrt(a);
    }
}

/////////////////////////////////////////

private static void intConsumerAndThenTest() {
    IntConsumer println = System.out::println;// è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º
    IntConsumer errPrintln = System.err::println;// è¾“å‡ºåˆ° é”™è¯¯è¾“å‡º
    Arrays.stream(arr).forEach(println.andThen(errPrintln));
}

// IntConsumerçš„å®ç°

@FunctionalInterface
public interface IntConsumer {

    void accept(int value);

    //å…ˆè°ƒç”¨ accept, ç„¶åafter.accept()
    default IntConsumer andThen(IntConsumer after) {
        Objects.requireNonNull(after);
        return (int t) -&gt; { accept(t); after.accept(t); };
    }
}


</code></pre>
<h3><a class="header" href="#functionalinterface-å‡½æ•°æ¥å£" id="functionalinterface-å‡½æ•°æ¥å£">@FunctionalInterface-å‡½æ•°æ¥å£</a></h3>
<p>ç”¨äºæ ‡æ³¨å‡½æ•°å¼æ¥å£ - è¿™ä¸ªæ¥å£ä¸­åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•(attention: å…è®¸å­˜åœ¨å…¶ä»–çš„æ¥å£é»˜è®¤æ–¹æ³• or Object ä¸­åŒ…å«çš„æ–¹æ³•); æ˜¯å¦æ·»åŠ è¿™ä¸ªæ³¨è§£ä¸æ˜¯å¼ºåˆ¶æ€§çš„, ç±»ä¼¼ @Override, åªæ˜¯ä¸ºäº†æä¾›ç¼–è¯‘æ£€æŸ¥</p>
<p>æœ¬è´¨æ˜¯å»¶è¿Ÿäº†å‡½æ•°çš„å®šä¹‰, ä½¿ç”¨çš„æ—¶å€™å†æ¥å®šä¹‰å‡½æ•°çš„å…·ä½“å®ç°, æ–¹ä¾¿äº† lambda è¡¨è¾¾å¼</p>
<p>å‡½æ•°å¼æ¥å£çš„å®ä¾‹é€šè¿‡ &quot;æ–¹æ³•å¼•ç”¨&quot; å’Œ &quot;lambda&quot; æ„é€ </p>
<pre><code class="language-java">// å®šä¹‰å‡½æ•°å¼æ¥å£
@FunctionalInterface
interface Converter&lt;F, T&gt; {
    T convert(F from);// åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•
}

// è¿™ä¸ªä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£
@FunctionalInterface
interface IntHandler {
    void handl(int i);
    boolean equals(Object obj);// equals() è¢« Object å®ç°äº†, è€ŒIntHandlerçš„å®ä¾‹é»˜è®¤ç»§æ‰¿è‡ªObject
}

// ä½¿ç”¨

Converter&lt;String, Integer&gt; converter = (from) -&gt; Integer.valueOf(from);
Integer converted = converter.convert(&quot;123&quot;);
System.out.println(converted);    // 123
</code></pre>
<h3><a class="header" href="#æ–¹æ³•çš„å¼•ç”¨" id="æ–¹æ³•çš„å¼•ç”¨">æ–¹æ³•çš„å¼•ç”¨</a></h3>
<p>ç”¨æ¥ç®€åŒ– lambda è¡¨è¾¾å¼</p>
<ul>
<li>é™æ€æ–¹æ³•å¼•ç”¨ -- ClassName:methodName</li>
<li>å®ä¾‹æ–¹æ³•å¼•ç”¨
<ul>
<li>é€šè¿‡ç±»å‹å¯¹å®ä¾‹æ–¹æ³•å¼•ç”¨ -- ClassName::methodName</li>
<li>é€šè¿‡å®ä¾‹å¯¹å®ä¾‹æ–¹æ³•å¼•ç”¨ -- instance::methodName</li>
</ul>
</li>
<li>è¶…ç±»ä¸Šçš„æ–¹æ³•å¼•ç”¨ -- super::methodName</li>
<li>æ„é€ æ–¹æ³•å¼•ç”¨ -- ClassName::new</li>
<li>æ•°ç»„æ„é€ æ–¹æ³•å¼•ç”¨ -- TypeName[]::new</li>
</ul>
<p>ä¸è¦è¯•å›¾ç”¨åœ¨é‡è½½æ–¹æ³•ä¸Š, ç¼–è¯‘å™¨ç¢°åˆ°å¤šä¸ªç›¸åŒçš„åç§°çš„æ–¹æ³•ä¼šæ„Ÿåˆ°å›°æƒ‘, æŠ›å‡ºå¼‚å¸¸</p>
<pre><code class="language-java">/**
 * main
 */
public class App {
    private static final Logger log = LoggerFactory.getLogger(App.class);
    public static void main( String[] args ){
        System.out.println( &quot;java 8&quot; );
    }
    /**
     * :: æ™®é€šå‡½æ•°çš„å¼•ç”¨
     */
    private static void test3() {
        Person person = new Person(&quot;Peter&quot;, &quot;Parker&quot;);
        String ret = person::sayAndReturn;//// ç¼–è¯‘æ— æ³•é€šè¿‡, [String ret ] æ— æ³•æ¥å—ä¸€ä¸ªå‡½æ•°
                                    // person::sayAndReturn è¿”å›çš„å¼æ–¹æ³•å¼•ç”¨, è€Œä¸æ˜¯ æ–¹æ³•æ‰§è¡Œçš„ç»“æœ
        // ç¼–è¯‘é€šè¿‡, testæ–¹æ³•ç¬¦åˆConverterä¸­çš„æ¥å£è§„èŒƒ
        Converter&lt;String, String&gt; converter = person::test;

        Demo demo = new Demo();
        Converter&lt;String, String&gt; converter2 = demo::startWith;// æ¥æ”¶ä¸€ä¸ªstring, è¿”å›ç¬¬ä¸€ä¸ªå­—ç¬¦
                                                // (strtWithçš„è¾“å…¥è¾“å‡ºè¦å’ŒConverterçš„å‡½æ•°å¼æ¥å£åŒ¹é…)
        String firstLetter = converter2.convert(&quot;Java&quot;);
        log.info(firstLetter);
    }
    /**
     * :: constructor reference
     */
    private static void test2() {
        PersonFactory&lt;Person&gt; personFac =  Person::new;// Person::newè¡¨ç¤ºPersonçš„æ„é€ å‡½æ•°
                                        // çš„reference, ä¹Ÿæ˜¯ PersonFactory è¿™ä¸ªå‡½æ•°å¼æ¥å£çš„ä¸€ä¸ªå®ä¾‹;
                                        // åˆšå¥½ç”¨ personFac æ¥æ”¶
        Person person = personFac.create(&quot;Peter&quot;, &quot;Parker&quot;);
    }
    @FunctionalInterface
    interface PersonFactory&lt;P extends Person&gt; {
        P create(String first, String last);
    }

}

</code></pre>
<h3><a class="header" href="#lambda-è¡¨è¾¾å¼" id="lambda-è¡¨è¾¾å¼">Lambda è¡¨è¾¾å¼</a></h3>
<h4><a class="header" href="#lambda-ä»‹ç»" id="lambda-ä»‹ç»">lambda ä»‹ç»</a></h4>
<p>æœ¬è´¨å°±æ˜¯åŒ¿åç±»</p>
<p>lambda è¡¨è¾¾å¼å¯ä»¥ä½¿ç”¨å¤–éƒ¨å˜é‡, ä½†æ˜¯ lambda ä¸€æ—¦å®šä¹‰, è¿™ä¸ªå¤–éƒ¨å˜é‡å°±ä¸èƒ½æ”¹å˜äº†, åº”è¯¥è§†ä¸º &quot;final&quot;</p>
<pre><code class="language-java">List&lt;String&gt; names = Arrays.asList(&quot;peter&quot;, &quot;anna&quot;, &quot;mike&quot;, &quot;xenia&quot;);

// oldç‰ˆæœ¬
Collections.sort(names, new Comparator&lt;String&gt;() {
    @Override
    public int compare(String a, String b) {
        return b.compareTo(a);
    }
});

// Lambdaè¡¨è¾¾å¼
Collections.sort(names, (String a, String b) -&gt; {
    return b.compareTo(a);
});
//æ›´ç®€å•1
Collections.sort(names, (String a, String b) -&gt; b.compareTo(a));
// æ›´ç®€å•2
Collections.sort(names, (a, b) -&gt; b.compareTo(a));// ç¼–è¯‘å™¨çŸ¥é“å‚æ•°ç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥è·³è¿‡å®ƒä»¬ä¸å†™
</code></pre>
<h4><a class="header" href="#lambda-ä½œç”¨åŸŸé—®é¢˜" id="lambda-ä½œç”¨åŸŸé—®é¢˜">Lambda ä½œç”¨åŸŸé—®é¢˜</a></h4>
<h5><a class="header" href="#è®¿é—®å±€éƒ¨å˜é‡" id="è®¿é—®å±€éƒ¨å˜é‡">è®¿é—®å±€éƒ¨å˜é‡</a></h5>
<p>å±€éƒ¨å˜é‡å¿…é¡»å£°æ˜ä¸º: final æˆ–è€…éšå¼ final</p>
<pre><code class="language-java">//// è¿™æ ·å¯ä»¥
final int num = 1;
Converter&lt;Integer, String&gt; stringConverter = (from) -&gt; String.valueOf(from + num);
stringConverter.convert(2);     // 3

/// è¿™æ ·å¯ä»¥(éšå¼final)
int num = 1;
Converter&lt;Integer, String&gt; stringConverter = (from) -&gt; String.valueOf(from + num);
stringConverter.convert(2);     // 3

// è¿™æ ·æ— æ³•ç¼–è¯‘
int num = 1;
Converter&lt;Integer, String&gt; stringConverter = (from) -&gt; String.valueOf(from + num);
num = 3;// ä¸æ˜¯finalçš„äº†
</code></pre>
<h5><a class="header" href="#è®¿é—®æˆå‘˜å˜é‡" id="è®¿é—®æˆå‘˜å˜é‡">è®¿é—®æˆå‘˜å˜é‡</a></h5>
<p>å¾ˆæ™®é€š, å¯è¯»å¯å†™</p>
<pre><code class="language-java">class Lambda4 {
    static int outerStaticNum;
    int outerNum;

    void testScopes() {
        Converter&lt;Integer, String&gt; stringConverter1 = (from) -&gt; {
            outerNum = 23;
            return String.valueOf(from);
        };

        Converter&lt;Integer, String&gt; stringConverter2 = (from) -&gt; {
            outerStaticNum = 72;
            return String.valueOf(from);
        };
    }
}
</code></pre>
<h5><a class="header" href="#è®¿é—®é»˜è®¤æ¥å£æ–¹æ³•" id="è®¿é—®é»˜è®¤æ¥å£æ–¹æ³•">è®¿é—®é»˜è®¤æ¥å£æ–¹æ³•</a></h5>
<p>ä¸èƒ½è®¿é—®</p>
<pre><code class="language-java">interface Formula {
    double calculate(int a);

    default double sqrt(int a) {
        return Math.sqrt(a);
    }
}

// ç¼–è¯‘ä¸é€šè¿‡,
Formula formula = (a) -&gt; sqrt( a * 100);
</code></pre>
<h2><a class="header" href="#java8-ä¸­çš„å¹¶è¡Œæµ" id="java8-ä¸­çš„å¹¶è¡Œæµ">java8 ä¸­çš„å¹¶è¡Œæµ</a></h2>
<h3><a class="header" href="#ä½¿ç”¨å¹¶è¡Œè¿‡æ»¤æ•°æ®" id="ä½¿ç”¨å¹¶è¡Œè¿‡æ»¤æ•°æ®">ä½¿ç”¨å¹¶è¡Œè¿‡æ»¤æ•°æ®</a></h3>
<p>parallel() - å¾—åˆ°å¹¶è¡Œæµ</p>
<pre><code class="language-java">private static long countPrime() {

    // long count = IntStream.range(1, 5).filter(Lambdda::isPrime).count();

    // ä½¿ç”¨å¹¶è¡Œæ¨¡å¼
    // Lambdda::isPrime ä¼šè¢«å¤šçº¿ç¨‹å¹¶å‘è°ƒç”¨
    long count = IntStream.range(1, 10000).parallel().filter(Lambdda::isPrime).count();

    System.out.println(count);
    return count;
}

/**
    * åˆ¤æ–­æ˜¯å¦è´¨æ•°
    * è´¨æ•°: åªèƒ½è¢« 1å’Œå®ƒæœ¬èº«æ•´é™¤
    * @param target
    * @return
    */
private static boolean isPrime(int target) {
    if (target &lt; 2) {
        return false;
    }
    for (int i = 2; i &lt;= Math.sqrt(target); i++) {
        if (target % i == 0) {
            return false;
        }
    }
    // System.out.println(&quot;prime: &quot; + target);
    return true;
}

</code></pre>
<h3><a class="header" href="#ä»é›†åˆå¾—åˆ°å¹¶è¡Œæµ" id="ä»é›†åˆå¾—åˆ°å¹¶è¡Œæµ">ä»é›†åˆå¾—åˆ°å¹¶è¡Œæµ</a></h3>
<pre><code class="language-java">private static void average() {
    ArrayList&lt;Student&gt; stuList = new ArrayList&lt;Student&gt;();
    stuList.add(new Student(1));
    stuList.add(new Student(2));
    stuList.add(new Student(3));

    // ä»é›†åˆè·å–æµ
    double asDouble = stuList.stream().mapToInt(stu -&gt; stu.score).average().getAsDouble();
    // å¹¶è¡Œæµ
    double asDouble2 = stuList.stream().parallel().mapToInt(stu -&gt; stu.score).average().getAsDouble();
    System.out.println(asDouble);
}

</code></pre>
<h3><a class="header" href="#å¹¶è¡Œæ’åº-ç»™æ•°ç»„èµ‹å€¼" id="å¹¶è¡Œæ’åº-ç»™æ•°ç»„èµ‹å€¼">å¹¶è¡Œæ’åº-ç»™æ•°ç»„èµ‹å€¼</a></h3>
<pre><code class="language-java">private static void parallelSort() {
    int[] bigArr = new int[100];
    Arrays.setAll(bigArr, ele -&gt; new Random().nextInt(200));
    // å¹¶è¡Œèµ‹å€¼
    // Arrays.parallelSetAll(bigArr, ele -&gt; new Random().nextInt());

    // æ’åº
    Arrays.sort(bigArr);
    // å¹¶è¡Œæ’åº
    // Arrays.parallelSort(bigArr);

    Arrays.stream(bigArr).forEach(System.out::println);
}

</code></pre>
<h2><a class="header" href="#completablefuture-æ¥å£-å¢å¼ºçš„-future" id="completablefuture-æ¥å£-å¢å¼ºçš„-future">CompletableFuture æ¥å£-å¢å¼ºçš„ Future</a></h2>
<h3><a class="header" href="#å…ˆçœ‹çœ‹-future-ç¼ºç‚¹" id="å…ˆçœ‹çœ‹-future-ç¼ºç‚¹">å…ˆçœ‹çœ‹ Future ç¼ºç‚¹</a></h3>
<p>è§ concurrent-java#future æ¨¡å¼ ä»‹ç»</p>
<p>Futureå¾ˆéš¾ç›´æ¥è¡¨è¿°å¤šä¸ªFuture ç»“æœä¹‹é—´çš„ä¾èµ–æ€§</p>
<p>å¦‚, å°†ä¸¤ä¸ªå¼‚æ­¥è®¡ç®—åˆå¹¶ä¸ºä¸€ä¸ªï¼ˆè¿™ä¸¤ä¸ªå¼‚æ­¥è®¡ç®—ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼ŒåŒæ—¶ç¬¬äºŒä¸ªåˆä¾èµ–äºç¬¬ä¸€ä¸ªçš„ç»“æœï¼‰
ç­‰å¾… Future é›†åˆä¸­çš„æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆã€‚
ä»…ç­‰å¾… Future é›†åˆä¸­æœ€å¿«ç»“æŸçš„ä»»åŠ¡å®Œæˆï¼Œå¹¶è¿”å›å®ƒçš„ç»“æœ</p>
<h3><a class="header" href="#åŸç†ä»‹ç»" id="åŸç†ä»‹ç»">åŸç†ä»‹ç»</a></h3>
<p>CompletableFuture æ˜¯è¶…å¤§å‹å·¥å…·ç±», æ–¹æ³•å·¨å¤š, å®ç°äº† Future , CompletionStage, ä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿å¤šçº¿ç¨‹å¼‚æ­¥ä»»åŠ¡çš„ç¼–æ’</p>
<p>Callableï¼Œæœ‰ç»“æœçš„åŒæ­¥è¡Œä¸ºï¼Œæ¯”å¦‚åšè›‹ç³•ï¼Œäº§ç”Ÿè›‹ç³•
Runnableï¼Œæ— ç»“æœçš„åŒæ­¥è¡Œä¸ºï¼Œæ¯”å¦‚å–ç‰›å¥¶ï¼Œä»…ä»…å°±æ˜¯å–
Futureï¼Œå¼‚æ­¥å°è£…Callable/Runnableï¼Œæ¯”å¦‚å§”æ‰˜ç»™å¸ˆå‚…ï¼ˆå…¶ä»–çº¿ç¨‹ï¼‰å»åšç³•ç‚¹
CompletableFutureï¼Œå°è£…Futureï¼Œä½¿å…¶æ‹¥æœ‰å›è°ƒåŠŸèƒ½ï¼Œæ¯”å¦‚è®©å¸ˆå‚…ä¸»åŠ¨å‘Šè¯‰æˆ‘è›‹ç³•åšå¥½äº†</p>
<p>åˆ›å»ºæ—¶éœ€è¦ä¼ é€’çº¿ç¨‹æ± , ä¸ä¼ åˆ™ä½¿ç”¨é»˜è®¤ pool</p>
<h3><a class="header" href="#å®Œæˆäº†å°±é€šçŸ¥æˆ‘-æ‰‹åŠ¨å¡«å……-completablefuture" id="å®Œæˆäº†å°±é€šçŸ¥æˆ‘-æ‰‹åŠ¨å¡«å……-completablefuture">å®Œæˆäº†å°±é€šçŸ¥æˆ‘-æ‰‹åŠ¨å¡«å…… CompletableFuture</a></h3>
<p>å¯ä½œä¸ºå‡½æ•°è°ƒç”¨çš„å¥‘çº¦(çœŸå®è¿”å›å€¼çš„åŒ…è£…)</p>
<pre><code class="language-java">/**
 * CompletableFutureDemo  å¤æ‚çš„è®¡ç®—åœ¨ main thread
 */
public class CompletableFutureDemo {
    // block until main thread complete the complex compute, then print result
    private static class AskTask implements Runnable {
        private CompletableFuture&lt;Integer&gt; future;

        public AskTask(CompletableFuture&lt;Integer&gt; future) {
            this.future = future;
        }

        @Override
        public void run() {
            try {
                Integer integer = future.get();// é˜»å¡, CompletableFutureä¸º &quot;æœªå®Œæˆ&quot; çŠ¶æ€
                System.out.println(integer);
            } catch (InterruptedException | ExecutionException e) {
                e.printStackTrace();
            }
        }

    }

    public static void main(String[] args) throws InterruptedException {
        CompletableFuture&lt;Integer&gt; future = new CompletableFuture&lt;Integer&gt;();
        new Thread(new AskTask(future)).start();// å¯åŠ¨ç­‰å¾…çº¿ç¨‹

        // simulate complex compute
        Thread.sleep(1000);

        // å‘ŠçŸ¥è¿ç®—ç»“æœ: 100
        future.complete(100);// æ­¤æ—¶ä¸º &quot;å®Œæˆ&quot;çŠ¶æ€
    }
}

</code></pre>
<h3><a class="header" href="#å¼‚æ­¥æ‰§è¡Œä»»åŠ¡" id="å¼‚æ­¥æ‰§è¡Œä»»åŠ¡">å¼‚æ­¥æ‰§è¡Œä»»åŠ¡</a></h3>
<p>è¿™ä¸ª demo åˆšå¥½å’Œä¸Šé¢çš„ demo ç›¸å, è´Ÿè´£çš„è®¡ç®—ä¸åœ¨ main thread</p>
<pre><code class="language-java">public static void main(String[] args) throws InterruptedException, ExecutionException {

    CompletableFuture&lt;Integer&gt; supplyAsync = CompletableFuture.supplyAsync(() -&gt; calculate(20));
                                    // supplyAsync() ç”¨äºéœ€è¦æœ‰è¿”å›å€¼çš„åœºæ™¯, å¯ä¼ é€’ pool
                                    // runAsync() ç”¨äºæ— éœ€è¿”å›å€¼çš„åœºæ™¯, å¯ä¼ é€’ pool
    // do sth else;

    System.out.println(supplyAsync.get());
}

private static Integer calculate(Integer param) {
    try {
        // simulate complex calculation
        Thread.sleep(1000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

    return param * param;
}

</code></pre>
<h3><a class="header" href="#æµå¼è°ƒç”¨ç»„åˆå¤šä¸ª-function-å’Œ-å¼‚å¸¸å¤„ç†" id="æµå¼è°ƒç”¨ç»„åˆå¤šä¸ª-function-å’Œ-å¼‚å¸¸å¤„ç†">æµå¼è°ƒç”¨ç»„åˆå¤šä¸ª function å’Œ å¼‚å¸¸å¤„ç†</a></h3>
<p>çº¿ç¨‹ä¸²è¡ŒåŒ– (ç­‰å¾…å‰ç½® ä»»åŠ¡å®Œæˆåå†...)</p>
<p>thenapply() ç­‰å¾…å®Œæˆç„¶åå¤„ç†, æœ‰è¿”å›å€¼
thenrun() .... æ²¡æœ‰è¿”å›å€¼, æ²¡æœ‰ä¼ å…¥å‚æ•°
thenaccept() ç­‰å¾…å®Œæˆç„¶åæ¶ˆè´¹</p>
<p>å¸¦æœ‰ async çš„æ–¹æ³•åˆ™æ–°ä»»åŠ¡æ˜¯æ–°å¼€ä¸€ä¸ªthread æ‰§è¡Œ, ä¸å¸¦ async çš„æ–¹æ³•åˆ™æ–°ä»»åŠ¡æ˜¯å’Œå‰ç½®ä»»åŠ¡å…±ç”¨ thread</p>
<pre><code class="language-java">private static void fluentApiDemo() throws InterruptedException, ExecutionException {
    CompletableFuture&lt;Void&gt; future = CompletableFuture.supplyAsync(() -&gt; calculate(50))
            .thenApply(i -&gt; Integer.toString(i)).thenApply(str -&gt; &quot;\&quot;&quot; + str + &quot;\&quot;&quot;)
            .thenAccept(System.out::println);// ç»“æœ: &quot;2500&quot;
            
//   ä¹Ÿå¯ä»¥åœ¨æµè°ƒç”¨ä¸­ä½¿ç”¨ whencomplete((resp, e) -&gt; {})    å¼‚å¸¸å¤„ç†
//                  ç±»ä¼¼ çš„ handle(( resp, e) -&gt; {return ...}), å¯ä»¥æœ‰è¿”å›å€¼
    future.get(); // éœ€è¦è®© main thread é˜»å¡, ç­‰å¾… calculateæ‰§è¡Œå®Œ
    System.out.println(future.get());// é˜»å¡ // ç»“æœ: null
}

private static Integer calculate(Integer param) {
    try {
        // simulate complex calculation
        Thread.sleep(1000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

    return param * param;
}

</code></pre>
<p>å¼‚å¸¸å¤„ç†</p>
<pre><code class="language-java">private static void fluentApiDemo() throws InterruptedException, ExecutionException {
    CompletableFuture&lt;Void&gt; future = CompletableFuture.supplyAsync(() -&gt; calculate(50))
    //   ä¹Ÿå¯ä»¥åœ¨æµè°ƒç”¨ä¸­ä½¿ç”¨ whencomplete((resp, e) -&gt; {})    å¼‚å¸¸å¤„ç†
//                  ç±»ä¼¼ çš„ handle(( resp, e) -&gt; {return ...}), å¯ä»¥æœ‰è¿”å›å€¼
            .exceptionally(e -&gt; {           // å¯¹ calculate æ–¹æ³•çš„å¼‚å¸¸å¤„ç†
                e.printStackTrace(); // java.util.concurrent.CompletionException: java.lang.ArithmeticException: / by zero
                return 0; // æœ€ç»ˆå¤„ç†ç»“æœ : &quot;0&quot;
            })
            .thenApply(i -&gt; Integer.toString(i)).thenApply(str -&gt; &quot;\&quot;&quot; + str + &quot;\&quot;&quot;)
            .thenAccept(System.out::println);// ç»“æœ: &quot;2500&quot;
    future.get(); // éœ€è¦è®© main thread é˜»å¡, ç­‰å¾… calculateæ‰§è¡Œå®Œ
    System.out.println(future.get());// é˜»å¡ // ç»“æœ: null
}

private static Integer calculate(Integer param) {
    int i = param/0;
    try {
        // simulate complex calculation
        Thread.sleep(1000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

    return param * param;
}

</code></pre>
<h3><a class="header" href="#ç»„åˆå¤šä¸ª-completablefuture" id="ç»„åˆå¤šä¸ª-completablefuture">ç»„åˆå¤šä¸ª CompletableFuture</a></h3>
<pre><code class="language-java">// é¡ºåºå®Œæˆ
private static void composeCompletableFutureDemo() throws InterruptedException, ExecutionException {
    CompletableFuture&lt;Void&gt; future = CompletableFuture.supplyAsync(() -&gt; calculate(20))
        .thenCompose(i -&gt; CompletableFuture.supplyAsync(() -&gt; calculate(i)))
                    // ç­‰å¾…ä¸Šä¸€ä¸ªfutureå¾—åˆ°ç»“æœ, ç„¶åå°†ä¸Šä¸€ä¸ª future çš„
                    // ç»“æœä¼ å…¥(è¿™ä¿© future æ˜¯ä¾èµ–å…³ç³»), å†æ¬¡æ„é€ ä¸€ä¸ª future
        .thenApply(i -&gt; &quot;\&quot;&quot; + i + &quot;\&quot;&quot;).thenAccept(System.out::println);// ç»“æœ: &quot;160000&quot;
    future.get();
}

// å¦ä¸€ç§ç»„åˆçš„æ–¹æ³•
// æ²¡æœ‰é¡ºåº, ä½†æ˜¯éƒ½è¦å®Œæˆ
private static void composeCompletableFutureDemo() throws InterruptedException, ExecutionException {
    CompletableFuture&lt;Void&gt; future = CompletableFuture.supplyAsync(() -&gt; calculate(20))
        // é¦–å…ˆå®Œæˆå‰ä¸€ä¸ª future  å’Œ è·Ÿç€çš„ future (è¿™ä¿©future æ²¡æœ‰ä»»ä½•å…³ç³»), ç„¶åå°†ä¸¤è€…ç»“æœè¿›è¡Œè®¡ç®—
        .thenCombine(CompletableFuture.supplyAsync(() -&gt; calculate(10)), (i, j) -&gt; {
            System.out.println(&quot;i=&quot; + i);
            System.out.println(&quot;j=&quot; + j);
            return i + j;
        })
        .thenApply(i -&gt; &quot;\&quot;&quot; + i + &quot;\&quot;&quot;).thenAccept(System.out::println);
                    // ç»“æœ:i=400 j=100 &quot;500&quot;

    future.get();
}

// æ²¡æœ‰é¡ºåºçš„ç»„åˆæ–¹æ³•
CompletableFuture.allOf(f1,f2).join();


// åªè¦ä¸€ä¸ªå®Œæˆ

applyToEither() ä»»ä¸€å®Œæˆ, è·å–è¿”å›å€¼, å¤„ç†ç„¶ååˆæœ‰æ–°çš„è¿”å›å€¼
accepttoeither() 
runaftereither()
</code></pre>
<h2><a class="header" href="#stampedlock-è¯»å†™é”çš„æ”¹è¿›" id="stampedlock-è¯»å†™é”çš„æ”¹è¿›">StampedLock-è¯»å†™é”çš„æ”¹è¿›</a></h2>
<h2><a class="header" href="#longadder-åŸå­ç±»çš„å¢å¼º" id="longadder-åŸå­ç±»çš„å¢å¼º">LongAdder-åŸå­ç±»çš„å¢å¼º</a></h2>
<p>å†…éƒ¨ä»ç„¶ä½¿ç”¨ CAS æ“ä½œ, ä½†æ˜¯ä½¿ç”¨ &quot;çƒ­ç‚¹æ•°æ®åˆ†ç¦»&quot; çš„æ€æƒ³, ç±»ä¼¼ ConcurrentHashMap å°†å†…éƒ¨æ•°æ®åˆ†ç¦»åˆ°å¤šä¸ª segment</p>
<p>LongAdder å°† AtomicInteger å†…éƒ¨çš„æ ¸å¿ƒæ•°æ® value åˆ†è§£ä¸ºä¸€ä¸ª æ•°ç»„, æ¯ä¸ª thread è®¿é—®å°±é€šè¿‡ hash ç®—æ³•æ˜ å°„åˆ°æ•°ç»„å…¶ä¸­ä¸€ä¸ªå…ƒç´ è¿›è¡Œè®¡ç®—, æœ€ç»ˆçš„ç»“æœåˆ™æ˜¯è¿™ä¸ªæ•°ç»„çš„æ±‚å’Œç´¯åŠ </p>
<h2><a class="header" href="#java8-å†…ç½®å‡½æ•°å¼æ¥å£" id="java8-å†…ç½®å‡½æ•°å¼æ¥å£">java8 å†…ç½®å‡½æ•°å¼æ¥å£</a></h2>
<h3><a class="header" href="#predicatesè°“è¯-æ–­å®š" id="predicatesè°“è¯-æ–­å®š">Predicates(è°“è¯, æ–­å®š)</a></h3>
<p><code>apply(T input): boolean</code> è¾“å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œè¿”å› true æˆ–è€… false</p>
<pre><code class="language-java">Predicate&lt;String&gt; predicateStr = (str) -&gt; str.length() &gt; 0;
boolean test = predicateStr.test(&quot;ssss&quot;);
log.info(test+&quot;&quot;);

Predicate&lt;Boolean&gt; nonNull = Objects::nonNull;
Predicate&lt;Boolean&gt; isNull = Objects::isNull;

Predicate&lt;String&gt; isEmpty = String::isEmpty;
Predicate&lt;String&gt; isNotEmpty = isEmpty.negate();
</code></pre>
<h3><a class="header" href="#functionså‡½æ•°" id="functionså‡½æ•°">Functions(å‡½æ•°)</a></h3>
<p><code>apply(S input): T</code> Functions æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªç»“æœã€‚é»˜è®¤æ–¹æ³•å¯ä»¥å°†å¤šä¸ªå‡½æ•°ä¸²åœ¨ä¸€èµ·ï¼ˆcompse, andThenï¼‰</p>
<pre><code class="language-java">Function&lt;String, Integer&gt; toInteger = Integer::valueOf;
Function&lt;String, String&gt; backToString = toInteger.andThen(String::valueOf);

backToString.apply(&quot;123&quot;);     // &quot;123&quot;

</code></pre>
<h3><a class="header" href="#suppliersç”Ÿäº§è€…" id="suppliersç”Ÿäº§è€…">Suppliers(ç”Ÿäº§è€…)</a></h3>
<p>å°±å¥½åƒä¸€ä¸ª bean å·¥å‚</p>
<p>Suppliers äº§ç”Ÿä¸€ä¸ªç»™å®šçš„æ³›å‹ç±»å‹çš„ç»“æœ, ä¸ Functional ä¸åŒçš„æ˜¯ Suppliers ä¸æ¥å—è¾“å…¥å‚æ•°ã€‚</p>
<pre><code class="language-java">// ç”±äºpersonSupplierä¸æ¥å—è¾“å…¥å‚æ•°, åˆ™è°ƒç”¨çš„æ˜¯personçš„æ— å‚æ•°Constructor
Supplier&lt;Person&gt; personSupplier = Person::new;
personSupplier.get();   // new Person
</code></pre>
<h3><a class="header" href="#consumersæ¶ˆè´¹è€…" id="consumersæ¶ˆè´¹è€…">Consumers(æ¶ˆè´¹è€…)</a></h3>
<p>Consumers ä»£è¡¨åœ¨ä¸€ä¸ªå•ä¸€çš„è¾“å…¥å‚æ•°ä¸Šæ‰§è¡Œæ“ä½œã€‚</p>
<pre><code class="language-java">
Consumer&lt;Person&gt; greeter = (p) -&gt; System.out.println(&quot;Hello, &quot; + p.name);
greeter.accept(new Person(&quot;Luke&quot;, &quot;Skywalker&quot;));
</code></pre>
<h3><a class="header" href="#comparatorsæ¯”è¾ƒå™¨" id="comparatorsæ¯”è¾ƒå™¨">Comparators(æ¯”è¾ƒå™¨)</a></h3>
<p>Comparators åœ¨æ—§ç‰ˆæœ¬ Java ä¸­æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ã€‚Java8 å¢åŠ äº†å„ç§é»˜è®¤æ–¹æ³•çš„æ¥å£</p>
<pre><code class="language-java">Comparator&lt;Person&gt; comparator = (p1, p2) -&gt; p1.name.compareTo(p2.name); // å‡åº, è‹¥ p2.name.compareTo(p1.name) åˆ™æ˜¯é™åº

// åœ¨ stream ä¸­, stream.max(comparator) å–æœ€å¤§å€¼, éœ€è¦ comparator æ˜¯å‡åºæ’åºå™¨

// å‡åºæ’åº ä¹Ÿå¯ä»¥ç®€å†™ Comparator.comparing(o -&gt; Long.valueOf(o.getVersion()))

Person p1 = new Person(&quot;John&quot;, &quot;Doe&quot;);
Person p2 = new Person(&quot;Alice&quot;, &quot;Wonderland&quot;);

comparator.compare(p1, p2);             // &gt; 0
comparator.reversed().compare(p1, p2);  // &lt; 0
</code></pre>
<h3><a class="header" href="#optionals" id="optionals">Optionals</a></h3>
<p>å¯é€‰å¯¹è±¡, æ˜¯å¯¹ object çš„ä¸€å±‚åŒ…è£…</p>
<p>Optionals æ˜¯æ²¡æœ‰ä»»ä½•å‡½æ•°çš„æ¥å£ï¼Œå”¯ä¸€ä½œç”¨æ˜¯é˜²æ­¢ NullPointerException å¼‚å¸¸</p>
<p>Optional is a simple container for a value which may be null or non-null. Think of a method which may return a non-null result but sometimes return nothing. Instead of returning null you return an Optional in Java 8.
(Optional æ˜¯ä¸€ä¸ªç®€å•çš„å®¹å™¨ï¼Œè¿™ä¸ªå€¼å¯èƒ½æ˜¯ç©ºçš„æˆ–è€…éç©ºçš„ã€‚è€ƒè™‘åˆ°ä¸€ä¸ªæ–¹æ³•å¯èƒ½ä¼šè¿”å›ä¸€ä¸ª non-null çš„å€¼ï¼Œä¹Ÿå¯èƒ½è¿”å›ä¸€ä¸ªç©ºå€¼ã€‚ä¸ºäº†ä¸ç›´æ¥è¿”å› nullï¼Œæˆ‘ä»¬åœ¨ Java 8 ä¸­å°±è¿”å›ä¸€ä¸ª Optionalã€‚)</p>
<p>å¸¸ç”¨ api:</p>
<pre><code>Optional.of()
Optional.ofNullable()
Optional.empty()

public&lt;U&gt; Optional&lt;U&gt; map(Function&lt;? super T, ? extends U&gt; mapper)
public T orElse(T other)
public T orElseGet(Supplier&lt;? extends T&gt; other)
public void ifPresent(Consumer&lt;? super T&gt; consumer)
public Optional&lt;T&gt; filter(Predicate&lt;? super T&gt; predicate)
public&lt;U&gt; Optional&lt;U&gt; flatMap(Function&lt;? super T, Optional&lt;U&gt;&gt; mapper)
public &lt;X extends Throwable&gt; T orElseThrow(Supplier&lt;? extends X&gt; exceptionSupplier) throws X
</code></pre>
<pre><code class="language-java">/**
* optional api ç¤ºä¾‹
*/
private static void test5() {
    Optional&lt;String&gt; opt = Optional.of(&quot;mama&quot;);

    // ä¸æ¨èä½¿ç”¨
    log.info(opt.isPresent()+&quot;&quot;);
    log.info(opt.get());


    log.info(opt.orElse(&quot;elseValue&quot;));
    opt.ifPresent((s) -&gt; log.info(s.charAt(0)+&quot;&quot;));
    opt.flatMap((input) -&gt; {
        return null; // è¿”å›çš„æ˜¯ä¸€ä¸ªOptionnal
    });
    opt.map((input) -&gt; {
        return null;// è¿”å›çš„æ˜¯ä¸€ä¸ªObject
    });
}

return user.orElse(null);  //è€Œä¸æ˜¯ return user.isPresent() ? user.get() : null;
return user.orElse(UNKNOWN_USER);
eturn user.orElseGet(() -&gt; fetchAUserFromDatabase());
user.ifPresent(System.out::println);
return user.map(u -&gt; u.getOrders()).orElse(Collections.emptyList())

// æœ€ä½³å®è·µ
 private String getName2(User_1 user_1) {
    return Optional.ofNullable(user_1)
            .map(user1 -&gt; user1.user_2)
            .map(user_2 -&gt; user_2.name)
            .orElseThrow(RuntimeException::new);
}

</code></pre>
<p>optional ç›´æ¥ç”Ÿæˆ stream</p>
<pre><code class="language-java">Optional&lt;String&gt; optional = Optional.of(&quot;ggg&quot;);
// java 8
Stream&lt;String&gt; texts = optional.map(Stream::of).orElseGet(Stream::empty);
Stream&lt;String&gt; hello = Optional.of(new String[] {&quot;hello&quot;, &quot;aa&quot;, &quot;bb&quot;}).map(Stream::of).orElseGet(Stream::empty);
// java 9
Stream&lt;String&gt; texts = optional.stream();
</code></pre>
<h2><a class="header" href="#streamsç®¡é“" id="streamsç®¡é“">Streams(ç®¡é“)</a></h2>
<h3><a class="header" href="#stream-ä»‹ç»" id="stream-ä»‹ç»">stream ä»‹ç»</a></h3>
<p>https://github.com/biezhi/learn-java8/blob/master/java8-stream/README.md</p>
<ul>
<li>
<p><code>java.util.Stream</code></p>
</li>
<li>
<p>æµæ˜¯ä¸€ä¸ªæºäº§ç”Ÿçš„ï¼Œä¾‹å¦‚ java.util.Collection(æ¯”å¦‚:Collection.stream()æˆ– Collection.parallelStream())</p>
</li>
<li>
<p>æ“ä½œçš„éƒ½æ˜¯é›†åˆçš„è§†å›¾, åŸé›†åˆæ²¡æœ‰å˜åŒ–</p>
</li>
<li>
<p>Parallel Streams(å¹¶è¡Œç®¡é“): é€šè¿‡<code>list.parallelStream()</code>è·å– paralled stream, æ•ˆç‡æå¤§æå‡</p>
</li>
<li>
<p>stream åªèƒ½ä½¿ç”¨ä¸€æ¬¡, é‡å¤ä½¿ç”¨éœ€è¦æ„é€ ä¸€ä¸ª Supplier</p>
</li>
</ul>
<pre><code class="language-java">IntStream.range(1, 4)
        .forEach(System.out::println);

Arrays.stream(new int[] {1, 2, 3})
        .map(n -&gt; 2 * n + 1)
        .average()
        .ifPresent(System.out::println);
</code></pre>
<h3><a class="header" href="#é‡å¤ä½¿ç”¨-stream" id="é‡å¤ä½¿ç”¨-stream">é‡å¤ä½¿ç”¨ stream</a></h3>
<p>é€šè¿‡ supplier: (æœ¬è´¨å°±æ˜¯è°ƒç”¨ get() æ—¶ é‡æ–°ç”Ÿæˆäº†æµ, æ‰€ä»¥, æµç”Ÿæˆä¸èƒ½å†™åœ¨ supplier å¤–éƒ¨)</p>
<pre><code class="language-java">Supplier&lt;Stream&lt;String&gt;&gt;  supplier = () -&gt; Stream.of(&quot;hello&quot;, &quot;aa&quot;, &quot;bb&quot;);
boolean        aa    = supplier.get().allMatch(s -&gt; s.equalsIgnoreCase(&quot;aa&quot;));
boolean        aa1   = supplier.get().anyMatch(s -&gt; s.equalsIgnoreCase(&quot;aa&quot;));
System.out.println(aa);
System.out.println(aa1);
</code></pre>
<h3><a class="header" href="#map-å’Œ-flatmap" id="map-å’Œ-flatmap">map å’Œ flatMap</a></h3>
<p>map æ¥æ”¶ä¸€ä¸ªå‡½æ•°, å‡½æ•°è¿”å›å¤„ç†åçš„ stream</p>
<p>flatmap, æ¥å—ä¸€ä¸ªå‡½æ•°, å‡½æ•°è¿”å› stream, æœ€åä¼šå°†å„ä¸ª stream åˆå¹¶ä¸ºä¸€ä¸ª stream</p>
<h3><a class="header" href="#å»é‡" id="å»é‡">å»é‡</a></h3>
<pre><code class="language-java">stream æœ‰ distinct()

æ ¹æ®æŸä¸ª object å±æ€§å»é‡:
studentList = studentList.stream().collect(
      collectingAndThen(
        toCollection(() -&gt; new TreeSet&lt;&gt;(Comparator.comparing(Student::getName))), ArrayList::new)
    );
</code></pre>
<h3><a class="header" href="#collectæ–¹æ³•-å¦‚ä½•æ”¶é›†å¤„ç†åçš„å…ƒç´ -åˆ†ç»„-å»é‡" id="collectæ–¹æ³•-å¦‚ä½•æ”¶é›†å¤„ç†åçš„å…ƒç´ -åˆ†ç»„-å»é‡">collectæ–¹æ³• å¦‚ä½•æ”¶é›†å¤„ç†åçš„å…ƒç´  åˆ†ç»„ å»é‡</a></h3>
<pre><code class="language-java">// set , å»é‡
System.out.println(Stream.of(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;,&quot;a&quot;).collect(Collectors.toSet()));

// è½¬æ¢ä¸ºç‰¹å®š é›†åˆ
TreeSet&lt;String&gt; treeSet = Stream.of(&quot;a&quot;, &quot;c&quot;, &quot;b&quot;, &quot;a&quot;).collect(Collectors.toCollection(TreeSet::new));

//å¯¹äºstringåˆ—è¡¨å»é‡
List stringListï¼›
stringList = stringList.stream().distinct().collect(Collectors.toList());
// å¯¹äºå®ä½“ç±»çš„å»é‡
//é€šè¿‡hashcode()å’Œequals()æ–¹æ³•æ¥è·å–ä¸åŒå…ƒç´ ï¼Œå› æ­¤éœ€è¦å»é‡çš„ç±»å¿…é¡»å®ç°hashcode()å’Œequals()æ–¹æ³•
List studentListï¼›
studentList = studentList.stream().distinct().collect(Collectors.toList());

// æ ¹æ® List ä¸­ Object æŸä¸ªå±æ€§å»é‡(å§“åå»é‡)
List studentList;
studentList = studentList.stream()
.collect(collectingAndThen(toCollection(() -&gt; new TreeSet&lt;&gt;(Comparator.comparing(Student::getName))), ArrayList::new));
//æ ¹æ®List ä¸­ Object å¤šä¸ªå±æ€§å»é‡(å§“åï¼Œå¹´é¾„å»é‡)
ListstudentListï¼›
studentList=studentList.stream()
.collect(Collectors.collectingAndThen(Collectors.toCollection(() -&gt; new TreeSet&lt;&gt;(Comparator.comparing(o -&gt; o.getName() + â€œ;â€ + o.getAge()))), ArrayList::new));



//å‚æ•°:  toMap(
    //     keyMapper,
    //     valueMapper,
    //     mergeFunction // biFunction(oldVal, newVal) è¡¨ç¤º è‹¥ æ„é€ å½“å‰é”®å€¼å¯¹æ—¶, key å¯¹åº”çš„ value å·²ç»å­˜åœ¨, åˆ™ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ç”Ÿæˆæ–°çš„ value
    //  )
Map&lt;String, String&gt; collect = Stream.of(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;a&quot;).collect(Collectors.toMap(x -&gt; x, x -&gt; x + x,(oldVal, newVal) -&gt; newVal)));

// Collectors.minBy(Integer::compare)ï¼šæ±‚æœ€å°å€¼ï¼Œç›¸å¯¹åº”çš„å½“ç„¶ä¹Ÿæœ‰maxByæ–¹æ³•ã€‚

// Collectors.averagingInt(x-&gt;x)ï¼šæ±‚å¹³å‡å€¼ï¼ŒåŒæ—¶ä¹Ÿæœ‰averagingDoubleã€averagingLongæ–¹æ³•ã€‚

// Collectors.summingInt(x -&gt; x))ï¼šæ±‚å’Œ

//Collectors.summarizingDouble(x -&gt; x)ï¼šå¯ä»¥è·å–æœ€å¤§å€¼ã€æœ€å°å€¼ã€å¹³å‡å€¼ã€æ€»å’Œå€¼ã€æ€»æ•°ã€‚
DoubleSummaryStatistics summaryStatistics = Stream.of(1, 3, 4).collect(Collectors.summarizingDouble(x -&gt; x));
System.out.println(summaryStatistics .getAverage());

//Collectors.groupingBy(x -&gt; x)ï¼šæœ‰ä¸‰ç§æ–¹æ³•ï¼ŒæŸ¥çœ‹æºç å¯ä»¥çŸ¥é“å‰ä¸¤ä¸ªæ–¹æ³•æœ€ç»ˆè°ƒç”¨ç¬¬ä¸‰ä¸ªæ–¹æ³•ï¼Œç¬¬äºŒä¸ªå‚æ•°é»˜è®¤HashMap::new  ç¬¬ä¸‰ä¸ªå‚æ•°é»˜è®¤Collectors.toList()
Map&lt;Integer, List&lt;Integer&gt;&gt; map = Stream.of(1, 3, 3, 2).collect(Collectors.groupingBy(Function.identity()));//identity()æ˜¯Functionç±»çš„é™æ€æ–¹æ³•,å’Œ x-&gt;x æ˜¯ä¸€ä¸ªæ„æ€,å½“ä»…ä»…éœ€è¦è‡ªå·±è¿”å›è‡ªå·±æ—¶,ä½¿ç”¨identity()èƒ½æ›´æ¸…æ¥šçš„è¡¨è¾¾ä½œè€…çš„æ„æ€.å†™çš„å¤æ‚ä¸€ç‚¹,ç»•ä¸€ç‚¹,å¯¹ç†è§£å¾ˆæœ‰å¥½å¤„
Map&lt;Integer, Integer&gt; map1 = Stream.of(1, 3, 3, 2).collect(Collectors.groupingBy(Function.identity(), Collectors.summingInt(x -&gt; x)));
HashMap&lt;Integer, List&lt;Integer&gt;&gt; hashMap = Stream.of(1, 3, 3, 2).collect(Collectors.groupingBy(Function.identity(), HashMap::new, Collectors.mapping(x -&gt; x + 1, Collectors.toList())));



// Collectors.partitioningBy(x -&gt; x &gt; 2)ï¼ŒæŠŠæ•°æ®åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œkeyä¸ºture/falseã€‚ç¬¬ä¸€ä¸ªæ–¹æ³•ä¹Ÿæ˜¯è°ƒç”¨ç¬¬äºŒä¸ªæ–¹æ³•ï¼Œç¬¬äºŒä¸ªå‚æ•°é»˜è®¤ä¸ºCollectors.toList()
Map&lt;Boolean, List&lt;Integer&gt;&gt; map = Stream.of(1, 3, 3, 2).collect(Collectors.partitioningBy(x -&gt; x &gt; 2));
Map&lt;Boolean, Long&gt; longMap = Stream.of(1, 3, 3, 2).collect(Collectors.partitioningBy(x -&gt; x &gt; 1, Collectors.counting()));

//Collectors.joining(&quot;,&quot;)ï¼šæ‹¼æ¥å­—ç¬¦ä¸²
System.out.println(Stream.of(&quot;1&quot;, &quot;3&quot;, &quot;3&quot;, &quot;2&quot;).collect(Collectors.joining(&quot;,&quot;)));


//Collectors.collectingAndThen(Collectors.toList(), x -&gt; x.size())ï¼šå…ˆæ‰§è¡Œcollectæ“ä½œåå†æ‰§è¡Œç¬¬äºŒä¸ªå‚æ•°çš„è¡¨è¾¾å¼ã€‚è¿™é‡Œæ˜¯å…ˆå¡åˆ°é›†åˆï¼Œå†å¾—å‡ºé›†åˆé•¿åº¦ã€‚
Integer integer = Stream.of(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;).collect(Collectors.collectingAndThen(Collectors.toList(), x -&gt; x.size()));


//Collectors.mapping(...)ï¼šè·ŸStreamçš„mapæ“ä½œç±»ä¼¼ï¼Œåªæ˜¯å‚æ•°æœ‰ç‚¹åŒºåˆ«
System.out.println(Stream.of(1, 3, 5).collect(Collectors.mapping(x -&gt; x + 1, Collectors.toList())));


</code></pre>
<h3><a class="header" href="#stream-ä¸­å¼‚å¸¸å¤„ç†" id="stream-ä¸­å¼‚å¸¸å¤„ç†">stream ä¸­å¼‚å¸¸å¤„ç†</a></h3>
<p>https://cloud.tencent.com/developer/article/1429208</p>
<h2><a class="header" href="#date-æ—¶é—´æ—¥æœŸæ–°çš„-api" id="date-æ—¶é—´æ—¥æœŸæ–°çš„-api">date æ—¶é—´æ—¥æœŸæ–°çš„ api</a></h2>
<h3><a class="header" href="#ä»‹ç»-ä¸ºä»€ä¹ˆä½¿ç”¨" id="ä»‹ç»-ä¸ºä»€ä¹ˆä½¿ç”¨">ä»‹ç»-ä¸ºä»€ä¹ˆä½¿ç”¨</a></h3>
<p>å¸æ”¶äº† <a href="http://www.joda.org/joda-time/">joda date api</a> è¿™ä¸ªå¼€æºå®ç°</p>
<p>ä¸ºä»€ä¹ˆä½¿ç”¨å‘¢:</p>
<ul>
<li>
<p>Java8 ä¹‹å‰æˆ‘ä»¬å¸¸ç”¨ SimpleDateFormat, Date, Calander, ç¹ç, è€Œä¸”çº¿ç¨‹ä¸å®‰å…¨</p>
</li>
<li>
<p>Java8 ä»¥å‰ä½¿ç”¨ new Date()è·å–æœˆæ—¶ï¼Œä» 0 å¼€å§‹ï¼Œæ¯æ¬¡éƒ½è¦+1ã€‚è·å–æœ¬æœˆæœ€åä¸€å¤©ï¼Œè¦åˆ†æƒ…å†µåˆ¤æ–­ 28ï¼Œ29ï¼Œ30ï¼Œ31</p>
</li>
<li>
<p>æ—¶åŒºå¤„ç†ä¸æ–¹ä¾¿</p>
</li>
</ul>
<p>LocalDateï¼ŒLocalTimeï¼ŒLocalDateTime.... , ä½äº java.time åŒ…ä¸‹, final ä¸å¯ç»§æ‰¿</p>
<ul>
<li>ZoneId: æ—¶åŒº IDï¼Œç”¨æ¥ç¡®å®š Instant å’Œ LocalDateTime äº’ç›¸è½¬æ¢çš„è§„åˆ™</li>
<li>Instant: ç”¨æ¥è¡¨ç¤ºæ—¶é—´çº¿ä¸Šçš„ä¸€ä¸ªç‚¹</li>
<li>LocalDate: è¡¨ç¤ºæ²¡æœ‰æ—¶åŒºçš„æ—¥æœŸ, LocalDate æ˜¯ä¸å¯å˜å¹¶ä¸”çº¿ç¨‹å®‰å…¨çš„</li>
<li>LocalTime: è¡¨ç¤ºæ²¡æœ‰æ—¶åŒºçš„æ—¶é—´, LocalTime æ˜¯ä¸å¯å˜å¹¶ä¸”çº¿ç¨‹å®‰å…¨çš„</li>
<li>LocalDateTime: è¡¨ç¤ºæ²¡æœ‰æ—¶åŒºçš„æ—¥æœŸæ—¶é—´, LocalDateTime æ˜¯ä¸å¯å˜å¹¶ä¸”çº¿ç¨‹å®‰å…¨çš„</li>
<li>ZonedDateTimeï¼šæœ€å®Œæ•´çš„æ—¥æœŸæ—¶é—´ï¼ŒåŒ…å«æ—¶åŒºå’Œç›¸å¯¹UTCæˆ–æ ¼æ—å¨æ²»çš„æ—¶å·®
ZoneOffSetå’ŒZoneIdç±»</li>
<li>Clock: ç”¨äºè®¿é—®å½“å‰æ—¶åˆ»ã€æ—¥æœŸã€æ—¶é—´ï¼Œç”¨åˆ°æ—¶åŒº</li>
<li>Duration: ç”¨ç§’å’Œçº³ç§’è¡¨ç¤ºæ—¶é—´çš„æ•°é‡</li>
</ul>
<h3><a class="header" href="#ä½¿ç”¨æ–°çš„æ—¶é—´æ—¥æœŸ-api" id="ä½¿ç”¨æ–°çš„æ—¶é—´æ—¥æœŸ-api">ä½¿ç”¨æ–°çš„æ—¶é—´æ—¥æœŸ api</a></h3>
<pre><code class="language-java">// æ„é€ 
LocalDate.now();  // è·å–å½“å‰æ—¥æœŸ format: yyyy-MM-dd
LocalTime.now();  // è·å–å½“å‰æ—¶é—´ format: HH:mm:ss
LocalDateTime.now();  // è·å–å½“å‰æ—¥æœŸæ—¶é—´ format: yyyy-MM-ddTHH:mm:ss
LocalDate.of(2017, 07, 20);
LocalDateTime.of(2017, Month.JULY, 20, 15, 18);
LocalDateTime.parse(&quot;2017-07-20T15:18:00&quot;);
LocalDate.parse(&quot;2017-07-20&quot;); // å¯ä¼ å…¥ formatter æŒ‡å®šæ ¼å¼
LocalTime nowTime = LocalTime.parse(&quot;15:02&quot;);
LocalTime nowTime = LocalTime.of(15, 02);

// åŠ å‡

LocalDate tomorrow = LocalDate.now().plusDays(1);
LocalDate prevMonth = LocalDate.now().minus(1, ChronoUnit.MONTHS);
// ä¸€ä¸ªå°æ—¶åçš„æ—¶é—´
LocalTime nextHour = LocalTime.parse(&quot;15:02&quot;).plus(1, ChronoUnit.HOURS);

LocalDateTime tomorrow = now.plusDays(1);
System.out.println(&quot;æ˜å¤©çš„è¿™ä¸ªæ—¶é—´: &quot; + tomorrow);
LocalDateTime minusTowHour = now.minusHours(2);
System.out.println(&quot;ä¸¤å°æ—¶å‰: &quot; + minusTowHour);



//è·å–æ—¶é—´, æ—¥æœŸ, æœˆä»½, æ˜ŸæœŸ, 

// ä¸€ç³»åˆ—çš„getæ–¹æ³•æ¥è·å–ç‰¹å®šå•ä½:
LocalDate date = LocalDate.parse(&quot;2017-07-20&quot;)
// æ˜ŸæœŸ
DayOfWeek thursday = date.getDayOfWeek();
System.out.println(&quot;å‘¨å››: &quot; + thursday);// å‘¨å››: THURSDAY
// æ—¥æœŸ
int twenty = LocalDate.parse(&quot;2017-07-20&quot;).getDayOfMonth();
System.out.println(&quot;twenty: &quot; + twenty);// twenty: 20
// æœˆä»½
int month = date.getMonthValue()
Month month = now.getMonth();
// å¹´ä»½
int year = date.getYear()
// è·å–æœ¬æœˆç¬¬ä¸€å¤©
LocalDate firstDayOfMonth = LocalDate.parse(&quot;2017-07-20&quot;)
                .with(TemporalAdjusters.firstDayOfMonth());
System.out.println(&quot;è¿™ä¸ªæœˆçš„ç¬¬ä¸€å¤©: &quot; + firstDayOfMonth);
firstDayOfMonth = firstDayOfMonth.withDayOfMonth(1);
System.out.println(&quot;è¿™ä¸ªæœˆçš„ç¬¬ä¸€å¤©: &quot; + firstDayOfMonth);

int hour = LocalTime.parse(&quot;15:02&quot;).getHour();
System.out.println(&quot;å°æ—¶: &quot; + hour);
int minute = LocalTime.parse(&quot;15:02&quot;).getMinute();
System.out.println(&quot;åˆ†é’Ÿ: &quot; + minute);
// æ¯å¤©çš„å¼€å§‹ç»“æŸ
System.out.println(LocalTime.MAX);
System.out.println(LocalTime.MIN);
// 23:59:59.999999999
// 00:00



// æ¯”è¾ƒæ—¥æœŸ

// æ˜¯å¦ç›¸ç­‰
LocalDate date1 = LocalDate.of(2014, 01, 14);
if(date1.equals(today)){
    System.out.printf(&quot;Today %s and date1 %s are same date %n&quot;, today, date1);
}
// åˆ¤æ–­æ˜¯å¦ä¹‹å‰ä¹‹å
boolean notBefore = LocalDate.parse(&quot;2017-07-20&quot;)
                .isBefore(LocalDate.parse(&quot;2017-07-22&quot;));
System.out.println(&quot;notBefore: &quot; + notBefore);
boolean isAfter = LocalDate.parse(&quot;2017-07-20&quot;).isAfter(LocalDate.parse(&quot;2017-07-22&quot;));
System.out.println(&quot;isAfter: &quot; + isAfter);


// åˆ¤æ–­å‘¨æœŸæ€§äº‹ä»¶ (ä¸å¸¦å¹´ä»½çš„æ—¥æœŸ)

// ç”Ÿæ—¥
//åˆ¤æ–­ä»Šå¤©æ˜¯å¦æ˜¯æˆ‘çš„ç”Ÿæ—¥ï¼Œä¾‹å¦‚æˆ‘çš„ç”Ÿæ—¥æ˜¯ 2009-07-20
LocalDate birthday = LocalDate.of(2009, 07, 20);
// monthday è¡¨ç¤º ä¸å¸¦å¹´çš„æ—¥æœŸ, 
//å¯ä»¥ç”¨å®ƒåˆ¤æ–­æ¯å¹´éƒ½ä¼šå‘ç”Ÿäº‹ä»¶, 
MonthDay birthdayMd = MonthDay.of(birthday.getMonth(), birthday.getDayOfMonth());
MonthDay today = MonthDay.from(LocalDate.now());
System.out.println(&quot;ä»Šå¤©æ˜¯å¦æ˜¯æˆ‘çš„ç”Ÿæ—¥: &quot; + today.equals(birthdayMd));

// ä¿¡ç”¨å¡åˆ°æœŸ
// YearMonth ä¸å¸¦æ—¶é—´çš„å¹´æœˆ
YearMonth currentYearMonth = YearMonth.now();
System.out.printf(&quot;current year-month is %s, has %d days&quot;, currentYearMonth, currentYearMonth.lengthOfMonth());
YearMonth creditCardExpiry = YearMonth.of(2018, Month.FEBRUARY);
System.out.printf(&quot;Your credit card expires on %s &quot;, creditCardExpiry);
// Output:
// current year-month is 2014-01: has 31 days
// Your credit card expires on 2018-02


// æ˜¯å¦é—°å¹´
boolean leapYear = LocalDate.now().isLeapYear();
System.out.println(&quot;æ˜¯å¦é—°å¹´: &quot; + leapYear);

////////////////////////////////////////////////////////////

// é—´éš”
////Periodç±»è¡¨ç¤ºä¸€æ®µæ—¶é—´, ç”¨äºä¿®æ”¹ç»™å®šæ—¥æœŸæˆ–è·å¾—çš„ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„é—´éš”

LocalDate initialDate = LocalDate.parse(&quot;2017-07-20&quot;);
LocalDate finalDate   = initialDate.plus(Period.ofDays(5));
System.out.println(&quot;åˆå§‹åŒ–æ—¥æœŸ: &quot; + initialDate);
System.out.println(&quot;åŠ æ—¥æœŸä¹‹å: &quot; + finalDate);


LocalDate java8Release = LocalDate.of(2014, Month.MARCH, 14);
Period periodToNextJavaRelease = Period.between(today, java8Release);
System.out.println(&quot;Months left between today and Java 8 release : &quot;
                                   + periodToNextJavaRelease.getMonths() );
// Output:
// Months left between today and Java 8 release : 2

final long duration = Duration.between(LocalDateTime.now(), latestTime.toInstant()).getSeconds();




//////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////


// æ ¼å¼åŒ–

LocalDateTime now = LocalDateTime.now();
DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;);
System.out.println(&quot;é»˜è®¤æ ¼å¼åŒ–: &quot; + now);
System.out.println(&quot;è‡ªå®šä¹‰æ ¼å¼åŒ–: &quot; + now.format(dateTimeFormatter));

LocalDateTime localDateTime = LocalDateTime.parse(&quot;2017-07-20 15:27:44&quot;, dateTimeFormatter);
System.out.println(&quot;å­—ç¬¦ä¸²è§£æ LocalDateTime: &quot; + localDateTime);

String dateString = dateTimeFormatter.format(LocalDate.now());
System.out.println(&quot;æ—¥æœŸè½¬å­—ç¬¦ä¸²: &quot; + dateString);


///////////////////////////////////////////////////////////////

// ä¸é—ç•™ä»£ç è½¬æ¢

// Dateå’ŒInstantäº’ç›¸è½¬æ¢
Date date = Date.from(Instant.now());
Instant instant = date.toInstant();

// Dateè½¬æ¢ä¸ºLocalDateTime
Date startDate=new Date();
LocalDateTime localDateTime = startDate.toInstant()
                .atZone(ZoneId.systemDefault())
                .toLocalDateTime()

// LocalDateTimeè½¬Date
Date date =
    Date.from(localDateTime.atZone(ZoneId.systemDefault()).toInstant());

// LocalDateè½¬Date
Date date =
    Date.from(LocalDate.now().atStartOfDay().atZone(ZoneId.systemDefault()).toInstant());


///////////////////////////////////////////////////////////////


//æ—¶é—´æˆ³

Instant timestamp = Instant.now();
System.out.println(&quot;What is value of this instant &quot; + timestamp);
// Output :
// What is value of this instant 2014-01-14T08:33:33.379Z


///////////////////////////////////////////////////////////////

// Clockæ—¶é’Ÿç±» 
//ç”¨äºè·å–å½“æ—¶çš„æ—¶é—´æˆ³ï¼Œæˆ–å½“å‰æ—¶åŒºä¸‹çš„æ—¥æœŸæ—¶é—´ä¿¡æ¯
// System.currentTimeMillis()å’ŒTimeZone.getDefault()çš„åœ°æ–¹éƒ½å¯ç”¨Clockæ›¿æ¢ã€‚
public void clock(){
    // æ ¹æ®ç³»ç»Ÿæ—¶é—´è¿”å›å½“å‰æ—¶é—´å¹¶è®¾ç½®ä¸ºUTCã€‚
    Clock clock = Clock.systemUTC();
    System.out.println(&quot;Clock : &quot; + clock);//Clock : SystemClock[Z]


    // æ ¹æ®ç³»ç»Ÿæ—¶é’ŸåŒºåŸŸè¿”å›æ—¶é—´
    Clock defaultClock = Clock.systemDefaultZone();
    System.out.println(&quot;Clock : &quot; + clock);//Clock : SystemClock[Z]

    //æŒ‡å®šæ—¶åŒº
    LocalDate.now(clock)

}

///////////////////////////////////////////////////////////

// æ—¶åŒºå’Œæ—¶å·®:
//æ—¶åŒº: ä»£è¡¨äº†åœ°çƒä¸ŠæŸä¸ªåŒºåŸŸå†…æ™®éä½¿ç”¨çš„æ ‡å‡†æ—¶é—´ã€‚æ¯ä¸ªæ—¶åŒºéƒ½æœ‰ä¸€ä¸ªä»£å·ï¼Œæ ¼å¼é€šå¸¸ç”±åŒºåŸŸ/åŸå¸‚æ„æˆï¼ˆAsia/Tokyoï¼‰ï¼Œåœ¨åŠ ä¸Šä¸æ ¼æ—å¨æ²»æˆ– UTCçš„æ—¶å·®ã€‚ä¾‹å¦‚ï¼šä¸œäº¬çš„æ—¶å·®æ˜¯+09:00ã€‚
//æ—¶å·®: OffsetDateTimeç±»å®é™…ä¸Šç»„åˆäº†LocalDateTimeç±»å’ŒZoneOffsetç±»ã€‚ç”¨æ¥è¡¨ç¤ºåŒ…å«å’Œæ ¼æ—å¨æ²»æˆ–UTCæ—¶å·®çš„å®Œæ•´æ—¥æœŸï¼ˆå¹´ã€æœˆã€æ—¥ï¼‰å’Œæ—¶é—´ï¼ˆæ—¶ã€åˆ†ã€ç§’ã€çº³ç§’ï¼‰ä¿¡æ¯
// OffSetDateTimeæ˜¯å¯¹è®¡ç®—æœºå‹å¥½çš„ï¼Œ
// ZoneDateTimeåˆ™å¯¹äººæ›´å‹å¥½

// å¤„ç†æ—¶åŒº

ZoneId america = ZoneId.of(&quot;America/New_York&quot;);
LocalDateTime localtDateAndTime = LocalDateTime.now();
ZonedDateTime dateAndTimeInNewYork  = ZonedDateTime.of(localtDateAndTime, america );
System.out.println(&quot;Current date and time in a particular timezone : &quot; + dateAndTimeInNewYork);
// Output :
// Current date and time in a particular timezone : 2014-01-14T16:33:33.373-05:00[America/New_York]

// æ—¶å·®

LocalDateTime datetime = LocalDateTime.of(2014, Month.JANUARY, 14, 19, 30);
ZoneOffset offset = ZoneOffset.of(&quot;+05:30&quot;);//å°åº¦ä¸GMTæˆ–UTCæ ‡å‡†æ—¶åŒºç›¸å·®+05:30
OffsetDateTime date = OffsetDateTime.of(datetime, offset);  
System.out.println(&quot;Date and Time with timezone offset in Java : &quot; + date);
// Output :
// Date and Time with timezone offset in Java : 2014-01-14T19:30+05:30


</code></pre>
<h2><a class="header" href="#å¯é‡å¤çš„-annotations" id="å¯é‡å¤çš„-annotations">å¯é‡å¤çš„ Annotations</a></h2>
<p>åœ¨ Java8 ä¸­æ³¨è§£æ˜¯å¯ä»¥é‡å¤çš„</p>
<pre><code class="language-java">@interface Hint {
    String value();

    @Target({ ElementType.METHOD, ElementType.FIELD, ElementType.ANNOTATION_TYPE, ElementType.CONSTRUCTOR,
            ElementType.PARAMETER })
    @Retention(RetentionPolicy.RUNTIME)
    @Documented
    public @interface Hints {
        Hint[] value();
    }
}

// æ•ˆæœåŒä¸Š
@Repeatable(Hints.class)
@interface Hint {
    String value();
}
</code></pre>
<h2><a class="header" href="#base64-ç¼–ç " id="base64-ç¼–ç ">base64 ç¼–ç </a></h2>
<pre><code class="language-java">final Base64.Decoder decoder = Base64.getDecoder();
final Base64.Encoder encoder = Base64.getEncoder();
final String text = &quot;å­—ä¸²æ–‡å­—&quot;;
final byte[] textByte = text.getBytes(&quot;UTF-8&quot;);
//ç¼–ç 
final String encodedText = encoder.encodeToString(textByte);
System.out.println(encodedText);
//è§£ç 
System.out.println(new String(decoder.decode(encodedText), &quot;UTF-8&quot;));

</code></pre>
<h2><a class="header" href="#map-æ˜ å°„çš„æ–°æ–¹æ³•" id="map-æ˜ å°„çš„æ–°æ–¹æ³•">map æ˜ å°„çš„æ–°æ–¹æ³•</a></h2>
<pre><code class="language-java">// &gt;&gt;&gt; compute å¯¹keyå­˜åœ¨çš„å…ƒç´ è¿›è¡ŒåŠ å·¥ï¼Œå¹¶è¿”å›åŠ å·¥åçš„å…ƒç´ ï¼ŒåŒæ—¶mapä¸­è¯¥å…ƒç´ ä¹Ÿè¢«æ›¿æ¢æˆåŠ å·¥åçš„

KeyAndValue a1 = new KeyAndValue().setName(&quot;kevin&quot;).setValue(&quot;lee&quot;);
KeyAndValue a5 = new KeyAndValue().setName(&quot;kevin2&quot;).setValue(&quot;lee5&quot;);
KeyAndValue a6 = new KeyAndValue().setName(&quot;kevin3&quot;).setValue(&quot;lee8&quot;);
Map&lt;String, KeyAndValue&gt; maps = new HashMap&lt;&gt;();
maps.put(&quot;a&quot;,a1); //{a=KeyAndValue(name=kevin, value=lee)}
//keyå­˜åœ¨æ—¶
KeyAndValue compute1 = maps.compute(&quot;a&quot;, (k, old) -&gt; {
    Optional.ofNullable(old).ifPresent(v -&gt; v.setValue(old.getValue().concat(&quot;__ddddd&quot;)));
    return v;
});
System.out.println(compute1);
// KeyAndValue(name=kevin, value=lee__ddddd)
System.out.println(maps);
// {a=KeyAndValue(name=kevin, value=lee__ddddd)}

// keyä¸å­˜åœ¨æ—¶
KeyAndValue compute = maps.compute(&quot;b&quot;, (k, v) -&gt; {
    Optional.ofNullable(v).ifPresent(v1 -&gt; v1.setValue(v.getValue().concat(&quot;__ddddd&quot;)));
    return v;
});
System.out.println(compute);
//null
System.out.println(maps);
// {a=KeyAndValue(name=kevin, value=lee__ddddd)}



// &gt;&gt;&gt; é’ˆå¯¹valueä¸å­˜åœ¨å’Œå­˜åœ¨ï¼Œä¹Ÿæœ‰é’ˆå¯¹æ€§çš„æ–¹æ³•ï¼ˆcomputeIfAbsentå’ŒcomputeIfPresentï¼‰

//computeIfAbsent
// keyä¸å­˜åœ¨æˆ–nullï¼Œåˆ™ä¼šå¤„ç†ï¼Œè¿”å›å¤„ç†åç»“æœï¼Œå¹¶æ›´æ–°value (å³, key, å’Œ newValue ä¼š mapping ä¸Š)
// keyå­˜åœ¨ï¼Œåˆ™ä¸ä¼šè¿›è¡Œå¤„ç†ï¼Œè¿”å›valueï¼Œä¸æ›´æ–°map
//
//computeIfPresent ï¼Œ
// keyå­˜åœ¨åˆ™å¤„ç†ï¼Œè¿”å›å¤„ç†åç»“æœï¼Œå¹¶æ›´æ–°value
// keyä¸å­˜åœ¨æˆ–nullï¼Œåˆ™ä¸è¿›è¡Œå¤„ç†ï¼Œè¿”å›nullï¼Œä¸æ›´æ–°value
Map&lt;String, KeyAndValue&gt; map = new HashMap&lt;&gt;();
System.out.println(map);
//{}
KeyAndValue computeIfAbsent = map.computeIfAbsent(&quot;a&quot;, k -&gt; {
    return a6;
});
System.out.println(computeIfAbsent);
// KeyAndValue(name=kevin3, value=lee8)
System.out.println(map);
// {a=KeyAndValue(name=kevin3, value=lee8)}


// &gt;&gt;&gt;merge:å¯¹keyå­˜åœ¨çš„å…ƒç´ è¿›è¡Œåˆå¹¶æ–°å…ƒç´ ï¼Œå¹¶è¿”å›åŠ å·¥åçš„å…ƒç´ 

Map&lt;String, KeyAndValue&gt; map = new HashMap&lt;&gt;();
map.put(&quot;a&quot;,a1);
System.out.println(map);
// {a=KeyAndValue(name=kevin, value=lee)}
//â€œaâ€æœ‰å€¼ï¼Œåˆ™åˆå¹¶
//a6å°±æ˜¯åˆè¿›æ¥çš„æ–°å€¼ï¼Œa6å’ŒnewVæ˜¯åŒä¸€å¯¹è±¡
//oldVæ˜¯mapä¸­åŸæœ‰keyå¯¹åº”çš„å€¼ï¼ŒoldVæœ‰å€¼åˆ™åˆå¹¶ï¼Œæ— å€¼åˆ™æ–°å¢å¯¹åº”çš„kå’Œvalue=newVçš„é”®å€¼å¯¹
KeyAndValue merge = map.merge(&quot;a&quot;, a6, (oldV, newV) -&gt; {
    oldV.setValue(newV.getValue()+&quot;___&quot;+oldV.getValue());
    return oldV;

});
System.out.println(merge);
// KeyAndValue(name=kevin, value=lee8___lee)
System.out.println(map);
// {a=KeyAndValue(name=kevin, value=lee8___lee)}

//â€œbâ€æ— å€¼ï¼Œåˆ™æ–°å¢&quot;b&quot;:newV
KeyAndValue merge1 = map.merge(&quot;b&quot;, a5, (oldV, newV) -&gt; {
    oldV.setValue(oldV.getValue()+&quot;___&quot;+oldV.getValue());
    return oldV;    //a5å°±æ˜¯åˆè¿›æ¥çš„æ–°å€¼ï¼Œa5å’ŒnewVæ˜¯åŒä¸€å¯¹è±¡ï¼Œæ‰€ä»¥newVå’Œa5å¯äº’æ¢ï¼›
    // oldVæ˜¯mapä¸­åŸæœ‰key=â€œbâ€å¯¹åº”çš„å€¼ï¼ŒoldVæœ‰å€¼åˆ™åˆå¹¶ï¼Œæ— å€¼åˆ™æ–°å¢
});
System.out.println(merge1);
// KeyAndValue(name=kevin2, value=lee5)
System.out.println(map);
// {a=KeyAndValue(name=kevin, value=lee), b=KeyAndValue(name=kevin2, value=lee5)}

</code></pre>
<h1><a class="header" href="#java11" id="java11">java11</a></h1>
<p>https://zhuanlan.zhihu.com/p/94459000</p>
<h2><a class="header" href="#java-module" id="java-module">java module</a></h2>
<p>Java æ¨¡å—åŒ–å¼€å‘: å¢åŠ äº†æ›´é«˜çº§åˆ«çš„èšåˆï¼Œæ˜¯Packageçš„å°è£…ä½“ã€‚Packageæ˜¯ä¸€äº›ç±»è·¯å¾„åå­—çš„çº¦å®šï¼Œè€Œæ¨¡å—æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªPackageç»„æˆçš„å°è£…ä½“ã€‚</p>
<p>java9ä»¥å‰ ï¼špackage =&gt; class/interfaceã€‚java9ä»¥å ï¼šmodule =&gt; package =&gt; class/interfaceã€‚</p>
<p><code>java --list-modules</code> æŸ¥çœ‹ jdk9 è¢«åˆ†æ‹†ä¸ºå“ªäº› module</p>
<p>æ¨¡å—çš„æ˜¯é€šè¿‡module-info.javaè¿›è¡Œå®šä¹‰ï¼Œç¼–è¯‘åæ‰“åŒ…åï¼Œå°±æˆä¸ºä¸€ä¸ªæ¨¡å—çš„å®ä½“</p>
<pre><code class="language-java">// open ç”¨æ¥æŒ‡å®šå¼€æ”¾æ¨¡å—,å¼€æ”¾æ¨¡å—çš„æ‰€æœ‰åŒ…éƒ½æ˜¯å…¬å¼€çš„
open module module.one {
    // å¯¼å…¥
    // opens ç”¨æ¥æŒ‡å®šå¼€æ”¾çš„åŒ…
    opens requires java.logging;
}

module module.one {
 
 exports &lt;package&gt;;//exportsç”¨äºæŒ‡å®šæ¨¡å—ä¸‹çš„å“ªäº›åŒ…å¯ä»¥è¢«å…¶ä»–æ¨¡å—è®¿é—®
 
 exports &lt;package&gt; to &lt;module1&gt;, &lt;module2&gt;...;
}

</code></pre>
<ul>
<li><a href="https://www.zhihu.com/question/40413806/answer/135807272">ä¸ºä»€ä¹ˆ Java 9 æ¨¡å—åŒ–ä½¿ç”¨ Jigsaw è€Œä¸æ˜¯ OSGiï¼Ÿ</a></li>
<li><a href="http://www.cnblogs.com/chenjianjx/archive/2012/05/24/2516620.html">osgi å…¥é—¨</a> , https://www.cnblogs.com/zhangpan1244/p/11677705.html</li>
</ul>
<h2><a class="header" href="#jshell" id="jshell">jshell</a></h2>
<p>åœ¨å‘½ä»¤è¡Œé»˜è®¤å¯¼å…¥äº† </p>
<pre><code class="language-java">
import java.lang.*; 
import java.io.*; 
import java.math.*; 
import java.net.*; 
import java.nio.file.*; 
import java.util.*; 
import java.util.concurrent.*; 
import java.util.function.*; 
import java.util.prefs.*; 
import java.util.regex.*; 
import java.util.stream.*;

//   -&gt; /exitå°±å¯ä»¥é€€å‡º

</code></pre>
<h2><a class="header" href="#var" id="var">var</a></h2>
<p>å±€éƒ¨ç±»å‹å˜é‡æ¨æ–­ã€‚å®ƒä¼šæ ¹æ®åé¢çš„å€¼æ¥æ¨æ–­å˜é‡çš„ç±»å‹ï¼Œæ‰€ä»¥varå¿…é¡»è¦åˆå§‹åŒ–ã€‚</p>
<pre><code class="language-java">
var a = 1; 
ç­‰äº
int a = 1;


</code></pre>
<p>varä¸èƒ½å†å“ªé‡Œä½¿ç”¨ï¼Ÿ</p>
<p>ç±»æˆå‘˜å˜é‡ç±»å‹ã€‚
æ–¹æ³•è¿”å›å€¼ç±»å‹ã€‚
Java10ä¸­Lambdaä¸èƒ½ä½¿ç”¨varï¼ŒJava11ä¸­å¯ä»¥ä½¿ç”¨ã€‚</p>
<h2><a class="header" href="#jdk-api-enhencement" id="jdk-api-enhencement">jdk api enhencement</a></h2>
<pre><code class="language-java">
// åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºç™½
&quot; &quot;.isBlank(); // true
// å»é™¤é¦–å°¾ç©ºæ ¼
&quot; Hello Java11 &quot;.strip(); // &quot;Hello Java11&quot;
// å»é™¤å°¾éƒ¨ç©ºæ ¼ 
&quot; Hello Java11 &quot;.stripTrailing(); // &quot; Hello Java11&quot;
// å»é™¤é¦–éƒ¨ç©ºæ ¼ 
&quot; Hello Java11 &quot;.stripLeading(); // &quot;Hello Java11 &quot;
// å¤åˆ¶å­—ç¬¦ä¸²
&quot;Java11&quot;.repeat(3); // &quot;Java11Java11Java11&quot;
// è¡Œæ•°ç»Ÿè®¡
&quot;A\nB\nC&quot;.lines().count(); // 3

//åˆ›å»ºä¸å¯å˜é›†åˆã€‚

var list = List.of(&quot;Java&quot;, &quot;Python&quot;, &quot;C&quot;); //ä¸å¯å˜é›†åˆ
 var copy = List.copyOf(list); //copyOfåˆ¤æ–­æ˜¯å¦æ˜¯ä¸å¯å˜é›†åˆç±»å‹ï¼Œå¦‚æœæ˜¯ç›´æ¥è¿”å›
 System.out.println(list == copy); // true
 var list = new ArrayList&lt;String&gt;(); // è¿™é‡Œè¿”å›æ­£å¸¸çš„é›†åˆ
 var copy = List.copyOf(list); // è¿™é‡Œè¿”å›ä¸€ä¸ªä¸å¯å˜é›†åˆ
 System.out.println(list == copy); // false


ä»¥å‰
Stream.of(null); //æŠ¥é”™
ç°åœ¨
Stream.ofNullable(null);

// http client æ”¯æŒåŒæ­¥å¼‚æ­¥

var request = HttpRequest.newBuilder()
 .uri(URI.create(&quot;https://www.baidu.com/&quot;))
 .build();
 var client = HttpClient.newHttpClient();
 // åŒæ­¥
 HttpResponse&lt;String&gt; response = client.send(request, HttpResponse.BodyHandlers.ofString());
 System.out.println(response.body());
 // å¼‚æ­¥
 CompletableFuture&lt;HttpResponse&lt;String&gt;&gt; sendAsync = client.sendAsync(request, HttpResponse.BodyHandlers.ofString());
 //è¿™é‡Œä¼šé˜»å¡
 HttpResponse&lt;String&gt; response1 = sendAsync.get();
 System.out.println(response1.body());
</code></pre>
<h2><a class="header" href="#æ”¹è¿›-java-ç¨‹åºåœ¨-docker-ä¸­çš„è¡¨ç°" id="æ”¹è¿›-java-ç¨‹åºåœ¨-docker-ä¸­çš„è¡¨ç°">æ”¹è¿› java ç¨‹åºåœ¨ docker ä¸­çš„è¡¨ç°</a></h2>
<p>JVMç°åœ¨å¯ä»¥è¯†åˆ«ç”±å®¹å™¨æ§åˆ¶ç»„ï¼ˆcgroupsï¼‰è®¾ç½®çš„çº¦æŸã€‚å¯ä»¥åœ¨å®¹å™¨ä¸­ä½¿ç”¨å†…å­˜å’ŒCPUçº¦æŸæ¥ç›´æ¥ç®¡ç†Javaåº”ç”¨ç¨‹åºï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š</p>
<p>éµå®ˆå®¹å™¨ä¸­è®¾ç½®çš„å†…å­˜é™åˆ¶
åœ¨å®¹å™¨ä¸­è®¾ç½®å¯ç”¨çš„CPU
åœ¨å®¹å™¨ä¸­è®¾ç½®CPUçº¦æŸ</p>
<h1><a class="header" href="#classloader-ç±»åŠ è½½å™¨" id="classloader-ç±»åŠ è½½å™¨">classloader ç±»åŠ è½½å™¨</a></h1>
<p>https://www.cnblogs.com/doit8791/p/5820037.html</p>
<h2><a class="header" href="#classloader-çš„æ¦‚å¿µ" id="classloader-çš„æ¦‚å¿µ">classloader çš„æ¦‚å¿µ</a></h2>
<p>ç±»åŠ è½½å™¨ï¼ˆclass loaderï¼‰ç”¨æ¥åŠ è½½ Java ç±»åˆ° Java è™šæ‹Ÿæœºä¸­ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒClassLoader è¿˜è´Ÿè´£åŠ è½½ Java åº”ç”¨æ‰€éœ€çš„èµ„æºï¼Œå¦‚å›¾åƒæ–‡ä»¶å’Œé…ç½®æ–‡ä»¶ç­‰</p>
<h2><a class="header" href="#å±‚çº§ç»“æ„" id="å±‚çº§ç»“æ„">å±‚çº§ç»“æ„</a></h2>
<p>æ ‘çŠ¶ç»“æ„:</p>
<p><img src="Snipaste_2018-10-29_23-25-08.png" alt="alt" /><img src="Snipaste_2018-12-29_00-19-01.png" alt="alt" /></p>
<p>åˆ†ç±». [çˆ¶ -&gt; å­ å…³ç³»]æ˜¯è¿™æ ·çš„: å¼•å¯¼ç±»åŠ è½½å™¨ï¼ˆbootstrap class loaderï¼‰-&gt; æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆextensions class loaderï¼‰ -&gt; ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆsystem class loaderï¼‰ -&gt; user-defined classloader</p>
<ul>
<li>
<p>ç³»ç»Ÿ(jvm) æä¾›çš„ classloader</p>
<ul>
<li>
<p>å¼•å¯¼ç±»åŠ è½½å™¨ï¼ˆbootstrap class loaderï¼‰ï¼šå®ƒç”¨æ¥åŠ è½½ Java çš„æ ¸å¿ƒåº“ (rt.jar ä¸­çš„æ‰€æœ‰ class)ï¼Œç”± C++ç¼–å†™çš„ï¼Œå®ƒæœ¬èº«æ˜¯è™šæ‹Ÿæœºçš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ª JAVA ç±»ï¼Œå¹¶ä¸ç»§æ‰¿è‡ª java.lang.ClassLoader, æ²¡æœ‰ parent</p>
</li>
<li>
<p>æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆextensions class loaderï¼‰ï¼š <code>ExtClassLoader</code>, å®ƒç”¨æ¥åŠ è½½ Java çš„æ‰©å±•åº“(Java è™šæ‹Ÿæœºçš„å®ç°ä¼šæä¾›ä¸€ä¸ªæ‰©å±•åº“ç›®å½•, è¯¥ç±»åŠ è½½å™¨åœ¨æ­¤ç›®å½•é‡Œé¢æŸ¥æ‰¾å¹¶åŠ è½½ Java ç±»)ã€‚</p>
</li>
<li>
<p>ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆapp class loaderï¼‰ï¼š <code>AppClassLoader</code>, å®ƒæ ¹æ® Java åº”ç”¨çš„ç±»è·¯å¾„ï¼ˆCLASSPATHï¼‰æ¥åŠ è½½ Java ç±»ã€‚Java åº”ç”¨çš„ç±»éƒ½æ˜¯ç”±å®ƒæ¥å®ŒæˆåŠ è½½çš„ã€‚å¯ä»¥é€šè¿‡ <code>ClassLoader.getSystemClassLoader()</code>æ¥è·å–å®ƒã€‚</p>
</li>
<li>
<p>è‡ªå®šä¹‰çš„ classloader - é€šè¿‡ç»§æ‰¿ <code>java.lang.ClassLoader</code>æŠ½è±¡ç±»çš„æ–¹å¼å®ç°è‡ªå·±çš„ç±»åŠ è½½å™¨, å¯ä»¥ç”¨æ¥<code>åŠ è½½ é classpath ä¸­çš„ jar å’Œ ç›®å½• (æ¯”å¦‚ä»ç½‘ç»œä¸‹è½½)</code>, <code>åœ¨åŠ è½½ class å‰ åšå…¶ä»–äº‹æƒ…, å¦‚è§£å¯†</code> , <code>å®ç°ç±»éš”ç¦»</code> (è¿è¡Œå¤šä¸ªä¸åŒç‰ˆæœ¬çš„ jar åŒ…, check https://blog.csdn.net/t894690230/article/details/73252331)</p>
<ul>
<li>
<p>loadClass æ–¹æ³• - åŠ è½½æŒ‡å®šåç§°çš„ç±», (å¦ä¸€ç§åŠ è½½ class çš„æ–¹æ³• <code>Class.forName</code> å¯åŠ¨è¿™ä¸ªåŠ è½½è¿‡ç¨‹æ˜¯é€šè¿‡è°ƒç”¨ <code>loadClass</code>æ¥å®ç°çš„, ç§°ä¸ºåˆå§‹åŠ è½½å™¨ï¼ˆinitiating loaderï¼‰)</p>
</li>
<li>
<p>findLoadedClass æ–¹æ³• - ä»å½“å‰ classloader å®ä¾‹çš„ç¼“å­˜ä¸­å¯»æ‰¾å·²ç»åŠ è½½çš„ç±»</p>
</li>
<li>
<p><code>findClassæ–¹æ³•</code> - åªéœ€è¦è¦†ç›–è¿™ä¸ªæ–¹æ³•, è‡ªå®šä¹‰åŠ è½½é€»è¾‘, å…¶ä»–æ–¹æ³•ä¸åŠ¨;</p>
</li>
<li>
<p>defineClass æ–¹æ³• - å°† class å­—èŠ‚ç è½¬æ¢ä¸º Class å¯¹è±¡ (çœŸæ­£å®Œæˆç±»çš„åŠ è½½å·¥ä½œæ˜¯é€šè¿‡è°ƒç”¨ <code>defineClass</code>æ¥å®ç°çš„, ç§°ä¸ºä¸€ä¸ªç±»çš„å®šä¹‰åŠ è½½å™¨ï¼ˆdefining loaderï¼‰)</p>
</li>
<li>
<p>defineClass() å’Œ loadClass() ä¸¤ç§åŠ è½½æ–¹å¼çš„å…³è”ä¹‹å¤„åœ¨äºï¼šä¸€ä¸ªç±»çš„å®šä¹‰åŠ è½½å™¨æ˜¯å®ƒå¼•ç”¨çš„å…¶å®ƒç±»çš„åˆå§‹åŠ è½½å™¨ã€‚å¦‚ç±» com.example.Outer å¼•ç”¨äº†ç±» com.example.Innerï¼Œåˆ™ç”±ç±» com.example.Outer çš„å®šä¹‰åŠ è½½å™¨è´Ÿè´£å¯åŠ¨ç±» com.example.Inner çš„åŠ è½½è¿‡ç¨‹ã€‚</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2><a class="header" href="#å·¥ä½œè¿‡ç¨‹-and-åŒäº²å§”æ´¾æ¨¡å¼" id="å·¥ä½œè¿‡ç¨‹-and-åŒäº²å§”æ´¾æ¨¡å¼">å·¥ä½œè¿‡ç¨‹ and åŒäº²å§”æ´¾æ¨¡å¼</a></h2>
<ol>
<li>
<p>Java æºç¨‹åºï¼ˆ.java æ–‡ä»¶ï¼‰åœ¨ç»è¿‡ Java ç¼–è¯‘å™¨ç¼–è¯‘ä¹‹åå°±è¢«è½¬æ¢æˆ Java å­—èŠ‚ä»£ç ï¼ˆ.class æ–‡ä»¶ï¼‰ã€‚</p>
</li>
<li>
<p>ç±»åŠ è½½å™¨è´Ÿè´£è¯»å– Java å­—èŠ‚ä»£ç ï¼Œå¹¶è½¬æ¢æˆ java.lang.Class ç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚æ¯ä¸ªè¿™æ ·çš„å®ä¾‹ç”¨æ¥è¡¨ç¤ºä¸€ä¸ª Java ç±»ã€‚é€šè¿‡æ­¤å®ä¾‹çš„<code>newInstance()</code>æ–¹æ³•å°±å¯ä»¥åˆ›å»ºå‡ºè¯¥ç±»çš„ä¸€ä¸ªå¯¹è±¡</p>
<ol>
<li>
<p>ç±»åŠ è½½å™¨åœ¨å°è¯• è‡ªå·±å»æŸ¥æ‰¾æŸä¸ªç±»çš„å­—èŠ‚ä»£ç å¹¶å®šä¹‰å®ƒ ä¹‹å‰, ä¼šå…ˆå°è¯•é€šè¿‡ parent classloader åŠ è½½ï¼Œå¦‚æœæ— æ³•åŠ è½½ï¼Œä¾æ¬¡ç±»æ¨ -- <code>classloaderçš„åŒäº²å§”æ´¾æ¨¡å¼</code> , ç”±äº [åŒäº²å§”æ´¾æ¨¡å¼], çœŸæ­£å®Œæˆç±»çš„åŠ è½½å·¥ä½œçš„ç±»åŠ è½½å™¨å’Œå¯åŠ¨è¿™ä¸ªåŠ è½½è¿‡ç¨‹çš„ç±»åŠ è½½å™¨ï¼Œæœ‰å¯èƒ½ä¸æ˜¯åŒä¸€ä¸ª;</p>
</li>
<li>
<p>ä¸ºä»€ä¹ˆè¦æœ‰ classloader åŒäº²å§”æ´¾æ¨¡å¼çš„è®¾è®¡? ------- ä¸ºäº†ä¿è¯ Java æ ¸å¿ƒåº“çš„ç±»å‹å®‰å…¨ (ä¸¾ä¸ªä¾‹å­ ğŸŒ° -&gt; æ‰€æœ‰ Java åº”ç”¨éƒ½è‡³å°‘éœ€è¦å¼•ç”¨ java.lang.Object ç±»ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œjava.lang.Object è¿™ä¸ªç±»éœ€è¦è¢«åŠ è½½åˆ° Java è™šæ‹Ÿæœºä¸­ã€‚å¦‚æœè¿™ä¸ªåŠ è½½è¿‡ç¨‹ç”± Java åº”ç”¨è‡ªå·±çš„ç±»åŠ è½½å™¨æ¥å®Œæˆçš„è¯ï¼Œå¾ˆå¯èƒ½å°±å­˜åœ¨å¤šä¸ªç‰ˆæœ¬çš„ java.lang.Object ç±»ï¼Œè€Œä¸”è¿™äº›ç±»ä¹‹é—´æ˜¯ä¸å…¼å®¹çš„ã€‚é€šè¿‡ä»£ç†æ¨¡å¼ï¼Œå¯¹äº Java æ ¸å¿ƒåº“çš„ç±»çš„åŠ è½½å·¥ä½œç”±å¼•å¯¼ç±»åŠ è½½å™¨æ¥ç»Ÿä¸€å®Œæˆï¼Œä¿è¯äº† Java åº”ç”¨æ‰€ä½¿ç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ªç‰ˆæœ¬çš„ Java æ ¸å¿ƒåº“çš„ç±»ï¼Œæ˜¯äº’ç›¸å…¼å®¹çš„ã€‚)</p>
</li>
</ol>
</li>
<li>
<p>ç±»åŠ è½½å™¨åœ¨æˆåŠŸåŠ è½½æŸä¸ªç±»ä¹‹åï¼Œä¼šæŠŠå¾—åˆ°çš„ java.lang.Class ç±»çš„å®ä¾‹ç¼“å­˜èµ·æ¥ - å¯¹äºä¸€ä¸ªç±»åŠ è½½å™¨å®ä¾‹æ¥è¯´ï¼Œç›¸åŒå…¨åçš„ç±»åªåŠ è½½ä¸€æ¬¡ï¼Œå³ loadClass æ–¹æ³•ä¸ä¼šè¢«é‡å¤è°ƒç”¨ã€‚</p>
</li>
</ol>
<h2><a class="header" href="#çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨-æ‰“ä¹±å±‚çº§ç»“æ„" id="çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨-æ‰“ä¹±å±‚çº§ç»“æ„">çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨-æ‰“ä¹±å±‚çº§ç»“æ„</a></h2>
<p>çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼ˆcontext class loaderï¼‰åªæ˜¯ä¸€ä¸ªæ¦‚å¿µ , ç±» <code>java.lang.Thread</code>ä¸­çš„æ–¹æ³• <code>getContextClassLoader()</code>å’Œ <code>setContextClassLoader(ClassLoader cl)</code>ç”¨æ¥è·å–å’Œè®¾ç½®çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨</p>
<p>ä¸»è¦æ˜¯ä¸ºäº†è§£å†³ä¸€ä¸ªåŒäº²å§”æ´¾æ¨¡å¼çš„ bug , ä¸¾ä¸ªä¾‹å­ ğŸŒ°: Java æä¾›äº†å¾ˆå¤šæœåŠ¡æä¾›è€…æ¥å£ï¼ˆService Provider Interfaceï¼ŒSPIï¼‰ï¼Œå…è®¸ç¬¬ä¸‰æ–¹ä¸ºè¿™äº›æ¥å£æä¾›å®ç°(å¸¸è§çš„ SPI æœ‰ JDBC, JAXP..., ) , è¿™äº›å®ç°ç”±<code>app class loader</code>æ¥åŠ è½½, è€Œè¿™äº› SPI çš„æ¥å£ç”± Java æ ¸å¿ƒåº“æ¥æä¾›, æ˜¯é€šè¿‡<code>å¼•å¯¼ç±»åŠ è½½å™¨ bootstrap class loader</code>æ¥åŠ è½½). å¼•å¯¼ç±»åŠ è½½å™¨æ˜¯æ— æ³•æ‰¾åˆ° SPI çš„å®ç°ç±»çš„ï¼Œå› ä¸ºå®ƒåªåŠ è½½ Java çš„æ ¸å¿ƒåº“ã€‚å®ƒä¹Ÿä¸èƒ½ä»£ç†ç»™ app class loader ï¼Œå› ä¸º bootstrap class loader åœ¨ app class loader çš„ä¸Šå±‚, ä¹Ÿå°±æ˜¯è¯´ï¼Œç±»åŠ è½½å™¨çš„åŒäº²å§”æ´¾æ¨¡å¼æ— æ³•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨æ­£å¥½è§£å†³äº†è¿™ä¸ªé—®é¢˜ [åœ¨ SPI æ¥å£çš„ä»£ç ä¸­ä½¿ç”¨çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼Œå°±å¯ä»¥æˆåŠŸçš„åŠ è½½åˆ° SPI å®ç°çš„ç±»]</p>
<h2><a class="header" href="#å€ŸåŠ©-classloader-å®ç°ç±»éš”ç¦»" id="å€ŸåŠ©-classloader-å®ç°ç±»éš”ç¦»">å€ŸåŠ© classloader å®ç°ç±»éš”ç¦»</a></h2>
<p>ä¸åŒçš„ç±»åŠ è½½å™¨ä¸ºå„è‡ªåŠ è½½çš„ç±»åˆ›å»ºäº†é¢å¤–çš„åç§°ç©ºé—´, å³ä½¿å„è‡ªåŠ è½½çš„æ˜¯ç›¸åŒåç§°çš„ç±»ã€‚ç›¸åŒåç§°çš„ç±»å¯ä»¥å¹¶å­˜åœ¨ Java è™šæ‹Ÿæœºä¸­ï¼Œ<code>åªéœ€è¦ç”¨ä¸åŒçš„ç±»åŠ è½½å™¨æ¥åŠ è½½å®ƒä»¬å³å¯</code>ã€‚ä¸åŒç±»åŠ è½½å™¨åŠ è½½çš„ç±»ä¹‹é—´æ˜¯ä¸å…¼å®¹çš„ï¼Œè¿™å°±ç›¸å½“äºåœ¨ Java è™šæ‹Ÿæœºå†…éƒ¨åˆ›å»ºäº†ä¸€ä¸ªä¸ª<code>ç›¸äº’éš”ç¦»çš„ Java ç±»ç©ºé—´</code>ã€‚è¿™ç§æŠ€æœ¯åœ¨è®¸å¤šæ¡†æ¶ä¸­éƒ½è¢«ç”¨åˆ°</p>
<p>å¯ä»¥è¿™ä¹ˆåšçš„åŸç†æ˜¯:</p>
<p>Java è™šæ‹Ÿæœºæ˜¯å¦‚ä½•åˆ¤å®šä¸¤ä¸ª Java ç±»æ˜¯ç›¸åŒçš„? ------- ğŸ“Œ ç±»çš„å…¨åæ˜¯å¦ç›¸åŒ ğŸ“Œ åŠ è½½æ­¤ç±»çš„ç±»åŠ è½½å™¨(å®ä¾‹å¯¹è±¡ id)æ˜¯å¦ä¸€æ ·</p>
<h2><a class="header" href="#ç±»åŠ è½½ç›¸å…³çš„å¼‚å¸¸" id="ç±»åŠ è½½ç›¸å…³çš„å¼‚å¸¸">ç±»åŠ è½½ç›¸å…³çš„å¼‚å¸¸</a></h2>
<ul>
<li>
<p>classnotfoundException - åœ¨å½“å‰çš„ classloader ä¸­<code>åŠ è½½ class æ–‡ä»¶æ—¶æ²¡æœ‰æ‰¾åˆ°</code></p>
<p>å¯¹äº system class loader, åªè¦ class path ä¸­æ²¡æœ‰ç›¸åº”çš„ class æ–‡ä»¶, å°±æŠ›å¼‚å¸¸;
å¯¹äº user-defined class loader è¦åˆ°ä»£ç æ‰¾æ‰¾çœ‹, çœ‹å…·ä½“æ˜¯ä»ä»€ä¹ˆä½ç½®åŠ è½½ class</p>
</li>
<li>
<p>NoClassDefFoundException - åŠ è½½çš„ç±»å¼•ç”¨äº†å¦å¤–çš„ç±», è€Œè¿™ä¸ª&quot;å¦å¤–çš„&quot;<code>å¼•ç”¨ç±»ä¸å­˜åœ¨orå½“å‰class loaderæ— æ³•åŠ è½½å¼•ç”¨çš„ç±»</code></p>
<p>è§£å†³è¿™ä¸ªå¼‚å¸¸, éœ€è¦åˆ°å¼‚å¸¸ç±»ä¸­æ‰¾åˆ°å¼•ç”¨åˆ°äº†å“ªäº›å¦å¤–çš„ç±» , ç„¶åçœ‹çœ‹è¿™äº›å¦å¤–çš„ç±»æ˜¯ä¸æ˜¯å­˜åœ¨äºèƒ½å¤Ÿè¢«å½“å‰ class loader åŠ è½½åˆ°çš„ä½ç½®</p>
</li>
<li>
<p>LinkageError - åŠ è½½æŸä¸ª class æ—¶, è¿™ä¸ª class å·²ç»å­˜åœ¨äºå½“å‰çš„ class loader ä¸­äº† , ä¹Ÿå°±æ˜¯ <code>é‡å¤çš„åŠ è½½</code></p>
<p>è‡ªå®šä¹‰ class loader ä¸­ and å¹¶å‘ä¸‹å®¹æ˜“å‡ºç°</p>
<p>è¿™ä¸ªæœºåˆ¶ä¹Ÿé€ æˆ jvm æ— æ³•ç›´æ¥æ›´æ–°ä¸€ä¸ªå·²ç»åŠ è½½è¿‡çš„ class, åªèƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„ class loader æ¥åŠ è½½æ›´æ–°åçš„ class, ç„¶åå°†æ–°è¯·æ±‚è½¬å…¥æ–° class loader æ¥è·å–æ›´æ–°åçš„ç±» -------- è¿™ä¹Ÿæ—¶åŠ¨æ€æ›´æ–°çš„åŸç†</p>
</li>
<li>
<p>ClassCastException - è½¬å‹å¼‚å¸¸</p>
<p>ä½¿ç”¨æ³›å‹å¯ä»¥è§„é¿</p>
<p>è¦æ³¨æ„ä¸¤ä¸ªåŒç±»å‹å¯¹è±¡ä½†æ˜¯é€šè¿‡ä¸åŒ class loader åŠ è½½çš„æƒ…å†µ, è¿™ç§æƒ…å†µä¹Ÿä¼šæŠ›å¼‚å¸¸</p>
</li>
</ul>
<h2><a class="header" href="#è‡ªå®šä¹‰-classloaderåŠ è½½ç½‘ç»œä¸Šçš„-class" id="è‡ªå®šä¹‰-classloaderåŠ è½½ç½‘ç»œä¸Šçš„-class">è‡ªå®šä¹‰ classloader(åŠ è½½ç½‘ç»œä¸Šçš„ class)</a></h2>
<p>åœºæ™¯: åº”ç”¨é€šè¿‡ç½‘ç»œæ¥ä¼ è¾“ Java ç±»çš„å­—èŠ‚ä»£ç ï¼Œä¸ºäº†ä¿è¯å®‰å…¨æ€§ï¼Œè¿™äº›å­—èŠ‚ä»£ç ç»è¿‡äº†åŠ å¯†å¤„ç†ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦è‡ªå·±çš„ç±»åŠ è½½å™¨æ¥ä»æŸä¸ªç½‘ç»œåœ°å€ä¸Šè¯»å–åŠ å¯†åçš„å­—èŠ‚ä»£ç ï¼Œæ¥ç€è¿›è¡Œè§£å¯†å’ŒéªŒè¯ï¼Œæœ€åå®šä¹‰å‡ºè¦åœ¨ Java è™šæ‹Ÿæœºä¸­è¿è¡Œçš„ç±»æ¥</p>
<p>ç¼–å†™ä¸€ä¸ªç±»ç»§æ‰¿è‡ª ClassLoader æŠ½è±¡ç±»ã€‚
å¤å†™å®ƒçš„ findClass()æ–¹æ³•ã€‚
åœ¨ findClass()æ–¹æ³•ä¸­è°ƒç”¨ defineClass()ã€‚</p>
<pre><code class="language-java">//æ–‡ä»¶ç³»ç»Ÿç±»åŠ è½½å™¨
public class FileSystemClassLoader extends ClassLoader {

   private String rootDir;

   public FileSystemClassLoader(String rootDir) {
       this.rootDir = rootDir;
   }

   // è‡ªå®šä¹‰ classloader é‡å†™ findClass å³å¯
   /*
   - java.lang.ClassLoaderç±»çš„æ–¹æ³• loadClass()å°è£…äº†å‰é¢æåˆ°çš„ä»£ç†æ¨¡å¼çš„å®ç°ã€‚è¯¥æ–¹æ³•ä¼šé¦–å…ˆè°ƒç”¨ findLoadedClass()æ–¹æ³•æ¥æ£€æŸ¥è¯¥ç±»æ˜¯å¦å·²ç»è¢«åŠ è½½è¿‡ï¼›å¦‚æœæ²¡æœ‰åŠ è½½è¿‡çš„è¯ï¼Œä¼šè°ƒç”¨çˆ¶ç±»åŠ è½½å™¨çš„ loadClass()æ–¹æ³•æ¥å°è¯•åŠ è½½è¯¥ç±»ï¼›å¦‚æœçˆ¶ç±»åŠ è½½å™¨æ— æ³•åŠ è½½è¯¥ç±»çš„è¯ï¼Œå°±è°ƒç”¨ findClass()æ–¹æ³•æ¥æŸ¥æ‰¾è¯¥ç±»ã€‚å› æ­¤ï¼Œä¸ºäº†ä¿è¯ç±»åŠ è½½å™¨éƒ½æ­£ç¡®å®ç°ä»£ç†æ¨¡å¼ï¼Œåœ¨å¼€å‘è‡ªå·±çš„ç±»åŠ è½½å™¨æ—¶ï¼Œæœ€å¥½ä¸è¦è¦†å†™ loadClass()æ–¹æ³•ï¼Œè€Œæ˜¯è¦†å†™ findClass()æ–¹æ³•ã€‚
   */
   protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException {
       byte[] classData = getClassData(name);
       if (classData == null) {
           throw new ClassNotFoundException();
       }
       else {
           return defineClass(name, classData, 0, classData.length);
       }
   }

   private byte[] getClassData(String className) {
       String path = classNameToPath(className);
       try {
           InputStream ins = new FileInputStream(path);
           ByteArrayOutputStream baos = new ByteArrayOutputStream();
           int bufferSize = 4096;
           byte[] buffer = new byte[bufferSize];
           int bytesNumRead = 0;
           while ((bytesNumRead = ins.read(buffer)) != -1) {
               baos.write(buffer, 0, bytesNumRead);
           }
           return baos.toByteArray();
       } catch (IOException e) {
           e.printStackTrace();
       }
       return null;
   }

   private String classNameToPath(String className) {
       return rootDir + File.separatorChar
               + className.replace('.', File.separatorChar) + &quot;.class&quot;;
   }
}

</code></pre>
<pre><code class="language-java">// ç½‘ç»œç±»åŠ è½½å™¨
/**
é€šè¿‡ç½‘ç»œä¸‹è½½ Java ç±»å­—èŠ‚ä»£ç å¹¶å®šä¹‰å‡º Java ç±»
 */
public class NetworkClassLoader extends ClassLoader {

    private String rootUrl;

    public NetworkClassLoader(String rootUrl) {
        this.rootUrl = rootUrl;
    }

    protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException {
        byte[] classData = getClassData(name);
        if (classData == null) {
            throw new ClassNotFoundException();
        }
        else {
            return defineClass(name, classData, 0, classData.length);
        }
    }

    private byte[] getClassData(String className) {
        String path = classNameToPath(className);
        try {
            URL url = new URL(path);
            InputStream ins = url.openStream();
            ByteArrayOutputStream baos = new ByteArrayOutputStream();
            int bufferSize = 4096;
            byte[] buffer = new byte[bufferSize];
            int bytesNumRead = 0;
            while ((bytesNumRead = ins.read(buffer)) != -1) {
                baos.write(buffer, 0, bytesNumRead);
            }
            return baos.toByteArray();
        } catch (Exception e) {
            e.printStackTrace();
        }
        return null;
    }

    private String classNameToPath(String className) {
        return rootUrl + &quot;/&quot;
                + className.replace('.', '/') + &quot;.class&quot;;
    }
}

////////////////////////////////////////

// test
public class CalculatorTest {

    public static void main(String[] args) {
        String url = &quot;http://localhost:8080/ClassloaderTest/classes&quot;;
        NetworkClassLoader ncl = new NetworkClassLoader(url);
        String basicClassName = &quot;com.example.CalculatorBasic&quot;;
        String advancedClassName = &quot;com.example.CalculatorAdvanced&quot;;
        try {
            Class&lt;?&gt; clazz = ncl.loadClass(basicClassName);
            ICalculator calculator = (ICalculator) clazz.newInstance();// é€šè¿‡æ¥å£æ¥æ”¶
            System.out.println(calculator.getVersion());
            clazz = ncl.loadClass(advancedClassName);
            calculator = (ICalculator) clazz.newInstance();
            System.out.println(calculator.getVersion());
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

}

</code></pre>
<h1><a class="header" href="#è·¯å¾„é—®é¢˜" id="è·¯å¾„é—®é¢˜">è·¯å¾„é—®é¢˜</a></h1>
<h2><a class="header" href="#è·å–-classpath-å’Œ-ç³»ç»Ÿå±æ€§-ç¯å¢ƒå˜é‡" id="è·å–-classpath-å’Œ-ç³»ç»Ÿå±æ€§-ç¯å¢ƒå˜é‡">è·å– classpath å’Œ ç³»ç»Ÿå±æ€§ ç¯å¢ƒå˜é‡</a></h2>
<pre><code class="language-java">String str = Thread.currentThread().getContextClassLoader().getResource(&quot;&quot;).getPath();
System.out.println(&quot;-------&quot;);
System.out.println(str); // æˆ‘æ˜¯åœ¨æµ‹è¯•ç›®å½•ä¸‹, æ‰€ä»¥ç»“æœæ˜¯: /D:/repo/eclipse/etc-learn/target/test-classes/

String str1 = Thread.currentThread().getContextClassLoader().getResource(&quot;./&quot;).getPath();
System.out.println(str1);// æ— è®ºæ˜¯[.] è¿˜æ˜¯[./], ç»“æœåŒ str

String str2 = Thread.currentThread().getContextClassLoader().getResource(&quot;demo.properties&quot;).getPath();
System.out.println(str2);// /D:/repo/eclipse/etc-learn/target/classes/demo.properties

// è¿™ç§é€šè¿‡ .class è·å–çš„è·¯å¾„, ä¸æ˜¯ root classpath, è€Œæ˜¯ è¯¥ç±»æ‰€åœ¨çš„è¯¦ç»†class pathè·¯å¾„
PathUtil.class.getResource(classpath).getPath()
//   /D:/repo/repo_github/shared_already/springboot-demos/groovy-demo/target/classes/io/github/xiaoyu/groovydemo/util/


</code></pre>
<p>è·å–èµ„æºæ–‡ä»¶</p>
<pre><code class="language-java">Properties props = new Properties();
props.load(Thread.currentThread().getContextClassLoader()
// è¿™é‡Œå¿…é¡»æ˜¯ class path
        .getResourceAsStream(&quot;com/xiaoyu/learn/etc/schedule/quartz/simple/demo/quartz.properties&quot;));

</code></pre>
<p>é€šè¿‡ System.getProperty(&quot;user.dir&quot;)</p>
<p>è‹¥æ˜¯è®¾ç½®è‡ªå®šä¹‰å‚æ•°, å¯ä»¥åœ¨ jvm å‚æ•°ä¸­è®¾ç½®: <code>-Daaa=xxx</code>, åœ¨ Tomcat çš„  catalina.sh ä¸­ é…ç½® <code>JAVA_OPS=-Daaa=xxx</code></p>
<pre><code class="language-java">/**
*
java.version          Java è¿è¡Œæ—¶ç¯å¢ƒç‰ˆæœ¬
java.vendor         Java è¿è¡Œæ—¶ç¯å¢ƒä¾›åº”å•†
java.vendor.url         Java ä¾›åº”å•†çš„ URL
java.vm.specification.version         Java è™šæ‹Ÿæœºè§„èŒƒç‰ˆæœ¬
java.vm.specification.vendor         Java è™šæ‹Ÿæœºè§„èŒƒä¾›åº”å•†
java.vm.specification.name         Java è™šæ‹Ÿæœºè§„èŒƒåç§°
java.vm.version         Java è™šæ‹Ÿæœºå®ç°ç‰ˆæœ¬
java.vm.vendor         Java è™šæ‹Ÿæœºå®ç°ä¾›åº”å•†
java.vm.name         Java è™šæ‹Ÿæœºå®ç°åç§°
java.specification.version         Java è¿è¡Œæ—¶ç¯å¢ƒè§„èŒƒç‰ˆæœ¬
java.specification.vendor         Java è¿è¡Œæ—¶ç¯å¢ƒè§„èŒƒä¾›åº”å•†
java.specification.name         Java è¿è¡Œæ—¶ç¯å¢ƒè§„èŒƒåç§°
os.name         æ“ä½œç³»ç»Ÿçš„åç§°
os.arch         æ“ä½œç³»ç»Ÿçš„æ¶æ„
os.version         æ“ä½œç³»ç»Ÿçš„ç‰ˆæœ¬
file.separator         æ–‡ä»¶åˆ†éš”ç¬¦ï¼ˆåœ¨ UNIX ç³»ç»Ÿä¸­æ˜¯â€œ / â€ï¼‰
path.separator         è·¯å¾„åˆ†éš”ç¬¦ï¼ˆåœ¨ UNIX ç³»ç»Ÿä¸­æ˜¯â€œ : â€ï¼‰
line.separator         è¡Œåˆ†éš”ç¬¦ï¼ˆåœ¨ UNIX ç³»ç»Ÿä¸­æ˜¯â€œ /n â€ï¼‰

java.home         Java å®‰è£…ç›®å½•
java.class.version         Java ç±»æ ¼å¼ç‰ˆæœ¬å·
java.class.path         Java ç±»è·¯å¾„
java.library.path          åŠ è½½åº“æ—¶æœç´¢çš„è·¯å¾„åˆ—è¡¨
java.io.tmpdir         é»˜è®¤çš„ä¸´æ—¶æ–‡ä»¶è·¯å¾„
java.compiler         è¦ä½¿ç”¨çš„ JIT ç¼–è¯‘å™¨çš„åç§°
java.ext.dirs         ä¸€ä¸ªæˆ–å¤šä¸ªæ‰©å±•ç›®å½•çš„è·¯å¾„
user.name         ç”¨æˆ·çš„è´¦æˆ·åç§°
user.home         ç”¨æˆ·çš„ä¸»ç›®å½•
user.dir
*/

</code></pre>
<h1><a class="header" href="#æ•°æ®ç±»å‹" id="æ•°æ®ç±»å‹">æ•°æ®ç±»å‹</a></h1>
<h2><a class="header" href="#å„ä¸ªæ•°æ®ç±»å‹çš„èŒƒå›´" id="å„ä¸ªæ•°æ®ç±»å‹çš„èŒƒå›´">å„ä¸ªæ•°æ®ç±»å‹çš„èŒƒå›´</a></h2>
<p>https://blog.csdn.net/qfikh/article/details/52832087</p>
<h2><a class="header" href="#double-ç±»å‹çš„åŠ å‡ä¹˜é™¤" id="double-ç±»å‹çš„åŠ å‡ä¹˜é™¤">double ç±»å‹çš„åŠ å‡ä¹˜é™¤</a></h2>
<p>float : å•ç²¾åº¦æµ®ç‚¹æ•°, å  4 å­—èŠ‚</p>
<p>double : åŒç²¾åº¦æµ®ç‚¹æ•° -- ç¼–è¯‘å™¨é»˜è®¤å°æ•°; å æ® 8 å­—èŠ‚</p>
<pre><code class="language-java">//å¦‚æœä¸å£°æ˜ï¼Œé»˜è®¤å°æ•°ä¸ºdoubleç±»å‹ï¼Œæ‰€ä»¥å¦‚æœè¦ç”¨floatçš„è¯ï¼Œå¿…é¡»è¿›è¡Œå¼ºè½¬
//ä¾‹å¦‚ï¼šfloat  a=1.3; ä¼šç¼–è¯‘æŠ¥é”™ï¼Œæ­£ç¡®çš„å†™æ³• float a = (float)1.3;æˆ–è€…float a = 1.3f;ï¼ˆfæˆ–Féƒ½å¯ä»¥ä¸åŒºåˆ†å¤§å°å†™ï¼‰

public class DoubleArith {
    private static final int DEF_DIV_SCALE = 10;
    /**
     * ä¸¤ä¸ªDoubleæ•°ç›¸åŠ 
     * @param v1
     * @param v2
     * @return Double
     */
    public static Double add(Double v1,Double v2){
        BigDecimal b1 = new BigDecimal(v1.toString());
        BigDecimal b2 = new BigDecimal(v2.toString());
        return b1.add(b2).doubleValue();
    }

    /**
     * ä¸¤ä¸ªDoubleæ•°ç›¸å‡
     * @param v1
     * @param v2
     * @return Double
     */
    public static Double sub(Double v1,Double v2){
        BigDecimal b1 = new BigDecimal(v1.toString());
        BigDecimal b2 = new BigDecimal(v2.toString());
        return b1.subtract(b2).doubleValue();
    }

    /**
     * ä¸¤ä¸ªDoubleæ•°ç›¸ä¹˜
     * @param v1
     * @param v2
     * @return Double
     */
    public static Double mul(Double v1,Double v2){
        BigDecimal b1 = new BigDecimal(v1.toString());
        BigDecimal b2 = new BigDecimal(v2.toString());
        return b1.multiply(b2).doubleValue();
    }

    /**
     * ä¸¤ä¸ªDoubleæ•°ç›¸é™¤
     * @param v1
     * @param v2
     * @return Double
     */
    public static Double div(Double v1,Double v2){
        BigDecimal b1 = new BigDecimal(v1.toString());
        BigDecimal b2 = new BigDecimal(v2.toString());
        return b1.divide(b2,DEF_DIV_SCALE,BigDecimal.ROUND_HALF_UP).doubleValue();
    }

    /**
     * ä¸¤ä¸ªDoubleæ•°ç›¸é™¤ï¼Œå¹¶ä¿ç•™scaleä½å°æ•°
     * @param v1
     * @param v2
     * @param scale
     * @return Double
     */
    public static Double div(Double v1,Double v2,int scale){
        if(scale&lt;0){
            throw new IllegalArgumentException(
            &quot;The scale must be a positive integer or zero&quot;);
        }
        BigDecimal b1 = new BigDecimal(v1.toString());
        BigDecimal b2 = new BigDecimal(v2.toString());
        return b1.divide(b2,scale,BigDecimal.ROUND_HALF_UP).doubleValue();
    }

}
</code></pre>
<h1><a class="header" href="#æ§åˆ¶å°å‘½ä»¤" id="æ§åˆ¶å°å‘½ä»¤">æ§åˆ¶å°å‘½ä»¤</a></h1>
<h2><a class="header" href="#æ‰“-jar-åŒ…" id="æ‰“-jar-åŒ…">æ‰“ jar åŒ…</a></h2>
<pre><code class="language-sh">jar cvf &lt;jaræ–‡ä»¶å&gt; &lt;classæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹&gt;
</code></pre>
<ul>
<li>jar åŒ…æ‰“å¥½åï¼Œè¦æŒ‡å®šå…¥å£ç±» å³æ›´æ”¹ manifest.mf æ–‡ä»¶ æ ¼å¼ï¼šMain-Class: åŒ…å.ç±»åï¼ˆä¸åŠ .class)</li>
<li>jar åŒ…åŒå‡»è¿è¡Œåªå¯¹å›¾å½¢ç•Œé¢èµ·ä½œç”¨</li>
<li>éå›¾å½¢ç•Œé¢è¦ç”¨ bat æ–‡ä»¶</li>
<li>å¦‚æœæ˜¯ä½¿ç”¨ä»–äººçš„ jar åŒ…ï¼Œè¦å…ˆè®¾ç½® classpath</li>
</ul>
<h2><a class="header" href="#ç”Ÿæˆæ³¨é‡Šæ–‡æ¡£-javadoc" id="ç”Ÿæˆæ³¨é‡Šæ–‡æ¡£-javadoc">ç”Ÿæˆæ³¨é‡Šæ–‡æ¡£ javadoc</a></h2>
<p><code>javadoc -d å­˜æ”¾æ–‡æ¡£çš„è·¯å¾„ javaçš„æºæ–‡ä»¶</code></p>
<h2><a class="header" href="#ç¼–è¯‘å’Œåç¼–è¯‘" id="ç¼–è¯‘å’Œåç¼–è¯‘">ç¼–è¯‘å’Œåç¼–è¯‘</a></h2>
<p>å¦‚æœ Java æ–‡ä»¶å«æœ‰åŒ…ã€packageã€‘ï¼Œåˆ™ <code>javac â€“d . Demo.java</code>-----ã€.ã€‘è¡¨ç¤ºå½“å‰è·¯å¾„ï¼Œå³ class æ–‡ä»¶è·¯å¾„
å¿…é¡»åŠ ã€-dã€‘ï¼Œå¦åˆ™ç¼–è¯‘å‡ºæ¥æ²¡æœ‰åŒ…æ–‡ä»¶å¤¹ã€‚</p>
<p>è¿è¡Œæ—¶ï¼š <code>java com.xiaoyu.Demo</code></p>
<p>åç¼–è¯‘: <code>javap -verbose classæ–‡ä»¶</code></p>
<h1><a class="header" href="#é‡è¦çš„å¯¹è±¡" id="é‡è¦çš„å¯¹è±¡">é‡è¦çš„å¯¹è±¡</a></h1>
<h2><a class="header" href="#object" id="object">Object</a></h2>
<p>http://www.javacoder.cn/?p=274</p>
<h2><a class="header" href="#string" id="string">String</a></h2>
<h1><a class="header" href="#å­—èŠ‚ç ç¼–è¾‘æŠ€æœ¯" id="å­—èŠ‚ç ç¼–è¾‘æŠ€æœ¯">å­—èŠ‚ç ç¼–è¾‘æŠ€æœ¯</a></h1>
<h2><a class="header" href="#javassist" id="javassist">javassist</a></h2>
<p>https://github.com/jboss-javassist/javassist
https://www.cnblogs.com/rickiyang/p/11336268.html</p>
<h1><a class="header" href="#å‰æ²¿" id="å‰æ²¿">å‰æ²¿</a></h1>
<h2><a class="header" href="#graalvm" id="graalvm">graalvm</a></h2>
<p>https://zhuanlan.zhihu.com/p/106555993</p>
<h2><a class="header" href="#vertx" id="vertx">vertx</a></h2>
<h2><a class="header" href="#micronaut" id="micronaut">Micronaut</a></h2>
<h2><a class="header" href="#quarkus" id="quarkus">Quarkus</a></h2>
<h1><a class="header" href="#æ‹¾é—" id="æ‹¾é—">æ‹¾é—</a></h1>
<h2><a class="header" href="#æ­£åˆ™è¡¨è¾¾å¼-regex" id="æ­£åˆ™è¡¨è¾¾å¼-regex">æ­£åˆ™è¡¨è¾¾å¼ regex</a></h2>
<pre><code class="language-java">private final static Pattern VERSION_PREFIX_PATTERN = Pattern.compile(&quot;v(\\d+)/&quot;);
Matcher m = VERSION_PREFIX_PATTERN.matcher(httpServletRequest.getRequestURI());
if(m.find()){
            Integer version = Integer.valueOf(m.group(1));
            if(version &gt;= this.apiVersion)
            {
                return this;
            }
        }

</code></pre>
<h2><a class="header" href="#é™æ€ç»‘å®šå’ŒåŠ¨æ€ç»‘å®š" id="é™æ€ç»‘å®šå’ŒåŠ¨æ€ç»‘å®š">é™æ€ç»‘å®šå’ŒåŠ¨æ€ç»‘å®š</a></h2>
<p>https://droidyue.com/blog/2014/12/28/static-biding-and-dynamic-binding-in-java/</p>
<p>åŠ¨æ€ç»‘å®šæ˜¯æŒ‡ç¼–è¯‘å™¨åœ¨ç¼–è¯‘é˜¶æ®µä¸çŸ¥é“è¦è°ƒç”¨å“ªä¸ªæ–¹æ³•ï¼Œç›´åˆ°è¿è¡Œæ—¶æ‰èƒ½ç¡®å®š</p>
<p>å¦‚æœç¼–è¯‘å™¨å¯ä»¥åœ¨ç¼–è¯‘é˜¶æ®µå°±å®Œæˆç»‘å®šï¼Œå°±å«ä½œé™æ€ç»‘å®š</p>
<p>æ˜¯å¦æ˜¯é™æ€ç»‘å®šå¯ä»¥åç¼–è¯‘ class æ–‡ä»¶æŸ¥çœ‹ <code>javap -c &lt;class_name&gt;</code></p>
<ul>
<li>é™æ€ç»‘å®šå‘ç”Ÿåœ¨ç¼–è¯‘æ—¶æœŸï¼ŒåŠ¨æ€ç»‘å®šå‘ç”Ÿåœ¨è¿è¡Œæ—¶</li>
<li>é™æ€ç»‘å®šä½¿ç”¨ç±»ä¿¡æ¯æ¥å®Œæˆï¼Œè€ŒåŠ¨æ€ç»‘å®šåˆ™éœ€è¦ä½¿ç”¨å¯¹è±¡ä¿¡æ¯æ¥å®Œæˆã€‚</li>
<li>æ–¹æ³•é‡è½½æ˜¯é™æ€ç»‘å®šï¼Œ æ–¹æ³•é‡å†™æ˜¯åŠ¨æ€ç»‘å®š</li>
<li>ä½¿ç”¨ private æˆ– static æˆ– final ä¿®é¥°çš„å˜é‡æˆ–è€…æ–¹æ³•ï¼Œä½¿ç”¨é™æ€ç»‘å®šã€‚è€Œè™šæ–¹æ³•ï¼ˆå¯ä»¥è¢«å­ç±»é‡å†™çš„æ–¹æ³•ï¼‰åˆ™ä¼šæ ¹æ®è¿è¡Œæ—¶çš„å¯¹è±¡è¿›è¡ŒåŠ¨æ€ç»‘å®šã€‚</li>
<li>é‡è½½(Overload)çš„æ–¹æ³•ä½¿ç”¨é™æ€ç»‘å®šå®Œæˆï¼Œè€Œé‡å†™(Override)çš„æ–¹æ³•åˆ™ä½¿ç”¨åŠ¨æ€ç»‘å®šå®Œæˆã€‚</li>
</ul>
<h2><a class="header" href="#é‡è½½-and-é‡å†™" id="é‡è½½-and-é‡å†™">é‡è½½ and é‡å†™</a></h2>
<p>æ–¹æ³•ç­¾å: æ–¹æ³•åç§°+æ–¹æ³•å‚æ•° (ä¸åŒ…æ‹¬è¿”å›å€¼)</p>
<ul>
<li>é‡è½½å¿…é¡»æ–¹æ³•ç­¾åä¸åŒ</li>
<li>é‡å†™å¿…é¡»æ–¹æ³•ç­¾åç›¸åŒ</li>
</ul>
<h2><a class="header" href="#java-å€¼ä¼ é€’-or-å¼•ç”¨ä¼ é€’" id="java-å€¼ä¼ é€’-or-å¼•ç”¨ä¼ é€’">java å€¼ä¼ é€’ or å¼•ç”¨ä¼ é€’</a></h2>
<ul>
<li>åŸºæœ¬æ•°æ®ç±»å‹, æ˜¯å€¼ä¼ é€’ -- ç›¸å½“äºå°†å‚æ•°å¤åˆ¶äº†ä¸€ä»½, å¯¹å½¢å‚çš„ä¿®æ”¹ä¸ä¼šå½±å“å®å‚ï¼›</li>
<li>å¼•ç”¨ç±»å‹, æ˜¯å¼•ç”¨ä¼ é€’ -- ç›¸å½“äºä¼ é€’çš„æ˜¯å†…å­˜åœ°å€(è¿™æ˜¯ä¸ºäº†é¿å…å¤åˆ¶å¤æ‚ç±»å‹çš„å†…å­˜è€—è´¹), å½¢å‚å’Œå®å‚æŒ‡å‘åŒä¸€ä¸ªå†…å­˜åœ°å€ï¼ˆå³å¼•ç”¨ï¼‰ï¼Œæ‰€ä»¥å¯¹å‚æ•°çš„ä¿®æ”¹ä¼šå½±å“åˆ°å®é™…çš„å¯¹è±¡ã€‚</li>
<li>String, Integer, Double ç­‰ immutable çš„ç±»å‹ç‰¹æ®Šå¤„ç†ï¼Œå¯ä»¥ç†è§£ä¸ºä¼ å€¼ï¼Œæœ€åçš„æ“ä½œä¸ä¼šä¿®æ”¹å®å‚å¯¹è±¡ã€‚</li>
</ul>
<h2><a class="header" href="#è®¿é—®ä¿®é¥°ç¬¦-public-protect-default-private" id="è®¿é—®ä¿®é¥°ç¬¦-public-protect-default-private">è®¿é—®ä¿®é¥°ç¬¦ public-protect-default-private</a></h2>
<p>https://blog.csdn.net/u012418131/article/details/52822381</p>
<pre><code>
ä½œç”¨åŸŸæœ‰å››ä¸ªå¯è®¿é—®çº§åˆ«: å½“å‰ç±», åŒåŒ…, ç»§æ‰¿, ä¸åŒåŒ…

1. public           èŒƒå›´æœ€å¤§, éƒ½å…è®¸
2. protected        èŒƒå›´å°ä¸€ç‚¹, ä¸å¯è·¨åŒ…è®¿é—®, ä½†æ˜¯å¯ä»¥é€šè¿‡ç»§æ‰¿æ‰“ç ´
3. default          èŒƒå›´å†å°ä¸€ç‚¹ (package scope),ä¸å¯è·¨åŒ…è®¿é—®, ä¹Ÿä¸å¯é€šè¿‡ç»§æ‰¿è®¿é—® , åªèƒ½åœ¨åŒåŒ…ä¸‹è®¿é—®;
4. private          èŒƒå›´æœ€å°, åªèƒ½å†ç±»å†…éƒ¨è®¿é—®;

</code></pre>
<h2><a class="header" href="#getcontextclassloadergetclassloader-åŒºåˆ«" id="getcontextclassloadergetclassloader-åŒºåˆ«">getcontextclassloader&amp;getclassloader åŒºåˆ«</a></h2>
<p>å¦‚æœä½ ä½¿ç”¨ Test.class.getClassLoader()ï¼Œå¯èƒ½ä¼šå¯¼è‡´å’Œå½“å‰çº¿ç¨‹æ‰€è¿è¡Œçš„ç±»åŠ è½½å™¨ä¸ä¸€è‡´, ä¸€èˆ¬åªèƒ½ç”¨åœ¨ getResource</p>
<p>æœ€å¥½ä½¿ç”¨ Thread.currentThread().getContextClassLoader()</p>
<h2><a class="header" href="#getter-å’Œ-setter-å­˜åœ¨çš„æ„ä¹‰" id="getter-å’Œ-setter-å­˜åœ¨çš„æ„ä¹‰">getter å’Œ setter å­˜åœ¨çš„æ„ä¹‰</a></h2>
<p>https://stackoverflow.com/questions/1568091/why-use-getters-and-setters-accessors</p>
<p>æ›´å¥½çš„å°è£…æ€§, æ— æ³•ç›´æ¥ access æˆå‘˜å˜é‡</p>
<p>æ‹“å±•æ€§å¥½, å¯ä»¥åœ¨å‡½æ•°ä¸­æ·»åŠ å…¶ä»–åŠŸèƒ½</p>
<p>æ–¹ä¾¿æ‰“æ–­ç‚¹ debug</p>
<h2><a class="header" href="#ä¸ºä»€ä¹ˆ-service-åªæœ‰ä¸€ä¸ªå®ç°ä¹Ÿéœ€è¦ä¸€ä¸ªæ¥å£" id="ä¸ºä»€ä¹ˆ-service-åªæœ‰ä¸€ä¸ªå®ç°ä¹Ÿéœ€è¦ä¸€ä¸ªæ¥å£">ä¸ºä»€ä¹ˆ service åªæœ‰ä¸€ä¸ªå®ç°ä¹Ÿéœ€è¦ä¸€ä¸ªæ¥å£</a></h2>
<p>åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸€ä¸ª service æ¥å£åªæœ‰ä¸€ä¸ªå®ç°ç±», ä¸ºä»€ä¹ˆè¿˜è¦å•ç‹¬æŠ½å‡ºä¸€ä¸ªæ¥å£å‘¢? è¿™ä¸ªæ¥å£æ—¶å¤šä½™çš„å—?</p>
<ul>
<li>
<p>æ–¹ä¾¿ JAVA åº•å±‚çš„ç›¸å…³ç‰¹æ€§å®ç°ï¼Œä¾‹å¦‚åå°„, ç”Ÿæˆä»£ç†</p>
</li>
<li>
<p>é¢å‘æ¥å£å¼€å‘çš„å¥½å¤„, æ¯”å¦‚ å¯ä»¥æŠŠæ¥å£æ‰“è¿›è°ƒç”¨æ–¹å¼€å‘åŒ…æä¾›å‡ºå»ï¼Œè€Œä¸æ˜¯å®ç°ç±»ã€‚æ‰€ä»¥è°ƒç”¨å°±æ˜¯ç­¾åçš„è°ƒç”¨, æ¥å£æ˜¯å¦å®ç°ä¸å½±å“è°ƒç”¨</p>
</li>
</ul>
<h2><a class="header" href="#static-å…³é”®å­—" id="static-å…³é”®å­—">static å…³é”®å­—</a></h2>
<p><a href="https://www.cnblogs.com/dotgua/p/6354151.html?utm_source=itdadao&amp;utm_medium=referral">å››ä¸ªä½œç”¨</a>
sos ä¸Šçš„ä¸€ä¸ªé—®é¢˜: <a href="https://stackoverflow.com/questions/413898/what-does-the-static-keyword-do-in-a-class">What does the 'static' keyword do in a class?</a></p>
<p><a href="https://www.cnblogs.com/hf-cherish/p/4970267.html">é™æ€å˜é‡çš„ç”Ÿå‘½å‘¨æœŸ</a></p>
<p>static å…³é”®å­—çš„ä½œç”¨æ˜¯æŠŠç±»çš„æˆå‘˜å˜æˆç±»ç›¸å…³ï¼Œè€Œä¸æ˜¯å®ä¾‹ç›¸å…³</p>
<ul>
<li>
<p>ä¿®é¥°æˆå‘˜å˜é‡ - å†…å­˜ä½ç½®å˜åŒ–: heap(å±äºå¯¹è±¡, å¯¹è±¡ç‹¬æœ‰) --&gt; method area(å±äº class, å¯¹è±¡å…¬æœ‰)</p>
</li>
<li>
<p>ä¿®é¥°æˆå‘˜æ–¹æ³• - å†…å­˜å˜åŒ–: æ²¡æœ‰å¤šå¤§çš„å˜åŒ–, æ–¹æ³•æœ¬æ¥å°±æ˜¯å­˜æ”¾åœ¨ç±»çš„å®šä¹‰å½“ä¸­çš„</p>
<ul>
<li>
<p>æœ€å¤§çš„ä½œç”¨ï¼Œå°±æ˜¯å¯ä»¥ä½¿ç”¨&quot;ç±»å.æ–¹æ³•å&quot;çš„æ–¹å¼æ“ä½œæ–¹æ³•ï¼Œé¿å…äº†å…ˆè¦ new å‡ºå¯¹è±¡çš„ç¹çå’Œèµ„æºæ¶ˆè€—.</p>
</li>
<li>
<p>ä¸è¿‡å®ƒä¹Ÿæœ‰ä½¿ç”¨çš„å±€é™ï¼Œä¸€ä¸ª static ä¿®é¥°çš„æ–¹æ³•ä¸­ï¼Œä¸èƒ½ä½¿ç”¨é static ä¿®é¥°çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•ï¼Œè¿™å¾ˆå¥½ç†è§£ï¼Œå› ä¸º static ä¿®é¥°çš„æ–¹æ³•æ˜¯å±äºç±»çš„ï¼Œå¦‚æœå»ç›´æ¥ä½¿ç”¨å¯¹è±¡çš„æˆå‘˜å˜é‡ï¼Œå®ƒä¼šä¸çŸ¥æ‰€æªï¼ˆä¸çŸ¥è¯¥ä½¿ç”¨å“ªä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼‰ã€‚</p>
</li>
</ul>
</li>
<li>
<p>é™æ€å— - åˆå§‹åŒ– static ä¿®é¥°çš„æˆå‘˜æ—¶ï¼Œå¯ä»¥å°†ä»–ä»¬ç»Ÿä¸€æ”¾åœ¨ä¸€ä¸ªä»¥ static å¼€å§‹ï¼Œç”¨èŠ±æ‹¬å·åŒ…è£¹èµ·æ¥çš„å—çŠ¶è¯­å¥ä¸­. é™æ€å—å’Œé™æ€æˆå‘˜å˜é‡æ•ˆæœç­‰åŒ</p>
<ul>
<li>
<p>åŠ è½½é¡ºåº</p>
<p>1ã€ï¼ˆå¦‚æœç±»è¿˜æœªè¢«åŠ è½½ï¼‰å…ˆæ‰§è¡Œçˆ¶ç±»çš„é™æ€ä»£ç å—å’Œé™æ€å˜é‡åˆå§‹åŒ–ï¼Œå¹¶ä¸”é™æ€ä»£ç å—å’Œé™æ€å˜é‡çš„æ‰§è¡Œé¡ºåºåªè·Ÿä»£ç ä¸­å‡ºç°çš„é¡ºåºæœ‰å…³ã€‚
2ã€ï¼ˆå¦‚æœç±»è¿˜æœªè¢«åŠ è½½ï¼‰æ‰§è¡Œå­ç±»çš„é™æ€ä»£ç å—å’Œé™æ€å˜é‡åˆå§‹åŒ–ã€‚
3ã€æ‰§è¡Œçˆ¶ç±»çš„å®ä¾‹å˜é‡åˆå§‹åŒ–
4ã€æ‰§è¡Œçˆ¶ç±»çš„æ„é€ å‡½æ•°
5ã€æ‰§è¡Œå­ç±»çš„å®ä¾‹å˜é‡åˆå§‹åŒ–
6ã€æ‰§è¡Œå­ç±»çš„æ„é€ å‡½æ•°</p>
</li>
</ul>
</li>
<li>
<p>é™æ€å¯¼åŒ…</p>
</li>
</ul>
<h2><a class="header" href="#å†…éƒ¨ç±»-or-é™æ€å†…éƒ¨ç±»" id="å†…éƒ¨ç±»-or-é™æ€å†…éƒ¨ç±»">å†…éƒ¨ç±» or é™æ€å†…éƒ¨ç±»</a></h2>
<p>https://www.cnblogs.com/Gaojiecai/p/4041663.html</p>
<h3><a class="header" href="#å†…éƒ¨ç±»" id="å†…éƒ¨ç±»">å†…éƒ¨ç±»</a></h3>
<ul>
<li>
<p>å†…éƒ¨ç±»ï¼šå®šä¹‰å†ç±»å†…éƒ¨çš„ç±»</p>
<p><code>éé™æ€å†…éƒ¨ç±»å¯¹è±¡æœ‰ç€æŒ‡å‘å…¶å¤–éƒ¨ç±»å¯¹è±¡çš„å¼•ç”¨</code>, æ‰€ä»¥ <code>åœ¨åˆ›å»ºéé™æ€å†…éƒ¨ç±»å¯¹è±¡æ—¶ï¼Œä¸€å®šè¦å…ˆåˆ›å»ºèµ·ç›¸åº”çš„å¤–éƒ¨ç±»å¯¹è±¡</code></p>
</li>
<li>
<p>ä½œç”¨ - å°è£…æ€§</p>
<ul>
<li>
<p><code>å†…éƒ¨ç±»æˆå‘˜å¯ä»¥ç›´æ¥è®¿é—®å¤–éƒ¨ç±»çš„ç§æœ‰æ•°æ®</code></p>
</li>
<li>
<p>å¤–éƒ¨ç±»ä¸èƒ½è®¿é—®å†…éƒ¨ç±»çš„å®ç°ç»†èŠ‚ï¼Œä¾‹å¦‚å†…éƒ¨ç±»çš„æˆå‘˜å˜é‡</p>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>ç†è§£: ä»€ä¹ˆæ˜¯å†…éƒ¨ï¼Ÿå†…éƒ¨å°±æ˜¯æˆ‘æ˜¯ä½ çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘äº†è§£ä½ ï¼Œæˆ‘çŸ¥é“ä½ çš„å…¨éƒ¨ï¼Œæ²¡æœ‰ä½ å°±æ²¡æœ‰æˆ‘ã€‚ï¼ˆæ‰€ä»¥å†…éƒ¨ç±»å¯¹è±¡æ˜¯ä»¥å¤–éƒ¨ç±»å¯¹è±¡å­˜åœ¨ä¸ºå‰æçš„ï¼‰</p>
</blockquote>
<h3><a class="header" href="#é™æ€å†…éƒ¨ç±»" id="é™æ€å†…éƒ¨ç±»">é™æ€å†…éƒ¨ç±»</a></h3>
<p>é™æ€å†…éƒ¨ç±»(é™æ€åµŒå¥—ç±»)ï¼šä½¿ç”¨ static æ¥ä¿®é¥°ä¸€ä¸ªå†…éƒ¨ç±»</p>
<p><code>static InnerClass å’Œ OuterClass æ²¡å•¥å…³ç³»</code>, å°±æ˜¯ä¸ªç‹¬ç«‹çš„ class, è‡ªå·±å¯ä»¥å®Œå…¨ç‹¬ç«‹å­˜åœ¨, ä¹Ÿå°±æ²¡æœ‰äº†æŒ‡å‘å¤–éƒ¨ç±»çš„å¼•ç”¨, å› æ­¤ä¹Ÿå°±æ— æ³•è®¿é—®å¤–éƒ¨ç±»çš„æˆå‘˜</p>
<p>å¤–éƒ¨ç±»å¯ä»¥è®¿é—® static InnerClass çš„æˆå‘˜</p>
<blockquote>
<p>ç†è§£: æ¯”å¦‚æœ‰ Aï¼ŒB ä¸¤ä¸ªç±»ï¼ŒB æœ‰ç‚¹ç‰¹æ®Šï¼Œè™½ç„¶å¯ä»¥ç‹¬ç«‹å­˜åœ¨ï¼Œä½†åªè¢« A ä½¿ç”¨ã€‚è¿™æ—¶å€™æ€ä¹ˆåŠï¼Ÿå¦‚æœæŠŠ B å¹¶å…¥ A é‡Œï¼Œå¤æ‚åº¦æé«˜ï¼Œæå¾— A è¿åå•ä¸€èŒè´£ã€‚å¦‚æœ B ç‹¬ç«‹ï¼Œåˆå¯èƒ½è¢«å…¶ä»–ç±»ï¼ˆæ¯”å¦‚åŒä¸€ä¸ªåŒ…ä¸‹çš„ Cï¼‰ä¾èµ–ï¼Œä¸ç¬¦åˆè®¾è®¡çš„æœ¬æ„ã€‚æ‰€ä»¥ä¸å¦‚å°†å…¶å˜æˆ A.Bï¼Œç­‰äºæ·»åŠ ä¸ªæ³¨é‡Šï¼Œå‘Šè¯‰å…¶ä»–ç±»åˆ«ä½¿ç”¨ B äº†ï¼Œå®ƒåªè·Ÿ A ç©ã€‚</p>
</blockquote>
<h2><a class="header" href="#java-ç±»åˆå§‹åŒ–é¡ºåº" id="java-ç±»åˆå§‹åŒ–é¡ºåº">Java ç±»åˆå§‹åŒ–é¡ºåº</a></h2>
<p>å•ç‹¬çš„ç±»:</p>
<ol>
<li>é™æ€å±æ€§</li>
<li>é™æ€ä»£ç å—</li>
<li>æ™®é€šå±æ€§</li>
<li>æ™®é€šä»£ç å—</li>
<li>æ„é€ æ–¹æ³•</li>
</ol>
<p>ç»§æ‰¿å…³ç³»çš„çˆ¶å­ç±»:</p>
<ol>
<li>çˆ¶ç±»é™æ€å±æ€§</li>
<li>çˆ¶ç±»é™æ€ä»£ç å—</li>
<li>å­ç±»é™æ€å±æ€§</li>
<li>å­ç±»é™æ€ä»£ç å—</li>
<li>çˆ¶ç±»æ™®é€šå±æ€§</li>
<li>çˆ¶ç±»æ™®é€šä»£ç å—</li>
<li>çˆ¶ç±»æ„é€ æ–¹æ³•</li>
<li>å­ç±»æ™®é€šå˜é‡</li>
<li>å­ç±»æ™®é€šä»£ç å—</li>
<li>å­ç±»æ„é€ æ–¹æ³•</li>
</ol>
<h2><a class="header" href="#random-éšæœºæ•°" id="random-éšæœºæ•°">Random-éšæœºæ•°</a></h2>
<p>https://www.cnblogs.com/yrrAwx/p/7806444.html</p>
<h2><a class="header" href="#ä½è¿ç®—" id="ä½è¿ç®—">ä½è¿ç®—</a></h2>
<p>å·¦ç§»: å·¦ç§» n ä½å°±æ˜¯æŠŠæœ€é«˜ä½ n ä½ç§»å‡ºï¼Œä½ä½æ·»åŠ  n ä¸ª 0 çš„æ“ä½œï¼Œå·¦ç§»æ“ä½œç›¸å½“äºå°†è¯¥æ•°ä¹˜ä»¥ 2^n æ¬¡æ–¹ã€‚</p>
<p>å³ç§»: å³ç§» n ä½å°±æ˜¯æŠŠä½ä½ n ä½ç§»å‡ºï¼Œé«˜ä½æ·»åŠ  n ä¸ª 0 çš„æ“ä½œï¼Œå³ç§»æ“ä½œç›¸å½“äºå°†è¯¥æ•°é™¤ä»¥ 2^n æ¬¡æ–¹ã€‚</p>
<p>https://www.cnblogs.com/liaopeng/p/8436155.html</p>
<h2><a class="header" href="#ä¸ºä»€ä¹ˆåŒ…åéƒ½å°å†™" id="ä¸ºä»€ä¹ˆåŒ…åéƒ½å°å†™">ä¸ºä»€ä¹ˆåŒ…åéƒ½å°å†™</a></h2>
<p>å®é™…ä¸Š, java åŒ…åæ˜¯å¤§å°å†™æ•æ„Ÿçš„, é‚£ä¸ºä»€ä¹ˆè¿˜æ˜¯è¦æ±‚éƒ½è¦å°å†™å‘¢</p>
<p>æ˜¯ä¸ºäº†è·¨å¹³å°çš„è€ƒè™‘, Linux ä¸­çš„æ–‡ä»¶åæ˜¯å¤§å°å†™æ•æ„Ÿçš„, ä½†æ˜¯ windows ä¸­çš„æ–‡ä»¶åæ˜¯å¤§å°å†™ä¸æ•æ„Ÿçš„, é˜²æ­¢åœ¨ Windows å¹³å°å‡ºé”™, ç»Ÿä¸€è¦æ±‚å°å†™</p>
<h2><a class="header" href="#å¤„ç†-unicode-ç¼–ç é—®é¢˜" id="å¤„ç†-unicode-ç¼–ç é—®é¢˜">å¤„ç† unicode ç¼–ç é—®é¢˜</a></h2>
<pre><code class="language-java">// æ–¹æ³•1
public class UnicodeUtils {

    /**
     * å­—ç¬¦ä¸²ç¼–ç æˆUnicodeç¼–ç 
     */
    public static String encode(String src) throws Exception {
        char c;
        StringBuilder str = new StringBuilder();
        int intAsc;
        String strHex;
        for (int i = 0; i &lt; src.length(); i++) {
            c = src.charAt(i);
            intAsc = (int) c;
            strHex = Integer.toHexString(intAsc);
            if (intAsc &gt; 128)
                str.append(&quot;\\u&quot; + strHex);
            else
                str.append(&quot;\\u00&quot; + strHex); // ä½ä½åœ¨å‰é¢è¡¥00
        }
        return str.toString();
    }

    /**
     * Unicodeè§£ç æˆå­—ç¬¦ä¸²
     * @param src
     * @return
     */
    public static String decode(String src) {
        int t =  src.length() / 6;
        StringBuilder str = new StringBuilder();
        for (int i = 0; i &lt; t; i++) {
            String s = src.substring(i * 6, (i + 1) * 6); // æ¯6ä½æè¿°ä¸€ä¸ªå­—èŠ‚
            // é«˜ä½éœ€è¦è¡¥ä¸Š00å†è½¬
            String s1 = s.substring(2, 4) + &quot;00&quot;;
            // ä½ä½ç›´æ¥è½¬
            String s2 = s.substring(4);
            // å°†16è¿›åˆ¶çš„stringè½¬ä¸ºint
            int n = Integer.valueOf(s1, 16) + Integer.valueOf(s2, 16);
            // å°†intè½¬æ¢ä¸ºå­—ç¬¦
            char[] chars = Character.toChars(n);
            str.append(new String(chars));
        }
        return str.toString();
    }
}


// æ–¹æ³•2
public class T {
    @Test
    public void te() {
        String te = &quot;\\u97e6\\u5c0f\\u5b9d&quot;;
        final String result = unicodeDecode(te);
        System.out.println(result);
    }

    public static String unicodeDecode(String string) {
        Pattern pattern = Pattern.compile(&quot;(\\\\u(\\p{XDigit}{4}))&quot;);
        Matcher matcher = pattern.matcher(string);
        char    ch;
        while (matcher.find()) {
            ch = (char) Integer.parseInt(matcher.group(2), 16);
            string = string.replace(matcher.group(1), ch + &quot;&quot;);
        }
        return string;
    }

    public static String unicodeEncode(String string) {
        char[] utfBytes = string.toCharArray();
        String unicodeBytes = &quot;&quot;;
        for (int i = 0; i &lt; utfBytes.length; i++) {
            String hexB = Integer.toHexString(utfBytes[i]);
            if (hexB.length() &lt;= 2) {
                hexB = &quot;00&quot; + hexB;
            }
            unicodeBytes = unicodeBytes + &quot;\\u&quot; + hexB;
        }
        return unicodeBytes;
    }
}
</code></pre>
<h2><a class="header" href="#ä¸ºä»€ä¹ˆæˆå‘˜å˜é‡å†æ¬¡èµ‹å€¼ç»™å±€éƒ¨å˜é‡" id="ä¸ºä»€ä¹ˆæˆå‘˜å˜é‡å†æ¬¡èµ‹å€¼ç»™å±€éƒ¨å˜é‡">ä¸ºä»€ä¹ˆæˆå‘˜å˜é‡å†æ¬¡èµ‹å€¼ç»™å±€éƒ¨å˜é‡</a></h2>
<p>https://www.oschina.net/question/2319418_2317139</p>
<p>å¤§ä½“æ¥è¯´ï¼Œè¿™æ ·å†™æ˜¯ä¸€ç§æç«¯çš„ä¼˜åŒ–ï¼Œåœ¨è¿è¡Œæ—¶ï¼Œå³æ—¶ç¼–è¯‘å™¨ï¼ˆJITï¼‰å°†ä¼šæŠŠè¿™ç§ä»£ç ç¼–è¯‘æˆä¸æœ¬åœ°å¹³å°ç›¸å…³çš„æœºå™¨ç ï¼Œå¹¶è¿›è¡Œå„ç§å±‚æ¬¡çš„ä¼˜åŒ–ï¼Œä»¥æé«˜æ€§èƒ½ã€‚</p>
<p>http://mail.openjdk.java.net/pipermail/core-libs-dev/2010-May/004165.html
https://stackoverflow.com/questions/2785964/in-arrayblockingqueue-why-copy-final-member-field-into-local-final-variable</p>
<h2><a class="header" href="#ä¸ºä»€ä¹ˆå®šä¹‰æˆå‘˜å˜é‡ä¸ç”¨èµ‹å€¼è€Œå®šä¹‰å±€éƒ¨å˜é‡å¿…é¡»èµ‹å€¼" id="ä¸ºä»€ä¹ˆå®šä¹‰æˆå‘˜å˜é‡ä¸ç”¨èµ‹å€¼è€Œå®šä¹‰å±€éƒ¨å˜é‡å¿…é¡»èµ‹å€¼">ä¸ºä»€ä¹ˆå®šä¹‰æˆå‘˜å˜é‡ä¸ç”¨èµ‹å€¼è€Œå®šä¹‰å±€éƒ¨å˜é‡å¿…é¡»èµ‹å€¼</a></h2>
<p>ä»»ä½•å˜é‡åœ¨Cè¯­è¨€ä¸­ä¸èµ‹å€¼çš„è¯ï¼Œä¼šæ˜¯ä¹±ç çš„å½¢å¼ï¼Œå¯èƒ½æœ‰å®‰å…¨é—®é¢˜ã€‚æ‰€ä»¥javaä¿®æ­£äº†è¿™ç‚¹ï¼Œå¯¹äºå±€éƒ¨å˜é‡å¼ºåˆ¶è®©ä½ èµ‹å€¼</p>
<p>ä¸ºä»€ä¹ˆæˆå‘˜å˜é‡æœ‰è‡ªå·±çš„åˆå§‹å€¼ï¼Œè€Œä¸éœ€è¦å¼ºåˆ¶èµ‹å€¼ï¼Œé‚£æ˜¯å› ä¸ºnewå¯¹è±¡çš„æ—¶å€™ï¼Œæ„é€ å‡½æ•°å¸®ä½ åˆå§‹åŒ–é»˜è®¤å€¼äº†</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="java-memory-model-jmm-jvm.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="rust-note.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="java-memory-model-jmm-jvm.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="rust-note.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
