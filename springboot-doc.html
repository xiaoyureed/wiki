<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>springboot-doc - Xiaoyu Wiki</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="pre.html">pre page</a></li><li class="chapter-item expanded "><a href="SpringBoot-note.html"><strong aria-hidden="true">1.</strong> Spring boot note</a></li><li class="chapter-item expanded "><a href="springcloud-note.html"><strong aria-hidden="true">2.</strong> springcloud-note</a></li><li class="chapter-item expanded "><a href="java-concurrent.html"><strong aria-hidden="true">3.</strong> java-concurrent</a></li><li class="chapter-item expanded "><a href="java-memory-model-jmm-jvm.html"><strong aria-hidden="true">4.</strong> java-memory-model-jmm-jvm</a></li><li class="chapter-item expanded "><a href="java-note.html"><strong aria-hidden="true">5.</strong> java-note</a></li><li class="chapter-item expanded "><a href="rust-note.html"><strong aria-hidden="true">6.</strong> rust-note</a></li><li class="chapter-item expanded "><a href="git-note.html"><strong aria-hidden="true">7.</strong> git note</a></li><li class="chapter-item expanded "><a href="linux-note.html"><strong aria-hidden="true">8.</strong> linux-note</a></li><li class="chapter-item expanded "><a href="cross-gfw.html"><strong aria-hidden="true">9.</strong> cross gfw</a></li><li class="chapter-item expanded "><a href="react-note.html"><strong aria-hidden="true">10.</strong> react-note</a></li><li class="chapter-item expanded "><a href="cs-note.html"><strong aria-hidden="true">11.</strong> cs note</a></li><li class="chapter-item expanded "><a href="distributed-system.html"><strong aria-hidden="true">12.</strong> distributed system</a></li><li class="chapter-item expanded "><a href="message-queue.html"><strong aria-hidden="true">13.</strong> message-queue</a></li><li class="chapter-item expanded "><a href="data-structure-and-algorithm.html"><strong aria-hidden="true">14.</strong> data structure and algorithm</a></li><li class="chapter-item expanded "><a href="effective-java-reading-note.html"><strong aria-hidden="true">15.</strong> effective java reading note</a></li><li class="chapter-item expanded "><a href="docker-note.html"><strong aria-hidden="true">16.</strong> docker note</a></li><li class="chapter-item expanded "><a href="how-to-test-java-app.html"><strong aria-hidden="true">17.</strong> how-to-test-java-app</a></li><li class="chapter-item expanded "><a href="maven-note.html"><strong aria-hidden="true">18.</strong> maven-note</a></li><li class="chapter-item expanded "><a href="mac.html"><strong aria-hidden="true">19.</strong> mac</a></li><li class="chapter-item expanded "><a href="autohotkey.html"><strong aria-hidden="true">20.</strong> AHK collection</a></li><li class="chapter-item expanded "><a href="class-conflict-check.html"><strong aria-hidden="true">21.</strong> class conflict check</a></li><li class="chapter-item expanded "><a href="cpp.html"><strong aria-hidden="true">22.</strong> cpp</a></li><li class="chapter-item expanded "><a href="create-blog-by-react.html"><strong aria-hidden="true">23.</strong> create blog by react</a></li><li class="chapter-item expanded "><a href="css-note.html"><strong aria-hidden="true">24.</strong> css-note</a></li><li class="chapter-item expanded "><a href="css-pre-processor.html"><strong aria-hidden="true">25.</strong> css pre processor</a></li><li class="chapter-item expanded "><a href="defect-about-java-programmer-from-programming-thinking.html"><strong aria-hidden="true">26.</strong> from programming thinking</a></li><li class="chapter-item expanded "><a href="design-pattern-note.html"><strong aria-hidden="true">27.</strong> design pattern note</a></li><li class="chapter-item expanded "><a href="dev-resources.html"><strong aria-hidden="true">28.</strong> dev resources</a></li><li class="chapter-item expanded "><a href="eclipse.html"><strong aria-hidden="true">29.</strong> eclipse</a></li><li class="chapter-item expanded "><a href="extjs-note.html"><strong aria-hidden="true">30.</strong> extjs-note</a></li><li class="chapter-item expanded "><a href="FreeMarker-note.html"><strong aria-hidden="true">31.</strong> FreeMarker-note</a></li><li class="chapter-item expanded "><a href="go-note.html"><strong aria-hidden="true">32.</strong> golang</a></li><li class="chapter-item expanded "><a href="hello-world.html"><strong aria-hidden="true">33.</strong> hexo</a></li><li class="chapter-item expanded "><a href="html-note.html"><strong aria-hidden="true">34.</strong> html-note</a></li><li class="chapter-item expanded "><a href="idea-note.html"><strong aria-hidden="true">35.</strong> idea-note</a></li><li class="chapter-item expanded "><a href="interview-system-design.html"><strong aria-hidden="true">36.</strong> interview-system-design</a></li><li class="chapter-item expanded "><a href="java-code-clean.html"><strong aria-hidden="true">37.</strong> java-code-clean</a></li><li class="chapter-item expanded "><a href="job-interview-cv.html"><strong aria-hidden="true">38.</strong> job-interview-cv</a></li><li class="chapter-item expanded "><a href="joke-collecting.html"><strong aria-hidden="true">39.</strong> joke-collecting</a></li><li class="chapter-item expanded "><a href="jquery-note.html"><strong aria-hidden="true">40.</strong> jquery-note</a></li><li class="chapter-item expanded "><a href="js-tutorial.html"><strong aria-hidden="true">41.</strong> js-tutorial</a></li><li class="chapter-item expanded "><a href="money.html"><strong aria-hidden="true">42.</strong> money</a></li><li class="chapter-item expanded "><a href="mongodb-note.html"><strong aria-hidden="true">43.</strong> mongodb-note</a></li><li class="chapter-item expanded "><a href="mvc-mvvm.html"><strong aria-hidden="true">44.</strong> mvc-mvvm</a></li><li class="chapter-item expanded "><a href="my-ioc.html"><strong aria-hidden="true">45.</strong> my-ioc</a></li><li class="chapter-item expanded "><a href="mybatis-note.html"><strong aria-hidden="true">46.</strong> mybatis-note</a></li><li class="chapter-item expanded "><a href="mysql-note.html"><strong aria-hidden="true">47.</strong> mysql-note</a></li><li class="chapter-item expanded "><a href="nodejs.html"><strong aria-hidden="true">48.</strong> nodejs</a></li><li class="chapter-item expanded "><a href="outline-about-cache.html"><strong aria-hidden="true">49.</strong> outline-about-cache</a></li><li class="chapter-item expanded "><a href="outline-about-db-design-note.html"><strong aria-hidden="true">50.</strong> outline-about-db-design-note</a></li><li class="chapter-item expanded "><a href="outline-about-http.html"><strong aria-hidden="true">51.</strong> outline-about-http</a></li><li class="chapter-item expanded "><a href="outline-about-rest-api.html"><strong aria-hidden="true">52.</strong> outline-about-rest-api</a></li><li class="chapter-item expanded "><a href="php-note.html"><strong aria-hidden="true">53.</strong> php-note</a></li><li class="chapter-item expanded "><a href="postgres-note.html"><strong aria-hidden="true">54.</strong> postgres-note</a></li><li class="chapter-item expanded "><a href="python-note.html"><strong aria-hidden="true">55.</strong> python-note</a></li><li class="chapter-item expanded "><a href="redis-login-limitation.html"><strong aria-hidden="true">56.</strong> redis-login-limitation</a></li><li class="chapter-item expanded "><a href="redis-note.html"><strong aria-hidden="true">57.</strong> redis-note</a></li><li class="chapter-item expanded "><a href="regex-js.html"><strong aria-hidden="true">58.</strong> regex-js</a></li><li class="chapter-item expanded "><a href="servlet.html"><strong aria-hidden="true">59.</strong> servlet</a></li><li class="chapter-item expanded "><a href="spring-note.html"><strong aria-hidden="true">60.</strong> spring-note</a></li><li class="chapter-item expanded "><a href="springboot-doc.html" class="active"><strong aria-hidden="true">61.</strong> springboot-doc</a></li><li class="chapter-item expanded "><a href="springmvc-note.html"><strong aria-hidden="true">62.</strong> springmvc-note</a></li><li class="chapter-item expanded "><a href="task-schedule-note.html"><strong aria-hidden="true">63.</strong> task-schedule-note</a></li><li class="chapter-item expanded "><a href="tcp-ip-note.html"><strong aria-hidden="true">64.</strong> tcp-ip-note</a></li><li class="chapter-item expanded "><a href="tomcat-jetty-nginx.html"><strong aria-hidden="true">65.</strong> tomcat-jetty-nginx</a></li><li class="chapter-item expanded "><a href="webpack-note.html"><strong aria-hidden="true">66.</strong> webpack-note</a></li><li class="chapter-item expanded "><a href="windows-sub-system-on-linux.html"><strong aria-hidden="true">67.</strong> windows-sub-system-on-linux</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Xiaoyu Wiki</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <hr />
<h2>title: SpringBoot reference Doc
date: 2017-12-30 22:40:32
tags: [springboot]
categories: java web</h2>
<div align="center">
springboot reference doc ç¿»è¯‘
å¼€ç®±å³ç”¨ï¼Œæä¾›å„ç§é»˜è®¤é…ç½®æ¥ç®€åŒ–é¡¹ç›®é…ç½®|å†…åµŒå¼å®¹å™¨ç®€åŒ–Webé¡¹ç›®| æ²¡æœ‰å†—ä½™ä»£ç ç”Ÿæˆå’ŒXMLé…ç½®çš„è¦æ±‚
</div>
<!--more-->
<!-- TOC -->
<ul>
<li><a href="#quickstart">quickstart</a>
<ul>
<li><a href="#%E7%94%9F%E6%88%90%E9%AA%A8%E6%9E%B6">ç”Ÿæˆéª¨æ¶</a></li>
<li><a href="#%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E7%9A%84%E7%BB%93%E6%9E%84-structuring-your-code">é¡¹ç›®ä»£ç çš„ç»“æ„ Structuring your code</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81">ä»£ç </a></li>
</ul>
</li>
<li><a href="#starter">starter</a></li>
<li><a href="#%E6%A0%87%E8%AF%86%E5%85%A5%E5%8F%A3%E7%B1%BB">æ ‡è¯†å…¥å£ç±»</a></li>
<li><a href="#%E9%85%8D%E7%BD%AE%E7%B1%BBconfiguration-classes-">é…ç½®ç±»(Configuration classes )</a>
<ul>
<li><a href="#%E6%B7%BB%E5%8A%A0%E9%85%8D%E7%BD%AE%E7%B1%BBimporting-additional-configuration-classes">æ·»åŠ é…ç½®ç±»(Importing additional configuration classes)</a></li>
<li><a href="#importing-xml-configuration-%E6%B7%BB%E5%8A%A0xml%E9%85%8D%E7%BD%AE">Importing XML configuration æ·»åŠ xmlé…ç½®</a></li>
</ul>
</li>
<li><a href="#%E5%BC%80%E5%90%AF%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AEauto-configuration">å¼€å¯è‡ªåŠ¨é…ç½®(Auto-configuration)</a>
<ul>
<li><a href="#%E5%8F%96%E6%B6%88%E7%89%B9%E5%AE%9A%E7%9A%84%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AEdisabling-specific-auto-configuration-">å–æ¶ˆç‰¹å®šçš„è‡ªåŠ¨é…ç½®(Disabling specific auto-configuration )</a></li>
</ul>
</li>
<li><a href="#bean%E6%B3%A8%E5%86%8C-%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5">beanæ³¨å†Œ ä¾èµ–æ³¨å…¥</a></li>
<li><a href="#springbootapplication%E4%BD%BF%E7%94%A8">@SpringBootApplicationä½¿ç”¨</a></li>
<li><a href="#%E5%B7%A5%E7%A8%8B%E8%B7%91%E8%B5%B7%E6%9D%A5running-your-application">å·¥ç¨‹è·‘èµ·æ¥(Running your application)</a></li>
<li><a href="#%E5%BC%80%E5%8F%91%E8%80%85%E7%BB%84%E4%BB%B6developer-tools">(å¼€å‘è€…ç»„ä»¶)Developer tools</a>
<ul>
<li><a href="#%E7%89%B9%E6%80%A7%E8%87%AA%E5%8A%A8%E8%AE%BE%E7%BD%AE%E9%BB%98%E8%AE%A4%E5%80%BC">ç‰¹æ€§ï¼šè‡ªåŠ¨è®¾ç½®é»˜è®¤å€¼</a></li>
<li><a href="#%E7%89%B9%E6%80%A7%E8%87%AA%E5%8A%A8%E9%87%8D%E5%90%AFautomatic-restart">ç‰¹æ€§ï¼šè‡ªåŠ¨é‡å¯(Automatic restart)</a>
<ul>
<li><a href="#%E9%87%8D%E5%90%AF%E6%97%B6%E7%9A%84%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95logging-changes-in-condition-evaluation">é‡å¯æ—¶çš„æ—¥å¿—è®°å½•ï¼ˆLogging changes in condition evaluationï¼‰</a></li>
<li><a href="#%E6%8E%92%E9%99%A4%E5%8F%97%E7%9B%91%E6%8E%A7%E8%B5%84%E6%BA%90excluding-resources">æ’é™¤å—ç›‘æ§èµ„æº(Excluding resources)</a></li>
<li><a href="#%E6%B7%BB%E5%8A%A0%E9%A2%9D%E5%A4%96%E7%9B%91%E6%8E%A7%E8%B7%AF%E5%BE%84watching-additional-paths-">æ·»åŠ é¢å¤–ç›‘æ§è·¯å¾„(Watching additional paths )</a></li>
<li><a href="#%E9%87%8D%E5%90%AF%E5%A4%B1%E6%95%88disabling-restart">é‡å¯å¤±æ•ˆï¼ˆDisabling restartï¼‰</a></li>
<li><a href="#%E8%AE%BE%E7%BD%AE%E4%B8%80%E4%B8%AAtrigger-file">è®¾ç½®ä¸€ä¸ªtrigger file</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89restart-classloader">è‡ªå®šä¹‰restart classloader</a></li>
<li><a href="#devtools%E7%9A%84%E5%B1%80%E9%99%90">devtoolsçš„å±€é™</a></li>
</ul>
</li>
<li><a href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E8%87%AA%E5%8A%A8%E5%88%B7%E6%96%B0livereload">æµè§ˆå™¨è‡ªåŠ¨åˆ·æ–°(LiveReload)</a></li>
<li><a href="#%E5%85%A8%E5%B1%80%E8%AE%BE%E7%BD%AEglobal-settings-">å…¨å±€è®¾ç½®(Global settings )</a></li>
<li><a href="#%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95appremote-applications">è¿œç¨‹è°ƒè¯•app(Remote applications)</a>
<ul>
<li><a href="#%E5%90%AF%E5%8A%A8%E6%9C%AC%E5%9C%B0%E7%9A%84%E5%AE%A2%E6%88%B7%E7%AB%AF">å¯åŠ¨æœ¬åœ°çš„å®¢æˆ·ç«¯</a></li>
<li><a href="#%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95">è¿œç¨‹è°ƒè¯•</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E6%89%93%E5%8C%85%E5%88%B0%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83">æ‰“åŒ…åˆ°ç”Ÿäº§ç¯å¢ƒ</a></li>
<li><a href="#springapplication">SpringApplication</a>
<ul>
<li><a href="#%E5%90%AF%E5%8A%A8%E5%A4%B1%E8%B4%A5startup-failure">å¯åŠ¨å¤±è´¥(Startup failure)</a></li>
<li><a href="#%E5%AE%9A%E5%88%B6banner">å®šåˆ¶banner</a>
<ul>
<li><a href="#%E7%9B%B4%E6%8E%A5%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEfile">ç›´æ¥é€šè¿‡è®¾ç½®file</a></li>
<li><a href="#%E9%80%9A%E8%BF%87%E7%BC%96%E7%A8%8B%E6%96%B9%E5%BC%8F">é€šè¿‡ç¼–ç¨‹æ–¹å¼</a></li>
<li><a href="#%E6%8E%A7%E5%88%B6banner%E6%89%93%E5%8D%B0%E5%88%B0%E7%9A%84%E5%9C%B0%E6%96%B9">æ§åˆ¶banneræ‰“å°åˆ°çš„åœ°æ–¹</a></li>
</ul>
</li>
<li><a href="#%E5%AE%9A%E5%88%B6springapplication">å®šåˆ¶SpringApplication</a></li>
<li><a href="#%E5%BA%94%E7%94%A8%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%92%8C%E7%9B%91%E5%90%AC%E5%99%A8">åº”ç”¨çš„äº‹ä»¶å’Œç›‘å¬å™¨</a></li>
<li><a href="#%E6%B3%A8%E5%85%A5applicationcontext">æ³¨å…¥ApplicationContext</a></li>
<li><a href="#%E8%87%AA%E5%8A%A8%E8%AE%BE%E7%BD%AEweb%E7%8E%AF%E5%A2%83">è‡ªåŠ¨è®¾ç½®webç¯å¢ƒ</a></li>
<li><a href="#application-exit">Application exit</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96admin%E5%B1%9E%E6%80%A7admin-features">è·å–adminå±æ€§(Admin features)</a></li>
</ul>
</li>
<li><a href="#%E5%BC%95%E5%85%A5%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6externalized-configuration">å¼•å…¥é…ç½®æ–‡ä»¶(Externalized Configuration)</a>
<ul>
<li><a href="#%E6%80%8E%E4%B9%88%E5%BC%95%E5%85%A5%E5%91%A2">æ€ä¹ˆå¼•å…¥å‘¢</a></li>
<li><a href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7">é…ç½®æ–‡ä»¶çš„ä¼˜å…ˆçº§</a></li>
<li><a href="#%E4%B8%8D%E5%90%8C%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%AD%E7%9A%84applicationproperties">ä¸åŒæ–‡ä»¶å¤¹ä¸­çš„application.properties</a></li>
<li><a href="#%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AEprofile-specific-properties">å¤šç¯å¢ƒé…ç½®(Profile-specific properties)</a></li>
<li><a href="#%E6%B3%A8%E5%85%A5%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7-%E5%8D%A0%E4%BD%8D%E7%AC%A6">æ³¨å…¥è‡ªå®šä¹‰å±æ€§-å ä½ç¬¦</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8yaml">ä½¿ç”¨YAML</a>
<ul>
<li><a href="#%E8%BD%BD%E5%85%A5yaml">è½½å…¥yaml</a></li>
<li><a href="#%E5%B0%86yml%E8%BD%AC%E4%B8%BAproperties">å°†ymlè½¬ä¸ºproperties</a></li>
<li><a href="#yaml%E7%9A%84%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE">yamlçš„å¤šç¯å¢ƒé…ç½®</a></li>
<li><a href="#yaml%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8propertysource">yamlä¸èƒ½ä½¿ç”¨@PropertySource</a></li>
<li><a href="#ymal%E4%B8%AD%E7%9A%84list">ymalä¸­çš„list</a></li>
</ul>
</li>
<li><a href="#configurationproperties">@ConfigurationProperties</a>
<ul>
<li><a href="#%E7%BB%9F%E4%B8%80%E5%89%8D%E7%BC%80">ç»Ÿä¸€å‰ç¼€</a></li>
<li><a href="#%E7%AC%AC%E4%B8%89%E6%96%B9%E7%BB%84%E4%BB%B6%E5%8E%BB%E9%85%8D%E7%BD%AE%E5%8C%96">ç¬¬ä¸‰æ–¹ç»„ä»¶å»é…ç½®åŒ–</a></li>
<li><a href="#%E6%9D%BE%E7%BB%91%E5%AE%9Arelaxed-binding">æ¾ç»‘å®šï¼ˆrelaxed bindingï¼‰</a></li>
<li><a href="#%E5%A4%8D%E6%9D%82%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%B7%B7%E5%90%88merge">å¤æ‚ç±»å‹çš„æ··åˆ(merge)</a></li>
<li><a href="#%E5%B1%9E%E6%80%A7-%E8%BD%AC%E6%8D%A2">å±æ€§ è½¬æ¢</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#profiles">profiles</a>
<ul>
<li><a href="#%E6%B7%BB%E5%8A%A0active-profiles">æ·»åŠ active-profiles</a></li>
</ul>
</li>
<li><a href="#springboot%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95">springbootå•å…ƒæµ‹è¯•</a></li>
<li><a href="#%E6%97%A5%E5%BF%97">æ—¥å¿—</a>
<ul>
<li><a href="#%E8%BE%93%E5%87%BA%E9%85%8D%E7%BD%AE">è¾“å‡ºé…ç½®</a>
<ul>
<li><a href="#%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F">è¾“å‡ºæ ¼å¼</a></li>
<li><a href="#console%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%87%BA">consoleæ§åˆ¶å°è¾“å‡º</a></li>
<li><a href="#%E5%B8%A6%E9%A2%9C%E8%89%B2%E8%BE%93%E5%87%BA">å¸¦é¢œè‰²è¾“å‡º</a></li>
<li><a href="#file%E6%96%87%E4%BB%B6%E8%BE%93%E5%87%BA">fileæ–‡ä»¶è¾“å‡º</a></li>
</ul>
</li>
<li><a href="#%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%ABlog-levels">æ—¥å¿—çº§åˆ«(Log Levels)</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89log-configration">è‡ªå®šä¹‰log configration</a></li>
<li><a href="#mdc%E7%89%B9%E6%80%A7">MDCç‰¹æ€§</a></li>
<li><a href="#logback%E8%AF%A6%E7%BB%86%E9%85%8D%E7%BD%AE">logbackè¯¦ç»†é…ç½®</a>
<ul>
<li><a href="#%E4%BE%9D%E8%B5%96">ä¾èµ–</a></li>
<li><a href="#logback-springxml">logback-spring.xml</a></li>
<li><a href="#%E7%9C%8B%E4%B8%80%E4%B8%AA%E5%85%B7%E4%BD%93%E6%97%A5%E5%BF%97%E9%9C%80%E6%B1%82">çœ‹ä¸€ä¸ªå…·ä½“æ—¥å¿—éœ€æ±‚</a></li>
<li><a href="#%E6%8E%92%E9%99%A4%E4%B8%8D%E9%9C%80%E8%A6%81%E7%9A%84%E6%97%A5%E5%BF%97">æ’é™¤ä¸éœ€è¦çš„æ—¥å¿—</a></li>
</ul>
</li>
<li><a href="#logback%E6%89%A9%E5%B1%95%E7%89%B9%E6%80%A7">logbackæ‰©å±•ç‰¹æ€§</a>
<ul>
<li><a href="#logback%E7%9A%84%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE">logbackçš„å¤šç¯å¢ƒé…ç½®</a></li>
<li><a href="#%E9%85%8D%E7%BD%AE%E4%B8%AD%E4%BD%BF%E7%94%A8environment-properties">é…ç½®ä¸­ä½¿ç”¨Environment properties</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%BC%80%E5%8F%91-web-app">å¼€å‘ web app</a>
<ul>
<li><a href="#%E5%BC%95%E5%85%A5webjars">å¼•å…¥WebJars</a>
<ul>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AFwebjars">ä»€ä¹ˆæ˜¯webjars</a></li>
<li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8webjars">ä¸ºä»€ä¹ˆä½¿ç”¨webjars</a></li>
<li><a href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-webjars">å¦‚ä½•ä½¿ç”¨ webjars</a></li>
</ul>
</li>
<li><a href="#gradle-%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7">Gradle æ„å»ºå·¥å…·</a></li>
<li><a href="#%E5%BC%80%E5%8F%91filter">å¼€å‘filter</a></li>
<li><a href="#spring-web-mvc%E6%A1%86%E6%9E%B6">Spring Web MVCæ¡†æ¶</a>
<ul>
<li><a href="#%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AEspringmvc">è‡ªåŠ¨é…ç½®Springmvc</a></li>
<li><a href="#http%E6%B6%88%E6%81%AF%E8%BD%AC%E6%8D%A2%E5%99%A8httpmessageconverters">httpæ¶ˆæ¯è½¬æ¢å™¨(HttpMessageConverters)</a></li>
<li><a href="#messagecodesresolver">MessageCodesResolver</a></li>
<li><a href="#%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90">é™æ€èµ„æº</a></li>
<li><a href="#%E6%AC%A2%E8%BF%8E%E9%A1%B5">æ¬¢è¿é¡µ</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BD%91%E7%AB%99%E5%9B%BE%E6%A0%87">è‡ªå®šä¹‰ç½‘ç«™å›¾æ ‡</a></li>
<li><a href="#%E8%AF%B7%E6%B1%82%E5%8C%B9%E9%85%8D%E5%92%8C%E8%B5%84%E6%BA%90%E5%AF%BC%E8%88%AApath-matching-and-content-negotiation">è¯·æ±‚åŒ¹é…å’Œèµ„æºå¯¼èˆª(Path Matching and Content Negotiation)</a></li>
<li><a href="#configurablewebbindinginitializer">ConfigurableWebBindingInitializer</a></li>
<li><a href="#%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E">æ¨¡æ¿å¼•æ“</a></li>
<li><a href="#%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86">å…¨å±€å¼‚å¸¸å¤„ç†</a>
<ul>
<li><a href="#%E5%A6%82%E6%9E%9C%E8%BF%94%E5%9B%9E%E8%A7%86%E5%9B%BE">å¦‚æœè¿”å›è§†å›¾</a></li>
<li><a href="#%E5%A6%82%E6%9E%9C%E8%BF%94%E5%9B%9Ejson">å¦‚æœè¿”å›json</a></li>
<li><a href="#%E5%AE%9A%E5%88%B6%E8%87%AA%E5%B7%B1%E7%9A%84%E9%94%99%E8%AF%AF%E9%A1%B5%E9%9D%A2">å®šåˆ¶è‡ªå·±çš„é”™è¯¯é¡µé¢</a></li>
<li><a href="#%E4%B8%8D%E4%BD%BF%E7%94%A8springmvc">ä¸ä½¿ç”¨springmvc</a></li>
</ul>
</li>
<li><a href="#%E9%85%8D%E7%BD%AE%E5%85%81%E8%AE%B8%E8%B7%A8%E5%9F%9F%E8%AE%BF%E9%97%AE">é…ç½®å…è®¸è·¨åŸŸè®¿é—®</a></li>
</ul>
</li>
<li><a href="#spring-webflux-framework">Spring WebFlux Framework</a></li>
<li><a href="#jax-rs-and-jersey">JAX-RS and Jersey</a></li>
<li><a href="#%E5%B5%8C%E5%85%A5%E5%BC%8Fservlet%E5%AE%B9%E5%99%A8">åµŒå…¥å¼servletå®¹å™¨</a>
<ul>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%86%85%E5%B5%8C%E5%AE%B9%E5%99%A8">è‡ªå®šä¹‰å†…åµŒå®¹å™¨</a></li>
<li><a href="#servlets-filters-and-listeners">Servlets, Filters, and listeners</a></li>
<li><a href="#servlet%E4%B8%8A%E4%B8%8B%E6%96%87%E5%88%9D%E5%A7%8B%E5%8C%96">servletä¸Šä¸‹æ–‡åˆå§‹åŒ–</a></li>
<li><a href="#%E5%AF%B9jsp%E7%9A%84%E9%99%90%E5%88%B6">å¯¹jspçš„é™åˆ¶</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%AE%89%E5%85%A8security">å®‰å…¨(Security)</a>
<ul>
<li><a href="#oauth2">OAuth2</a></li>
</ul>
</li>
<li><a href="#%E5%AE%9E%E8%B7%B5">å®è·µ</a>
<ul>
<li><a href="#%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%8F%91">æ¥å£å¼€å‘</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E">ä½¿ç”¨æ¨¡æ¿å¼•æ“</a>
<ul>
<li><a href="#themeleaf">themeleaf</a></li>
<li><a href="#freemarker">freemarker</a></li>
<li><a href="#velocity">velocity</a></li>
</ul>
</li>
<li><a href="#%E9%9B%86%E6%88%90swagger2">é›†æˆswagger2</a></li>
<li><a href="#%E7%BB%9F%E4%B8%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86">ç»Ÿä¸€å¼‚å¸¸å¤„ç†</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8jdbctemplate">ä½¿ç”¨JdbcTemplate</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8spring-data-jpa">ä½¿ç”¨Spring-data-jpa</a></li>
<li><a href="#%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE">å¤šæ•°æ®æºé…ç½®</a>
<ul>
<li><a href="#mybatis">mybatis</a></li>
<li><a href="#jdbctemplate">JdbcTemplate</a></li>
<li><a href="#spring-data-jpa">Spring-data-jpa</a></li>
</ul>
</li>
<li><a href="#%E4%BD%BF%E7%94%A8redis%E4%BD%9C%E4%B8%BA%E6%95%B0%E6%8D%AE%E5%BA%93">ä½¿ç”¨redisä½œä¸ºæ•°æ®åº“</a></li>
<li><a href="#async%E5%BC%82%E6%AD%A5%E8%B0%83%E7%94%A8">@Asyncå¼‚æ­¥è°ƒç”¨</a></li>
<li><a href="#log4j%E6%94%AF%E6%8C%81">log4jæ”¯æŒ</a></li>
<li><a href="#%E5%A4%9A%E7%8E%AF%E5%A2%83%E4%B8%8B%E7%9A%84%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE">å¤šç¯å¢ƒä¸‹çš„æ—¥å¿—é…ç½®</a></li>
<li><a href="#aop%E7%BB%9F%E4%B8%80%E5%A4%84%E7%90%86%E8%AF%B7%E6%B1%82%E6%97%A5%E5%BF%97">aopç»Ÿä¸€å¤„ç†è¯·æ±‚æ—¥å¿—</a></li>
<li><a href="#%E7%BC%93%E5%AD%98%E6%94%AF%E6%8C%81">ç¼“å­˜æ”¯æŒ</a></li>
<li><a href="#%E6%B6%88%E6%81%AF%E6%9C%8D%E5%8A%A1">æ¶ˆæ¯æœåŠ¡</a></li>
<li><a href="#%E7%9B%91%E6%8E%A7%E7%AE%A1%E7%90%86">ç›‘æ§ç®¡ç†</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h1><a class="header" href="#quickstart" id="quickstart">quickstart</a></h1>
<h2><a class="header" href="#ç”Ÿæˆéª¨æ¶" id="ç”Ÿæˆéª¨æ¶">ç”Ÿæˆéª¨æ¶</a></h2>
<p>è®¿é—®ï¼šhttp://start.spring.io/</p>
<p>ç”Ÿæˆçš„Applicationå’ŒApplicationTestsç±»éƒ½å¯ä»¥ç›´æ¥è¿è¡Œæ¥å¯åŠ¨å½“å‰åˆ›å»ºçš„é¡¹ç›®ï¼Œç”±äºç›®å‰è¯¥é¡¹ç›®æœªé…åˆä»»ä½•æ•°æ®è®¿é—®æˆ–Webæ¨¡å—ï¼Œç¨‹åºä¼šåœ¨åŠ è½½å®ŒSpringä¹‹åç»“æŸè¿è¡Œã€‚</p>
<p>æ­¤æ—¶çš„pom.xmlå†…å®¹å¦‚ä¸‹ï¼Œä»…å¼•å…¥äº†ä¸¤ä¸ªæ¨¡å—</p>
<ul>
<li>spring-boot-starterï¼šæ ¸å¿ƒæ¨¡å—ï¼ŒåŒ…æ‹¬è‡ªåŠ¨é…ç½®æ”¯æŒã€æ—¥å¿—å’ŒYAML</li>
<li>spring-boot-starter-testï¼šæµ‹è¯•æ¨¡å—ï¼ŒåŒ…æ‹¬JUnitã€Hamcrestã€Mockito</li>
</ul>
<p>ä¸ºäº†å¼•å…¥Webæ¨¡å—ï¼Œéœ€æ·»åŠ spring-boot-starter-webæ¨¡å—</p>
<pre><code class="language-xml">&lt;dependency&gt;
	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
	&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<ul>
<li>
<p>è¿™é‡Œæ¯”è¾ƒä¸‹<code>&lt;dependency&gt;</code>å’Œ<code>&lt;dependencyManagement&gt;</code>åŒºåˆ«ï¼š</p>
<ul>
<li>
<p><code>&lt;dependencyManagement&gt;</code>åªæ˜¯å¯¹jarç‰ˆæœ¬å·è¿›è¡Œç®¡ç†ï¼Œä¸ä¼šå¼•å…¥ï¼Œåªæ˜¯å£°æ˜,éœ€åœ¨å­pomä¸­æ˜¾å¼å¼•å…¥(å­pomä¸­å¯ä»¥ä¸åŠ ç‰ˆæœ¬å· )</p>
<p>ä¾‹å¦‚ï¼šçˆ¶pomåœ¨dependencyManagementä¸­å¼•å…¥spring-boot-dependenciesï¼Œåˆ™æ‰€æœ‰å­pomä¸­å¼•å…¥ä¾èµ–æ—¶æ— éœ€ç‰ˆæœ¬å·</p>
</li>
<li>
<p><code>&lt;dependency&gt;</code>çœŸæ­£å¼•å…¥ï¼Œå­pomå‡ä¼šç»§æ‰¿</p>
</li>
</ul>
</li>
</ul>
<h2><a class="header" href="#é¡¹ç›®ä»£ç çš„ç»“æ„-structuring-your-code" id="é¡¹ç›®ä»£ç çš„ç»“æ„-structuring-your-code">é¡¹ç›®ä»£ç çš„ç»“æ„ Structuring your code</a></h2>
<p>å…¶ä¸­src/main/javaä¸­æ¨èçš„ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code>com
+- example
    +- myproject
        +- Application.java
        |
        +- domain
        |   +- Customer.java
        |   +- CustomerRepository.java
        |
        +- service
        |   +- CustomerService.java
        |
        +- web
            +- CustomerController.java
</code></pre>
<h2><a class="header" href="#ä»£ç " id="ä»£ç ">ä»£ç </a></h2>
<pre><code class="language-java">@RestController
@RequestMapping(&quot;/&quot;)
public class DemoController {

    @GetMapping(&quot;index&quot;)
    public String index() {
        return &quot;hello&quot;;
    }
}

</code></pre>
<p>é€šè¿‡ideå¯åŠ¨ä¸»ç¨‹åºï¼Œæ‰“å¼€æµè§ˆå™¨è®¿é—®http://localhost:8080/indexï¼Œå¯ä»¥çœ‹åˆ°é¡µé¢è¾“å‡ºHello</p>
<p>é€šè¿‡mavenå¯åŠ¨ï¼šè¿›å…¥æ ¹ç›®å½•ï¼Œ<code>mvn spring-boot:run</code></p>
<p>é€šè¿‡å‘½ä»¤è¡Œ, <code>java -jar xxx</code>å¯åŠ¨. å…ˆæ‰“åŒ…ï¼Œç”Ÿæˆjarï¼š<code>mvn package </code>,å¦‚æœè¦å¿½ç•¥æµ‹è¯•ï¼š<code>mvn package -DskipTests</code>,jaråŒ…åœ¨targetç›®å½•</p>
<p>å¦‚æœæ²¡æœ‰ç»§æ‰¿spring-boot-starter-parentï¼Œpoméœ€è¦å¼•å…¥ï¼š</p>
<pre><code class="language-xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;

</code></pre>
<p>å•å…ƒæµ‹è¯•ç”¨ä¾‹ï¼šä¸ç”¨å¯åŠ¨å³å¯æµ‹è¯•</p>
<pre><code class="language-java">/**
æ³¨æ„å¼•å…¥ä¸‹é¢å†…å®¹ï¼Œè®©statusã€contentã€equalToå‡½æ•°å¯ç”¨

    import static org.hamcrest.Matchers.equalTo;
    import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
    import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

*/
@RunWith(SpringRunner.class)
@SpringBootTest
public class Chapter1ApplicationTests {

    private MockMvc mvc;

    @Before
    public void setUp() throws Exception {
        mvc = MockMvcBuilders.standaloneSetup(new HelloController()).build();
    }

	@Test
	public void getHello() throws Exception {
	    mvc.perform(MockMvcRequestBuilders.get(&quot;/index&quot;).accept(MediaType.APPLICATION_JSON))
        .andExpect(status().isOk())
        .andExpect(content().string(equalTo(&quot;Hello World!&quot;)));
	}

}
</code></pre>
<h1><a class="header" href="#starter" id="starter">starter</a></h1>
<p>https://www.nosuchfield.com/2017/10/15/Spring-Boot-Starters/
https://www.cnblogs.com/yuansc/p/9088212.html</p>
<h1><a class="header" href="#æ ‡è¯†å…¥å£ç±»" id="æ ‡è¯†å…¥å£ç±»">æ ‡è¯†å…¥å£ç±»</a></h1>
<p><code>@EnableAutoConfiguration</code> ä¸€èˆ¬è®¾ç½®åœ¨å…¥å£ç±»ä¸Š, ä»–éšå¼åœ°å°†å½“å‰ç±»æ‰€åœ¨åŒ…è®¾ç½®ä¸º&quot;base search package&quot;, æ•´ä¸ªappå°†æœå¯»è¿™ä¸ªåŒ…åŠå…¶å­åŒ…ä¸­çš„items(eg: ä¸€ä¸ªjpa app, è¢«è¯¥æ³¨è§£è¡¨ç¤ºç±»æ‰€åœ¨çš„åŒ…å°†ä¼šè¢«ç”¨æ¥æœå¯»@Entity items).</p>
<p>ä½¿ç”¨äº†<code>@EnableAutoConfiguration</code>æ ‡è¯†base packageä¹‹å,  ä½¿ç”¨<code>@ComponentScan</code>å°±æ— éœ€è®¾ç½®<code>basePackage </code>å±æ€§äº†</p>
<p><code>@Configuration</code> ç”¨@Configurationæ³¨è§£çš„ç±»ï¼Œç­‰ä»· ä¸XMLä¸­é…ç½®beansï¼›ç”¨@Beanæ ‡æ³¨æ–¹æ³•ç­‰ä»·äºXMLä¸­é…ç½®çš„bean</p>
<p>ä¾‹å­å¦‚ä¸‹: (ç›¸å½“äº é…ç½®springå¼€å¯æ³¨è§£æ‰«æ<code>&lt;context:component-scan base-package=&quot;com.xiaoyu.demo&quot; /&gt;</code>)</p>
<pre><code class="language-java">@Configuration  
public class ExampleConfiguration {  
  
    @Value(&quot;${batch.jdbc.driver}&quot;)  
    private String driverClassName;  
  
    @Value(&quot;${batch.jdbc.url}&quot;)  
    private String driverUrl;  
  
    @Value(&quot;${batch.jdbc.user}&quot;)  
    private String driverUsername;  
  
    @Value(&quot;${batch.jdbc.password}&quot;)  
    private String driverPassword;  
  
    @Bean(name = &quot;dataSource&quot;)  
    public DataSource dataSource() {  
        BasicDataSource dataSource = new BasicDataSource();  
        dataSource.setDriverClassName(driverClassName);  
        dataSource.setUrl(driverUrl);  
        dataSource.setUsername(driverUsername);  
        dataSource.setPassword(driverPassword);  
        return dataSource;  
    }  
  
    @Bean  
    public PlatformTransactionManager transactionManager() {  
        return new DataSourceTransactionManager(dataSource());  
    }  
  
}  
</code></pre>
<h1><a class="header" href="#é…ç½®ç±»configuration-classes-" id="é…ç½®ç±»configuration-classes-">é…ç½®ç±»(Configuration classes )</a></h1>
<p>å…¥å£ç±»ä¹Ÿæ˜¯ä½œä¸º@configuration class çš„ å¥½é€‰æ‹©(Usually the class that defines the main method is also a good candidate as the primary <code>@Configuration</code>.)</p>
<p>æƒ³è¦æ·»åŠ é…ç½®æ–‡ä»¶æ—¶, å…ˆè¯•è¯•æœç´¢<code>@Enable*</code>æ³¨è§£, å¦‚æœä¸èƒ½è§£å†³, å†è€ƒè™‘æ·»åŠ xmlé…ç½®</p>
<h2><a class="header" href="#æ·»åŠ é…ç½®ç±»importing-additional-configuration-classes" id="æ·»åŠ é…ç½®ç±»importing-additional-configuration-classes">æ·»åŠ é…ç½®ç±»(Importing additional configuration classes)</a></h2>
<p>å¦‚æœä¸æ­¢ä¸€ä¸ª@Configuration class, å¯ä»¥åœ¨é€‰å®šçš„ä¸»é…ç½®ç±»ä¸Š(æ¯”å¦‚å…¥å£ç±»)ä½¿ç”¨<code>@Import({xxxConfig.class})</code>æ¥å¯¼å…¥å¦å¤–çš„é…ç½®ç±»,è¿™ç§æ–¹å¼æƒ…å†µä¸‹, åªéœ€è¦ä¸»é…ç½®ç±»ä½¿ç”¨<code>@Configurationå’Œ@Import({xxxConfig.class})</code>, å…¶ä»–é…ç½®ç±»æ— éœ€ä»»ä½•æ³¨è§£</p>
<p>æˆ–è€…ä¹Ÿå¯ä»¥<code>@ComponentScan</code>è‡ªåŠ¨æ‰«ææ‰€æœ‰spring component, å½“ç„¶ä¹ŸåŒ…æ‹¬@Configuration classes, æ­¤æ—¶æ¯ä¸ªé…ç½®ç±»éƒ½éœ€è¦@Configuration</p>
<h2><a class="header" href="#importing-xml-configuration-æ·»åŠ xmlé…ç½®" id="importing-xml-configuration-æ·»åŠ xmlé…ç½®">Importing XML configuration æ·»åŠ xmlé…ç½®</a></h2>
<p>é¦–å…ˆåˆ›å»ºä¸€ä¸ª<code>@Configuration</code>ç±», ç„¶ååœ¨ç±»ä¸Šé€šè¿‡<code>@ImportResource(&quot;classpath:cons-injec.xml&quot;)</code>æ¥å¯¼å…¥xmlé…ç½®æ–‡ä»¶</p>
<p>ç”¨æ¥å…¼å®¹è€çš„ spring é¡¹ç›®</p>
<h1><a class="header" href="#å¼€å¯è‡ªåŠ¨é…ç½®auto-configuration" id="å¼€å¯è‡ªåŠ¨é…ç½®auto-configuration">å¼€å¯è‡ªåŠ¨é…ç½®(Auto-configuration)</a></h1>
<p>é€‰æ‹©ä¸€ä¸ª<code>@Configuration</code> classes æ·»åŠ  <code>@EnableAutoConfiguration</code> or <code>@SpringBootApplication</code>, æ¨èå…¥å£ç±»</p>
<p>è‡ªåŠ¨é…ç½®å¼€å¯å, å¼•å…¥å…¶ä»–ç‰¹å®šçš„ç»„ä»¶é‚£ä¹ˆç›¸åº”çš„è‡ªåŠ¨é…ç½®ä¼šè¢«è‡ªåŠ¨æ›¿æ¢, é€šè¿‡<code>--debug</code>è¿è¡ŒæŸ¥çœ‹æœ‰å“ªäº›è‡ªåŠ¨é…ç½®(Auto-configuration is noninvasive, at any point you can start to define your own configuration to replace specific parts of the auto-configuration. For example, if you add your own DataSource bean, the default embedded database support will back away)</p>
<h2><a class="header" href="#å–æ¶ˆç‰¹å®šçš„è‡ªåŠ¨é…ç½®disabling-specific-auto-configuration-" id="å–æ¶ˆç‰¹å®šçš„è‡ªåŠ¨é…ç½®disabling-specific-auto-configuration-">å–æ¶ˆç‰¹å®šçš„è‡ªåŠ¨é…ç½®(Disabling specific auto-configuration )</a></h2>
<p><code>@EnableAutoConfiguration(exclude={xxxAutoConfiguration.class})</code></p>
<pre><code class="language-java">@Configuration
@EnableAutoConfiguration(exclude={DataSourceAutoConfiguration.class})
public class MyConfiguration {
}
</code></pre>
<p>å¦‚æœæƒ³å–æ¶ˆçš„ è‡ªåŠ¨é…ç½®ç±» ä¸åœ¨classpathä¸‹, ä½¿ç”¨è¯¥æ³¨è§£çš„<code>excludeName </code> æ¥æŒ‡å®šfully qualified name</p>
<p>åŒæ—¶, ä¹Ÿå¯ä½¿ç”¨<code>spring.autoconfigure.exclude</code> property.</p>
<h1><a class="header" href="#beanæ³¨å†Œ-ä¾èµ–æ³¨å…¥" id="beanæ³¨å†Œ-ä¾èµ–æ³¨å…¥">beanæ³¨å†Œ ä¾èµ–æ³¨å…¥</a></h1>
<p><code>@ComponentScan</code> å’Œ <code>@Autowired</code> è”åˆä½¿ç”¨</p>
<p>å¦‚æœæŒ‰ç…§æ¨èçš„ä»£ç ç»“æ„, <code>@ComponentScan</code>æ— éœ€é…ç½®ä»»ä½•é¢å¤–å±æ€§, å°±èƒ½å°† All of your application components (<code>@Component, @Service, @Repository, @Controller</code> etc.) will be automatically registered as Spring Beans.</p>
<pre><code class="language-java">@Service
public class DatabaseAccountService implements AccountService {

    private final RiskAssessor riskAssessor = null;// è¿™é‡Œæ˜¯finalçš„, æ„å‘³ç€ä¸èƒ½ä¿®æ”¹å®ƒäº†

    // @Autowired// æ­¤æ—¶ç”±äºæœ‰äº†æ„é€ å‡½æ•°, @Autowiredå…¶å®å¯ä»¥çœç•¥
    public DatabaseAccountService(RiskAssessor riskAssessor) {
        this.riskAssessor = riskAssessor;
    }

    // ...

}

// æˆ–è€…ç›´æ¥
@Service
public class DatabaseAccountService implements AccountService {

    @Autowired
    private final RiskAssessor riskAssessor;// è¿™é‡Œæ˜¯finalçš„, æ„å‘³ç€ä¸èƒ½ä¿®æ”¹å®ƒäº†

    // ...

}
</code></pre>
<h1><a class="header" href="#springbootapplicationä½¿ç”¨" id="springbootapplicationä½¿ç”¨">@SpringBootApplicationä½¿ç”¨</a></h1>
<p>The <code>@SpringBootApplication</code> annotation is equivalent to using <code>@Configuration, @EnableAutoConfiguration and @ComponentScan</code> with their default attributes</p>
<p><code>@SpringBootApplication</code>ä¹Ÿæä¾›å±æ€§æ¥æ’é™¤auto-configration class, è®¾ç½® base package</p>
<pre><code class="language-java">@SpringBootApplication // same as @Configuration @EnableAutoConfiguration @ComponentScan
public class Application {

	public static void main(String[] args) {
		SpringApplication.run(Application.class, args);
	}

}

//@Configuration, @EnableAutoConfiguration and @ComponentScanä¸æ˜¯éæœ‰ä¸å¯çš„
// æ¯”å¦‚ä¸ä½¿ç”¨@ComponentScan
@Configuration
@EnableAutoConfiguration
@Import({ MyConfig.class, MyAnotherConfig.class })
public class Application {

	public static void main(String[] args) {
			SpringApplication.run(Application.class, args);
	}

}

</code></pre>
<h1><a class="header" href="#å·¥ç¨‹è·‘èµ·æ¥running-your-application" id="å·¥ç¨‹è·‘èµ·æ¥running-your-application">å·¥ç¨‹è·‘èµ·æ¥(Running your application)</a></h1>
<p>Running from an IDEå°±ä¸è¯´äº†</p>
<p>Running as a packaged application <code>java -jar target/myproject-0.0.1-SNAPSHOT.jar</code></p>
<p>Using the Maven plugin <code>mvn spring-boot:run</code>, è®¾ç½®åˆé€‚çš„ç¯å¢ƒå˜é‡: <code>export MAVEN_OPTS=-Xmx1024m -XX:MaxPermSize=128M</code></p>
<p>çƒ­æ‹”æ’(çƒ­éƒ¨ç½²)æ•ˆæœ(Hot Swapping): springbootå·¥ç¨‹æ˜¯ä¸€ä¸ªç®€å•çš„java app, æ‰€ä»¥çƒ­éƒ¨ç½²æ˜¯out of the boxçš„,ä½†æ˜¯åœ¨å­—èŠ‚ç æ›¿æ¢æ–¹é¢æœ‰é™åˆ¶( JVM hot swapping is somewhat limited with the bytecode that it can replace), æ›´å¼ºçš„åŠŸèƒ½å¯ä»¥çœ‹çœ‹ <a href="https://zeroturnaround.com/software/jrebel/">ğŸšª</a></p>
<h1><a class="header" href="#å¼€å‘è€…ç»„ä»¶developer-tools" id="å¼€å‘è€…ç»„ä»¶developer-tools">(å¼€å‘è€…ç»„ä»¶)Developer tools</a></h1>
<p>spring-boot-devtools èƒ½å¤Ÿæä¾›å¼€å‘é˜¶æ®µçš„ä¸€ç³»åˆ—ç‰¹æ€§(æ¯”å¦‚æ¨¡ç‰ˆå¼•æ“ä¼šç¼“å­˜è§£æåçš„æ¨¡ç‰ˆ, DevToolsä¼šç¦ç”¨å®ƒ, å†æ¯”å¦‚åœ¨ä¸ºé™æ€èµ„æºæä¾›æœåŠ¡æ—¶ï¼ŒSpring MVCå¯ä»¥å°†HTTPç¼“å­˜å¤´æ·»åŠ åˆ°å“åº”ä¸­, DevToolä¹Ÿç¦ç”¨ä»–)ï¼Œå½“è¿è¡Œä¸€ä¸ªæ‰“åŒ…å¥½çš„ç¨‹åºAPPæ—¶(æ¯”å¦‚:java -jar xxx)ï¼Œè¿™äº›ç¦ç”¨ä¼šè‡ªåŠ¨å¤±æ•ˆï¼š</p>
<pre><code class="language-xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
        &lt;optional&gt;true&lt;/optional&gt; &lt;!--  æœ€ä½³å®è·µ, é˜²æ­¢ä¼ é€’åˆ°å…¶ä»–module --&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre>
<h2><a class="header" href="#ç‰¹æ€§è‡ªåŠ¨è®¾ç½®é»˜è®¤å€¼" id="ç‰¹æ€§è‡ªåŠ¨è®¾ç½®é»˜è®¤å€¼">ç‰¹æ€§ï¼šè‡ªåŠ¨è®¾ç½®é»˜è®¤å€¼</a></h2>
<p>ä¾‹å¦‚ï¼šæ— éœ€æ‰‹åŠ¨è®¾ç½®spring.thymeleaf.cache=falseï¼Œè¿˜æœ‰å…¶ä»–ä¸€äº›é»˜è®¤å±æ€§ï¼š</p>
<pre><code class="language-java">properties.put(&quot;spring.thymeleaf.cache&quot;, &quot;false&quot;);
properties.put(&quot;spring.freemarker.cache&quot;, &quot;false&quot;);
properties.put(&quot;spring.groovy.template.cache&quot;, &quot;false&quot;);
properties.put(&quot;spring.mustache.cache&quot;, &quot;false&quot;);
properties.put(&quot;server.session.persistent&quot;, &quot;true&quot;);
properties.put(&quot;spring.h2.console.enabled&quot;, &quot;true&quot;);
properties.put(&quot;spring.resources.cache-period&quot;, &quot;0&quot;);
properties.put(&quot;spring.resources.chain.cache&quot;, &quot;false&quot;);
properties.put(&quot;spring.template.provider.cache&quot;, &quot;false&quot;);
properties.put(&quot;spring.mvc.log-resolved-exception&quot;, &quot;true&quot;);
properties.put(&quot;server.jsp-servlet.init-parameters.development&quot;, &quot;true&quot;);
</code></pre>
<p>å…·ä½“æœ‰é‚£äº›default properties, see https://github.com/spring-projects/spring-boot/blob/v1.5.9.RELEASE/spring-boot-devtools/src/main/java/org/springframework/boot/devtools/env/DevToolsPropertyDefaultsPostProcessor.java</p>
<h2><a class="header" href="#ç‰¹æ€§è‡ªåŠ¨é‡å¯automatic-restart" id="ç‰¹æ€§è‡ªåŠ¨é‡å¯automatic-restart">ç‰¹æ€§ï¼šè‡ªåŠ¨é‡å¯(Automatic restart)</a></h2>
<p>classpathä¸‹çš„æ–‡ä»¶æ”¹åŠ¨ï¼ŒAPPè‡ªåŠ¨é‡å¯, é€šè¿‡spring-boot-devtoolså®ç°</p>
<p>autorestartå’ŒLiveReloadåˆä½œè‰¯å¥½ï¼Œ å’ŒJrebelåˆä½œè‡ªåŠ¨é‡å¯ä¼šå…³é—­ä»¥æ”¯æŒåŠ¨æ€ç±»é‡æ–°åŠ è½½(æ­¤æ—¶ä¹Ÿæ²¡å¿…è¦è‡ªåŠ¨é‡å¯äº†ï¼ŒJRebelç‰›ğŸ®å¤šäº†)</p>
<p>å¦‚ä½•å…³é—­?</p>
<pre><code class="language-java">//spring-boot-devtoolsä¾èµ– application contextâ€™s shutdown hook 
// ä¼šä½¿å¾—è‡ªåŠ¨é‡å¯å¤±æ•ˆ ,å¦‚æœä¸æŒ‡å®šé»˜è®¤æ˜¯å¼€å¯çš„ 
SpringApplication.setRegisterShutdownHook(false) 
</code></pre>
<p>å½“ç„¶ï¼Œè§¦å‘é‡å¯ä¼šå¿½ç•¥è¿™äº›åç§°çš„projectï¼šspring-boot, spring-boot-devtools, spring-boot-autoconfigure, spring-boot-actuator, and spring-boot-starter.</p>
<h3><a class="header" href="#é‡å¯æ—¶çš„æ—¥å¿—è®°å½•logging-changes-in-condition-evaluation" id="é‡å¯æ—¶çš„æ—¥å¿—è®°å½•logging-changes-in-condition-evaluation">é‡å¯æ—¶çš„æ—¥å¿—è®°å½•ï¼ˆLogging changes in condition evaluationï¼‰</a></h3>
<p>é»˜è®¤ä¸‹ï¼Œ æ¯æ¬¡restartï¼Œ æ—¥å¿—éƒ½ä¼šè®°å½•é€ æˆé‡å¯çš„é…ç½®ä¿®æ”¹ï¼Œ å¦‚æœæƒ³disableï¼Œ <code>spring.devtools.restart.log-condition-evaluation-delta=false</code></p>
<h3><a class="header" href="#æ’é™¤å—ç›‘æ§èµ„æºexcluding-resources" id="æ’é™¤å—ç›‘æ§èµ„æºexcluding-resources">æ’é™¤å—ç›‘æ§èµ„æº(Excluding resources)</a></h3>
<p>é»˜è®¤æƒ…å†µä¸‹, <code>/META-INF/maven, /META-INF/resources, /resources, /static, /public or /templates </code>ä¸­çš„æ–‡ä»¶æ”¹å˜ä¸ä¼šè§¦å‘restart, ä½†ä¼šè§¦å‘ live reload. å¦‚æœå¸Œæœ›è‡ªå®šä¹‰æ’é™¤ç›‘æ§çš„æ–‡ä»¶, <code>spring.devtools.restart.exclude</code></p>
<p>å¦‚æ’é™¤/staticåŒ…ï¼Œ/publicåŒ…ä¸‹æ–‡ä»¶ï¼š  <code>spring.devtools.restart.exclude=static/**,public/**</code></p>
<p>å¦‚æœå¸Œæœ›ä¿æŒé»˜è®¤, åœ¨é»˜è®¤çš„åŸºç¡€ä¸Šæ·»åŠ æ’é™¤ç›‘æ§çš„æ–‡ä»¶, <code>spring.devtools.restart.additional-exclude</code></p>
<h3><a class="header" href="#æ·»åŠ é¢å¤–ç›‘æ§è·¯å¾„watching-additional-paths-" id="æ·»åŠ é¢å¤–ç›‘æ§è·¯å¾„watching-additional-paths-">æ·»åŠ é¢å¤–ç›‘æ§è·¯å¾„(Watching additional paths )</a></h3>
<p>å¦‚æœéœ€è¦æ·»åŠ é¢å¤–çš„ç›‘æ§æ–‡ä»¶, å¦‚å°†éclasspathä¸‹æ–‡ä»¶çº³å…¥ç›‘æ§  <code>spring.devtools.restart.additional-paths </code></p>
<h3><a class="header" href="#é‡å¯å¤±æ•ˆdisabling-restart" id="é‡å¯å¤±æ•ˆdisabling-restart">é‡å¯å¤±æ•ˆï¼ˆDisabling restartï¼‰</a></h3>
<p>å¦‚ä½•ä½¿é‡å¯å¤±æ•ˆï¼Ÿ</p>
<pre><code class="language-java">// ç®€å•çš„æ–¹æ³•æ˜¯ï¼šé…ç½®æ–‡ä»¶ä¸­è®¾ç½®
spring.devtools.restart.enabled=false  

// å½“ç„¶è¿˜æœ‰æ›´â€œå…¨å±€â€çš„æ–¹æ³•ï¼š  
public static void main(String[] args) {
    System.setProperty(&quot;spring.devtools.restart.enabled&quot;, &quot;false&quot;);
    SpringApplication.run(MyApp.class, args);

    // å¦ä¸€ç§æ–¹æ³•å…³é—­
    SpringApplication.setRegisterShutdownHook(false) ;
}
</code></pre>
<h3><a class="header" href="#è®¾ç½®ä¸€ä¸ªtrigger-file" id="è®¾ç½®ä¸€ä¸ªtrigger-file">è®¾ç½®ä¸€ä¸ªtrigger file</a></h3>
<p>å¦‚æœä½ çš„IDEä¼šéšæ”¹éšç¼–è¯‘ï¼Œä½ å¯èƒ½ä¼šå€¾å‘äºåªåœ¨ç‰¹å®šæ—¶åˆ»å¼•å‘é‡å¯ï¼ˆå¦åˆ™ä¼šå¾ˆçƒ¦äººï¼Œè€Œä¸”æ€§èƒ½ä¸‹é™ï¼‰ã€‚è¿™æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨â€œtrigger fileâ€ï¼Œå°±æ˜¯ä¸€ä¸ªç‰¹å®šçš„æ–‡ä»¶ï¼Œåªæœ‰ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶æ—¶æ‰ä¼šè§¦å‘é‡å¯ã€‚ä½¿ç”¨ <code>spring.devtools.restart.trigger-file</code> å±æ€§å³å¯ã€‚</p>
<p>æ¯”å¦‚: spring.devtools.restart.trigger-file=.reloadtregger</p>
<p>å…¨å±€è®¾ç½® ç”¨æˆ·æ–‡ä»¶å¤¹ä¸‹çš„<code>.spring-boot-devtools.properties  </code>  åœ¨ $HOME folder ï¼Œè§ <a href="#%E5%85%A8%E5%B1%80%E8%AE%BE%E7%BD%AEglobal-settings-">å…¨å±€trigger-file</a></p>
<h3><a class="header" href="#è‡ªå®šä¹‰restart-classloader" id="è‡ªå®šä¹‰restart-classloader">è‡ªå®šä¹‰restart classloader</a></h3>
<p>å½“ä¸€ä¸ªé¡¹ç›®æœ‰å¤šä¸ªmoduleï¼Œè€Œå¹¶ä¸æ˜¯æ¯ä¸ªmoduleéƒ½å¯¼å…¥ideæ—¶ï¼ŒDevTools éœ€è¦è‡ªå®šä¹‰â€œrestart classloaderâ€ ï¼Œå®šä¹‰å“ªä¸ªmodelæ˜¯é‡å¯ç›‘æ§å¯¹è±¡</p>
<blockquote>
<p>restart vs. reloadï¼š
â€œè‡ªåŠ¨é‡å¯â€ç”±ä¸¤ä¸ªclassloaderå®ç°ï¼Œä¸å˜çš„jarï¼ˆå¦‚å¼•å…¥çš„ç¬¬ä¸‰æ–¹jarï¼‰ä¼šè¢«â€œbaseâ€ classloaerè½½å…¥ï¼Œideä¸­æ‰“å¼€çš„é¡¹ç›®è‡ªèº«ä¼šè¢«â€œrestartâ€ classloaderè½½å…¥, è§¦å‘é‡å¯æ—¶, åªæœ‰â€œrestartâ€ classloaderä¼šè¢«é”€æ¯é‡å»º, æ‰€ä»¥restarté€Ÿåº¦æ›´å¿«.æ›¿ä»£æŠ€æœ¯JRebelã€‚</p>
</blockquote>
<p>é€šè¿‡åˆ›å»º<code>META-INF/spring-devtools.properties</code>å®ç°ï¼ˆclasspathä¸‹æ‰€æœ‰çš„META-INF/spring-devtools.propertieså‡ä¼šè¢«è½½å…¥,å³ä½¿æ˜¯jaråŒ…ä¸­çš„ï¼‰</p>
<p><code>spring-devtools.properties</code>ä»‹ç»
propertiesæ–‡ä»¶ä¸­propertieså€¼ä¸ºæ­£åˆ™è¡¨è¾¾å¼, ä¼šåŒ¹é…æ•´ä¸ªclasspath, å…¶ä¸­åŒ…å«ä¸¤ç±»properties, ä¸€ç±»ä»¥<code>restart.exclude.</code>ä½œä¸ºå‰ç¼€, è¡¨ç¤ºä¼šè¢«æ”¾è¿›â€œbaseâ€ classloaderä¸­çš„jar, ä¸€ç±»ä»¥<code>restart.include.</code>å¼€å¤´, è¡¨ç¤ºä¼šè¢«æ”¾è¿›â€œrestartâ€ classloaderä¸­çš„jar</p>
<p>åç¼€ä»»æ„å³å¯</p>
<p>eg:</p>
<pre><code class="language-js">restart.exclude.companycommonlibs=/mycorp-common-[\\w-]+\.jar
restart.include.projectcommon=/mycorp-myproj-[\\w-]+\.jar
</code></pre>
<h3><a class="header" href="#devtoolsçš„å±€é™" id="devtoolsçš„å±€é™">devtoolsçš„å±€é™</a></h3>
<p>å¦‚æœé¡¹ç›®ä¸­çš„å¯¹è±¡æ˜¯é€šè¿‡<code>ObjectInputStream</code>è¿›è¡Œååºåˆ—åŒ–å¾—æ¥çš„, ç›‘æ§é‡å¯ç‰¹æ€§å°±ä¸å¥½ä½¿äº†(æ­¤æ—¶åº”è¯¥ä½¿ç”¨Springâ€™s <code>ConfigurableObjectInputStream</code> in combination with <code>Thread.currentThread().getContextClassLoader()</code>.)</p>
<h2><a class="header" href="#æµè§ˆå™¨è‡ªåŠ¨åˆ·æ–°livereload" id="æµè§ˆå™¨è‡ªåŠ¨åˆ·æ–°livereload">æµè§ˆå™¨è‡ªåŠ¨åˆ·æ–°(LiveReload)</a></h2>
<p><code>spring-boot-devtools</code>æ¨¡å—å†…ç½®äº†ä¸€ä¸ªLiveReload serverï¼Œèµ„æºæ”¹åŠ¨ä¼šè§¦å‘æµè§ˆå™¨è‡ªåŠ¨åˆ·æ–°ï¼Œéœ€è¦æ‹“å±•é…åˆï¼šhttp://livereload.com/extensions/</p>
<p>å¦‚æœæƒ³å…³é—­ï¼šset the <code>spring.devtools.livereload.enabled</code> property to <code>false</code>.</p>
<p>æ³¨æ„: LiveReload serverä¸€æ¬¡åªå¯èƒ½å¯åŠ¨ä¸€ä¸ª, å¦‚æœåŒæ—¶å¯åŠ¨å¤šä¸ªå¸¦DevTools çš„app, åªæœ‰ç¬¬ä¸€ä¸ªå¯åŠ¨çš„appæœ‰ livereloadåŠŸèƒ½.</p>
<h2><a class="header" href="#å…¨å±€è®¾ç½®global-settings-" id="å…¨å±€è®¾ç½®global-settings-">å…¨å±€è®¾ç½®(Global settings )</a></h2>
<p>$HOME æ–‡ä»¶å¤¹ä¸‹æ·»åŠ ä¸€ä¸ªæ–‡ä»¶<code>.spring-boot-devtools.properties</code>ï¼Œè¯¥æ–‡ä»¶ä¸­çš„å†…å®¹ä¼šè¢«ä½œç”¨äºæ‰€æœ‰çš„Spring Booté¡¹ç›®ã€‚ä¾‹å¦‚è®¾ç½® è§¦å‘æ–‡ä»¶ï¼šåœ¨ <code>~/.spring-boot-devtools.properties</code> é‡Œé¢è®¾ç½® <code>spring.devtools.reload.trigger-file=.reloadtrigger</code></p>
<h2><a class="header" href="#è¿œç¨‹è°ƒè¯•appremote-applications" id="è¿œç¨‹è°ƒè¯•appremote-applications">è¿œç¨‹è°ƒè¯•app(Remote applications)</a></h2>
<p>(è¿™ä¸ªç‰¹æ€§å…·æœ‰å®‰å…¨é£é™©, ç”Ÿäº§ç¯å¢ƒéœ€è¦ç¦ç”¨è¯¥ç‰¹æ€§)</p>
<p>Spring Boot developer toolsä¸æ­¢å¯ä»¥åœ¨local appä½¿ç”¨, ä¹Ÿèƒ½åœ¨ remote appä½¿ç”¨, è¿œç¨‹ç‰¹æ€§æ˜¯å¯é€‰æ‹©çš„, ä¸ºäº†æ‰“å¼€è¿™ä¸ªç‰¹æ€§, éœ€è¦ç¡®å®šremote appåŒ…å«å¦‚ä¸‹é…ç½®:</p>
<pre><code class="language-xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;configuration&gt;
                &lt;excludeDevtools&gt;false&lt;/excludeDevtools&gt;
            &lt;/configuration&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;
</code></pre>
<p>æ­¤å¤–, è¿˜éœ€è®¾ç½®ä¸€ä¸ª <code>spring.devtools.remote.secret</code> propertiesä½œä¸ºå£ä»¤, æ¯”å¦‚spring.devtools.remote.secret=mysecret</p>
<p>remote devtoolsæ”¯æŒåœ¨ä¸¤æ–¹é¢ä½“ç°ï¼šä¸€æ–¹é¢serverç«¯æœ‰endpointæ¥å—connectionï¼Œå¦ä¸€æ–¹é¢client app è¿è¡Œåœ¨IDE; å½“è®¾ç½®<code>spring.devtools.remote.secret</code> ä¹‹åï¼Œserverç«¯ä¼šè‡ªåŠ¨å¯ç”¨ï¼Œclientç«¯éœ€æ‰‹åŠ¨å¯åŠ¨ï¼›</p>
<h3><a class="header" href="#å¯åŠ¨æœ¬åœ°çš„å®¢æˆ·ç«¯" id="å¯åŠ¨æœ¬åœ°çš„å®¢æˆ·ç«¯">å¯åŠ¨æœ¬åœ°çš„å®¢æˆ·ç«¯</a></h3>
<p>è¿è¡Œ<code>org.springframework.boot.devtools.RemoteSpringApplication </code></p>
<p><img src="Snipaste_2018-06-13_11-03-52.png" alt="alt" /><img src="Snipaste_2018-06-13_11-10-17.png" alt="alt" /></p>
<p>å¯åŠ¨æˆåŠŸå, ç±»ä¼¼è¿™æ ·:</p>
<pre><code>  .   ____          _                                              __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _          ___               _      \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` |        | _ \___ _ __  ___| |_ ___ \ \ \ \
 \\/  ___)| |_)| | | | | || (_| []::::::[]   / -_) '  \/ _ \  _/ -_) ) ) ) )
  '  |____| .__|_| |_|_| |_\__, |        |_|_\___|_|_|_\___/\__\___|/ / / /
 =========|_|==============|___/===================================/_/_/_/
 :: Spring Boot Remote :: 2.0.2.RELEASE

2015-06-10 18:25:06.632  INFO 14938 --- [           main] o.s.b.devtools.RemoteSpringApplication   : Starting RemoteSpringApplication on pwmbp with PID 14938 (/Users/pwebb/projects/spring-boot/code/spring-boot-devtools/target/classes started by pwebb in /Users/pwebb/projects/spring-boot/code/spring-boot-samples/spring-boot-sample-devtools)
2015-06-10 18:25:06.671  INFO 14938 --- [           main] s.c.a.AnnotationConfigApplicationContext : Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@2a17b7b6: startup date [Wed Jun 10 18:25:06 PDT 2015]; root of context hierarchy
2015-06-10 18:25:07.043  WARN 14938 --- [           main] o.s.b.d.r.c.RemoteClientConfiguration    : The connection to http://localhost:8080 is insecure. You should use a URL starting with 'https://'.
2015-06-10 18:25:07.074  INFO 14938 --- [           main] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2015-06-10 18:25:07.130  INFO 14938 --- [           main] o.s.b.devtools.RemoteSpringApplication   : Started RemoteSpringApplication in 0.74 seconds (JVM running for 1.105)
</code></pre>
<p>è¿œç¨‹æ–¹å¼ä¸‹ï¼Œå®¢æˆ·ç«¯çš„ä»»ä½•æ›´æ–°éƒ½ä¼šè¢«pushåˆ°æœåŠ¡å™¨ç«¯ï¼Œå¹¶æŒ‰è®¾ç½®è§¦å‘restartã€‚æ¯”è¾ƒå¿«</p>
<p>ä½¿ç”¨ä»£ç†çš„è¯, è®¾ç½®spring.devtools.remote.proxy.host å’Œ spring.devtools.remote.proxy.port properties.</p>
<h3><a class="header" href="#è¿œç¨‹è°ƒè¯•" id="è¿œç¨‹è°ƒè¯•">è¿œç¨‹è°ƒè¯•</a></h3>
<p>devtoolsæ”¯æŒHttpåè®®çš„è¿œç¨‹è°ƒè¯•é€šé“ã€‚è¿œç¨‹å®¢æˆ·ç«¯æä¾›äº†ä¸€ä¸ªæœ¬åœ°æœåŠ¡å™¨ï¼ˆé»˜è®¤8000ç«¯å£ï¼Œå¯ä¿®æ”¹ï¼‰ï¼Œç”¨äºç»‘å®šè¿œç¨‹è°ƒè¯•å™¨ã€‚å½“ä¸€ä¸ªè¿æ¥è¢«åˆ›å»ºæ—¶ï¼Œdebugä¿¡æ¯å°±ä¼šé€šè¿‡HTTPå‘é€åˆ°è¿œç¨‹åº”ç”¨ã€‚
ä¿®æ”¹é»˜è®¤ç«¯å£ï¼š spring.devtools.remote.debug.local-port ã€‚ä½†æ˜¯ï¼Œé¦–å…ˆï¼Œä½ éœ€è¦ç¡®è®¤è¿œç¨‹åº”ç”¨ä»¥è¿œç¨‹è°ƒè¯•æ–¹å¼å¯åŠ¨ã€‚é€šå¸¸ï¼Œé…ç½®JAVA_OPTSå³å¯è¾¾åˆ°ç›®çš„ã€‚ä¾‹å¦‚ï¼Œåœ¨Cloud Foundryä¸Šï¼Œä½ å¯ä»¥åœ¨ manifest.yml ä¸­æ·»åŠ å¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<pre><code>---
  env:
    JAVA_OPTS: &quot;-Xdebug -Xrunjdwp:server=y,transport=dt_socket,suspend=n&quot;
</code></pre>
<p>è¿‡ç½‘ç»œè¿›è¡Œè¿œç¨‹è°ƒè¯•ï¼Œå¯èƒ½å¾ˆæ…¢ï¼Œæ‰€ä»¥ä½ éœ€è¦å¢åŠ è¶…æ—¶æ—¶é—´ã€‚Eclipseä¸­ï¼šJava -&gt; Debug -&gt; Debugger timeout (ms)ï¼Œè®¾æˆ60000å¾ˆä¸é”™ã€‚</p>
<h1><a class="header" href="#æ‰“åŒ…åˆ°ç”Ÿäº§ç¯å¢ƒ" id="æ‰“åŒ…åˆ°ç”Ÿäº§ç¯å¢ƒ">æ‰“åŒ…åˆ°ç”Ÿäº§ç¯å¢ƒ</a></h1>
<p>æ‰“æˆå¯æ‰§è¡ŒåŒ…å³å¯, æ›´å¤šé€‚ç”¨äºç”Ÿäº§ç¯å¢ƒçš„ç‰¹æ€§æ¯”å¦‚ç›‘æ§ç­‰æ·»åŠ <code>spring-boot-actuator</code> starter</p>
<h1><a class="header" href="#springapplication" id="springapplication">SpringApplication</a></h1>
<p>å¯åŠ¨å¼•å¯¼ç¨‹åº</p>
<pre><code class="language-java">public static void main(String[] args) {
    // ä½¿ç”¨é»˜è®¤é…ç½®å¯åŠ¨
    SpringApplication.run(MySpringConfiguration.class, args);
}
</code></pre>
<h2><a class="header" href="#å¯åŠ¨å¤±è´¥startup-failure" id="å¯åŠ¨å¤±è´¥startup-failure">å¯åŠ¨å¤±è´¥(Startup failure)</a></h2>
<p>å¦‚æœå¯åŠ¨å¤±è´¥, æ³¨å†Œçš„<code>FailureAnalyzers</code>ä¼šæä¾›ç›¸åº”çš„å¤±è´¥ä¿¡æ¯, åŒæ—¶å°è¯•è§£å†³</p>
<p>springbootä¸­æœ‰å¾ˆå¤šFailureAnalyzer çš„å®ç°, ä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰ä¸€ä¸ªå®ç°;</p>
<p>debugæ¨¡å¼ä¸‹ä¼šæ˜¾ç¤ºæ›´å¤šé”™è¯¯ä¿¡æ¯ <code>java -jar myproject-0.0.1-SNAPSHOT.jar --debug</code></p>
<h2><a class="header" href="#å®šåˆ¶banner" id="å®šåˆ¶banner">å®šåˆ¶banner</a></h2>
<h3><a class="header" href="#ç›´æ¥é€šè¿‡è®¾ç½®file" id="ç›´æ¥é€šè¿‡è®¾ç½®file">ç›´æ¥é€šè¿‡è®¾ç½®file</a></h3>
<p>classpathä¸­åŠ å…¥banner.txt ï¼Œor è®¾ç½® <code>spring.banner.location</code>å±æ€§, <code>spring.banner.charset</code>è®¾ç½®bannerç¼–ç (é»˜è®¤utf-8), æ”¯æŒbanner.gif, banner.jpg, or banner.pngæ ¼å¼(æˆ–è€…spring.banner.image.locationè®¾ç½®åŠ¨å›¾), </p>
<p><a href="https://docs.spring.io/spring-boot/docs/2.0.2.RELEASE/reference/htmlsingle/#boot-features-banner">bannerä¸­å¯ä»¥ä½¿ç”¨ä¸€äº›é¢„å®šä¹‰çš„å˜é‡</a></p>
<h3><a class="header" href="#é€šè¿‡ç¼–ç¨‹æ–¹å¼" id="é€šè¿‡ç¼–ç¨‹æ–¹å¼">é€šè¿‡ç¼–ç¨‹æ–¹å¼</a></h3>
<pre><code class="language-java">// å®ç°org.springframework.boot.Banner æ¥å£ and implement your own printBanner() method
SpringApplication.setBanner(...)
</code></pre>
<h3><a class="header" href="#æ§åˆ¶banneræ‰“å°åˆ°çš„åœ°æ–¹" id="æ§åˆ¶banneræ‰“å°åˆ°çš„åœ°æ–¹">æ§åˆ¶banneræ‰“å°åˆ°çš„åœ°æ–¹</a></h3>
<p>è®¾ç½®<code>spring.main.banner-mode</code>å±æ€§(console|log|off)</p>
<p>å¦‚æœæ˜¯ymlæ–‡ä»¶, åŠ å¼•å·</p>
<pre><code class="language-yml">spring:
	main:
		banner-mode: &quot;off&quot;
</code></pre>
<h2><a class="header" href="#å®šåˆ¶springapplication" id="å®šåˆ¶springapplication">å®šåˆ¶SpringApplication</a></h2>
<pre><code class="language-java">public static void main(String[] args) {
    // è¿™ç§å¯åŠ¨æ–¹å¼å¯ä»¥è‡ªå®šä¹‰ä¸€äº›ç‰¹æ€§
    SpringApplication app = new SpringApplication(MySpringConfiguration.class);//MySpringConfigurationé…ç½®ç±»ï¼Œè¢«@Configurationæ ‡æ³¨ï¼Œä¹Ÿå¯ä»¥æ˜¯xmlæ–‡ä»¶ï¼Œæˆ–è€…ä¸€ä¸ªåŒ…è·¯å¾„(å…¨åŒ…æ‰«æ)ï¼›ä¹Ÿå¯ä»¥é€šè¿‡application.propertiesé…ç½®
    app.setBannerMode(Banner.Mode.OFF);//bannerä¸è¾“å‡ºåˆ°console
    app.run(args);
}

// appè¿˜å¯ä»¥åšå“ªäº›è®¾ç½®, è§https://docs.spring.io/spring-boot/docs/1.5.9.RELEASE/api/org/springframework/boot/SpringApplication.html

//è¿™ç§æ–¹å¼ä¹Ÿè¡Œï¼Œå…è®¸å±‚çº§ç»“æ„
// é™åˆ¶: Web components must be contained within the child context, and the same Environment will be used for both parent and child contexts. 
// å±‚çº§ç»“æ„å­˜ç–‘(https://docs.spring.io/spring-boot/docs/2.0.2.RELEASE/reference/htmlsingle/#boot-features-fluent-builder-api)
new SpringApplicationBuilder()
        .sources(Parent.class)
        .child(Application.class)
        .bannerMode(Banner.Mode.OFF)
        .run(args);

</code></pre>
<h2><a class="header" href="#åº”ç”¨çš„äº‹ä»¶å’Œç›‘å¬å™¨" id="åº”ç”¨çš„äº‹ä»¶å’Œç›‘å¬å™¨">åº”ç”¨çš„äº‹ä»¶å’Œç›‘å¬å™¨</a></h2>
<p>é™¤äº†ä¼ ç»Ÿçš„Spring Framework events, å¦‚: ContextRefreshedEvent, springboot appæä¾›ä¸€äº›é¢å¤–çš„event</p>
<p>æœ‰äº›eventåœ¨ApplicationContext åˆ›å»ºä¹‹å‰å°±è¢«è§¦å‘, å› æ­¤ä¸èƒ½ä½œä¸º@Beanæ³¨å†Œlistener, æ­¤æ—¶æœ‰å¦‚ä¸‹æ–¹æ³•:
ä¸€ç§æ–¹æ³•æ˜¯ï¼š<code>SpringApplication.addListeners(â€¦â€‹)</code> or <code>SpringApplicationBuilder.listeners(â€¦â€‹)</code> methods.</p>
<p>å¦ä¸€ç§ï¼š<code> META-INF/spring.factories</code>æ–‡ä»¶ä¸­æ·»åŠ ä¸€è¡Œ:  <code>org.springframework.context.ApplicationListener=com.example.project.MyListener  </code>è¿™ç§æ–¹æ³•ä¼šå¿½ç•¥appæ˜¯ä»¥ä½•ç§æ–¹å¼åˆ›å»ºçš„;</p>
<p>å…±æœ‰å¦‚ä¸‹å‡ ç§application eventsï¼šåŒæ—¶ä¹Ÿæ˜¯ä»–ä»¬çš„è§¦å‘é¡ºåº</p>
<ol>
<li><code>ApplicationStartingEvent</code> :åœ¨æ³¨å†Œlistenerså’Œinitializersä¹‹å, æ­¤æ—¶è¿˜æœªè¿›è¡Œä»»ä½•processing, </li>
<li><code>ApplicationEnvironmentPreparedEvent</code> : Environment å‡†å¤‡å¥½ä¹‹å, contextåˆ›å»ºä¹‹å‰, </li>
<li><code>ApplicationPreparedEvent</code> : beanè¢«è½½å…¥ä¹‹å, contexté‡å»ºä¹‹å‰, æ ‡å¿—appæ­£åœ¨å‡†å¤‡ä¸­</li>
<li><code>ApplicationStartedEvent </code>: context é‡å»ºä¹‹å,  application and command-line runnersè°ƒç”¨ä¹‹å‰</li>
<li><code>ApplicationReadyEvent</code> : application and command-line runners è°ƒç”¨ä¹‹å, æ ‡å¿—ç€appå·²ç»å‡†å¤‡å¥½æä¾›æœåŠ¡</li>
<li><code>ApplicationFailedEvent</code> : å¯åŠ¨æ—¶ç¢°åˆ°exceptionè§¦å‘</li>
</ol>
<p>Application events æ˜¯é€šè¿‡spring frameworkçš„äº‹ä»¶æœºåˆ¶è§¦å‘çš„, è¿™å°±ä¿è¯äº†åœ¨å…·æœ‰å±‚çº§ç»“æ„çš„springContextä¸­, child contextä¸­è§¦å‘çš„äº‹ä»¶ä¼šä¼ é€’åˆ° ancestors context, æ‰€ä»¥ä¸€ä¸ªlistenerå¯èƒ½ä¼šæ¥æ”¶åˆ°å¤šä¸ªäº‹ä»¶å®ä¾‹</p>
<p>ä¸€ä¸ªlistenerä¸ºäº†åŒºåˆ†å®ƒè‡ªå·±çš„contextä¸­çš„äº‹ä»¶å’Œå±‚çº§ç»“æ„ä¸­çš„äº‹ä»¶, éœ€è¦è¯¥listenerçš„application contextè¢«æ³¨å…¥, ç„¶åæ¯”è¾ƒlistenerçš„contextå’Œeventçš„context, å¦‚ä½•æ³¨å…¥listenerçš„ app context? The context can be injected by implementing <code>ApplicationContextAware</code> or, if the listener is a bean, using <code>@Autowired</code>.</p>
<h2><a class="header" href="#æ³¨å…¥applicationcontext" id="æ³¨å…¥applicationcontext">æ³¨å…¥ApplicationContext</a></h2>
<p>The context can be injected by implementing <code>ApplicationContextAware</code> or, if the listener is a bean, by using <code>@Autowired</code>.</p>
<p>å¯ä»¥æ–¹ä¾¿çš„æ¯”è¾ƒeventæ‰€å¤„çš„contextå’Œappçš„context</p>
<h2><a class="header" href="#è‡ªåŠ¨è®¾ç½®webç¯å¢ƒ" id="è‡ªåŠ¨è®¾ç½®webç¯å¢ƒ">è‡ªåŠ¨è®¾ç½®webç¯å¢ƒ</a></h2>
<ul>
<li>
<p>SpringApplication ä¼šè¯•å›¾åˆ›å»ºæ­£ç¡®çš„ ApplicationContextã€‚é»˜è®¤çš„ï¼Œä½¿ç”¨ AnnotationConfigApplicationContext æˆ–è€… AnnotationConfigEmbeddedWebApplicationContext ï¼Œè¿™å–å†³äºæ˜¯å¦webåº”ç”¨ã€‚</p>
</li>
<li>
<p>å¯ä»¥ä½¿ç”¨è¦†ç›– setWebEnvironment(boolean webEnvironment) é»˜è®¤è®¾ç½®ã€‚</p>
</li>
<li>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨ setApplicationContextClass(â€¦) æ¥æ§åˆ¶ ApplicationContext çš„ç±»å‹ã€‚</p>
</li>
<li>
<p>æ³¨æ„ï¼šå½“åœ¨JUnitç¯å¢ƒä¸‹ä½¿ç”¨SpringApplicationæ—¶ï¼Œé€šå¸¸éœ€è¦è®¾ç½® setWebEnvironment(false) æˆ–è€…setWebApplicationType(WebApplicationType.NONE) when using SpringApplication within a JUnit testã€‚</p>
</li>
</ul>
<h2><a class="header" href="#application-exit" id="application-exit">Application exit</a></h2>
<p>spring boot appä¼šæ³¨å†Œä¸€ä¸ª a shutdown hook åˆ° the JVMä¸­ ä»¥ä¿è¯ ApplicationContext é¡ºåˆ©å…³é—­. æ‰€æœ‰çš„Springç”Ÿå‘½å‘¨æœŸä¸­çš„å›è°ƒï¼ˆå¦‚ DisposableBean æ¥å£ï¼Œæˆ–è€… @PreDestroy æ³¨è§£ï¼‰éƒ½å¯ä»¥ä½¿ç”¨ã€‚</p>
<p>å¦å¤–ï¼Œå¦‚æœæƒ³åœ¨åº”ç”¨é€€å‡ºæ—¶è¿”å›ç‰¹å®šçš„exit codeï¼Œé‚£beanså¯ä»¥å®ç° org.springframework.boot.ExitCodeGenerator æ¥å£ã€‚(åŒæ ·å¯ä»¥ä½¿ç”¨@Orderæ§åˆ¶é¡ºåºï¼Œåªä¸è¿‡ç›¸å)</p>
<pre><code class="language-java">@SpringBootApplication
public class ExitCodeApplication {

	@Bean
	public ExitCodeGenerator exitCodeGenerator() {
		/* return new ExitCodeGenerator() {
			@Override
			public int getExitCode() {
				return 42;
			}
		}; */
        // æ‹‰å§†è¾¾è¡¨è¾¾å¼æ›´ç®€å•
        return () -&gt; 42;
	}

	public static void main(String[] args) {
		System.exit(SpringApplication
				.exit(SpringApplication.run(ExitCodeApplication.class, args)));
	}

}
</code></pre>
<h2><a class="header" href="#è·å–adminå±æ€§admin-features" id="è·å–adminå±æ€§admin-features">è·å–adminå±æ€§(Admin features)</a></h2>
<p>It is possible to enable admin-related features for the application by specifying the <code>spring.application.admin.enabled</code> property</p>
<p>eg: If you want to know on which HTTP port the application is running, get the property with key <code>local.server.port</code></p>
<h1><a class="header" href="#å¼•å…¥é…ç½®æ–‡ä»¶externalized-configuration" id="å¼•å…¥é…ç½®æ–‡ä»¶externalized-configuration">å¼•å…¥é…ç½®æ–‡ä»¶(Externalized Configuration)</a></h1>
<p>properties files, YAML files, environment variables and command-line arguments to externalize configuration.</p>
<h2><a class="header" href="#æ€ä¹ˆå¼•å…¥å‘¢" id="æ€ä¹ˆå¼•å…¥å‘¢">æ€ä¹ˆå¼•å…¥å‘¢</a></h2>
<p>ä¸¤ç§æ–¹æ³•</p>
<p>å…¶ä¸­Property valueså¯ä»¥é€šè¿‡<code>@Value</code>ç›´æ¥æ³¨å…¥åˆ°bean; é€šè¿‡springçš„<code>Environment</code> è·å–; ä¸é€šç”¨(@Value çš„å·¥ä½œæ˜¯åœ¨SpringApplicationå¯åŠ¨å®Œæˆä¹‹åè¿›è¡Œçš„ï¼Œåœ¨æ­¤ä¹‹å‰å€¼ä¸ºnull)</p>
<p>é€šè¿‡<code>@ConfigurationProperties</code>ç»‘å®šåˆ°ç»“æ„åŒ–çš„objectä¸Š</p>
<pre><code class="language-java">@ConfigurationProperties(prefix = &quot;spring.datasource&quot;, ignoreUnknownFields = false)// åŠ ä¸ŠignoreUnknownFields = false, é‚£ä¹ˆé…ç½®æ–‡ä»¶ä¸­æœ‰å¤šä½™çš„é…ç½®é¡¹(beanä¸­æ²¡æœ‰çš„å±æ€§é¡¹)åˆ™å¯åŠ¨æŠ¥é”™
public class SomeconfigurationBean {
}

</code></pre>
<p>å…·ä½“ä½¿ç”¨è§ <a href="#%E6%B3%A8%E5%85%A5%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7-%E5%8D%A0%E4%BD%8D%E7%AC%A6">æ³¨å…¥è‡ªå®šä¹‰å±æ€§-å ä½ç¬¦</a></p>
<h2><a class="header" href="#é…ç½®æ–‡ä»¶çš„ä¼˜å…ˆçº§" id="é…ç½®æ–‡ä»¶çš„ä¼˜å…ˆçº§">é…ç½®æ–‡ä»¶çš„ä¼˜å…ˆçº§</a></h2>
<p>å„ç§Properties ä¼˜å…ˆçº§ï¼š(ç”±é«˜åˆ°ä½, ä¼˜å…ˆçº§é«˜ ğŸ‘‰ è¯»å–é¡ºåºä¸ºæœ€å)</p>
<ul>
<li>
<p>Devtoolsçš„å…¨å±€è®¾ç½®æ–‡ä»¶: <code>~/.spring-boot-devtools.properties</code>ï¼Œå½“ç„¶æ˜¯devtoolsæ¿€æ´»çš„çŠ¶æ€ä¸‹.</p>
</li>
<li>
<p><code>@TestPropertySource</code> annotations ï¼Œæµ‹è¯•æ—¶å€™ä½¿ç”¨</p>
</li>
<li>
<p><code>@SpringBootTestä¸­çš„#properties å±æ€§</code>ï¼Œä¹Ÿæ˜¯æµ‹è¯•æƒ…å†µä¸‹</p>
</li>
<li>
<p>å‘½ä»¤è¡Œè®¾ç½®çš„å‚æ•°</p>
<p>ç³»ç»Ÿé»˜è®¤ä¼šæŠŠå‘½ä»¤è¡Œoptionå‚æ•°è½¬æ¢åˆ°Environmentä¸­, å¦‚æœä¸å¸Œæœ›è½¬æ¢åˆ°Environment(å¯èƒ½æ˜¯æ­£å¼ç¯å¢ƒä¸­éœ€è¦ç¦ç”¨æ¥è‡ªå‘½ä»¤è¡Œçš„å‚æ•°), å¯ä»¥è¿™ä¹ˆç¦ç”¨<code>SpringApplication.setAddCommandLineProperties(false);</code></p>
</li>
<li>
<p><code>SPRING_APPLICATION_JSON</code> ä¸­çš„ properties</p>
<p>åœ¨å‘½ä»¤è¡Œä¸­çš„ç”¨æ³•ï¼šï¼ˆä½œä¸ºä¸€ä¸ª environment variableè®¾ç½®ï¼‰</p>
<pre><code class="language-sh">$ SPRING_APPLICATION_JSON='{&quot;foo&quot;:{&quot;bar&quot;:&quot;spam&quot;}}' java -jar myapp.jar
$ java -Dspring.application.json='{&quot;foo&quot;:&quot;bar&quot;}' -jar myapp.jar
$ java -jar myapp.jar --spring.application.json='{&quot;foo&quot;:&quot;bar&quot;}'
</code></pre>
<p>æœ€ç»ˆåœ¨springçš„environmentä¸­ foo.bar=spam;</p>
</li>
<li>
<p><code>ServletConfig</code>ä¸­çš„åˆå§‹åŒ–å‚æ•° init parameters</p>
</li>
<li>
<p><code>ServletContext</code>ä¸­çš„åˆå§‹åŒ–å‚æ•°</p>
</li>
<li>
<p>JNDI attributes from java:comp/env.(å­˜ç–‘)</p>
</li>
<li>
<p>Java System properties (System.getProperties()).</p>
</li>
<li>
<p>OSçš„ç¯å¢ƒå˜é‡</p>
</li>
<li>
<p>é€šè¿‡RandomValuePropertySource å¾—åˆ°çš„éšæœºå€¼</p>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­è¿™æ ·é…ç½®</p>
<pre><code class="language-js">my.secret=${random.value}
my.number=${random.int}
my.bignumber=${random.long}
my.uuid=${random.uuid}
/*${random.int*} è¯­æ³•: OPEN value (,max) CLOSE , OPEN,CLOSEæ˜¯ä»»æ„ç¬¦å·, value,maxæ˜¯intç±»å‹, maxå¯é€‰, å¦‚æœæä¾›, valueä¸ºæœ€å°å€¼,maxä¸ºæœ€å¤§å€¼ */
my.number.less.than.ten=${random.int(10)} 
my.number.in.range=${random.int[1024,65536]}
</code></pre>
</li>
<li>
<p>jaråŒ…<code>å¤–éƒ¨</code>çš„ <code>application-{profile}.properties and YAML variants</code></p>
</li>
<li>
<p>jaråŒ…<code>å†…éƒ¨</code>çš„ <code>application-{profile}.properties and YAML variants</code></p>
</li>
<li>
<p>jaråŒ…<code>å¤–éƒ¨</code>çš„ <code>application.properties and YAML variants</code></p>
</li>
<li>
<p>jaråŒ…<code>å†…éƒ¨</code>çš„ <code>application.properties and YAML variants</code></p>
</li>
<li>
<p>é…ç½®ç±»ä¸Šçš„<code>@PropertySource(&quot;classpath:/com/myco/app.properties&quot;)</code> (<code>@PropertySource</code> annotations on your <code>@Configuration</code> classes)</p>
</li>
<li>
<p>Default properties (specified using <code>SpringApplication.setDefaultProperties</code>).</p>
</li>
</ul>
<p>ä¸¾ä¸ªğŸŒ°:</p>
<p>å‡è®¾å¼€å‘ä¸€ä¸ªcomponent</p>
<pre><code class="language-java">@Component
public class MyBean {

    @Value(&quot;${name}&quot;)
    private String name;

    // ...

}
</code></pre>
<p>é‚£ä¹ˆclass pathä¸­éœ€è¦æœ‰application.propertiesåŒ…å«ä¸€è¡Œ&quot;name=xxx&quot;;</p>
<p>æ‰“åŒ…è¿™ä¸ªappæˆä¸ºjaråè¿è¡Œäºæ–°çš„ç¯å¢ƒ, æ­¤æ—¶å¯ä»¥åœ¨jaråŒ…å¤–éƒ¨æä¾›ä¸€ä¸ªæ–°çš„application.propertiesæ–‡ä»¶è¦†ç›–jarå†…éƒ¨çš„é‚£ä¸ªé…ç½®æ–‡ä»¶</p>
<p>å¦‚æœä»…ä»…æ˜¯ä¸€æ¬¡æ€§çš„æµ‹è¯•, å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°(For one-off testing, you can launch with a specific command line switch (for example,    <code>java -jar app.jar --name=&quot;Spring&quot;</code>).)</p>
<h2><a class="header" href="#ä¸åŒæ–‡ä»¶å¤¹ä¸­çš„applicationproperties" id="ä¸åŒæ–‡ä»¶å¤¹ä¸­çš„applicationproperties">ä¸åŒæ–‡ä»¶å¤¹ä¸­çš„application.properties</a></h2>
<p>springboot appä» application.propertiesè·å–properties, å¹¶å°†å…¶è®¾ç½®è¿›spring <code>Environment</code>;</p>
<p>åˆ†ä¸ºä¸¤ç§æ–‡ä»¶application-{profile}.properties æˆ–è€… application.properties</p>
<p>è¿™é‡Œå…ˆçœ‹application.properties ï¼ŒSpringApplicationé»˜è®¤ä»ä»¥ä¸‹é»˜è®¤åœ°å€é¡ºåºæœå¯»(æœåˆ°å³åœæ­¢)ï¼Œå¹¶æ·»åŠ åˆ°Spring Environment ä¸­ï¼š</p>
<ol>
<li>å½“å‰ç›®å½•çš„<code>./config</code>å­ç›®å½•ï¼ˆfile:./config/ï¼‰</li>
<li>å½“å‰ç›®å½•<code>./</code>ï¼ˆfile:./ï¼‰</li>
<li>classpathä¸‹çš„ <code>/config</code> packageï¼ˆclasspath:/config/ï¼‰</li>
<li>The classpath root<code>classpath:/</code>ï¼ˆclasspath:/ ï¼‰</li>
</ol>
<p>é…ç½®æ–‡ä»¶é»˜è®¤ä¸ºapplication.properties, å¦‚æœé…ç½®æ–‡ä»¶æœ‰å…¶ä»–çš„åå­—ï¼Œç”¨ <code>spring.config.name</code>  environment propertyæ¥æŒ‡å®š</p>
<p>å¦‚æœé…ç½®æ–‡ä»¶è¿˜æœ‰å…¶ä»–çš„ä½ç½®ï¼Œç”¨ <code>spring.config.location</code> æ¥æŒ‡å®šå¯ä»¥æ˜¯è·¯å¾„ï¼Œå¯ä»¥æ˜¯å…·ä½“æ–‡ä»¶ä½ç½®ï¼Œä»¥é€—å·åˆ†å¼€ï¼Œè·¯å¾„éƒ½ä»¥'/'ç»“å°¾<br />
å‘½ä»¤è¡Œå¯åŠ¨çš„è¯ï¼Œlike this:</p>
<pre><code class="language-sh"># å¯ä»¥ä½¿ç”¨SPRING_CONFIG_NAME ä»£æ›¿ spring.config.name ã€‚
$ java -jar myproject.jar --spring.config.name=myproject
# or
$ java -jar myproject.jar --spring.config.location=classpath:/default.properties,classpath:/override.properties
</code></pre>
<p>é»˜è®¤æƒ…å†µä¸‹, spring appæŒ‰ç…§Config locationsçš„é…ç½®é€†åºæœå¯»æ–‡ä»¶(é»˜è®¤çš„åŠ è½½åœ°å€æ°¸è¿œæœ‰æ•ˆ), é»˜è®¤æä¾›é…ç½®æ˜¯
<code>spring.config.location=classpath:/,classpath:/config/,file:./,file:./config/</code>, é‚£ä¹ˆé»˜è®¤æœå¯»é¡ºåºå¦‚ä¸‹:</p>
<ol>
<li>file:./config/</li>
<li>file:./</li>
<li>classpath:/config/</li>
<li>classpath:/</li>
</ol>
<p>å¦‚æœè‡ªå®šä¹‰äº†<code>spring.config.location</code>ï¼ŒåŸæ¥çš„é»˜è®¤ä½ç½®ä¼šè¢«æ›¿æ¢  , å¦‚<code>spring.config.location=classpath:/custom-config/,file:./custom-config/</code>, æœå¯»é¡ºåºå˜ä¸º:</p>
<ol>
<li>file:./custom-config/</li>
<li>classpath:custom-config/</li>
</ol>
<p>å¦‚æœä½¿ç”¨<code>spring.config.additional-location</code>åˆ¶å®šä½ç½®, è‡ªå®šä¹‰è·¯å¾„ä¼šè¢«åŠ åˆ°é»˜è®¤è·¯å¾„ä¹‹å‰. æ¯”å¦‚: å¦‚æœ<code>spring.config.additional-location=classpath:/custom-config/,file:./custom-config/</code>ï¼Œé‚£ä¹ˆé¡ºåºå¦‚ä¸‹ï¼š</p>
<ol>
<li>file:./custom-config/</li>
<li>classpath:custom-config/</li>
<li>file:./config/</li>
<li>file:./</li>
<li>classpath:/config/</li>
<li>classpath:/</li>
</ol>
<p>ä¸åŒçš„ä¼˜å…ˆçº§ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿç»™å±æ€§ä¸€ä¸ªé»˜è®¤å€¼ï¼ˆå¦‚ï¼šapplication.propertiesä¸­è®¾ç½®ï¼‰ï¼Œç„¶åé€šè¿‡<code>spring.config.location</code>æŒ‡å®šæ–°çš„æ–‡ä»¶ä»£æ›¿é»˜è®¤æ–‡ä»¶ </p>
<h2><a class="header" href="#å¤šç¯å¢ƒé…ç½®profile-specific-properties" id="å¤šç¯å¢ƒé…ç½®profile-specific-properties">å¤šç¯å¢ƒé…ç½®(Profile-specific properties)</a></h2>
<p>åœ¨Spring Bootä¸­å¤šç¯å¢ƒé…ç½®æ–‡ä»¶åéœ€è¦æ»¡è¶³<code>application-{profile}.properties</code>çš„æ ¼å¼ï¼Œå…¶ä¸­{profile}å¯¹åº”ä½ çš„ç¯å¢ƒæ ‡è¯†</p>
<pre><code>application-dev.propertiesï¼šå¼€å‘ç¯å¢ƒ
application-test.propertiesï¼šæµ‹è¯•ç¯å¢ƒ
application-prod.propertiesï¼šç”Ÿäº§ç¯å¢ƒ
</code></pre>
<p>è‡³äºå“ªä¸ªå…·ä½“çš„é…ç½®æ–‡ä»¶ä¼šè¢«åŠ è½½ï¼Œéœ€è¦åœ¨application.propertiesæ–‡ä»¶ä¸­é€šè¿‡<code>spring.profiles.active</code>å±æ€§æ¥è®¾ç½®(å¦‚æœspring.profiles.activeå’ŒSpringApplication API ä¸­åŒæ—¶æŒ‡å®šäº†specific profile, ä»¥å‰è€…ä¸ºå‡†)ï¼Œå…¶å€¼å¯¹åº”{profile}å€¼ã€‚  å¦‚æœæ²¡æœ‰profileè¢«æ¿€æ´», <code>application-default.properties</code>ä¼šé»˜è®¤æ¿€æ´»</p>
<p>æ€»ç»“å¤šç¯å¢ƒé…ç½®æ€è·¯ï¼š</p>
<ul>
<li>
<p>application.propertiesä¸­é…ç½®é€šç”¨å†…å®¹ï¼Œå¹¶è®¾ç½®spring.profiles.active=devï¼Œä»¥å¼€å‘ç¯å¢ƒä¸ºé»˜è®¤é…ç½®</p>
</li>
<li>
<p>application-{profile}.propertiesä¸­é…ç½®å„ä¸ªç¯å¢ƒä¸åŒçš„å†…å®¹</p>
</li>
<li>
<p>é€šè¿‡å‘½ä»¤è¡Œæ–¹å¼å»æ¿€æ´»ä¸åŒç¯å¢ƒçš„é…ç½®</p>
</li>
</ul>
<p>è¿™é‡Œè®¨è®º <code>application-{profile}.properties</code>è¿™æ ·çš„é…ç½®æ–‡ä»¶.</p>
<p><code>Environment</code> æœ¬æ¥å°±æœ‰å¾ˆå¤šé»˜è®¤å±æ€§æ˜¯é€šè¿‡<code>application-default.properties</code>åŠ è½½è€Œæ¥.</p>
<p><code>application-{profile}.properties</code>çš„ä¼˜å…ˆçº§æ€»æ˜¯è¦é«˜äº<code>application.properties</code>çš„, ä¸ç®¡ <code>application-{profile}.properties</code>æ˜¯åœ¨jaråŒ…å¤–è¿˜æ˜¯åœ¨jarå†…éƒ¨</p>
<h2><a class="header" href="#æ³¨å…¥è‡ªå®šä¹‰å±æ€§-å ä½ç¬¦" id="æ³¨å…¥è‡ªå®šä¹‰å±æ€§-å ä½ç¬¦">æ³¨å…¥è‡ªå®šä¹‰å±æ€§-å ä½ç¬¦</a></h2>
<p>application.propertiesä¸­é»˜è®¤äº†å¾ˆå¤šé…ç½®ï¼Œå¦‚æœæ·»åŠ è‡ªå·±çš„å±æ€§æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>å®šä¹‰å¦‚ä¸‹å±æ€§ï¼š</p>
<pre><code class="language-sh">com.xy.blog.name=xy
com.xy.blog.title=reed

# å‚æ•°é—´å¼•ç”¨, æ³¨æ„åªèƒ½è°ƒç”¨å‰é¢å®šä¹‰è¿‡çš„å˜é‡
com.xy.blog.desc=${com.xy.blog.title}xxx

# éšæœºå€¼

my.secret=${random.value}
my.number=${random.int}
my.bignumber=${random.long}
my.uuid=${random.uuid}
my.number.less.than.ten=${random.int(10)}
my.number.in.range=${random.int[1024,65536]}
</code></pre>
<p>å¦‚æœè¿™äº›å±æ€§æ˜¯å®šä¹‰åœ¨application.propertiesä¸­ï¼Œé‚£ä¹ˆï¼š</p>
<p>ç›¸åº”Javabeanï¼š</p>
<pre><code class="language-java">@Data
@Component
public class Blog {

    @Value(&quot;${com.xy.blog.name}&quot;)
    private String name;
    
    @Value(&quot;${com.xy.blog.title}&quot;)
    private String title;
}

//æˆ–è€…ï¼ˆæ¨èè¿™ç§æ–¹å¼ï¼‰
@Component
@ConfigurationProperties(prefix=&quot;com.xy.blog&quot;)
public class ConnectionSettings {

    private String name;
    private String title;
}

</code></pre>
<p>æµ‹è¯•ï¼š</p>
<pre><code class="language-java">@RunWith(SpringRunner.class)
@SpringBootTest
public class Chapter1ApplicationTests {
    
    @Autowired
    private Blog blog;

	@Test
	public void testBlog() {
	    System.out.println(blog.getName());
	    System.out.println(blog.getTitle());
	}

}
</code></pre>
<p>è‹¥æœå®šä¹‰åœ¨æ–°çš„é…ç½®æ–‡ä»¶ä¸­ï¼šaaa.propertiesï¼Œé‚£ä¹ˆï¼š</p>
<pre><code class="language-java">@ConfigurationProperties(prefix = &quot;spring.test&quot;/*, ignoreUnknownFields = true*/)
@PropertySource(value = {&quot;classpath:apptest.properties&quot;}, encoding = &quot;utf-8&quot;, ignoreResourceNotFound = false)// classpathåé¢ä¸è¦åŠ ç©ºæ ¼
public class ConnectionSettings {

    private String name;
    private String title;
}
</code></pre>
<p>æœ€åæ³¨æ„ï¼šå¦‚æœå‘ç°@ConfigurationPropertiesä¸ç”Ÿæ•ˆï¼Œæœ‰å¯èƒ½æ˜¯é¡¹ç›®çš„ç›®å½•ç»“æ„é—®é¢˜ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨å…¥å£ç±»åŠ ä¸Š@EnableConfigurationProperties(ConnectionSettings.class)æ¥æ˜ç¡®æŒ‡å®šéœ€è¦ç”¨å“ªä¸ªå®ä½“ç±»æ¥è£…è½½é…ç½®ä¿¡æ¯ã€‚å¦‚ä¸‹:</p>
<pre><code class="language-java">@SpringBootApplication  
@EnableConfigurationProperties({aaa.class,bbb.class})  
public class DemoApplication {  
  
    public static void main(String[] args) {  
        SpringApplication.run(DemoApplication.class, args);  
    }  
} 
</code></pre>
<h2><a class="header" href="#ä½¿ç”¨yaml" id="ä½¿ç”¨yaml">ä½¿ç”¨YAML</a></h2>
<p>spring-boot-starterä¼šæä¾›yamlçš„ç›¸å…³æ”¯æŒ  , or æä¾› <a href="http://www.snakeyaml.org/">SnakeYAML</a> lib (<a href="https://www.jianshu.com/p/d8136c913e52">å…¥é—¨</a>) æ¥æ”¯æŒyamlé…ç½®æ–‡ä»¶</p>
<p>springbootæä¾›<code>YamlPropertiesFactoryBean</code> will load YAML as <code>Properties</code> and the <code>YamlMapFactoryBean</code> will load YAML as a <code>Map</code></p>
<h3><a class="header" href="#è½½å…¥yaml" id="è½½å…¥yaml">è½½å…¥yaml</a></h3>
<pre><code class="language-yml">environments:
    dev:
        url: http://dev.bar.com
        name: Developer Setup
    prod:
        url: http://foo.bar.com
        name: My Cool App
my:
   servers:
       - dev.bar.com
       - foo.bar.com
# ä¸ºäº†ä¿è¯listç±»å‹èƒ½å¤Ÿè¢«è¦†ç›–, å»ºè®®å®šä¹‰æˆå¦‚ä¸‹ç±»å‹
my:
   servers: dev.bar.com,foo.bar.com


</code></pre>
<p>ä¸Šé¢ä¼šè¢«è½¬ä¸ºå¦‚ä¸‹properties:</p>
<pre><code class="language-sh"># ä¼šè¢«è½¬æˆï¼š
environments.dev.url=http://dev.bar.com
environments.dev.name=Developer Setup
environments.prod.url=http://foo.bar.com
environments.prod.name=My Cool App
my.servers[0]=dev.bar.com
my.servers[1]=foo.bar.com
</code></pre>
<p>æ€ä¹ˆåœ¨appå†…éƒ¨ä½¿ç”¨? <code>@Value</code> or <code>@ConfigurationProperties()</code></p>
<h3><a class="header" href="#å°†ymlè½¬ä¸ºproperties" id="å°†ymlè½¬ä¸ºproperties">å°†ymlè½¬ä¸ºproperties</a></h3>
<p><code>YamlPropertySourceLoader </code>å¯ä»¥å°†å˜é‡ä»yamlå½¢å¼è½¬ä¸ºpropertieså½¢å¼æ³¨å…¥åˆ°<code>Environment</code>ä¸­, æ–¹ä¾¿ç›´æ¥é€šè¿‡<code>@Value</code>ä½¿ç”¨yaml(é»˜è®¤ä¸‹, @valueåªèƒ½ä½¿ç”¨properties)</p>
<h3><a class="header" href="#yamlçš„å¤šç¯å¢ƒé…ç½®" id="yamlçš„å¤šç¯å¢ƒé…ç½®">yamlçš„å¤šç¯å¢ƒé…ç½®</a></h3>
<p>å€ŸåŠ©<code>spring.profiles</code>key</p>
<pre><code class="language-yml"># å¦‚æœdevelopmentå’Œproductionæ–‡ä»¶éƒ½ä¸å¯ç”¨ï¼Œä¸º192.168.1.100
server:
    address: 192.168.1.100
---
# å¦‚æœdevelopmentæ–‡ä»¶è¢«æ¿€æ´»ï¼Œserver.address=127.0.0.1
spring:
    profiles: development
server:
    address: 127.0.0.1
---
# å¦‚æœproductionæ–‡ä»¶è¢«æ¿€æ´»ï¼Œserver.address=192.168.1.120
spring:
    profiles: production
server:
    address: 192.168.1.120
---
# å¦‚æœæ²¡æœ‰profileè¢«æŒ‡å®š
spring:
  profiles: default
  security:
    user:
      password: weak
</code></pre>
<h3><a class="header" href="#yamlä¸èƒ½ä½¿ç”¨propertysource" id="yamlä¸èƒ½ä½¿ç”¨propertysource">yamlä¸èƒ½ä½¿ç”¨@PropertySource</a></h3>
<p>ä¸æ”¯æŒ @PropertySource  ï¼Œåªæœ‰propertiesæ–‡ä»¶æ‰æ”¯æŒ@PropertySource</p>
<p>@PropertySource å¯ä»¥æŒ‡å®šæ˜¯å“ªä¸ªé…ç½®æ–‡ä»¶ï¼Œè¯»å–çš„ç¼–ç æ ¼å¼</p>
<pre><code class="language-java">@RestController  
@PropertySource(value = {&quot;classpath:application.properties&quot;},encoding=&quot;utf-8&quot;)  
@RequestMapping(value=&quot;hello&quot;)  
public class HelloController {  
    /** ä½¿ç”¨@valueæ³¨è§£ï¼Œä»é…ç½®æ–‡ä»¶è¯»å–å€¼ */  
    @Value(&quot;${TestValue}&quot;)  
    private String testValueAnno;  
      
    @RequestMapping(value=&quot;sayHello&quot;)  
    @ResponseBody  
    private String sayHello() {  
        System.out.println(&quot;æµ‹è¯•:&quot;+testValueAnno);  
        return &quot;hello world!&quot;;  
    }  
} 
</code></pre>
<h3><a class="header" href="#ymalä¸­çš„list" id="ymalä¸­çš„list">ymalä¸­çš„list</a></h3>
<pre><code class="language-yml">foo:
  list: # è¡¨ç¤ºé»˜è®¤ï¼Œå¦‚æœdev profileä¹ˆæœ‰è¢«æ¿€æ´»ï¼Œé‚£ä¹ˆlistä¸­çš„Mypojoå°±æ˜¯è¿™ä¸ª
    - name: my name
      description: my description
---
spring:
  profiles: dev # å¦‚æœdevè¢«æ¿€æ´»ï¼Œlistä¸­çš„pojoå°±æ˜¯è¿™ä¸ªï¼Œæ€»ä¹‹ï¼Œlistä¸­çš„å…ƒç´ åªæœ‰ä¸€ä¸ª
foo:
  list:
    - name: my another name
</code></pre>
<pre><code class="language-java">@ConfigurationProperties(&quot;foo&quot;)
public class FooProperties {

    private final List&lt;MyPojo&gt; list = new ArrayList&lt;&gt;();//mypojoä¸­å®šä¹‰çš„æœ‰nameï¼Œdescription

    public List&lt;MyPojo&gt; getList() {
        return this.list;
    }

}
</code></pre>
<h2><a class="header" href="#configurationproperties" id="configurationproperties">@ConfigurationProperties</a></h2>
<h3><a class="header" href="#ç»Ÿä¸€å‰ç¼€" id="ç»Ÿä¸€å‰ç¼€">ç»Ÿä¸€å‰ç¼€</a></h3>
<p>é€šè¿‡@Value(&quot;${property}&quot;) çš„æ–¹å¼å®å¤ªè¿‡ç¬¨é‡  ï¼Œå¦ä¸€ç§æ–¹å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">@Component// ä¿è¯æ³¨å†Œåˆ°äº†contextä¸­
@ConfigurationProperties(&quot;foo&quot;)
public class FooProperties {

    private boolean enabled;//å®šä¹‰äº†ï¼šfoo.enabled, false by default

    private InetAddress remoteAddress;//å®šä¹‰äº†ï¼šfoo.remote-addressï¼Œipåœ°å€, èƒ½å¤Ÿä»stringå¼ºè½¬

    private final Security security = new Security();//å®šä¹‰äº†ï¼šfoo.security.usernameï¼Œfoo.security.passwordï¼Œfoo.security.rolesï¼›è¿™é‡Œçš„å±æ€§åsecurityï¼Œå¯¹åº”é…ç½®æ–‡ä»¶ä¸­çš„security


    public static class Security {

        private String username;

        private String password;

        private List&lt;String&gt; roles = new ArrayList&lt;&gt;(Collections.singleton(&quot;USER&quot;));//ï¼ˆä¸€ä¸ªstringçš„é›†åˆï¼‰


    }
}
</code></pre>
<p>å…¶ä¸­æœ‰äº›å±æ€§å¯ä»¥ä¸è¦setteræ–¹æ³•ï¼Œå…·ä½“å‚è§ï¼š<a href="https://docs.spring.io/spring-boot/docs/1.5.6.RELEASE/reference/htmlsingle/#boot-features-external-config-typesafe-configuration-properties">è¿™é‡Œ</a></p>
<p>å¦‚æœ @ConfigurationProperties ä¸ç”Ÿæ•ˆ(æ¯”å¦‚æŒ‡å®šçš„å‰ç¼€æ— æ•ˆ), å¯ä»¥é€šè¿‡åœ¨ä¸»é…ç½®ç±»ä¸ŠåŠ @EnableConfigurationPropertiesæ¥åˆ—å‡ºæœ‰å“ªäº›ç±»ç”¨æ¥è£…è½½é…ç½®å˜é‡</p>
<pre><code class="language-java">
@Configuration
// è¿™æ ·æ³¨å†Œå, FooPropertiesåœ¨contextä¸­ä¼šæœ‰ä¸€ä¸ªé»˜è®¤åå­—, &lt;prefix&gt;-&lt;fullQualifiedName&gt;, æ¯”å¦‚æ­¤å¤„å³ä¸º: foo-com.xxx.xxx.FooProperties 
@EnableConfigurationProperties(FooProperties.class)
public class MyConfiguration {
}
</code></pre>
<h3><a class="header" href="#ç¬¬ä¸‰æ–¹ç»„ä»¶å»é…ç½®åŒ–" id="ç¬¬ä¸‰æ–¹ç»„ä»¶å»é…ç½®åŒ–">ç¬¬ä¸‰æ–¹ç»„ä»¶å»é…ç½®åŒ–</a></h3>
<p>@ConfigurationPropertiesé™¤äº†å¯ä»¥æ ‡æ³¨class, è¿˜å¯ä»¥æ ‡æ³¨ @Bean æ–¹æ³•;</p>
<p>ç”¨åœ¨å°†environmentä¸­çš„propertiesé…ç½®åˆ°ä¸€ä¸ªç¬¬ä¸‰æ–¹beanä¸­ç‰¹åˆ«æ–¹ä¾¿ï¼Œå°†@ConfigurationPropertiesæ·»åŠ åˆ°è¿™ä¸ªbeançš„æ³¨å†Œè¿‡ç¨‹ï¼š</p>
<pre><code class="language-java">@ConfigurationProperties(prefix = &quot;bar&quot;)// ä»»ä½•ä»¥barä¸ºå‰ç¼€çš„å±æ€§å®šä¹‰éƒ½ä¼šè¢«æ˜ å°„åˆ°BarComponentä¸Š
@Bean
public BarComponent barComponent() {
    ...
}
</code></pre>
<p><a href="http://blog.csdn.net/liuchuanhong1/article/details/70105193">Springbootæ•´åˆquartzçš„ä¾‹å­</a></p>
<h3><a class="header" href="#æ¾ç»‘å®šrelaxed-binding" id="æ¾ç»‘å®šrelaxed-binding">æ¾ç»‘å®šï¼ˆrelaxed bindingï¼‰</a></h3>
<pre><code class="language-java">@Data
@ConfigurationProperties(prefix=&quot;person&quot;)
public class OwnerProperties {

    private String name;

}
</code></pre>
<p>å¦‚ä¸‹å½¢å¼ä¹¦å†™çš„å±æ€§å‡å¯åŒ¹é…ï¼š</p>
<p><code>person.name</code>
<code>person.first-name</code>--------(æ¨è)
<code>person.first_name</code>
<code>PERSON_FIRST_NAME</code></p>
<h3><a class="header" href="#å¤æ‚ç±»å‹çš„æ··åˆmerge" id="å¤æ‚ç±»å‹çš„æ··åˆmerge">å¤æ‚ç±»å‹çš„æ··åˆ(merge)</a></h3>
<p>å¯¹äº List</p>
<pre><code class="language-java">@ConfigurationProperties(&quot;acme&quot;)
public class AcmeProperties {

	private final List&lt;MyPojo&gt; list = new ArrayList&lt;&gt;();// MyPojo æœ‰name, descriptionå±æ€§

	public List&lt;MyPojo&gt; getList() {
		return this.list;
	}

}

</code></pre>
<pre><code class="language-yml">acme:
  list:
    - name: my name
      description: my description
---
spring:
  profiles: dev
acme:
  list:
    - name: my another name
</code></pre>
<p>å¦‚æœ dev æ²¡æœ‰æ¿€æ´», å¯ç”¨é»˜è®¤å€¼, listå«æœ‰ä¸€ä¸ªå…ƒç´ , å¦‚æœ dev æ¿€æ´», å«æœ‰ä¸€ä¸ªå…ƒç´ , description = null;(è¿™é‡Œæ²¡æœ‰merge)</p>
<p>å¯¹äº Map</p>
<pre><code class="language-java">@ConfigurationProperties(&quot;acme&quot;)
public class AcmeProperties {

	private final Map&lt;String, MyPojo&gt; map = new HashMap&lt;&gt;();

	public Map&lt;String, MyPojo&gt; getMap() {
		return this.map;
	}

}

</code></pre>
<pre><code class="language-yml">acme:
  map:
    key1:
      name: my name 1
      description: my description 1
---
spring:
  profiles: dev
acme:
  map:
    key1:
      name: dev name 1
    key2:
      name: dev name 2
      description: dev description 2
</code></pre>
<p>å¦‚æœ dev æ²¡æœ‰æ¿€æ´», map åŒ…å«ä¸€ä¸ªå…ƒç´ 
å¦‚æœ dev æ¿€æ´», mapåŒ…å«2ä¸ªå…ƒç´ , å…ƒç´ 1 key1:{name: dev name 1, description: my description 1}, å…ƒç´ 2 key2: {...}</p>
<p>è¿™é‡Œæ··åˆäº†</p>
<h3><a class="header" href="#å±æ€§-è½¬æ¢" id="å±æ€§-è½¬æ¢">å±æ€§ è½¬æ¢</a></h3>
<p>å¯èƒ½å’Œ@ConfigurationPropertiesBinding æœ‰å…³  ï¼Œè¿™é‡ŒMarkä¸€ä¸‹ï¼Œåé¢å®Œæˆã€‚</p>
<p>è‡ªå®šä¹‰ç±»å‹è½¬æ¢, ä¸‰ç§æ–¹å¼:</p>
<ul>
<li>
<p>æä¾›ä¸€ä¸ª ConversionService  bean(å‘½åè¯¥beanä¸º conversionService)</p>
</li>
<li>
<p>å®šåˆ¶ property editors (é€šè¿‡ CustomEditorConfigurer bean)</p>
</li>
<li>
<p>å®šåˆ¶ Converters  (é€šè¿‡æ³¨è§£ @ConfigurationPropertiesBinding)</p>
</li>
</ul>
<p>https://docs.spring.io/spring-boot/docs/2.0.2.RELEASE/reference/htmlsingle/#boot-features-external-config-conversion</p>
<h1><a class="header" href="#profiles" id="profiles">profiles</a></h1>
<h2><a class="header" href="#æ·»åŠ active-profiles" id="æ·»åŠ active-profiles">æ·»åŠ active-profiles</a></h2>
<p>Spring profiles ç»™è¿™ç§éœ€æ±‚æä¾›äº†å® ----&gt; æ ¹æ®ä¸åŒçš„ç¯å¢ƒå¯ç”¨ä¸åŒçš„å±æ€§é…ç½®æ–‡ä»¶</p>
<p>ä»»ä½•è¢«@componentã€@@Configuration æ ‡æ³¨çš„ç±»ï¼Œéƒ½èƒ½é€šè¿‡@Profileæ¥å®ç°é™åˆ¶ä½•æ—¶è¢«åŠ è½½ï¼š</p>
<pre><code class="language-java">@Configuration
@Profile(&quot;production&quot;)
public class ProductionConfiguration {

    // ...

}
</code></pre>
<p>å½“ç„¶ï¼Œä¹Ÿæœ‰å…¶ä»–çš„æ–¹æ³•ï¼š</p>
<ul>
<li>
<p>åœ¨å±æ€§é…ç½®æ–‡ä»¶ä¸­ï¼ˆå¦‚ï¼šapplication.propertiesï¼‰é…ç½®ç¯å¢ƒå±æ€§ï¼š <code>spring.profiles.active=dev,hsqldb</code></p>
</li>
<li>
<p>å‘½ä»¤è¡Œå¯åŠ¨æ—¶ï¼ŒåŠ å‚æ•°ï¼š<code>--spring.profiles.active=dev,hsqldb</code></p>
</li>
<li>
<p>ä½†æ˜¯ï¼Œè¿™äº›æ–¹æ³•éƒ½æ˜¯ç›´æ¥æ›¿æ¢ï¼Œæœ‰æ—¶å€™æ·»åŠ æ¯”æ›¿æ¢æ›´å¥½ï¼Œç¯å¢ƒå±æ€§ï¼š<code>spring.profiles.include</code>æä¾›äº†è¿™ç§ç‰¹æ€§. </p>
</li>
<li>
<p>ä¹Ÿå¯é€šè¿‡Java APIåœ¨app run()ä¹‹å‰è®¾ç½®ï¼š <code>SpringApplication.setAdditionalProfiles(â€¦â€‹)  </code></p>
</li>
<li>
<p>ä¹Ÿå¯ä»¥é€šè¿‡<code>ConfigurableEnvironment interface.</code>(ä¸å¸¸ç”¨)</p>
</li>
</ul>
<p>ä¸‹é¢çœ‹çœ‹ä¾‹å­:</p>
<p>å½“æŒ‡å®šprodå¯ç”¨æ—¶ï¼Œproddb å’Œ prodmqä¹Ÿä¼šè¢«å¯ç”¨</p>
<pre><code class="language-yml">---
my.property: fromyamlfile
---
spring.profiles: prod
spring.profiles.include:
  - proddb
  - prodmq
</code></pre>
<h1><a class="header" href="#springbootå•å…ƒæµ‹è¯•" id="springbootå•å…ƒæµ‹è¯•">springbootå•å…ƒæµ‹è¯•</a></h1>
<p>https://www.cnblogs.com/aston/p/7259825.html</p>
<h1><a class="header" href="#æ—¥å¿—" id="æ—¥å¿—">æ—¥å¿—</a></h1>
<p>Springboot å†…éƒ¨æ—¥å¿—ç³»ç»Ÿé‡‡ç”¨ Commons Loggingï¼Œä½†æ˜¯å¼€æ”¾äº†æ—¥å¿—æ¥å£ï¼Œæä¾›äº†è¿™äº›æ—¥å¿—çš„é»˜è®¤é…ç½®ï¼š Java Util Logging, Log4J2 and Logbackï¼›é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä½¿ç”¨startersï¼ŒLogbackæ—¥å¿—ä¼šè¢«é‡‡ç”¨, é»˜è®¤consoleè¾“å‡º, fileè¾“å‡ºå¯é€‰</p>
<pre><code class="language-properties">logging.path=/user/local/log
logging.level.com.favorites=DEBUG
logging.level.org.springframework.web=INFO
logging.level.org.hibernate=ERROR

</code></pre>
<h2><a class="header" href="#è¾“å‡ºé…ç½®" id="è¾“å‡ºé…ç½®">è¾“å‡ºé…ç½®</a></h2>
<h3><a class="header" href="#è¾“å‡ºæ ¼å¼" id="è¾“å‡ºæ ¼å¼">è¾“å‡ºæ ¼å¼</a></h3>
<p>é»˜è®¤çš„æ—¥å¿—è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<pre><code>2014-03-05 10:57:51.112  INFO 45469 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet Engine: Apache Tomcat/7.0.52
2014-03-05 10:57:51.253  INFO 45469 --- [ost-startStop-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2014-03-05 10:57:51.253  INFO 45469 --- [ost-startStop-1] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 1358 ms
2014-03-05 10:57:51.698  INFO 45469 --- [ost-startStop-1] o.s.b.c.e.ServletRegistrationBean        : Mapping servlet: 'dispatcherServlet' to [/]
2014-03-05 10:57:51.702  INFO 45469 --- [ost-startStop-1] o.s.b.c.embedded.FilterRegistrationBean  : Mapping filter: 'hiddenHttpMethodFilter' to: [/*]
</code></pre>
<p>æœ‰è¿™äº›ä¿¡æ¯ï¼š</p>
<ul>
<li>æ—¥æœŸå’Œæ—¶é—´</li>
<li>æ—¥å¿—çº§åˆ«ï¼ŒERROR, WARN, INFO, DEBUG or TRACE.</li>
<li>è¿›ç¨‹ID</li>
<li>â€œ---â€ï¼Œè¡¨ç¤ºåé¢æ˜¯çœŸæ­£çš„æ—¥å¿—ä¿¡æ¯</li>
<li>â€œ[xxx]â€,çº¿ç¨‹å</li>
<li>Loggeråï¼Œé€šå¸¸æ˜¯source class name</li>
<li>çœŸæ­£çš„æ—¥å¿—ä¿¡æ¯</li>
</ul>
<p>æ³¨: Logback does not have a FATAL level (it is mapped to ERROR)</p>
<h3><a class="header" href="#consoleæ§åˆ¶å°è¾“å‡º" id="consoleæ§åˆ¶å°è¾“å‡º">consoleæ§åˆ¶å°è¾“å‡º</a></h3>
<p>By default ERROR, WARN and INFO level messages are logged. å¦‚æœå¸Œæœ›debugçº§åˆ«æ—¥å¿—ä¹Ÿè®°å½•, <code> java -jar myapp.jar --debug</code>(You can also specify debug=true in your application.properties.)</p>
<h3><a class="header" href="#å¸¦é¢œè‰²è¾“å‡º" id="å¸¦é¢œè‰²è¾“å‡º">å¸¦é¢œè‰²è¾“å‡º</a></h3>
<p>éœ€è¦è®¾ç½® spring.output.ansi.enabled ã€‚
see: https://docs.spring.io/spring-boot/docs/1.5.9.RELEASE/reference/htmlsingle/#boot-features-logging-color-coded-output</p>
<h3><a class="header" href="#fileæ–‡ä»¶è¾“å‡º" id="fileæ–‡ä»¶è¾“å‡º">fileæ–‡ä»¶è¾“å‡º</a></h3>
<p>spring booté»˜è®¤åªè¾“å‡ºæ—¥å¿—åˆ°console, å¦‚æœå¸Œæœ›è¾“å‡ºåˆ°æ–‡ä»¶, è®¾ç½®<code>logging.file</code> or <code>logging.path</code>å±æ€§åˆ°application.properties</p>
<table><thead><tr><th>logging.file</th><th>logging.path</th><th>Example</th><th>Description</th></tr></thead><tbody>
<tr><td></td><td></td><td></td><td>Console only logging.</td></tr>
<tr><td>Specific file</td><td></td><td>my.log</td><td>å†™å…¥åˆ°æŒ‡å®šçš„æ–‡ä»¶</td></tr>
<tr><td></td><td>Specific directory</td><td>/var/log</td><td>Writes <code>spring.log</code> to the specified directory.</td></tr>
</tbody></table>
<p>Log files è¾¾åˆ° 10 MB è‡ªåŠ¨å¦æä¸€ä¸ªæ–‡ä»¶è®°å½•, é€šè¿‡<code>logging.file.max-size</code> æ›´æ”¹ file size</p>
<p><code>logging.file.max-history=30</code>æ—¥å¿—æ–‡ä»¶ä¿å­˜30å¤©çš„</p>
<h2><a class="header" href="#æ—¥å¿—çº§åˆ«log-levels" id="æ—¥å¿—çº§åˆ«log-levels">æ—¥å¿—çº§åˆ«(Log Levels)</a></h2>
<p><code>logging.level.&lt;logger-name&gt;=&lt;level&gt;</code> where level is one of TRACE, DEBUG, INFO, WARN, ERROR, FATAL, or OFF</p>
<p>The root logger can be configured by using <code>logging.level.root</code>.</p>
<p>è¾“å‡ºä¼˜å…ˆçº§: fatal &gt; error &gt; warn &gt;  info &gt; debug &gt; TRACE</p>
<p>å¦‚æœä¸é…ç½®, application.propertiesä¸­å·²ç»é»˜è®¤é…ç½®äº†å¦‚ä¸‹å±æ€§:</p>
<pre><code class="language-yml">logging.level.root=WARN # root logger
logging.level.org.springframework.web=DEBUG
logging.level.org.hibernate=ERROR
</code></pre>
<h2><a class="header" href="#è‡ªå®šä¹‰log-configration" id="è‡ªå®šä¹‰log-configration">è‡ªå®šä¹‰log configration</a></h2>
<ul>
<li>
<p>springbootæ”¯æŒå¤šç§æ—¥å¿—ç³»ç»Ÿçš„è‡ªåŠ¨é…ç½®, å½“å¼•å…¥ä¸€ä¸ªç‰¹å®šçš„æ—¥å¿—lib, è¿™ä¸ªæ—¥å¿—ç³»ç»Ÿä¼šè¢«è‡ªåŠ¨æ¿€æ´»,è€Œæ—¥å¿—ç³»ç»Ÿçš„é…ç½®æ–‡ä»¶ä¸€èˆ¬åœ¨classpathçš„æ ¹ç›®å½•ä¸‹, or é€šè¿‡<code>logging.config</code> propertyæŒ‡å®šæ—¥å¿—çš„é…ç½®æ–‡ä»¶ä½ç½®(å¦‚:logging.config=classpath:log/logback-spring.xml);</p>
</li>
<li>
<p>å¯ä»¥é€šè¿‡<code>org.springframework.boot.logging.LoggingSystem</code>è¿™ä¸ªsystem propertyæ¥å¼ºåˆ¶springbootä½¿ç”¨æŸä¸ªæ—¥å¿—ç³»ç»Ÿ, å±æ€§å€¼æ˜¯<code> fully-qualified class name of a LoggingSystem implementation</code>, å€¼ä¸º<code>none</code>æ—¶, appçš„æ—¥å¿—ç³»ç»Ÿè¢«ç¦ç”¨;</p>
</li>
</ul>
<p>æ³¨: æ—¥å¿—ç³»ç»Ÿåœ¨ApplicationContext åˆ›å»ºå‰å°±è¿›è¡Œäº†åˆå§‹åŒ–, å› æ­¤é€šè¿‡@PropertySourcesæŒ‡å®š@Configurationé…ç½®æ–‡ä»¶ä¸å¯è¡Œ,  <code>System properties</code> and the conventional <code>Spring Boot external configuration files</code>åˆ™å¯ä»¥æ§åˆ¶æ—¥å¿—ç³»ç»Ÿ;</p>
<p>æ ¹æ®ä¸åŒçš„æ—¥å¿—ç³»ç»Ÿ, å¦‚ä¸‹çš„æ–‡ä»¶ä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨è¯»å–:</p>
<p><img src="./SpringBoot%E6%96%87%E6%A1%A3%E7%BF%BB%E8%AF%91/Screenshot_2.png" alt="" /></p>
<p>æ­¤å¤–, ä¸ºäº†æ–¹ä¾¿è‡ªå®šä¹‰log, ä¸€äº›String Environment è¢«è½¬ä¸ºäº† System property</p>
<table><thead><tr><th>Spring Environment</th><th>System Property</th><th>Comments</th></tr></thead><tbody>
<tr><td>logging.exception-conversion-word</td><td>LOG_EXCEPTION_CONVERSION_WORD</td><td>The conversion word used when logging exceptions.</td></tr>
<tr><td>logging.file</td><td>LOG_FILE</td><td>If defined, it is used in the default log configuration.</td></tr>
<tr><td>logging.file.max-size</td><td>LOG_FILE_MAX_SIZE</td><td>Maximum log file size (if LOG_FILE enabled). (Only supported with the default Logback setup.)</td></tr>
<tr><td>logging.file.max-history</td><td>LOG_FILE_MAX_HISTORY</td><td>Maximum number of archive log files to keep (if LOG_FILE enabled). (Only supported with the default Logback setup.)</td></tr>
<tr><td>logging.path</td><td>LOG_PATH</td><td>If defined, it is used in the default log configuration.</td></tr>
<tr><td>logging.pattern.console</td><td>CONSOLE_LOG_PATTERN</td><td>The log pattern to use on the console (stdout). (Only supported with the default Logback setup.)</td></tr>
<tr><td>logging.pattern.dateformat</td><td>LOG_DATEFORMAT_PATTERN</td><td>Appender pattern for log date format. (Only supported with the default Logback setup.)</td></tr>
<tr><td>logging.pattern.file</td><td>FILE_LOG_PATTERN</td><td>The log pattern to use in a file (if LOG_FILE is enabled). (Only supported with the default Logback setup.)</td></tr>
<tr><td>logging.pattern.level</td><td>LOG_LEVEL_PATTERN</td><td>The format to use when rendering the log level (default %5p). (Only supported with the default Logback setup.)</td></tr>
<tr><td>PID</td><td>PID</td><td>The current process ID (discovered if possible and when not already defined as an OS environment variable).</td></tr>
</tbody></table>
<p>åœ¨ spring-boot.jar ä¸­æŸ¥é˜…é…ç½®ä¿¡æ¯ <a href="https://github.com/spring-projects/spring-boot/tree/v2.0.2.RELEASE/spring-boot-project/spring-boot/src/main/resources/org/springframework/boot/logging/logback/defaults.xml">logback</a> | <a href="https://github.com/spring-projects/spring-boot/tree/v2.0.2.RELEASE/spring-boot-project/spring-boot/src/main/resources/org/springframework/boot/logging/log4j2/log4j2.xml">log4j 2</a></p>
<h2><a class="header" href="#mdcç‰¹æ€§" id="mdcç‰¹æ€§">MDCç‰¹æ€§</a></h2>
<p>https://blog.csdn.net/n447194252/article/details/73864046
https://logging.apache.org/log4j/2.x/manual/thread-context.html</p>
<p>log4j 2ä¸­å€ŸåŠ©[MDC ] ç‰¹æ€§å°†å½“å‰è®¿é—®useråŠ å…¥æ—¥å¿—: è¦†ç›–<code>LOG_LEVEL_PATTERN</code>or Logback ä¸­çš„<code>logging.pattern.level</code>, ä¸¾ä¸ª ğŸŒ°:</p>
<p>è®¾ç½® <code>logging.pattern.level=user:%X{user} %5p</code>, é»˜è®¤çš„æ—¥å¿—æ ¼å¼åŒ…å«ä¸€ä¸ª MDC entry  &quot;user&quot;, å¦‚æœè¿™ä¸ªuserå­˜åœ¨, æ‰“å°å¦‚ä¸‹:</p>
<pre><code>2015-09-30 12:30:04.031 user:someone INFO 22174 --- [  nio-8080-exec-0] demo.Controller
Handling authenticated request
</code></pre>
<p><a href="https://blog.csdn.net/xingbaozhen1210/article/details/89230570">logbackåˆ©ç”¨mdcæœºåˆ¶ä¸ºæ—¥å¿—å¢åŠ traceId</a></p>
<h2><a class="header" href="#logbackè¯¦ç»†é…ç½®" id="logbackè¯¦ç»†é…ç½®">logbackè¯¦ç»†é…ç½®</a></h2>
<h3><a class="header" href="#ä¾èµ–" id="ä¾èµ–">ä¾èµ–</a></h3>
<p>ogbackå½“å‰åˆ†æˆä¸‰ä¸ªæ¨¡å—ï¼šlogback-core,logback- classicå’Œlogback-accessã€‚</p>
<p>logback-coreæ˜¯å…¶å®ƒä¸¤ä¸ªæ¨¡å—çš„åŸºç¡€æ¨¡å—ã€‚logback-classicæ˜¯log4jçš„ä¸€ä¸ª æ”¹è‰¯ç‰ˆæœ¬ã€‚æ­¤å¤–logback-classicå®Œæ•´å®ç°SLF4J API, logback-accessè®¿é—®æ¨¡å—ä¸Servletå®¹å™¨é›†æˆæä¾›é€šè¿‡Httpæ¥è®¿é—®æ—¥å¿—çš„åŠŸèƒ½ã€‚</p>
<p>å•ç‹¬åœ¨springé¡¹ç›®ä¸­ä½¿ç”¨logbackéœ€è¦å¯¼å…¥: classicåŒ…, coreåŒ…, slf4j-apiçš„åŒ…</p>
<p>åœ¨springbootä¸­å¼•å…¥ <code>spring-boot-starter-web</code> starterå³å¯ä½¿ç”¨logback</p>
<p>æ³¨æ„: ğŸ–logbackçš„ä¾èµ–ä¸è¦æ··åœ¨ä¸€ä¸ªé¡¹ç›®, å¦‚æœå¼•å…¥ç¬¬ä¸‰æ–¹åŒ…, æ³¨æ„ä¸€å®šè¦ æ’é™¤<code>slf4j-log4j12.jar</code></p>
<h3><a class="header" href="#logback-springxml" id="logback-springxml">logback-spring.xml</a></h3>
<p>https://www.cnblogs.com/cb0327/p/5759441.html</p>
<p>logback-spring.xml</p>
<p>å¦å¤–ä¸€ä»½é…ç½®, å­˜åœ¨è¿™é‡Œ, å­˜ç–‘</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;

&lt;configuration scan=&quot;true&quot;&gt;
    &lt;include resource=&quot;org/springframework/boot/logging/logback/base.xml&quot;/&gt;

&lt;!-- The FILE and ASYNC appenders are here as examples for a production configuration --&gt;
&lt;!--
    &lt;appender name=&quot;FILE&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;
        &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;
            &lt;fileNamePattern&gt;logFile.%d{yyyy-MM-dd}.log&lt;/fileNamePattern&gt;
            &lt;maxHistory&gt;90&lt;/maxHistory&gt;
        &lt;/rollingPolicy&gt;
        &lt;encoder&gt;
            &lt;charset&gt;utf-8&lt;/charset&gt;
            &lt;Pattern&gt;%d %-5level [%thread] %logger{0}: %msg%n&lt;/Pattern&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;

    &lt;appender name=&quot;ASYNC&quot; class=&quot;ch.qos.logback.classic.AsyncAppender&quot;&gt;
        &lt;queueSize&gt;512&lt;/queueSize&gt;
        &lt;appender-ref ref=&quot;FILE&quot;/&gt;
    &lt;/appender&gt;
--&gt;

    &lt;logger name=&quot;com.paasit.pai.core.rest&quot; level=&quot;#logback.loglevel#&quot;/&gt;

    &lt;logger name=&quot;io.github.jhipster&quot; level=&quot;DEBUG&quot;/&gt;

    &lt;logger name=&quot;javax.activation&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;javax.mail&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;javax.xml.bind&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;ch.qos.logback&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;com.codahale.metrics&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;com.netflix&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;com.netflix.discovery&quot; level=&quot;INFO&quot;/&gt;
    &lt;logger name=&quot;com.ryantenney&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;com.sun&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;com.zaxxer&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;io.undertow&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;io.undertow.websockets.jsr&quot; level=&quot;ERROR&quot;/&gt;
    &lt;logger name=&quot;org.apache&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;org.apache.catalina.startup.DigesterFactory&quot; level=&quot;OFF&quot;/&gt;
    &lt;logger name=&quot;org.bson&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;org.hibernate.validator&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;org.hibernate&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;org.hibernate.ejb.HibernatePersistence&quot; level=&quot;OFF&quot;/&gt;
    &lt;logger name=&quot;org.springframework&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;org.springframework.web&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;org.springframework.security&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;org.springframework.cache&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;org.thymeleaf&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;org.xnio&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;springfox&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;sun.rmi&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;liquibase&quot; level=&quot;WARN&quot;/&gt;
    &lt;logger name=&quot;LiquibaseSchemaResolver&quot; level=&quot;INFO&quot;/&gt;
    &lt;logger name=&quot;sun.net.www&quot; level=&quot;INFO&quot;/&gt;
    &lt;logger name=&quot;sun.rmi.transport&quot; level=&quot;WARN&quot;/&gt;

    &lt;contextListener class=&quot;ch.qos.logback.classic.jul.LevelChangePropagator&quot;&gt;
        &lt;resetJUL&gt;true&lt;/resetJUL&gt;
    &lt;/contextListener&gt;

    &lt;root level=&quot;#logback.loglevel#&quot;&gt;
        &lt;appender-ref ref=&quot;CONSOLE&quot;/&gt;
    &lt;/root&gt;

&lt;/configuration&gt;

</code></pre>
<h3><a class="header" href="#çœ‹ä¸€ä¸ªå…·ä½“æ—¥å¿—éœ€æ±‚" id="çœ‹ä¸€ä¸ªå…·ä½“æ—¥å¿—éœ€æ±‚">çœ‹ä¸€ä¸ªå…·ä½“æ—¥å¿—éœ€æ±‚</a></h3>
<p>https://blog.csdn.net/wohaqiyi/article/details/72853962</p>
<ul>
<li>æ—¥å¿—éœ€è¦æ§åˆ¶å°æ‰“å°å’Œæ–‡ä»¶æ‰“å°ä¸¤ç§ã€‚</li>
<li>å…¶ä¸­æ–‡ä»¶æ‰“å°æŒ‰ç…§æ—¥å¿—çº§åˆ«åˆ†åˆ«ä¿å­˜åˆ°å„è‡ªçš„æ–‡ä»¶é‡Œã€‚</li>
<li>æ–‡ä»¶æ—¥å¿—æ¯å¤©ä¸€ä¸ªæ—¥å¿—ï¼Œå¹¶ä¸”ä¿å­˜30å¤©ã€‚</li>
<li>æ–‡ä»¶æ—¥å¿—å¯ä»¥è‡ªç”±æŒ‡å®šä¿å­˜è·¯å¾„ã€æ‰“å°æ ¼å¼ç­‰ã€‚</li>
<li>æ§åˆ¶å°æ‰“å°å¯æŒ‡å®šæ‰“å°æ ¼å¼ï¼Œå¹¶ä¸”è‡ªç”±å¢åŠ åˆ é™¤æŸäº›æ—¥å¿—ã€‚</li>
</ul>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;  
&lt;configuration scan=&quot;true&quot; scanPeriod=&quot;60 seconds&quot;&gt;  
    &lt;!-- éƒ½è¯´spring bootä½¿ç”¨æ—¥å¿—éœ€è¦å¼•å…¥è¿™ä¸ªï¼Œä½†æ˜¯æˆ‘å¼•å…¥äº†ä¹‹åæ€»æ˜¯æ‰“å°ä¸¤ä»½æ—¥å¿—ï¼Œæ‰€ä»¥æˆ‘å»é™¤äº†ï¼Œå¹¶ä¸å½±å“ä½¿ç”¨ --&gt;
    &lt;!-- &lt;include resource=&quot;org/springframework/boot/logging/logback/base.xml&quot;/&gt; --&gt;
    &lt;!-- æ§åˆ¶å°è®¾ç½® --&gt;  
    &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;  
        &lt;encoder&gt;  
            &lt;pattern&gt;${CONSOLE_LOG_PATTERN}&lt;/pattern&gt;  
        &lt;/encoder&gt;  
    &lt;/appender&gt;  
    &lt;!-- INFO --&gt;  
    &lt;appender name=&quot;infoAppender&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;  
        &lt;!-- æ–‡ä»¶è·¯å¾„ ï¼Œæ³¨æ„LOG_PATHæ˜¯é»˜è®¤å€¼ï¼Œ
            å®ƒçš„é…ç½®å¯¹åº”application.propertiesé‡Œçš„logging.pathå€¼--&gt;  
        &lt;file&gt;${LOG_PATH}/info/info.log&lt;/file&gt;  
        &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;  
            &lt;!-- æ–‡ä»¶åç§° --&gt;  
            &lt;fileNamePattern&gt;info/info-%d{yyyy-MM-dd}.log  
            &lt;/fileNamePattern&gt;  
            &lt;!-- æ–‡ä»¶æœ€å¤§ä¿å­˜å†å²æ•°é‡ --&gt;  
            &lt;MaxHistory&gt;30&lt;/MaxHistory&gt;  
        &lt;/rollingPolicy&gt;  
        &lt;encoder&gt;  
            &lt;pattern&gt;${FILE_LOG_PATTERN}&lt;/pattern&gt;  
        &lt;/encoder&gt;  
        &lt;filter class=&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&gt;  
            &lt;level&gt;INFO&lt;/level&gt;  
            &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt;    
            &lt;onMismatch&gt;DENY&lt;/onMismatch&gt;    
        &lt;/filter&gt;  
    &lt;/appender&gt;

    &lt;!-- DEBUG --&gt;  
    &lt;appender name=&quot;debugAppender&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;  
        &lt;!-- æ–‡ä»¶è·¯å¾„ ï¼Œæ³¨æ„LOG_PATHæ˜¯é»˜è®¤å€¼ï¼Œ
            å®ƒçš„é…ç½®å¯¹åº”application.propertiesé‡Œçš„logging.pathå€¼--&gt;  
        &lt;file&gt;${LOG_PATH}/debug/debug.log&lt;/file&gt;  
        &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;  
            &lt;!-- æ–‡ä»¶åç§° --&gt;  
            &lt;fileNamePattern&gt;debug/debug-%d{yyyy-MM-dd}.log&lt;/fileNamePattern&gt;  
            &lt;!-- æ–‡ä»¶æœ€å¤§ä¿å­˜å†å²æ•°é‡ --&gt;  
            &lt;MaxHistory&gt;30&lt;/MaxHistory&gt;  
        &lt;/rollingPolicy&gt;  
        &lt;encoder&gt;  
            &lt;pattern&gt;${FILE_LOG_PATTERN}&lt;/pattern&gt;  
        &lt;/encoder&gt;  
        &lt;filter class=&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&gt;  
            &lt;level&gt;DEBUG&lt;/level&gt;  
            &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt;    
            &lt;onMismatch&gt;DENY&lt;/onMismatch&gt;    
        &lt;/filter&gt;  
    &lt;/appender&gt; 
     &lt;!-- WARN --&gt;  
    &lt;appender name=&quot;warnAppender&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;  
        &lt;!-- æ–‡ä»¶è·¯å¾„ ï¼Œæ³¨æ„LOG_PATHæ˜¯é»˜è®¤å€¼ï¼Œ
            å®ƒçš„é…ç½®å¯¹åº”application.propertiesé‡Œçš„logging.pathå€¼--&gt;   
        &lt;file&gt;${LOG_PATH}/warn/warn.log&lt;/file&gt;  
        &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;  
            &lt;!-- æ–‡ä»¶åç§° --&gt;  
            &lt;fileNamePattern&gt;warn/warn-%d{yyyy-MM-dd}.log  
            &lt;/fileNamePattern&gt;  
            &lt;!-- æ–‡ä»¶æœ€å¤§ä¿å­˜å†å²æ•°é‡ --&gt;  
            &lt;MaxHistory&gt;30&lt;/MaxHistory&gt;  
        &lt;/rollingPolicy&gt;  
        &lt;encoder&gt;  
            &lt;pattern&gt;${FILE_LOG_PATTERN}&lt;/pattern&gt;  
        &lt;/encoder&gt;  
        &lt;filter class=&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&gt;  
            &lt;level&gt;WARN&lt;/level&gt;  
            &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt;    
            &lt;onMismatch&gt;DENY&lt;/onMismatch&gt;    
        &lt;/filter&gt;  
    &lt;/appender&gt; 

    &lt;!-- ERROR --&gt;  
    &lt;appender name=&quot;errorAppender&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;  
        &lt;!-- æ–‡ä»¶è·¯å¾„ ï¼Œæ³¨æ„LOG_PATHæ˜¯é»˜è®¤å€¼ï¼Œ
            å®ƒçš„é…ç½®å¯¹åº”application.propertiesé‡Œçš„logging.pathå€¼--&gt;  
        &lt;file&gt;${LOG_PATH}/error/error.log&lt;/file&gt;  
        &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;  
            &lt;!-- æ–‡ä»¶åç§° --&gt;  
            &lt;fileNamePattern&gt;error/error-%d{yyyy-MM-dd}.log  
            &lt;/fileNamePattern&gt;  
            &lt;!-- æ–‡ä»¶æœ€å¤§ä¿å­˜å†å²æ•°é‡ --&gt;  
            &lt;MaxHistory&gt;30&lt;/MaxHistory&gt;  
        &lt;/rollingPolicy&gt;  
        &lt;encoder&gt;  
            &lt;pattern&gt;${FILE_LOG_PATTERN}&lt;/pattern&gt;  
        &lt;/encoder&gt;  
        &lt;filter class=&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&gt;  
            &lt;level&gt;ERROR&lt;/level&gt;  
            &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt;    
            &lt;onMismatch&gt;DENY&lt;/onMismatch&gt;    
        &lt;/filter&gt;  
    &lt;/appender&gt;
      &lt;logger name=&quot;org.springframework&quot; additivity=&quot;false&quot;&gt;
        &lt;level value=&quot;ERROR&quot; /&gt;
        &lt;appender-ref ref=&quot;STDOUT&quot; /&gt;
        &lt;appender-ref ref=&quot;errorAppender&quot; /&gt;
    &lt;/logger&gt;

    &lt;!-- ç”±äºå¯åŠ¨çš„æ—¶å€™ï¼Œä»¥ä¸‹ä¸¤ä¸ªåŒ…ä¸‹æ‰“å°debugçº§åˆ«æ—¥å¿—å¾ˆå¤š ï¼Œæ‰€ä»¥è°ƒåˆ°ERROR--&gt;
    &lt;logger name=&quot;org.apache.tomcat.util&quot; additivity=&quot;false&quot;&gt;
        &lt;level value=&quot;ERROR&quot;/&gt;
        &lt;appender-ref ref=&quot;STDOUT&quot;/&gt;
        &lt;appender-ref ref=&quot;errorAppender&quot;/&gt;
    &lt;/logger&gt;

    &lt;!-- é»˜è®¤spring bootå¯¼å…¥hibernateå¾ˆå¤šçš„ä¾èµ–åŒ…ï¼Œå¯åŠ¨çš„æ—¶å€™ï¼Œä¼šæœ‰hibernateç›¸å…³çš„å†…å®¹ï¼Œç›´æ¥å»é™¤ --&gt;
    &lt;logger name=&quot;org.hibernate.validator&quot; additivity=&quot;false&quot;&gt;
        &lt;level value=&quot;ERROR&quot;/&gt;
        &lt;appender-ref ref=&quot;STDOUT&quot;/&gt;
        &lt;appender-ref ref=&quot;errorAppender&quot;/&gt;
    &lt;/logger&gt;
    &lt;root level=&quot;DEBUG&quot;&gt;
         &lt;appender-ref ref=&quot;STDOUT&quot;/&gt;  
         &lt;appender-ref ref=&quot;infoAppender&quot;/&gt;
         &lt;appender-ref ref=&quot;debugAppender&quot;/&gt;
          &lt;appender-ref ref=&quot;warnAppender&quot;/&gt;
         &lt;appender-ref ref=&quot;errorAppender&quot;/&gt;
    &lt;/root&gt; 
&lt;/configuration&gt;  
</code></pre>
<p>application.propertiesé‡Œé…ç½®:</p>
<pre><code class="language-props">logging.path=d:/logs/springBoot
logging.config=classpath:logback-spring.xml
# ä»¥ä¸‹æ˜¯æ§åˆ¶å°æ‰“å°æ—¥å¿—æ ¼å¼è®¾ç½®ï¼Œæ³¨æ„åœ¨logback-spring.xmlé‡Œç”¨CONSOLE_LOG_PATTERNæ‰èƒ½è·å–
logging.pattern.console=[%d{yyyy-MM-dd HH:mm:ss}] -- [%-5p]: [%c] -- %m%n
# ä»¥ä¸‹æ˜¯æ–‡ä»¶æ‰“å°æ—¥å¿—æ ¼å¼è®¾ç½®ï¼Œæ³¨æ„åœ¨logback-spring.xmlé‡Œç”¨FILE_LOG_PATTERNæ‰èƒ½è·å–åˆ°
logging.pattern.file=[%d{yyyy-MM-dd HH:mm:ss}] -- [%-5p]: [%c] -- %m%n

</code></pre>
<h3><a class="header" href="#æ’é™¤ä¸éœ€è¦çš„æ—¥å¿—" id="æ’é™¤ä¸éœ€è¦çš„æ—¥å¿—">æ’é™¤ä¸éœ€è¦çš„æ—¥å¿—</a></h3>
<p>æ¯”å¦‚ä¸éœ€è¦ä¸‹é¢ä¸‰è¡Œ</p>
<pre><code>[2017-06-05 19:14:23] -- [INFO ]: [org.I0Itec.zkclient.ZkClient] -- zookeeper state changed (SyncConnected)
[2017-06-05 19:14:23] -- [DEBUG]: [org.I0Itec.zkclient.ZkClient] -- Leaving process event
[2017-06-05 19:14:23] -- [DEBUG]: [org.I0Itec.zkclient.ZkClient] -- State is SyncConnected
</code></pre>
<p>å¦‚ä¸‹é…ç½®å³å¯</p>
<pre><code class="language-xml">&lt;!-- 
- nameè¡¨ç¤ºæ—¥å¿—çš„æ‰“å°ä½ç½®ï¼Œä»ä¸Šè¾¹å¯ä»¥çœ‹å‡ºæ˜¯æ¥è‡ªè¯¥ç±»ã€‚ 
- additivityè®¾ç½®ä¸ºfalseè¡¨ç¤ºè¯¥æ—¥å¿—æ‰“å°è®¾ç½®ï¼ˆæ§åˆ¶å°æ‰“å°è¿˜æ˜¯æ–‡ä»¶æ‰“å°ç­‰å…·ä½“è®¾ç½®ï¼‰ä¸ä¼šå‘æ ¹rootæ ‡ç­¾ä¼ é€’ï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥loggeré‡Œæ€ä¹ˆè®¾ç½®çš„é‚£å°±ä¼šæ€ä¹ˆæ‰“å°ï¼Œè·Ÿrootæ— å…³ã€‚ 
- level value=â€™errorâ€™è¡¨ç¤ºå°†è¯¥ç±»æ—¥å¿—çº§åˆ«è®¾ç½®ä¸ºerrorçº§æ‰ä¼šæ‰“å°ã€‚ 
- æœ€åä¸¤è¡Œè¡¨ç¤ºerrorçº§æ—¶ä¼šæ‰“å°æ§åˆ¶å°å’Œerroræ–‡ä»¶åŒæ—¶æ‰“å°æ—¥å¿—ã€‚
 --&gt;
&lt;logger name=&quot;org.I0Itec.zkclient.ZkClient&quot; additivity=&quot;false&quot;&gt;
        &lt;level value=&quot;ERROR&quot; /&gt;
        &lt;appender-ref ref=&quot;STDOUT&quot; /&gt;
        &lt;appender-ref ref=&quot;errorAppender&quot; /&gt;
&lt;/logger&gt;
</code></pre>
<h2><a class="header" href="#logbackæ‰©å±•ç‰¹æ€§" id="logbackæ‰©å±•ç‰¹æ€§">logbackæ‰©å±•ç‰¹æ€§</a></h2>
<p>LogBackæœ‰å¾ˆå¤šæ‹“å±•ç‰¹æ€§, å¯ä»¥åœ¨<code>logback-spring.xml</code>ä¸­å®šä¹‰</p>
<p>æ¨èä½¿ç”¨åç§°<code>logback-spring.xml</code>è€Œä¸æ˜¯<code>logback.xml</code>, å› ä¸ºåè€…åœ¨å¯åŠ¨æ—¶å°±ä¼šåŠ è½½ï¼ŒåŠ è½½éå¸¸æ—©ï¼Œä¼šå¯¼è‡´é…ç½®æ–‡ä»¶ä¸­çš„springbootæ ‡ç­¾ä¸è¯†åˆ«ã€‚æ‰€ä»¥æ¨èå‘½å<code>xxxxx-spring.xml</code>å½¢å¼</p>
<h3><a class="header" href="#logbackçš„å¤šç¯å¢ƒé…ç½®" id="logbackçš„å¤šç¯å¢ƒé…ç½®">logbackçš„å¤šç¯å¢ƒé…ç½®</a></h3>
<p>ä»¥ä¸‹é…ç½®, å¤„äº<code>&lt;configuration&gt;</code>æ ‡ç­¾</p>
<pre><code class="language-xml">&lt;springProfile name=&quot;staging&quot;&gt;
    &lt;!-- configuration to be enabled when the &quot;staging&quot; profile is active --&gt;
&lt;/springProfile&gt;

&lt;springProfile name=&quot;dev, staging&quot;&gt;
    &lt;!-- configuration to be enabled when the &quot;dev&quot; or &quot;staging&quot; profiles are active --&gt;
&lt;/springProfile&gt;

&lt;springProfile name=&quot;!production&quot;&gt;
    &lt;!-- configuration to be enabled when the &quot;production&quot; profile is not active --&gt;
&lt;/springProfile&gt;
</code></pre>
<p>å®ä¾‹: é€šè¿‡application.propertiesæ–‡ä»¶ä¸­ <code>spring.profiles.active=test </code>æ¥æŒ‡å®šlogback-spring.xml ä¸­ä½¿ç”¨å“ªä¸€æ®µæ¥è®°å½•æ—¥å¿—</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!-- ä»é«˜åˆ°åœ°ä½ OFF ã€ FATAL ã€ ERROR ã€ WARN ã€ INFO ã€ DEBUG ã€ TRACE ã€ ALL --&gt;  
&lt;!-- æ—¥å¿—è¾“å‡ºè§„åˆ™  æ ¹æ®å½“å‰ROOT çº§åˆ«ï¼Œæ—¥å¿—è¾“å‡ºæ—¶ï¼Œçº§åˆ«é«˜äºrooté»˜è®¤çš„çº§åˆ«æ—¶  ä¼šè¾“å‡º --&gt;  
&lt;!-- ä»¥ä¸‹  æ¯ä¸ªé…ç½®çš„ filter æ˜¯è¿‡æ»¤æ‰è¾“å‡ºæ–‡ä»¶é‡Œé¢ï¼Œä¼šå‡ºç°é«˜çº§åˆ«æ–‡ä»¶ï¼Œä¾ç„¶å‡ºç°ä½çº§åˆ«çš„æ—¥å¿—ä¿¡æ¯ï¼Œé€šè¿‡filter è¿‡æ»¤åªè®°å½•æœ¬çº§åˆ«çš„æ—¥å¿—--&gt; 
&lt;configuration&gt;
    &lt;!-- æ–‡ä»¶è¾“å‡ºæ ¼å¼ --&gt;
    &lt;property name=&quot;PATTERN&quot;
        value=&quot;%-12(%d{yyyy-MM-dd HH:mm:ss.SSS}) |-%-5level [%thread] %c [%L] -| %msg%n&quot; /&gt;
    &lt;!-- æ–‡ä»¶è·¯å¾„ --&gt;
    &lt;!--&lt;property name=&quot;FILE_PATH&quot; value=&quot;D:/DevData/kmcmsLogs&quot; /&gt; --&gt;

    &lt;!-- å¼€å‘ç¯å¢ƒ --&gt;
    &lt;springProfile name=&quot;dev&quot;&gt;
        &lt;appender name=&quot;CONSOLE&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
            &lt;encoder&gt;
                &lt;pattern&gt;${PATTERN}&lt;/pattern&gt;
            &lt;/encoder&gt;
        &lt;/appender&gt;

        &lt;logger name=&quot;com.km.controller&quot; level=&quot;debug&quot; /&gt;

        &lt;root level=&quot;info&quot;&gt;
            &lt;appender-ref ref=&quot;CONSOLE&quot; /&gt;
        &lt;/root&gt;
    &lt;/springProfile&gt;

    &lt;!-- æµ‹è¯•ç¯å¢ƒ --&gt;
    &lt;springProfile name=&quot;test&quot;&gt;
        &lt;appender name=&quot;ROLLING&quot;
            class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;
            &lt;!-- æ–‡ä»¶è·¯å¾„ --&gt;
            &lt;file&gt;D:/DevData/kmAppletLogs/kmapplet.log&lt;/file&gt;
            &lt;rollingPolicy
                class=&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&quot;&gt;
                &lt;!-- rollover daily --&gt;
                &lt;fileNamePattern&gt;D:/DevData/kmAppletLogs/kmapplet_%d{yyyy-MM-dd}.%i.log
                &lt;/fileNamePattern&gt;
                &lt;!-- each file should be at most 100MB, keep 60 days worth of history, 
                    but at most 20GB --&gt;
                &lt;maxFileSize&gt;1MB&lt;/maxFileSize&gt;
                &lt;maxHistory&gt;60&lt;/maxHistory&gt;
                &lt;totalSizeCap&gt;10MB&lt;/totalSizeCap&gt;
            &lt;/rollingPolicy&gt;
            &lt;!-- &lt;layout class=&quot;ch.qos.logback.classic.PatternLayout&quot;&gt; &lt;pattern&gt;${PATTERN}&lt;/pattern&gt; 
                &lt;/layout&gt; --&gt;
            &lt;encoder&gt;
                &lt;pattern&gt;${PATTERN}&lt;/pattern&gt;
            &lt;/encoder&gt;
        &lt;/appender&gt;

        &lt;root level=&quot;DEBUG&quot;&gt;
            &lt;appender-ref ref=&quot;ROLLING&quot; /&gt;
        &lt;/root&gt;
    &lt;/springProfile&gt;

    &lt;!-- ç”Ÿäº§ç¯å¢ƒ --&gt;
    &lt;springProfile name=&quot;prod&quot;&gt;
        &lt;appender name=&quot;ROLLING&quot;
            class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;
            &lt;!-- æ–‡ä»¶è·¯å¾„ --&gt;
            &lt;file&gt;/ftp/private/kmAppletLogs/kmapplet.log&lt;/file&gt;
            &lt;rollingPolicy
                class=&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&quot;&gt;
                &lt;!-- rollover daily --&gt;
                &lt;fileNamePattern&gt;/ftp/private/kmAppletLogs/kmapplet_%d{yyyy-MM-dd}.%i.log
                &lt;/fileNamePattern&gt;
                &lt;!-- each file should be at most 10MB, keep 30 days worth of history, 
                    but at most 1GB --&gt;
                &lt;!-- æ¯ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§10MB, ä¿ç•™30å¤©çš„æ—¥å¿—æ–‡ä»¶, ä½†æ˜¯æœ€å¤šæ€»æ–‡ä»¶å¤§å°ä¸º 5GB --&gt;
                &lt;maxFileSize&gt;10MB&lt;/maxFileSize&gt;
                &lt;maxHistory&gt;30&lt;/maxHistory&gt;
                &lt;totalSizeCap&gt;5GB&lt;/totalSizeCap&gt;
            &lt;/rollingPolicy&gt;
            &lt;!-- &lt;layout class=&quot;ch.qos.logback.classic.PatternLayout&quot;&gt; &lt;pattern&gt;${PATTERN}&lt;/pattern&gt; 
                &lt;/layout&gt; --&gt;
            &lt;encoder&gt;
                &lt;pattern&gt;${PATTERN}&lt;/pattern&gt;
            &lt;/encoder&gt;
        &lt;/appender&gt;

        &lt;!--è¿™é‡Œæ§åˆ¶æ—¥å¿—è¾“å‡ºçº§åˆ« --&gt;
        &lt;root level=&quot;DEBUG&quot;&gt;
            &lt;appender-ref ref=&quot;ROLLING&quot; /&gt;
        &lt;/root&gt;
    &lt;/springProfile&gt;

&lt;/configuration&gt;
</code></pre>
<h3><a class="header" href="#é…ç½®ä¸­ä½¿ç”¨environment-properties" id="é…ç½®ä¸­ä½¿ç”¨environment-properties">é…ç½®ä¸­ä½¿ç”¨Environment properties</a></h3>
<p>logbacké…ç½®æ–‡ä»¶ä¸­å¯ä»¥è·å–application.propertiesä¸­çš„å±æ€§</p>
<p>è¿™é‡Œç”¨åˆ°äº†<code>&lt;springProperty&gt;</code>, å’Œ<code>&lt;property&gt;</code>ç”¨æ³•ç±»ä¼¼</p>
<pre><code class="language-xml">&lt;!-- 
scope: context å¸Œæœ›å°†è¿™ä¸ªå±æ€§ä½œç”¨åŸŸåœ¨contextçº§åˆ«, 
scope: local  ä»…ä»…å­˜å‚¨åœ¨æœ¬åœ°èŒƒå›´
 --&gt;
&lt;springProperty scope=&quot;context&quot; name=&quot;fluentHost&quot; source=&quot;myapp.fluentd.host&quot;
        defaultValue=&quot;localhost&quot;/&gt;
&lt;appender name=&quot;FLUENT&quot; class=&quot;ch.qos.logback.more.appenders.DataFluentAppender&quot;&gt;
    &lt;remoteHost&gt;${fluentHost}&lt;/remoteHost&gt;
    ...
&lt;/appender&gt;
</code></pre>
<p>æ³¨: è¿™é‡Œä¼šé»˜è®¤é‡‡ç”¨æ¾ç»‘å®šåŒ¹é…, æŒ‡å®šäº†source=&quot;aa.bb.cc&quot;, é‚£ä¹ˆ,å±æ€§&quot;aaBbCc, aa-bb-cc, ç­‰ç­‰&quot; ä¹Ÿä¼šè¢«åŒ¹é…ä¸Š.</p>
<h1><a class="header" href="#å¼€å‘-web-app" id="å¼€å‘-web-app">å¼€å‘ web app</a></h1>
<p>ä¸€èˆ¬ä¼šå¼•å…¥<code>spring-boot-starter-web</code> module. æ­¤æ—¶ä¸å¿…å¼•å…¥ spring-boot-starter äº†ï¼Œ å‰è€…å·²ç»åŒ…å«äº†</p>
<p>ä¹Ÿå¯ä»¥å¼•å…¥<code>spring-boot-starter-webflux</code> å¼€å‘å“åº”å¼web app</p>
<h2><a class="header" href="#å¼•å…¥webjars" id="å¼•å…¥webjars">å¼•å…¥WebJars</a></h2>
<h3><a class="header" href="#ä»€ä¹ˆæ˜¯webjars" id="ä»€ä¹ˆæ˜¯webjars">ä»€ä¹ˆæ˜¯webjars</a></h3>
<p>ä»¥ Jar åŒ…çš„å½¢å¼æ¥ä½¿ç”¨å‰ç«¯çš„å„ç§æ¡†æ¶ã€ç»„ä»¶ã€‚</p>
<p>WebJars æ˜¯å°†å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰èµ„æºï¼ˆJavaScriptï¼ŒCssç­‰ï¼‰æ‰“æˆ Jar åŒ…æ–‡ä»¶ï¼Œä»¥å¯¹èµ„æºè¿›è¡Œç»Ÿä¸€ä¾èµ–ç®¡ç†ã€‚WebJars çš„ Jar åŒ…éƒ¨ç½²åœ¨ Maven ä¸­å¤®ä»“åº“ä¸Šã€‚</p>
<h3><a class="header" href="#ä¸ºä»€ä¹ˆä½¿ç”¨webjars" id="ä¸ºä»€ä¹ˆä½¿ç”¨webjars">ä¸ºä»€ä¹ˆä½¿ç”¨webjars</a></h3>
<p>å¯¹äº JavaScriptï¼ŒCss ç­‰å‰ç«¯èµ„æºåŒ…ï¼Œæˆ‘ä»¬åªèƒ½é‡‡ç”¨æ‹·è´åˆ° webapp ä¸‹çš„æ–¹å¼ï¼Œè¿™æ ·åšå°±æ— æ³•å¯¹è¿™äº›èµ„æºè¿›è¡Œä¾èµ–ç®¡ç†ã€‚é‚£ä¹ˆ WebJars å°±æä¾›ç»™æˆ‘ä»¬è¿™äº›å‰ç«¯èµ„æºçš„ Jar åŒ…å½¢åŠ¿ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œä¾èµ–ç®¡ç†ã€‚</p>
<h3><a class="header" href="#å¦‚ä½•ä½¿ç”¨-webjars" id="å¦‚ä½•ä½¿ç”¨-webjars">å¦‚ä½•ä½¿ç”¨ webjars</a></h3>
<p>åœ¨ https://www.webjars.org/ æŸ¥æ‰¾éœ€è¦æ¡†æ¶çš„mavenä¾èµ–</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.webjars&lt;/groupId&gt;
    &lt;artifactId&gt;vue&lt;/artifactId&gt;
    &lt;version&gt;2.5.16&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>thymeleafé¡µé¢ä¸­å¼•å…¥ï¼š</p>
<pre><code class="language-html">&lt;link th:href=&quot;@{/webjars/bootstrap/3.3.6/dist/css/bootstrap.css}&quot; rel=&quot;stylesheet&quot;&gt;&lt;/link&gt;

</code></pre>
<h2><a class="header" href="#gradle-æ„å»ºå·¥å…·" id="gradle-æ„å»ºå·¥å…·">Gradle æ„å»ºå·¥å…·</a></h2>
<pre><code class="language-gradle">buildscript {
    repositories {
        maven { url &quot;http://repo.spring.io/libs-snapshot&quot; }
        mavenLocal()
    }
    dependencies {
        classpath(&quot;org.springframework.boot:spring-boot-gradle-plugin:1.3.6.RELEASE&quot;)
    }
}

apply plugin: 'java'  //æ·»åŠ  Java æ’ä»¶, è¡¨æ˜è¿™æ˜¯ä¸€ä¸ª Java é¡¹ç›®
apply plugin: 'spring-boot' //æ·»åŠ  Spring-bootæ”¯æŒ
apply plugin: 'war'  //æ·»åŠ  War æ’ä»¶, å¯ä»¥å¯¼å‡º War åŒ…
apply plugin: 'eclipse' //æ·»åŠ  Eclipse æ’ä»¶, æ·»åŠ  Eclipse IDE æ”¯æŒ, Intellij Idea ä¸º &quot;idea&quot;

war {
    baseName = 'favorites'
    version =  '0.1.0'
}

sourceCompatibility = 1.7  //æœ€ä½å…¼å®¹ç‰ˆæœ¬ JDK1.7
targetCompatibility = 1.7  //ç›®æ ‡å…¼å®¹ç‰ˆæœ¬ JDK1.7

repositories {     //  Maven ä»“åº“
    mavenLocal()        //ä½¿ç”¨æœ¬åœ°ä»“åº“
    mavenCentral()      //ä½¿ç”¨ä¸­å¤®ä»“åº“
    maven { url &quot;http://repo.spring.io/libs-snapshot&quot; } //ä½¿ç”¨è¿œç¨‹ä»“åº“
}
 
dependencies {   // å„ç§ ä¾èµ–çš„jaråŒ…
    compile(&quot;org.springframework.boot:spring-boot-starter-web:1.3.6.RELEASE&quot;)
    compile(&quot;org.springframework.boot:spring-boot-starter-thymeleaf:1.3.6.RELEASE&quot;)
    compile(&quot;org.springframework.boot:spring-boot-starter-data-jpa:1.3.6.RELEASE&quot;)
    compile group: 'mysql', name: 'mysql-connector-java', version: '5.1.6'
    compile group: 'org.apache.commons', name: 'commons-lang3', version: '3.4'
    compile(&quot;org.springframework.boot:spring-boot-devtools:1.3.6.RELEASE&quot;)
    compile(&quot;org.springframework.boot:spring-boot-starter-test:1.3.6.RELEASE&quot;)
    compile 'org.webjars.bower:bootstrap:3.3.6'
	compile 'org.webjars.bower:jquery:2.2.4'
    compile(&quot;org.webjars:vue:1.0.24&quot;)
	compile 'org.webjars.bower:vue-resource:0.7.0'

}

bootRun {
    addResources = true
}

</code></pre>
<h2><a class="header" href="#å¼€å‘filter" id="å¼€å‘filter">å¼€å‘filter</a></h2>
<p>Spring Boot è‡ªåŠ¨æ·»åŠ äº† OrderedCharacterEncodingFilter å’Œ HiddenHttpMethodFilterï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ Filter</p>
<ul>
<li>å®ç° Filter æ¥å£ï¼Œå®ç° Filter æ–¹æ³•</li>
<li>æ·»åŠ @Configuration æ³¨è§£ï¼Œå°†è‡ªå®šä¹‰FilteråŠ å…¥è¿‡æ»¤é“¾</li>
</ul>
<pre><code class="language-java">public class MyFilter implements Filter

@Bean
public FilterRegistrationBean testFilterRegistration() {

    FilterRegistrationBean registration = new FilterRegistrationBean();
    registration.setFilter(new MyFilter());
    registration.addUrlPatterns(&quot;/*&quot;);
    registration.addInitParameter(&quot;paramName&quot;, &quot;paramValue&quot;);
    registration.setName(&quot;MyFilter&quot;);
    registration.setOrder(1);
    return registration;
}

</code></pre>
<h2><a class="header" href="#spring-web-mvcæ¡†æ¶" id="spring-web-mvcæ¡†æ¶">Spring Web MVCæ¡†æ¶</a></h2>
<p>ç›¸å…³çš„æ³¨è§£: @Controller or @RestController, @RequestMapping</p>
<h3><a class="header" href="#è‡ªåŠ¨é…ç½®springmvc" id="è‡ªåŠ¨é…ç½®springmvc">è‡ªåŠ¨é…ç½®Springmvc</a></h3>
<p>Spring boot å·²ç»è‡ªåŠ¨é…ç½®äº†å¦‚ä¸‹ç‰¹æ€§ï¼š</p>
<ul>
<li>Inclusion of <code>ContentNegotiatingViewResolver</code> and <code>BeanNameViewResolver</code> beans.</li>
<li>å¯¹é™æ€èµ„æºçš„æ”¯æŒï¼ŒåŒ…æ‹¬å¯¹WebJarsçš„æ”¯æŒ.</li>
<li>è‡ªåŠ¨æ³¨å†Œ Converter, GenericConverter, Formatter beans.</li>
<li>Support for <code>HttpMessageConverters</code> (see below).</li>
<li>è‡ªåŠ¨æ³¨å†Œ<code> MessageCodesResolver</code> (see below).</li>
<li>Static <code>index.html</code> support.</li>
<li>Custom Favicon support (see below).</li>
<li>Automatic use of a <code>ConfigurableWebBindingInitializer</code> bean (see below).</li>
</ul>
<p>å¦‚æœå¸Œæœ›æ·»åŠ é¢å¤–çš„mvcç‰¹æ€§ï¼ˆå¦‚ï¼šinterceptors, formatters, view controllers etc.ï¼‰ï¼Œåˆ›å»º@Configurationç±»ç»§æ‰¿WebMvcConfigurerAdapter(ç»§æ‰¿WebMvcConfigurer äº¦å¯è²Œä¼¼?å­˜ç–‘),ä½†æ˜¯ä¸èƒ½æœ‰@EnableWebMvcï¼Œä¾‹å¦‚ï¼šç»™appæ·»åŠ è·¨åŸŸè®¿é—®æ”¯æŒ</p>
<p>è§£å†³è·¨åŸŸé—®é¢˜:</p>
<pre><code class="language-java">@Configuration  
public class CorsConfig extends WebMvcConfigurerAdapter {  

    @Override  
    public void addCorsMappings(CorsRegistry registry) {  
        registry.addMapping(&quot;/**&quot;)  
                .allowedOrigins(&quot;*&quot;)  
                .allowCredentials(true)  
                .allowedMethods(&quot;OPTIONS&quot;, &quot;GET&quot;, &quot;POST&quot;, &quot;DELETE&quot;, &quot;PUT&quot;)
                .maxAge(3600);  
    }
}  
</code></pre>
<p>å¦‚æœå¸Œæœ›è‡ªå·±å®šåˆ¶<code>RequestMappingHandlerMapping</code>, <code>RequestMappingHandlerAdapter</code> or <code>ExceptionHandlerExceptionResolver</code>ï¼Œå¯ä»¥å£°æ˜ä¸€ä¸ª<code>WebMvcRegistrationsAdapter</code>å®ä¾‹æ¥æä¾›è¿™äº›ç»„ä»¶</p>
<p>å¦‚æœå¸Œæœ›å®Œå…¨æ§åˆ¶Springmvcï¼Œå¯ä»¥æä¾›è‡ªå·±çš„@Configrationç±»ï¼Œç”¨@EnableWebMvcæ ‡è®°</p>
<h3><a class="header" href="#httpæ¶ˆæ¯è½¬æ¢å™¨httpmessageconverters" id="httpæ¶ˆæ¯è½¬æ¢å™¨httpmessageconverters">httpæ¶ˆæ¯è½¬æ¢å™¨(HttpMessageConverters)</a></h3>
<p>springmvcä½¿ç”¨HttpMessageConvertersæ¥å£æ¥è½¬æ¢http requestå’Œresponseï¼Œæ¡†æ¶å·²ç»é»˜è®¤å®ç°äº†ä¸€äº›ç‰¹æ€§ï¼Œå¦‚ï¼šobjectè‡ªåŠ¨è½¬json(Jackson lib)æˆ–xml(Jackson lib, å¦‚æœæ²¡æœ‰Jackson, åˆ™Jaxb)ã€‚  Stringé»˜è®¤ä½¿ç”¨utf-8ç¼–ç ; </p>
<p>å¦‚æœéœ€è¦è‡ªå®šä¹‰æ¶ˆæ¯è½¬æ¢å™¨ï¼Œå¯ä»¥åˆ©ç”¨Spring bootçš„HttpMessageConvertersç±»ï¼š</p>
<pre><code class="language-java">@Configuration
public class MyConfiguration {

    @Bean
    public HttpMessageConverters customConverters() {
        HttpMessageConverter&lt;?&gt; additional = ...//è¿™äº›HttpMessageConverter ä¼šè¢«æ”¾å…¥HttpMessageConverters çš„ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œå‘ˆç°åœ¨ä¸Šä¸‹æ–‡ä¸­, é»˜è®¤çš„listä¼šè¢«è¦†ç›–
        HttpMessageConverter&lt;?&gt; another = ...
        return new HttpMessageConverters(additional, another);
    }

}
</code></pre>
<h3><a class="header" href="#messagecodesresolver" id="messagecodesresolver">MessageCodesResolver</a></h3>
<p>Spring bootä¼šä½¿ç”¨MessageCodesResolveræ¥ç”Ÿæˆerror codeï¼Œç¯å¢ƒå±æ€§<code>spring.mvc.message-codes-resolver.format</code> éœ€è¦é…ç½®ä¸º <code>PREFIX_ERROR_CODE</code> or <code>POSTFIX_ERROR_CODE</code>  , å…·ä½“å¯è®¾ç½®é‚£äº›å€¼, è§<code>DefaultMessageCodesResolver.Format</code>æšä¸¾ç±»</p>
<h3><a class="header" href="#é™æ€èµ„æº" id="é™æ€èµ„æº">é™æ€èµ„æº</a></h3>
<p>å­˜ç–‘, https://docs.spring.io/spring-boot/docs/2.0.2.RELEASE/reference/htmlsingle/#boot-features-spring-mvc-static-content</p>
<ul>
<li>
<p>Spring bootçš„è§„èŒƒä¸­ï¼Œé™æ€èµ„æºé»˜è®¤æ”¾åœ¨classpathä¸‹çš„ /static (or /public or /resources or /META-INF/resourcesï¼‰ï¼Œä½¿ç”¨ResourceHttpRequestHandler å¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ·»åŠ è‡ªå·±çš„WebMvcConfigurerAdapterè¦†ç›–addResourceHandlersæ–¹æ³•æ¥å®šåˆ¶è‡ªå·±çš„èµ„æºç›®å½•</p>
</li>
<li>
<p>æˆ–è€…ä½¿ç”¨environment propertyï¼š<code>spring.mvc.static-path-pattern=/resources/**</code> or <code>spring.resources.static-locations=# a list of directory locations</code>(å¦‚æœä½¿ç”¨åé¢è¿™ä¸ªå±æ€§ï¼Œindex.htmlå°†ä¼šä½¿ç”¨ä½ è‡ªå·±çš„ç›®å½•ä¸‹çš„index.html), é»˜è®¤ä¸‹, <code>spring.resources.static-locations=classpath:/META-INF/resources/,classpath:/resources/,classpath:/static/,classpath:/public/</code>, ä¼˜å…ˆçº§ä»ä»é«˜åˆ°ä½</p>
</li>
<li>
<p>åœ¨é»˜è®¤è§„èŒƒä¸­ï¼Œæœ‰ä¸€ä¸ªç›®å½•ï¼šclasspath: /webjars/**  æ˜¯ä¸º Webjars content ç•™çš„ã€‚æ‰€æœ‰/webjars/**ä¸­çš„èµ„æºå°†ä»jar æ–‡ä»¶ä¸­è¯»å–ï¼Œå¦‚æœä»–ä»¬ä»¥ç¬¦åˆWebjars è§„èŒƒçš„æ–¹å¼æ‰“åŒ…äº†çš„è¯ã€‚</p>
</li>
<li>
<p>ä¸è¦ä½¿ç”¨src/main/webappç›®å½•ï¼Œå¦‚æœåº”ç”¨è¢«æ‰“åŒ…æˆjaråŒ…ã€‚å› ä¸ºè¿™ä¸ªç›®å½•åªæœ‰åœ¨waråŒ…ä¸­æ‰ä¼šå·¥ä½œï¼Œè€Œä¸”ä¼šè¢«å¤§éƒ¨åˆ†æ„å»ºå·¥å…·å¿½ç•¥</p>
</li>
<li>
<p>å¯¹äºå¼•ç”¨ç¬¬ä¸‰æ–¹é™æ€èµ„æº, å¯ä»¥åšåˆ°ç‰ˆæœ¬æ— æ„ŸçŸ¥çš„æ•ˆæœ, æ¯”å¦‚ &quot;/webjars/jquery/jquery.min.js&quot; results in &quot;/webjars/jquery/x.y.z/jquery.min.js&quot;. where x.y.z is the Webjar version.éœ€è¦å¼•å…¥<code>webjars-locator-core </code>ä¾èµ–</p>
</li>
<li>
<p>ç‰ˆæœ¬æ— æ„ŸçŸ¥, è¿˜ä¸€ç§æ–¹æ³•</p>
<pre><code>spring.resources.chain.strategy.fixed.enabled=true
spring.resources.chain.strategy.fixed.paths=/js/lib/
spring.resources.chain.strategy.fixed.version=v12
</code></pre>
<p>ä½¿ç”¨ä»¥ä¸Šç­–ç•¥ï¼ŒJavaScriptæ¨¡å—åŠ è½½å™¨åŠ è½½&quot;/js/lib/&quot;ä¸‹çš„æ–‡ä»¶æ—¶ä¼šä½¿ç”¨ä¸€ä¸ªå›ºå®šçš„ç‰ˆæœ¬ç­–ç•¥&quot;/v12/js/lib/mymodule.js&quot;</p>
</li>
<li>
<p>é™æ€èµ„æºçš„ç¼“å­˜æ¸…é™¤</p>
<pre><code>spring.resources.chain.strategy.content.enabled=true
spring.resources.chain.strategy.content.paths=/**
</code></pre>
<p>åŸç†å®é™…ä¸Šæ˜¯å°†å†…å®¹hashæ·»åŠ åˆ°URLsä¸­ï¼Œæ¯”å¦‚<code>&lt;link href=&quot;/css/spring-2a2d595e6ed9a0b24f027f2b63b134d6.css&quot;/&gt;</code></p>
<p>æ³¨ å®ç°è¯¥åŠŸèƒ½çš„æ˜¯ResourceUrlEncodingFilterï¼Œå®ƒåœ¨æ¨¡æ¿è¿è¡ŒæœŸä¼šé‡å†™èµ„æºé“¾æ¥ï¼ŒThymeleafï¼ŒVelocityå’ŒFreeMarkerä¼šè‡ªåŠ¨é…ç½®è¯¥filterï¼ŒJSPéœ€è¦æ‰‹åŠ¨é…ç½®ã€‚å…¶ä»–æ¨¡æ¿å¼•æ“è¿˜æ²¡è‡ªåŠ¨æ”¯æŒï¼Œä¸è¿‡ä½ å¯ä»¥ä½¿ç”¨ResourceUrlProviderè‡ªå®šä¹‰æ¨¡å—å®æˆ–å¸®åŠ©ç±»</p>
</li>
</ul>
<h3><a class="header" href="#æ¬¢è¿é¡µ" id="æ¬¢è¿é¡µ">æ¬¢è¿é¡µ</a></h3>
<p>å…ˆæ‰¾ index.htmlåœ¨é™æ€èµ„æºç›®å½•ä¸­, æ²¡æ‰¾åˆ°ç„¶ååœ¨æ¨¡æ¿æ–‡ä»¶ä¸­æ‰¾index</p>
<h3><a class="header" href="#è‡ªå®šä¹‰ç½‘ç«™å›¾æ ‡" id="è‡ªå®šä¹‰ç½‘ç«™å›¾æ ‡">è‡ªå®šä¹‰ç½‘ç«™å›¾æ ‡</a></h3>
<p>Spring bootä¼šè‡ªåŠ¨æœå¯»ç½‘ç«™å›¾æ ‡<code>favicon.ico</code>ï¼Œåœ¨å¦‚ä¸‹ç›®å½•ï¼š</p>
<ul>
<li>é™æ€èµ„æºç›®å½•</li>
<li>classpathæ ¹ç›®å½•</li>
</ul>
<h3><a class="header" href="#è¯·æ±‚åŒ¹é…å’Œèµ„æºå¯¼èˆªpath-matching-and-content-negotiation" id="è¯·æ±‚åŒ¹é…å’Œèµ„æºå¯¼èˆªpath-matching-and-content-negotiation">è¯·æ±‚åŒ¹é…å’Œèµ„æºå¯¼èˆª(Path Matching and Content Negotiation)</a></h3>
<p>Spring MVCå¯ä»¥é€šè¿‡æŸ¥çœ‹è¯·æ±‚è·¯å¾„å¹¶å°†å…¶ä¸åº”ç”¨ç¨‹åºä¸­å®šä¹‰çš„æ˜ å°„è¿›è¡ŒåŒ¹é…ï¼Œå°†ä¼ å…¥çš„HTTPè¯·æ±‚æ˜ å°„åˆ°å¤„ç†ç¨‹åº, æ¯”å¦‚ï¼š @GetMapping(&quot;/projects/spring-boot&quot;)...</p>
<p>springbooté»˜è®¤ç¦ç”¨åç¼€åŒ¹é…ï¼Œ æ¯”å¦‚è¯·æ±‚è·¯å¾„â€œ&quot;GET /projects/spring-boot.json&quot;â€ æ— æ³•åŒ¹é…åˆ° @GetMapping(&quot;/projects/spring-boot&quot;)</p>
<p>å­˜ç–‘ï¼Œ https://docs.spring.io/spring-boot/docs/2.0.2.RELEASE/reference/htmlsingle/#boot-features-spring-mvc-pathmatch</p>
<h3><a class="header" href="#configurablewebbindinginitializer" id="configurablewebbindinginitializer">ConfigurableWebBindingInitializer</a></h3>
<p>Spring MVCä½¿ç”¨WebBindingInitializerä¸ºæ¯ä¸ªç‰¹æ®Šçš„è¯·æ±‚åˆå§‹åŒ–ç›¸åº”çš„WebDataBinderï¼Œå¦‚æœä½ åˆ›å»ºè‡ªå·±çš„ConfigurableWebBindingInitializer @Beanï¼ŒSpring Bootä¼šè‡ªåŠ¨é…ç½®Spring MVCä½¿ç”¨å®ƒ</p>
<h3><a class="header" href="#æ¨¡æ¿å¼•æ“" id="æ¨¡æ¿å¼•æ“">æ¨¡æ¿å¼•æ“</a></h3>
<p>Springbootä¸ºè¿™äº›template engineæä¾›è‡ªåŠ¨é…ç½®ï¼š</p>
<pre><code>FreeMarker
Groovy
Thymeleaf
Mustache
</code></pre>
<p>æ¨¡æ¿æ–‡ä»¶é»˜è®¤æ”¾ç½®åœ¨src/main/resources/templates</p>
<h3><a class="header" href="#å…¨å±€å¼‚å¸¸å¤„ç†" id="å…¨å±€å¼‚å¸¸å¤„ç†">å…¨å±€å¼‚å¸¸å¤„ç†</a></h3>
<p>Springbooté»˜è®¤æä¾›äº†ä¸€ä¸ªé”™è¯¯å¤„ç†æœºåˆ¶ï¼Œæ‰€æœ‰çš„å¼‚å¸¸ä¼šåŒ¹é…/error. ä½†æ˜¯è¿™æ˜æ˜¾ä¸å¤Ÿã€‚æˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰ã€‚</p>
<p>ä¸ºäº†å®Œå…¨å–ä»£é»˜è®¤è®¾ç½®, å¯ä»¥å®ç°<code>ErrorController</code>æ¥å£, å¹¶å°†è¿™ä¸ªbeanæ³¨å†Œ; æˆ–è€…ç›´æ¥æ³¨å†Œä¸€ä¸ª <code>ErrorAttributes </code>ç±»å‹çš„bean;</p>
<p>ä¸€ç§æ–¹æ³•æ˜¯ï¼šåˆ›å»ºcontrollerå®ç°ErrorControlleræ¥å£ï¼›BasicErrorControllerå¯ä»¥ä½œä¸ºerrorcontrollerçš„åŸºç±»ï¼Œæ·»åŠ ä¸€ä¸ªæ–¹æ³•ç”¨@requestmappongï¼ˆproduces =xxxï¼‰æ ‡è®°ï¼›è¿™ç§æ–¹æ³•å°¤å…¶åœ¨è¿™ç§æƒ…å†µä¸‹æœ‰ç”¨ï¼šå½“ä½ æƒ³ä¸ºæ–°çš„content-typeï¼ˆé»˜è®¤çš„ä¸€èˆ¬æ˜¯text/htmlï¼‰æ·»åŠ ä¸€ä¸ªHandler</p>
<p>å¦ç§æ–¹æ³•ï¼šï¼ˆæ¨èï¼‰</p>
<h4><a class="header" href="#å¦‚æœè¿”å›è§†å›¾" id="å¦‚æœè¿”å›è§†å›¾">å¦‚æœè¿”å›è§†å›¾</a></h4>
<pre><code class="language-java">/**
 * å…¨å±€å¼‚å¸¸å¤„ç†ç±»
 *
 * @version: 1.0.0
 * @author: è‚–é›¨
 * @date: 2017å¹´8æœˆ23æ—¥ ä¸‹åˆ11:32:23
 */
@ControllerAdvice
public class ExceptionAdvice {

    private static final String DEFAULT_ERROR_VIEW = &quot;error&quot;;
    
    @ExceptionHandler(Exception.class)
    public ModelAndView defaultErrorHandler(HttpServletRequest req, Exception e) {
        ModelAndView mav = new ModelAndView();
        mav.addObject(&quot;exception&quot;, e);
        mav.addObject(&quot;url&quot;, req.getRequestURL());
        mav.setViewName(DEFAULT_ERROR_VIEW);
        return mav;
    }
    
    //åé¢å¯ä»¥ç»§ç»­æ·»åŠ ï¼ŒåŒ¹é…ä¸åŒå¼‚å¸¸
}

</code></pre>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head lang=&quot;en&quot;&gt;
    &lt;meta charset=&quot;UTF-8&quot; /&gt;
    &lt;title&gt;ç»Ÿä¸€å¼‚å¸¸å¤„ç†&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Error Handler&lt;/h1&gt;
    &lt;div th:text=&quot;${url}&quot;&gt;&lt;/div&gt;
    &lt;div th:text=&quot;${exception.message}&quot;&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h4><a class="header" href="#å¦‚æœè¿”å›json" id="å¦‚æœè¿”å›json">å¦‚æœè¿”å›json</a></h4>
<pre><code class="language-java">@ControllerAdvice(basePackageClasses = FooController.class)//basePackageClasseså±æ€§è¡¨ç¤ºæœåŠ¡ç‰¹å®šçš„controller
public class FooControllerAdvice extends ResponseEntityExceptionHandler {

    @ExceptionHandler(YourException.class)// ä¸ºç‰¹å®šçš„exceptionæœåŠ¡
    @ResponseBody
    ResponseEntity&lt;?&gt; handleControllerException(HttpServletRequest request, Throwable ex) {
        HttpStatus status = getStatus(request);
        return new ResponseEntity&lt;&gt;(new CustomErrorType(status.value(), ex.getMessage()), status);
    }

    private HttpStatus getStatus(HttpServletRequest request) {
        Integer statusCode = (Integer) request.getAttribute(&quot;javax.servlet.error.status_code&quot;);
        if (statusCode == null) {
            return HttpStatus.INTERNAL_SERVER_ERROR;
        }
        return HttpStatus.valueOf(statusCode);
    }

}
</code></pre>
<h4><a class="header" href="#å®šåˆ¶è‡ªå·±çš„é”™è¯¯é¡µé¢" id="å®šåˆ¶è‡ªå·±çš„é”™è¯¯é¡µé¢">å®šåˆ¶è‡ªå·±çš„é”™è¯¯é¡µé¢</a></h4>
<p>æ ¹æ®è¿”å›çš„ error code åŒ¹é…åˆ°ä¸åŒé¡µé¢</p>
<p>ï¼ˆåŒ¹é…åˆ°404ï¼‰</p>
<pre><code>src/
+- main/
    +- java/
    |   + &lt;source code&gt;
    +- resources/
        +- public/
            +- error/
            |   +- 404.html
            +- &lt;other public assets&gt;
</code></pre>
<p>ï¼ˆåŒ¹é…æ‰€æœ‰ä»¥5å¼€å¤´çš„ error codeï¼‰</p>
<pre><code>src/
+- main/
    +- java/
    |   + &lt;source code&gt;
    +- resources/
        +- templates/
            +- error/
            |   +- 5xx.ftl
            +- &lt;other templates&gt;
</code></pre>
<p>å¯¹äºæ›´å¤æ‚çš„æƒ…å†µï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªbeanå®ç°ErrorViewResolveræ¥å£ï¼š</p>
<pre><code class="language-java">public class MyErrorViewResolver implements ErrorViewResolver {

    @Override
    public ModelAndView resolveErrorView(HttpServletRequest request, HttpStatus status, Map&lt;String, Object&gt; model) {
        // Use the request or status to optionally return a ModelAndView
        return ...
    }

}
</code></pre>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨Spring MVCç‰¹æ€§ï¼Œæ¯”å¦‚@ExceptionHandleræ–¹æ³•å’Œ@ControllerAdviceï¼ŒErrorControllerå°†å¤„ç†æ‰€æœ‰æœªå¤„ç†çš„å¼‚å¸¸</p>
<p>å­˜ç–‘ï¼Œ https://docs.spring.io/spring-boot/docs/2.0.2.RELEASE/reference/htmlsingle/#boot-features-error-handling-custom-error-pages</p>
<h4><a class="header" href="#ä¸ä½¿ç”¨springmvc" id="ä¸ä½¿ç”¨springmvc">ä¸ä½¿ç”¨springmvc</a></h4>
<p>ä½†æ˜¯ï¼Œå¦‚æœä¸ç”¨Springmvcï¼Œè¯¥å¦‚ä½•åŒ¹é…error pageså‘¢ ï¼Œé€šè¿‡ErrorPageRegistraræ¥å£ç›´æ¥æ³¨å†ŒErrorPages</p>
<pre><code class="language-java">@Bean
public ErrorPageRegistrar errorPageRegistrar(){
    return new MyErrorPageRegistrar();
}

// ...

private static class MyErrorPageRegistrar implements ErrorPageRegistrar {

    @Override
    public void registerErrorPages(ErrorPageRegistry registry) {
        registry.addErrorPages(new ErrorPage(HttpStatus.BAD_REQUEST, &quot;/400&quot;));
    }

}
</code></pre>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœä½ æ³¨å†Œä¸€ä¸ªErrorPageï¼Œè¯¥é¡µé¢éœ€è¦è¢«ä¸€ä¸ªFilterå¤„ç†ï¼ˆåœ¨ä¸€äº›éSpring webæ¡†æ¶ä¸­å¾ˆå¸¸è§ï¼Œæ¯”å¦‚Jerseyï¼ŒWicketï¼‰ï¼Œé‚£ä¹ˆè¯¥Filteréœ€è¦æ˜ç¡®æ³¨å†Œä¸ºä¸€ä¸ªERRORåˆ†å‘å™¨ï¼ˆdispatcherï¼‰ï¼Œå¦‚ï¼š</p>
<pre><code class="language-java">@Bean
public FilterRegistrationBean myFilter() {
    FilterRegistrationBean registration = new FilterRegistrationBean();
    registration.setFilter(new MyFilter());
    ...
    registration.setDispatcherTypes(EnumSet.allOf(DispatcherType.class));
    return registration;
}
</code></pre>
<h3><a class="header" href="#é…ç½®å…è®¸è·¨åŸŸè®¿é—®" id="é…ç½®å…è®¸è·¨åŸŸè®¿é—®">é…ç½®å…è®¸è·¨åŸŸè®¿é—®</a></h3>
<p>åªéœ€è¦åœ¨Spring Bootåº”ç”¨çš„controlleræ–¹æ³•ä¸Šæ³¨è§£@CrossOriginï¼Œå¹¶æ·»åŠ CORSé…ç½®ã€‚é€šè¿‡æ³¨å†Œä¸€ä¸ªè‡ªå®šä¹‰addCorsMappings(CorsRegistry)æ–¹æ³•çš„WebMvcConfigurer beanå¯ä»¥æŒ‡å®šå…¨å±€CORSé…ç½®</p>
<pre><code class="language-java">@Configuration  
public class CorsConfig extends WebMvcConfigurerAdapter {  

    @Override  
    public void addCorsMappings(CorsRegistry registry) {  
        registry.addMapping(&quot;/**&quot;)  
                .allowedOrigins(&quot;*&quot;)  
                .allowCredentials(true)  
                .allowedMethods(&quot;OPTIONS&quot;, &quot;GET&quot;, &quot;POST&quot;, &quot;DELETE&quot;, &quot;PUT&quot;)
                .maxAge(3600);  
    }
}  

</code></pre>
<p>æˆ–è€…ï¼š</p>
<pre><code class="language-java">@Configuration//æ ‡æ˜è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»
public class MyConfiguration {

    @Bean//@beanè¡¨ç¤ºè¿”å›å€¼è¢«Springç®¡ç†
    public WebMvcConfigurer corsConfigurer() {
        return new WebMvcConfigurerAdapter() {
            @Override
            public void addCorsMappings(CorsRegistry registry) {
                registry.addMapping(&quot;/api/**&quot;);
            }
        };
    }
}
</code></pre>
<h2><a class="header" href="#spring-webflux-framework" id="spring-webflux-framework">Spring WebFlux Framework</a></h2>
<p>https://docs.spring.io/spring-boot/docs/2.0.2.RELEASE/reference/htmlsingle/#boot-features-webflux</p>
<h2><a class="header" href="#jax-rs-and-jersey" id="jax-rs-and-jersey">JAX-RS and Jersey</a></h2>
<p>https://docs.spring.io/spring-boot/docs/1.5.6.RELEASE/reference/htmlsingle/#boot-features-jersey</p>
<h2><a class="header" href="#åµŒå…¥å¼servletå®¹å™¨" id="åµŒå…¥å¼servletå®¹å™¨">åµŒå…¥å¼servletå®¹å™¨</a></h2>
<p>Springbootå†…åµŒ Tomcat, Jetty, and Undertow serversï¼Œåªéœ€è¦å¼•å…¥åˆé€‚çš„Starterè·å–ä¸€ä¸ªå®Œå…¨é…ç½®å¥½çš„å®ä¾‹å³å¯ï¼Œå†…åµŒæœåŠ¡å™¨é»˜è®¤ç›‘å¬8080ç«¯å£çš„HTTPè¯·æ±‚</p>
<p>å¦‚æœä½¿ç”¨çš„å†…åµŒserveræ˜¯Tomcatï¼Œéœ€è¦è‡ªå®šä¹‰tmpwatché…ç½® or è®¾ç½®server.tomcat.basedir</p>
<h3><a class="header" href="#è‡ªå®šä¹‰å†…åµŒå®¹å™¨" id="è‡ªå®šä¹‰å†…åµŒå®¹å™¨">è‡ªå®šä¹‰å†…åµŒå®¹å™¨</a></h3>
<p>https://docs.spring.io/spring-boot/docs/2.0.2.RELEASE/reference/htmlsingle/#boot-features-customizing-embedded-containers</p>
<p>é€šè¿‡ç¨‹åºçš„æ–¹å¼å®šåˆ¶ï¼šhttps://docs.spring.io/spring-boot/docs/2.0.2.RELEASE/reference/htmlsingle/#boot-features-programmatic-embedded-container-customization</p>
<h3><a class="header" href="#servlets-filters-and-listeners" id="servlets-filters-and-listeners">Servlets, Filters, and listeners</a></h3>
<p>æ³¨å†ŒServlets, Filters, and listenersï¼Œå¯ä»¥æœ‰å¦‚ä¸‹æ–¹æ³•ï¼š</p>
<ul>
<li>ä½¿ç”¨ Spring beans</li>
<li>é€šè¿‡æ‰«æ servlet ç»„ä»¶</li>
</ul>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœcontextåªåŒ…æ‹¬ä¸€ä¸ªservletï¼Œå°†ä¼šåŒ¹é… /, å¦‚æœæœ‰å¤šä¸ªservlet beanï¼Œbean nameå°†ä¼šä½œä¸ºå‰ç¼€ï¼Œfilterså°†ä¼šåŒ¹é… /*</p>
<p>å¦‚æœè¿™äº›æƒ¯ä¾‹æ— æ³•æ»¡è¶³éœ€æ±‚ï¼Œ<code>ServletRegistrationBean</code>, <code>FilterRegistrationBean</code> and <code>ServletListenerRegistrationBean</code> classes å¯ä»¥æä¾›æ›´å®Œå…¨çš„æ§åˆ¶</p>
<p>æ‰«æServlets, Filterså’Œlistenersï¼š</p>
<p>å½“ä½¿ç”¨ä¸€ä¸ªå†…åµŒå®¹å™¨æ—¶ï¼Œé€šè¿‡@ServletComponentScanå¯ä»¥å¯ç”¨å¯¹æ³¨è§£@WebServletï¼Œ@WebFilterå’Œ@WebListenerç±»çš„è‡ªåŠ¨æ³¨å†Œã€‚</p>
<h3><a class="header" href="#servletä¸Šä¸‹æ–‡åˆå§‹åŒ–" id="servletä¸Šä¸‹æ–‡åˆå§‹åŒ–">servletä¸Šä¸‹æ–‡åˆå§‹åŒ–</a></h3>
<p>å†…åµŒçš„servletå®¹å™¨ä¸ä¼šæ‰§è¡ŒServlet 3.0+ javax.servlet.ServletContainerInitializeræ¥å£ï¼Œæˆ–è€…Springâ€™s org.springframework.web.WebApplicationInitializeræ¥å£ï¼›è¿™æ˜¯æœ‰æ„çš„è®¾è®¡ï¼Œä¸ºçš„æ˜¯é˜²æ­¢è¢«è®¾è®¡åœ¨warä¸­è¿è¡Œçš„ç¬¬ä¸‰æ–¹åº“é˜»æ–­Springbootçš„è¿è¡Œï¼›</p>
<p>å¦‚æœå¸Œæœ›åˆå§‹åŒ–ï¼Œä½¿ç”¨è¿™ç§æ–¹æ³•ï¼š</p>
<p>æ³¨å†Œä¸€ä¸ªbeanï¼Œå®ç°<code>org.springframework.boot.context.embedded.ServletContextInitializer</code>æ¥å£ï¼Œ onStartupæ–¹æ³•å¯ä»¥è·å–ServletContextï¼Œå¦‚æœéœ€è¦çš„è¯å¯ä»¥è½»æ¾ç”¨æ¥é€‚é…ä¸€ä¸ªå·²å­˜åœ¨çš„WebApplicationInitializer</p>
<h3><a class="header" href="#å¯¹jspçš„é™åˆ¶" id="å¯¹jspçš„é™åˆ¶">å¯¹jspçš„é™åˆ¶</a></h3>
<p>å½“ä½¿ç”¨å†…åµŒservletå®¹å™¨è¿è¡ŒSpring Bootåº”ç”¨æ—¶ï¼ˆå¹¶æ‰“åŒ…æˆä¸€ä¸ªå¯æ‰§è¡Œçš„å­˜æ¡£archiveï¼‰ï¼Œå®¹å™¨å¯¹JSPçš„æ”¯æŒæœ‰ä¸€äº›é™åˆ¶ï¼š</p>
<ul>
<li>
<p>Tomcatåªæ”¯æŒwarçš„æ‰“åŒ…æ–¹å¼ï¼Œä¸æ”¯æŒå¯æ‰§è¡Œjarã€‚</p>
</li>
<li>
<p>Jettyåªæ”¯æŒwarçš„æ‰“åŒ…æ–¹å¼ã€‚</p>
</li>
<li>
<p>Undertowä¸æ”¯æŒJSPsã€‚</p>
</li>
<li>
<p>åˆ›å»ºçš„è‡ªå®šä¹‰error.jspé¡µé¢ä¸ä¼šè¦†ç›–é»˜è®¤çš„error handlingè§†å›¾ã€‚</p>
</li>
</ul>
<p>jspå®ä¾‹ï¼šhttps://github.com/spring-projects/spring-boot/blob/v2.0.2.RELEASE/spring-boot-samples/spring-boot-sample-web-jsp/src/main/resources/application.properties</p>
<h1><a class="header" href="#å®‰å…¨security" id="å®‰å…¨security">å®‰å…¨(Security)</a></h1>
<p>å¦‚æœå¼•å…¥äº†  Spring Security ä¾èµ–ï¼Œ appé»˜è®¤å°±è¢«ä¿æŠ¤äº†ï¼Œ æ·»åŠ æ–¹æ³•çº§åˆ«çš„å®‰å…¨è‡ªå®šä¹‰è®¾ç½®ä½¿ç”¨@EnableGlobalMethodSecurity</p>
<p>é»˜è®¤çš„ UserDetailsService æä¾›ä¸€ä¸ª user å®ä¾‹ï¼Œ  nameä¸ºâ€œuserâ€ï¼Œ passwordä¸ºéšæœºï¼Œ æ‰“å°åœ¨infoçº§åˆ«æ—¥å¿—ï¼Œ ç¡®ä¿org.springframework.boot.autoconfigure.securityçš„æ—¥å¿—çº§åˆ«ä¸ºinfoï¼Œ å¯ä»¥é€šè¿‡ <code>spring.security.user.name </code>å’Œ<code> spring.security.user.password</code>ä¿®æ”¹é»˜è®¤çš„username, password</p>
<h2><a class="header" href="#oauth2" id="oauth2">OAuth2</a></h2>
<p>å¦‚æœæ·»åŠ äº†spring-security-oauth2ä¾èµ–ï¼Œä½ å¯ä»¥åˆ©ç”¨è‡ªåŠ¨é…ç½®ç®€åŒ–è®¤è¯ï¼ˆAuthorizationï¼‰æˆ–èµ„æºæœåŠ¡å™¨ï¼ˆResource Serverï¼‰çš„è®¾ç½®</p>
<h1><a class="header" href="#å®è·µ" id="å®è·µ">å®è·µ</a></h1>
<h2><a class="header" href="#æ¥å£å¼€å‘" id="æ¥å£å¼€å‘">æ¥å£å¼€å‘</a></h2>
<ul>
<li>@restcontrolleræ³¨è§£ç›¸å½“äº@controller+@responsebody</li>
<li>ä½¿ç”¨äº†æ¨¡æ¿å¼•æ“å°±ä¸è¦ç”¨@restcontrolleräº†</li>
<li>@getmappingï¼Œ@postmappingã€‚ã€‚ã€‚</li>
</ul>
<h2><a class="header" href="#ä½¿ç”¨æ¨¡æ¿å¼•æ“" id="ä½¿ç”¨æ¨¡æ¿å¼•æ“">ä½¿ç”¨æ¨¡æ¿å¼•æ“</a></h2>
<h3><a class="header" href="#themeleaf" id="themeleaf">themeleaf</a></h3>
<ul>
<li>ä¾èµ–spring-boot-starter-thymeleaf</li>
</ul>
<h3><a class="header" href="#freemarker" id="freemarker">freemarker</a></h3>
<ul>
<li>ä¾èµ–ï¼šspring-boot-starter-freemarker</li>
</ul>
<h3><a class="header" href="#velocity" id="velocity">velocity</a></h3>
<ul>
<li>ä¾èµ–ï¼šspring-boot-starter-velocity</li>
</ul>
<h2><a class="header" href="#é›†æˆswagger2" id="é›†æˆswagger2">é›†æˆswagger2</a></h2>
<ul>
<li>å¼•å…¥ä¾èµ– springfox-swagger2 https://mvnrepository.com/artifact/io.springfox/springfox-swagger2</li>
<li>å„ä¸ªæ“ä½œæ¥å£ä¸Šï¼š@ApiOperationï¼Œ@ApiImplicitParam</li>
<li>swagger2é…ç½®ç±»ï¼Œå’ŒAPPå¯åŠ¨ç±»åŒçº§ï¼Œ@Configurationï¼Œ@EnableSwagger2</li>
<li>è®¿é—®ï¼šhttp://localhost:8080/swagger-ui.html</li>
<li>é…ç½®mvcæ—¶å€™ï¼Œ å¦‚æœç»§æ‰¿äº†WebMvcConfigurationSupportï¼Œ éœ€è¦é‡æ–°æ³¨å…¥èµ„æºæ–‡ä»¶ï¼Œ å¦åˆ™è®¿é—®ä¸åˆ°swagger-ui.html;(<a href="https://blog.csdn.net/zjcjava/article/details/78064264">ref</a>)</li>
</ul>
<h2><a class="header" href="#ç»Ÿä¸€å¼‚å¸¸å¤„ç†" id="ç»Ÿä¸€å¼‚å¸¸å¤„ç†">ç»Ÿä¸€å¼‚å¸¸å¤„ç†</a></h2>
<ul>
<li>åˆ›å»º@ControllerAdviceç±»ï¼Œ@ExceptionHandler(xxxException.class)æ–¹æ³•</li>
</ul>
<h2><a class="header" href="#ä½¿ç”¨jdbctemplate" id="ä½¿ç”¨jdbctemplate">ä½¿ç”¨JdbcTemplate</a></h2>
<ul>
<li>ä¾èµ–ï¼šspring-boot-starter-jdbc</li>
<li>JdbcTemplateé€šè¿‡@autowiredæ³¨å…¥ç›´æ¥ä½¿ç”¨</li>
</ul>
<h2><a class="header" href="#ä½¿ç”¨spring-data-jpa" id="ä½¿ç”¨spring-data-jpa">ä½¿ç”¨Spring-data-jpa</a></h2>
<ul>
<li>ä¾èµ–spring-boot-starter-data-jpa</li>
<li>é€šè¿‡envå±æ€§é…ç½®è¡¨ç”Ÿæˆç­–ç•¥ï¼šspring.jpa.properties.hibernate.hbm2ddl.auto=create-drop</li>
<li>åˆ›å»ºxxxRepositoryæ¥å£ç»§æ‰¿JpaRepositoryæ¥å£ï¼Œæ–¹æ³•æ— éœ€å®ç°ï¼Œç‰¹æ®Šçš„å¯é€šè¿‡@Query(&quot;from User u where u.name=:name&quot;)æ³¨è§£</li>
<li>é€šè¿‡@Autowiredæ³¨å…¥ç›´æ¥ä½¿ç”¨</li>
<li>@Entityæ ‡æ³¨å®ä½“ï¼Œå’Œè¡¨åå¯¹åº”ï¼›@Columnæ ‡æ³¨å­—æ®µ</li>
</ul>
<pre><code class="language-properties">spring.datasource.url=jdbc:mysql://localhost:3306/test
spring.datasource.username=root
spring.datasource.password=root
spring.datasource.driver-class-name=com.mysql.jdbc.Driver

spring.jpa.properties.hibernate.hbm2ddl.auto=update # ç¬¬ä¸€æ¬¡åŠ è½½ hibernate æ—¶æ ¹æ® model ç±»ä¼šè‡ªåŠ¨å»ºç«‹èµ·è¡¨çš„ç»“æ„ï¼ˆå‰ææ˜¯å…ˆå»ºç«‹å¥½æ•°æ®åº“ï¼‰ï¼Œä»¥ååŠ è½½ hibernate æ—¶æ ¹æ® model ç±»è‡ªåŠ¨æ›´æ–°è¡¨ç»“æ„
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL5InnoDBDialect # å­˜å‚¨å¼•æ“ innodb
spring.jpa.show-sql= true

</code></pre>
<h2><a class="header" href="#å¤šæ•°æ®æºé…ç½®" id="å¤šæ•°æ®æºé…ç½®">å¤šæ•°æ®æºé…ç½®</a></h2>
<p>é¦–å…ˆéœ€è¦é…ç½®æ–‡ä»¶ä¸­ä¸¤ä¸ªæ•°æ®æºçš„è¿æ¥ä¿¡æ¯</p>
<h3><a class="header" href="#mybatis" id="mybatis">mybatis</a></h3>
<p>https://github.com/imcloudfloating/rw-separate-spring-boot-starter, https://www.cnblogs.com/cloudfloating/archive/2019/09/17/11536531.html //todo</p>
<p>https://www.cnblogs.com/wuyoucao/p/10965903.html æ•°æ®åº“é›†ç¾¤</p>
<p>https://www.luvnaxx.com/post/%E6%8A%80/spring-boot/multiple-data-source/</p>
<h3><a class="header" href="#jdbctemplate" id="jdbctemplate">JdbcTemplate</a></h3>
<ul>
<li>æ•°æ®æº@Configurationç±»</li>
<li>æ³¨å†Œæ•°æ®æºï¼Œ@Bean(name = &quot;secondaryDataSource&quot;)æ³¨è§£ æ³¨å†Œbeanï¼ŒnameæŒ‡å®šbeanåå­—ï¼›@PrimaryæŒ‡å®šé»˜è®¤æ•°æ®æºï¼›@ConfigurationPropertiesåŒ¹é…æŒ‡å®šå±æ€§</li>
<li>æ³¨å†Œjdbctemplateï¼Œ@Bean(name = &quot;primaryJdbcTemplate&quot;)</li>
<li>@Autowired+@Qualifier(&quot;primaryJdbcTemplate&quot;)æ³¨å…¥ä½¿ç”¨</li>
</ul>
<h3><a class="header" href="#spring-data-jpa" id="spring-data-jpa">Spring-data-jpa</a></h3>
<ul>
<li>æ•°æ®æº@Configurationç±»</li>
<li>æ•°æ®æºæ³¨å†Œ</li>
</ul>
<p>å¾…å®Œæˆ</p>
<p>##ä½¿ç”¨redisä½œä¸ºæ•°æ®åº“</p>
<ul>
<li>ä¾èµ–ï¼šspring-boot-starter-redis</li>
<li>æ·»åŠ é…ç½®æ–‡ä»¶ </li>
</ul>
<p>Spring Boot 1.0 é»˜è®¤ä½¿ç”¨çš„æ˜¯ Jedis å®¢æˆ·ç«¯ï¼Œ2.0 æ›¿æ¢æˆ Lettuce</p>
<pre><code class="language-props"># Redisæ•°æ®åº“ç´¢å¼•ï¼ˆé»˜è®¤ä¸º0ï¼‰
spring.redis.database=0  
# RedisæœåŠ¡å™¨åœ°å€
spring.redis.host=localhost
# RedisæœåŠ¡å™¨è¿æ¥ç«¯å£
spring.redis.port=6379  
# RedisæœåŠ¡å™¨è¿æ¥å¯†ç ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰
spring.redis.password=
# è¿æ¥æ± æœ€å¤§è¿æ¥æ•°ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰ é»˜è®¤ 8
spring.redis.lettuce.pool.max-active=8
# è¿æ¥æ± æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰ é»˜è®¤ -1
spring.redis.lettuce.pool.max-wait=-1
# è¿æ¥æ± ä¸­çš„æœ€å¤§ç©ºé—²è¿æ¥ é»˜è®¤ 8
spring.redis.lettuce.pool.max-idle=8
# è¿æ¥æ± ä¸­çš„æœ€å°ç©ºé—²è¿æ¥ é»˜è®¤ 0
spring.redis.lettuce.pool.min-idle=0
</code></pre>
<h2><a class="header" href="#asyncå¼‚æ­¥è°ƒç”¨" id="asyncå¼‚æ­¥è°ƒç”¨">@Asyncå¼‚æ­¥è°ƒç”¨</a></h2>
<ul>
<li>ä»»åŠ¡ç±»@Component</li>
<li>æ–¹æ³•ä¸Š@Async</li>
<li>è¿”å›å€¼Future<String>ï¼ŒAsyncResult&lt;&gt;</li>
</ul>
<h2><a class="header" href="#log4jæ”¯æŒ" id="log4jæ”¯æŒ">log4jæ”¯æŒ</a></h2>
<ul>
<li>
<p>ä¾èµ–ï¼šspring-boot-starter-log4j</p>
</li>
<li>
<p>æ’é™¤æ‰Springbootè‡ªå·±çš„æ—¥å¿—ç³»ç»Ÿï¼šlogback</p>
<pre><code>  &lt;dependency&gt;
  	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  	&lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;
  	&lt;exclusions&gt;
  		&lt;exclusion&gt;
  			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  			&lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;
  		&lt;/exclusion&gt;
  	&lt;/exclusions&gt;
  &lt;/dependency&gt;
</code></pre>
</li>
<li>
<p>propertiesæ–‡ä»¶</p>
<pre><code>  # LOG4Jé…ç½®
  log4j.rootCategory=INFO, stdout, file, errorfile
  log4j.category.com.didispace=DEBUG, didifile # com.didispaceåŒ…ä¸‹
  log4j.logger.error=errorfile

  # æ§åˆ¶å°è¾“å‡º
  log4j.appender.stdout=org.apache.log4j.ConsoleAppender
  log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
  log4j.appender.stdout.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss,SSS} %5p %c{1}:%L - %m%n

  # rootæ—¥å¿—è¾“å‡º
  log4j.appender.file=org.apache.log4j.DailyRollingFileAppender # æŒ‰å¤©åˆ†æ–‡ä»¶
  log4j.appender.file.file=logs/all.log
  log4j.appender.file.DatePattern='.'yyyy-MM-dd
  log4j.appender.file.layout=org.apache.log4j.PatternLayout
  log4j.appender.file.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss,SSS} %5p %c{1}:%L - %m%n

  # erroræ—¥å¿—è¾“å‡º
  log4j.appender.errorfile=org.apache.log4j.DailyRollingFileAppender
  log4j.appender.errorfile.file=logs/error.log
  log4j.appender.errorfile.DatePattern='.'yyyy-MM-dd
  log4j.appender.errorfile.Threshold = ERROR
  log4j.appender.errorfile.layout=org.apache.log4j.PatternLayout
  log4j.appender.errorfile.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss,SSS} %5p %c{1}:%L - %m%n

  # com.didispaceä¸‹çš„æ—¥å¿—è¾“å‡ºï¼Œ
  log4j.appender.didifile=org.apache.log4j.DailyRollingFileAppender
  log4j.appender.didifile.file=logs/my.log
  log4j.appender.didifile.DatePattern='.'yyyy-MM-dd
  log4j.appender.didifile.layout=org.apache.log4j.PatternLayout
  log4j.appender.didifile.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss,SSS} %5p %c{1}:%L ---- %m%n
</code></pre>
</li>
<li>
<p>ä½¿ç”¨</p>
<pre><code>  private Logger logger = Logger.getLogger(getClass());
</code></pre>
</li>
</ul>
<h2><a class="header" href="#å¤šç¯å¢ƒä¸‹çš„æ—¥å¿—é…ç½®" id="å¤šç¯å¢ƒä¸‹çš„æ—¥å¿—é…ç½®">å¤šç¯å¢ƒä¸‹çš„æ—¥å¿—é…ç½®</a></h2>
<ul>
<li>log4j.propertiesä¸­ä½¿ç”¨å ä½ç¬¦${xxx}</li>
<li>åœ¨ä¸åŒçš„application-profiles.propertiesä¸­æŒ‡å®šå ä½ç¬¦çš„å€¼</li>
<li>å‘½ä»¤è¡Œå¯åŠ¨ï¼šjava -jar xxx.jar --spring.profiles.active=prodï¼›æˆ–è€…ç›´æ¥æ›´æ”¹application.propertiesä¸­çš„spring.profiles.active</li>
</ul>
<h2><a class="header" href="#aopç»Ÿä¸€å¤„ç†è¯·æ±‚æ—¥å¿—" id="aopç»Ÿä¸€å¤„ç†è¯·æ±‚æ—¥å¿—">aopç»Ÿä¸€å¤„ç†è¯·æ±‚æ—¥å¿—</a></h2>
<ul>
<li>ä¾èµ–ï¼šspring-boot-starter-aop</li>
<li>éœ€è¦ä½¿ç”¨CGLIBæ¥å®ç°AOPçš„æ—¶å€™ï¼Œéœ€è¦é…ç½®spring.aop.proxy-target-class=trueï¼Œä¸ç„¶é»˜è®¤ä½¿ç”¨çš„æ˜¯æ ‡å‡†Javaçš„å®ç°</li>
<li>@Order(i)æ ‡æ˜åˆ‡é¢ç±»çš„ä¼˜å…ˆçº§ï¼Œiè¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼›@Componentï¼Œ@Aspect</li>
</ul>
<h2><a class="header" href="#ç¼“å­˜æ”¯æŒ" id="ç¼“å­˜æ”¯æŒ">ç¼“å­˜æ”¯æŒ</a></h2>
<h2><a class="header" href="#æ¶ˆæ¯æœåŠ¡" id="æ¶ˆæ¯æœåŠ¡">æ¶ˆæ¯æœåŠ¡</a></h2>
<h2><a class="header" href="#ç›‘æ§ç®¡ç†" id="ç›‘æ§ç®¡ç†">ç›‘æ§ç®¡ç†</a></h2>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="spring-note.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="springmvc-note.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="spring-note.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="springmvc-note.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
